<!DOCTYPE html>
<html xmlns="http://www.w3.org/1999/xhtml" lang="en" xml:lang="en"><head>

<meta charset="utf-8">
<meta name="generator" content="quarto-1.6.37">

<meta name="viewport" content="width=device-width, initial-scale=1.0, user-scalable=yes">

<meta name="author" content="Dante Conti, Sergi Ramirez, (c) IDEAI">
<meta name="dcterms.date" content="2025-09-30">

<title>Advance Preprocessing – Machine Learning for Data Scientist</title>
<style>
code{white-space: pre-wrap;}
span.smallcaps{font-variant: small-caps;}
div.columns{display: flex; gap: min(4vw, 1.5em);}
div.column{flex: auto; overflow-x: auto;}
div.hanging-indent{margin-left: 1.5em; text-indent: -1.5em;}
ul.task-list{list-style: none;}
ul.task-list li input[type="checkbox"] {
  width: 0.8em;
  margin: 0 0.8em 0.2em -1em; /* quarto-specific, see https://github.com/quarto-dev/quarto-cli/issues/4556 */ 
  vertical-align: middle;
}
/* CSS for syntax highlighting */
pre > code.sourceCode { white-space: pre; position: relative; }
pre > code.sourceCode > span { line-height: 1.25; }
pre > code.sourceCode > span:empty { height: 1.2em; }
.sourceCode { overflow: visible; }
code.sourceCode > span { color: inherit; text-decoration: inherit; }
div.sourceCode { margin: 1em 0; }
pre.sourceCode { margin: 0; }
@media screen {
div.sourceCode { overflow: auto; }
}
@media print {
pre > code.sourceCode { white-space: pre-wrap; }
pre > code.sourceCode > span { display: inline-block; text-indent: -5em; padding-left: 5em; }
}
pre.numberSource code
  { counter-reset: source-line 0; }
pre.numberSource code > span
  { position: relative; left: -4em; counter-increment: source-line; }
pre.numberSource code > span > a:first-child::before
  { content: counter(source-line);
    position: relative; left: -1em; text-align: right; vertical-align: baseline;
    border: none; display: inline-block;
    -webkit-touch-callout: none; -webkit-user-select: none;
    -khtml-user-select: none; -moz-user-select: none;
    -ms-user-select: none; user-select: none;
    padding: 0 4px; width: 4em;
  }
pre.numberSource { margin-left: 3em;  padding-left: 4px; }
div.sourceCode
  {   }
@media screen {
pre > code.sourceCode > span > a:first-child::before { text-decoration: underline; }
}
</style>


<script src="../../site_libs/quarto-nav/quarto-nav.js"></script>
<script src="../../site_libs/quarto-nav/headroom.min.js"></script>
<script src="../../site_libs/clipboard/clipboard.min.js"></script>
<script src="../../site_libs/quarto-search/autocomplete.umd.js"></script>
<script src="../../site_libs/quarto-search/fuse.min.js"></script>
<script src="../../site_libs/quarto-search/quarto-search.js"></script>
<meta name="quarto:offset" content="../../">
<link href="../../imagenes/ideai_logo.png" rel="icon" type="image/png">
<script src="../../site_libs/quarto-html/quarto.js"></script>
<script src="../../site_libs/quarto-html/popper.min.js"></script>
<script src="../../site_libs/quarto-html/tippy.umd.min.js"></script>
<script src="../../site_libs/quarto-html/anchor.min.js"></script>
<link href="../../site_libs/quarto-html/tippy.css" rel="stylesheet">
<link href="../../site_libs/quarto-html/quarto-syntax-highlighting-29e2c20b02301cfff04dc8050bf30c7e.css" rel="stylesheet" id="quarto-text-highlighting-styles">
<script src="../../site_libs/bootstrap/bootstrap.min.js"></script>
<link href="../../site_libs/bootstrap/bootstrap-icons.css" rel="stylesheet">
<link href="../../site_libs/bootstrap/bootstrap-83f5ffed4bb819e1a410337fb71ccdff.min.css" rel="stylesheet" append-hash="true" id="quarto-bootstrap" data-mode="light">
<script id="quarto-search-options" type="application/json">{
  "location": "navbar",
  "copy-button": false,
  "collapse-after": 3,
  "panel-placement": "end",
  "type": "overlay",
  "limit": 50,
  "keyboard-shortcut": [
    "f",
    "/",
    "s"
  ],
  "show-item-context": false,
  "language": {
    "search-no-results-text": "No results",
    "search-matching-documents-text": "matching documents",
    "search-copy-link-title": "Copy link to search",
    "search-hide-matches-text": "Hide additional matches",
    "search-more-match-text": "more match in this document",
    "search-more-matches-text": "more matches in this document",
    "search-clear-button-title": "Clear",
    "search-text-placeholder": "",
    "search-detached-cancel-button-title": "Cancel",
    "search-submit-button-title": "Submit",
    "search-label": "Search"
  }
}</script>
<link href="../../site_libs/htmltools-fill-0.5.8.1/fill.css" rel="stylesheet">

<script src="../../site_libs/htmlwidgets-1.6.4/htmlwidgets.js"></script>

<script src="../../site_libs/plotly-binding-4.10.4/plotly.js"></script>

<script src="../../site_libs/typedarray-0.1/typedarray.min.js"></script>

<script src="../../site_libs/jquery-3.5.1/jquery.min.js"></script>

<link href="../../site_libs/crosstalk-1.2.1/css/crosstalk.min.css" rel="stylesheet">

<script src="../../site_libs/crosstalk-1.2.1/js/crosstalk.min.js"></script>

<link href="../../site_libs/plotly-htmlwidgets-css-2.11.1/plotly-htmlwidgets.css" rel="stylesheet">

<script src="../../site_libs/plotly-main-2.11.1/plotly-latest.min.js"></script>


  <script src="https://cdnjs.cloudflare.com/polyfill/v3/polyfill.min.js?features=es6"></script>
  <script src="https://cdn.jsdelivr.net/npm/mathjax@3/es5/tex-chtml-full.js" type="text/javascript"></script>

<script type="text/javascript">
const typesetMath = (el) => {
  if (window.MathJax) {
    // MathJax Typeset
    window.MathJax.typeset([el]);
  } else if (window.katex) {
    // KaTeX Render
    var mathElements = el.getElementsByClassName("math");
    var macros = [];
    for (var i = 0; i < mathElements.length; i++) {
      var texText = mathElements[i].firstChild;
      if (mathElements[i].tagName == "SPAN") {
        window.katex.render(texText.data, mathElements[i], {
          displayMode: mathElements[i].classList.contains('display'),
          throwOnError: false,
          macros: macros,
          fleqn: false
        });
      }
    }
  }
}
window.Quarto = {
  typesetMath
};
</script>

<link rel="stylesheet" href="../../styles.css">
</head>

<body class="nav-fixed">

<div id="quarto-search-results"></div>
  <header id="quarto-header" class="headroom fixed-top">
    <nav class="navbar navbar-expand-lg " data-bs-theme="dark">
      <div class="navbar-container container-fluid">
      <div class="navbar-brand-container mx-auto">
    <a class="navbar-brand" href="../../index.html">
    <span class="navbar-title">Machine Learning for Data Scientist</span>
    </a>
  </div>
            <div id="quarto-search" class="" title="Search"></div>
          <button class="navbar-toggler" type="button" data-bs-toggle="collapse" data-bs-target="#navbarCollapse" aria-controls="navbarCollapse" role="menu" aria-expanded="false" aria-label="Toggle navigation" onclick="if (window.quartoToggleHeadroom) { window.quartoToggleHeadroom(); }">
  <span class="navbar-toggler-icon"></span>
</button>
          <div class="collapse navbar-collapse" id="navbarCollapse">
            <ul class="navbar-nav navbar-nav-scroll me-auto">
  <li class="nav-item">
    <a class="nav-link" href="../../index.html"> 
<span class="menu-text">Grau en Estadística</span></a>
  </li>  
</ul>
          </div> <!-- /navcollapse -->
            <div class="quarto-navbar-tools">
</div>
      </div> <!-- /container-fluid -->
    </nav>
</header>
<!-- content -->
<div id="quarto-content" class="quarto-container page-columns page-rows-contents page-layout-article page-navbar">
<!-- sidebar -->
<!-- margin-sidebar -->
    <div id="quarto-margin-sidebar" class="sidebar margin-sidebar"><div class="quarto-margin-header"><div class="margin-header-item">
<p><img src="../..\imagenes/Logo_UPC.svg.png" class="img-fluid"></p>
</div></div>
        <nav id="TOC" role="doc-toc" class="toc-active">
    <h2 id="toc-title">On this page</h2>
   
  <ul>
  <li><a href="#descripción-del-problema" id="toc-descripción-del-problema" class="nav-link active" data-scroll-target="#descripción-del-problema"><span class="header-section-number">1</span> Descripción del problema</a></li>
  <li><a href="#outliers" id="toc-outliers" class="nav-link" data-scroll-target="#outliers"><span class="header-section-number">2</span> Outliers</a>
  <ul class="collapse">
  <li><a href="#univariate" id="toc-univariate" class="nav-link" data-scroll-target="#univariate"><span class="header-section-number">2.1</span> Univariate</a>
  <ul class="collapse">
  <li><a href="#max-and-min" id="toc-max-and-min" class="nav-link" data-scroll-target="#max-and-min"><span class="header-section-number">2.1.1</span> Max and Min</a></li>
  <li><a href="#iqr" id="toc-iqr" class="nav-link" data-scroll-target="#iqr"><span class="header-section-number">2.1.2</span> IQR</a></li>
  <li><a href="#boxplot" id="toc-boxplot" class="nav-link" data-scroll-target="#boxplot"><span class="header-section-number">2.1.3</span> Boxplot</a></li>
  <li><a href="#z-score" id="toc-z-score" class="nav-link" data-scroll-target="#z-score"><span class="header-section-number">2.1.4</span> Z-Score</a></li>
  <li><a href="#hampel-identifier" id="toc-hampel-identifier" class="nav-link" data-scroll-target="#hampel-identifier"><span class="header-section-number">2.1.5</span> Hampel Identifier</a></li>
  <li><a href="#tests-estadístics" id="toc-tests-estadístics" class="nav-link" data-scroll-target="#tests-estadístics"><span class="header-section-number">2.1.6</span> Tests Estadístics</a></li>
  </ul></li>
  <li><a href="#multivariate" id="toc-multivariate" class="nav-link" data-scroll-target="#multivariate"><span class="header-section-number">2.2</span> Multivariate</a></li>
  <li><a href="#cas-general" id="toc-cas-general" class="nav-link" data-scroll-target="#cas-general"><span class="header-section-number">2.3</span> Cas general</a></li>
  <li><a href="#pca" id="toc-pca" class="nav-link" data-scroll-target="#pca"><span class="header-section-number">2.4</span> PCA</a></li>
  <li><a href="#distancia-de-mahalanobis" id="toc-distancia-de-mahalanobis" class="nav-link" data-scroll-target="#distancia-de-mahalanobis"><span class="header-section-number">2.5</span> Distancia de Mahalanobis</a>
  <ul class="collapse">
  <li><a href="#mahalanobis-robusto" id="toc-mahalanobis-robusto" class="nav-link" data-scroll-target="#mahalanobis-robusto"><span class="header-section-number">2.5.1</span> Mahalanobis Robusto</a></li>
  </ul></li>
  <li><a href="#regresió-lineal-i-residus" id="toc-regresió-lineal-i-residus" class="nav-link" data-scroll-target="#regresió-lineal-i-residus"><span class="header-section-number">2.6</span> Regresió Lineal i residus</a></li>
  <li><a href="#distancia-de-cook" id="toc-distancia-de-cook" class="nav-link" data-scroll-target="#distancia-de-cook"><span class="header-section-number">2.7</span> Distancia de Cook</a></li>
  <li><a href="#k-nearest-neighbors-knn-outlier-score" id="toc-k-nearest-neighbors-knn-outlier-score" class="nav-link" data-scroll-target="#k-nearest-neighbors-knn-outlier-score"><span class="header-section-number">2.8</span> K-Nearest Neighbors (KNN) Outlier Score</a></li>
  <li><a href="#local-outlier-factor-lof" id="toc-local-outlier-factor-lof" class="nav-link" data-scroll-target="#local-outlier-factor-lof"><span class="header-section-number">2.9</span> Local Outlier Factor (LOF)</a>
  <ul class="collapse">
  <li><a href="#nueva-versión-de-lof" id="toc-nueva-versión-de-lof" class="nav-link" data-scroll-target="#nueva-versión-de-lof"><span class="header-section-number">2.9.1</span> Nueva versión de LOF</a></li>
  </ul></li>
  <li><a href="#isolation-forest" id="toc-isolation-forest" class="nav-link" data-scroll-target="#isolation-forest"><span class="header-section-number">2.10</span> Isolation Forest</a></li>
  <li><a href="#tips-detección-de-anomalías" id="toc-tips-detección-de-anomalías" class="nav-link" data-scroll-target="#tips-detección-de-anomalías"><span class="header-section-number">2.11</span> TIPS: Detección de anomalías</a></li>
  </ul></li>
  <li><a href="#imputation-methods" id="toc-imputation-methods" class="nav-link" data-scroll-target="#imputation-methods"><span class="header-section-number">3</span> Imputation Methods</a>
  <ul class="collapse">
  <li><a href="#generate-data-with-nas" id="toc-generate-data-with-nas" class="nav-link" data-scroll-target="#generate-data-with-nas"><span class="header-section-number">3.1</span> Generate data with NA’s</a></li>
  <li><a href="#little-test" id="toc-little-test" class="nav-link" data-scroll-target="#little-test"><span class="header-section-number">3.2</span> Little Test</a></li>
  <li><a href="#patrons-descriptius-de-na-en-una-base-de-dades" id="toc-patrons-descriptius-de-na-en-una-base-de-dades" class="nav-link" data-scroll-target="#patrons-descriptius-de-na-en-una-base-de-dades"><span class="header-section-number">3.3</span> Patrons descriptius de NA en una base de dades</a>
  <ul class="collapse">
  <li><a href="#explorar-les-relacions-de-nas" id="toc-explorar-les-relacions-de-nas" class="nav-link" data-scroll-target="#explorar-les-relacions-de-nas"><span class="header-section-number">3.3.1</span> Explorar les relacions de NA’s</a></li>
  <li><a href="#visualització-dels-nas-per-variables" id="toc-visualització-dels-nas-per-variables" class="nav-link" data-scroll-target="#visualització-dels-nas-per-variables"><span class="header-section-number">3.3.2</span> Visualització dels NA’s per variables</a></li>
  <li><a href="#detecció-de-nas-en-la-base-de-dades" id="toc-detecció-de-nas-en-la-base-de-dades" class="nav-link" data-scroll-target="#detecció-de-nas-en-la-base-de-dades"><span class="header-section-number">3.3.3</span> Detecció de NA’s en la base de dades</a></li>
  <li><a href="#extreu-estadístiques-amb-nas-de-la-base-de-dades" id="toc-extreu-estadístiques-amb-nas-de-la-base-de-dades" class="nav-link" data-scroll-target="#extreu-estadístiques-amb-nas-de-la-base-de-dades"><span class="header-section-number">3.3.4</span> Extreu estadístiques amb NAs de la base de dades</a></li>
  </ul></li>
  <li><a href="#imputació-bàsica" id="toc-imputació-bàsica" class="nav-link" data-scroll-target="#imputació-bàsica"><span class="header-section-number">3.4</span> Imputació bàsica</a>
  <ul class="collapse">
  <li><a href="#imputar-amb-valor-mitjà" id="toc-imputar-amb-valor-mitjà" class="nav-link" data-scroll-target="#imputar-amb-valor-mitjà"><span class="header-section-number">3.4.1</span> Imputar amb valor mitjà</a></li>
  </ul></li>
  </ul></li>
  <li><a href="#imputar-amb-valor-aleatori" id="toc-imputar-amb-valor-aleatori" class="nav-link" data-scroll-target="#imputar-amb-valor-aleatori"><span class="header-section-number">4</span> Imputar amb valor aleatori</a>
  <ul class="collapse">
  <li><a href="#representa-la-distribució-a-variables-reals-i-dimputació-a-través-del-gráfico-de-densidad-con-ggplot2" id="toc-representa-la-distribució-a-variables-reals-i-dimputació-a-través-del-gráfico-de-densidad-con-ggplot2" class="nav-link" data-scroll-target="#representa-la-distribució-a-variables-reals-i-dimputació-a-través-del-gráfico-de-densidad-con-ggplot2"><span class="header-section-number">4.0.1</span> Representa la distribució a variables reals i d’imputació a través del gráfico de densidad con ggplot2</a></li>
  <li><a href="#multiple-iterative-regression-imputation-mi-method" id="toc-multiple-iterative-regression-imputation-mi-method" class="nav-link" data-scroll-target="#multiple-iterative-regression-imputation-mi-method"><span class="header-section-number">4.1</span> Multiple Iterative Regression Imputation (MI method)</a></li>
  <li><a href="#media-con-una-variable-target" id="toc-media-con-una-variable-target" class="nav-link" data-scroll-target="#media-con-una-variable-target"><span class="header-section-number">4.2</span> Media con una variable target</a></li>
  <li><a href="#multiple-imputation-by-chained-equations-mice" id="toc-multiple-imputation-by-chained-equations-mice" class="nav-link" data-scroll-target="#multiple-imputation-by-chained-equations-mice"><span class="header-section-number">4.3</span> Multiple Imputation by Chained Equations (MICE)</a>
  <ul class="collapse">
  <li><a href="#exercices" id="toc-exercices" class="nav-link" data-scroll-target="#exercices"><span class="header-section-number">4.3.1</span> Exercices:</a></li>
  </ul></li>
  <li><a href="#knn" id="toc-knn" class="nav-link" data-scroll-target="#knn"><span class="header-section-number">4.4</span> KNN</a>
  <ul class="collapse">
  <li><a href="#exercices-1" id="toc-exercices-1" class="nav-link" data-scroll-target="#exercices-1"><span class="header-section-number">4.4.1</span> Exercices:</a></li>
  </ul></li>
  <li><a href="#missforest" id="toc-missforest" class="nav-link" data-scroll-target="#missforest"><span class="header-section-number">4.5</span> missForest</a>
  <ul class="collapse">
  <li><a href="#exercises" id="toc-exercises" class="nav-link" data-scroll-target="#exercises"><span class="header-section-number">4.5.1</span> Exercises:</a></li>
  <li><a href="#extra" id="toc-extra" class="nav-link" data-scroll-target="#extra"><span class="header-section-number">4.5.2</span> Extra:</a></li>
  </ul></li>
  </ul></li>
  <li><a href="#bibliografía" id="toc-bibliografía" class="nav-link" data-scroll-target="#bibliografía"><span class="header-section-number">5</span> Bibliografía</a>
  <ul class="collapse">
  <li><a href="#outliers-1" id="toc-outliers-1" class="nav-link" data-scroll-target="#outliers-1"><span class="header-section-number">5.1</span> Outliers</a></li>
  <li><a href="#imputación" id="toc-imputación" class="nav-link" data-scroll-target="#imputación"><span class="header-section-number">5.2</span> Imputación</a></li>
  </ul></li>
  </ul>
</nav>
    </div>
<!-- main -->
<main class="content" id="quarto-document-content">

<header id="title-block-header" class="quarto-title-block default">
<div class="quarto-title">
<h1 class="title">Advance Preprocessing</h1>
</div>



<div class="quarto-title-meta">

    <div>
    <div class="quarto-title-meta-heading">Author</div>
    <div class="quarto-title-meta-contents">
             <p>Dante Conti, Sergi Ramirez, (c) IDEAI </p>
          </div>
  </div>
    
    <div>
    <div class="quarto-title-meta-heading">Published</div>
    <div class="quarto-title-meta-contents">
      <p class="date">September 30, 2025</p>
    </div>
  </div>
  
    <div>
    <div class="quarto-title-meta-heading">Modified</div>
    <div class="quarto-title-meta-contents">
      <p class="date-modified">September 30, 2025</p>
    </div>
  </div>
    
  </div>
  


</header>


<section id="descripción-del-problema" class="level1" data-number="1">
<h1 data-number="1"><span class="header-section-number">1</span> Descripción del problema</h1>
<p>Para hacer el apartado de preprocessing vamos a utilizar la base de datos <a href="https://www.kaggle.com/datasets/anyasorc/valentine-dataset"><code>valentine_dataset.csv</code></a>.</p>
</section>
<section id="outliers" class="level1" data-number="2">
<h1 data-number="2"><span class="header-section-number">2</span> Outliers</h1>
<section id="univariate" class="level2" data-number="2.1">
<h2 data-number="2.1" class="anchored" data-anchor-id="univariate"><span class="header-section-number">2.1</span> Univariate</h2>
<section id="max-and-min" class="level3" data-number="2.1.1">
<h3 data-number="2.1.1" class="anchored" data-anchor-id="max-and-min"><span class="header-section-number">2.1.1</span> Max and Min</h3>
<div class="cell">
<div class="sourceCode cell-code" id="cb1"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb1-1"><a href="#cb1-1" aria-hidden="true" tabindex="-1"></a><span class="fu">mapply</span>(<span class="cf">function</span>(x, name) {</span>
<span id="cb1-2"><a href="#cb1-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">cat</span>(<span class="st">"var. "</span>, name, <span class="st">": </span><span class="sc">\n\t</span><span class="st"> min: "</span>, <span class="fu">min</span>(x), <span class="st">"</span><span class="sc">\n\t</span><span class="st"> max: "</span>, <span class="fu">max</span>(x), <span class="st">"</span><span class="sc">\n</span><span class="st">"</span>)</span>
<span id="cb1-3"><a href="#cb1-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">invisible</span>(<span class="cn">NULL</span>)  <span class="co"># Evita la salida de valores NULL</span></span>
<span id="cb1-4"><a href="#cb1-4" aria-hidden="true" tabindex="-1"></a>}, dades[, varNum], <span class="fu">colnames</span>(dades[, varNum]))</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>var.  Age : 
     min:  18 
     max:  40 
var.  Income : 
     min:  20004 
     max:  79998 
var.  Appearance_Score : 
     min:  0 
     max:  99.99 
var.  Interests_Score : 
     min:  0.01 
     max:  100 
var.  Confidence_Score : 
     min:  0.01 
     max:  100 </code></pre>
</div>
<div class="cell-output cell-output-stdout">
<pre><code>$Age
NULL

$Income
NULL

$Appearance_Score
NULL

$Interests_Score
NULL

$Confidence_Score
NULL</code></pre>
</div>
</div>
</section>
<section id="iqr" class="level3" data-number="2.1.2">
<h3 data-number="2.1.2" class="anchored" data-anchor-id="iqr"><span class="header-section-number">2.1.2</span> IQR</h3>
<p>Es defineixen outliers els punts fora de <span class="math inline">\([Q1 - 1.5xIQR, Q3 + 1.5xIQR]\)</span></p>
<div class="cell">
<div class="sourceCode cell-code" id="cb4"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb4-1"><a href="#cb4-1" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(EnvStats)</span>
<span id="cb4-2"><a href="#cb4-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb4-3"><a href="#cb4-3" aria-hidden="true" tabindex="-1"></a>IQROutlier <span class="ot">&lt;-</span> <span class="cf">function</span>(variable, <span class="at">rmnas =</span> <span class="cn">TRUE</span>) {</span>
<span id="cb4-4"><a href="#cb4-4" aria-hidden="true" tabindex="-1"></a>  IQ <span class="ot">&lt;-</span> <span class="fu">iqr</span>(variable, <span class="at">na.rm =</span> rmnas)</span>
<span id="cb4-5"><a href="#cb4-5" aria-hidden="true" tabindex="-1"></a>  intInf <span class="ot">&lt;-</span> <span class="fu">quantile</span>(variable, <span class="at">probs =</span> <span class="fu">c</span>(<span class="fl">0.25</span>, <span class="fl">0.75</span>))[[<span class="dv">1</span>]] <span class="sc">-</span> <span class="fl">1.5</span><span class="sc">*</span>IQ</span>
<span id="cb4-6"><a href="#cb4-6" aria-hidden="true" tabindex="-1"></a>  intSup <span class="ot">&lt;-</span> <span class="fu">quantile</span>(variable, <span class="at">probs =</span> <span class="fu">c</span>(<span class="fl">0.25</span>, <span class="fl">0.75</span>))[[<span class="dv">2</span>]] <span class="sc">+</span> <span class="fl">1.5</span><span class="sc">*</span>IQ</span>
<span id="cb4-7"><a href="#cb4-7" aria-hidden="true" tabindex="-1"></a>  posicions <span class="ot">&lt;-</span> <span class="fu">which</span>(variable <span class="sc">&gt;=</span> intSup <span class="sc">|</span> variable <span class="sc">&lt;=</span> intInf)</span>
<span id="cb4-8"><a href="#cb4-8" aria-hidden="true" tabindex="-1"></a>  <span class="cf">if</span> (<span class="fu">length</span>(posicions) <span class="sc">&gt;</span> <span class="dv">0</span>) {</span>
<span id="cb4-9"><a href="#cb4-9" aria-hidden="true" tabindex="-1"></a>    <span class="fu">cat</span>(<span class="st">"Existeixen outliers en les posicions:"</span>, <span class="fu">paste0</span>(posicions, <span class="at">collapse =</span> <span class="st">", "</span>))</span>
<span id="cb4-10"><a href="#cb4-10" aria-hidden="true" tabindex="-1"></a>  } <span class="cf">else</span> {</span>
<span id="cb4-11"><a href="#cb4-11" aria-hidden="true" tabindex="-1"></a>    <span class="fu">cat</span>(<span class="st">"No existeixen outliers"</span>)</span>
<span id="cb4-12"><a href="#cb4-12" aria-hidden="true" tabindex="-1"></a>  }</span>
<span id="cb4-13"><a href="#cb4-13" aria-hidden="true" tabindex="-1"></a>  <span class="fu">return</span>(posicions)</span>
<span id="cb4-14"><a href="#cb4-14" aria-hidden="true" tabindex="-1"></a>}</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<div class="cell">
<div class="cell-output cell-output-stdout">
<pre><code>No existeixen outliers</code></pre>
</div>
<div class="cell-output cell-output-stdout">
<pre><code>integer(0)</code></pre>
</div>
</div>
</section>
<section id="boxplot" class="level3" data-number="2.1.3">
<h3 data-number="2.1.3" class="anchored" data-anchor-id="boxplot"><span class="header-section-number">2.1.3</span> Boxplot</h3>
<p>Visualització basada en IQR per detectar outliers.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb7"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb7-1"><a href="#cb7-1" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(ggplot2)</span>
<span id="cb7-2"><a href="#cb7-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb7-3"><a href="#cb7-3" aria-hidden="true" tabindex="-1"></a>variable <span class="ot">&lt;-</span> <span class="st">"Age"</span></span>
<span id="cb7-4"><a href="#cb7-4" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb7-5"><a href="#cb7-5" aria-hidden="true" tabindex="-1"></a><span class="fu">boxplot</span>(dades[, variable])</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<div>
<figure class="figure">
<p><img src="AdvancedPreprocessing_files/figure-html/boxplot-1.png" class="img-fluid figure-img" width="672"></p>
</figure>
</div>
</div>
<div class="sourceCode cell-code" id="cb8"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb8-1"><a href="#cb8-1" aria-hidden="true" tabindex="-1"></a><span class="fu">boxplot.stats</span>(dades[, variable])<span class="sc">$</span>out</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>integer(0)</code></pre>
</div>
<div class="sourceCode cell-code" id="cb10"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb10-1"><a href="#cb10-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Crear un boxplot</span></span>
<span id="cb10-2"><a href="#cb10-2" aria-hidden="true" tabindex="-1"></a><span class="fu">ggplot</span>(dades, <span class="fu">aes</span>(<span class="at">y =</span> <span class="fu">get</span>(variable))) <span class="sc">+</span></span>
<span id="cb10-3"><a href="#cb10-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_boxplot</span>(<span class="at">fill =</span> <span class="st">"skyblue"</span>, <span class="at">color =</span> <span class="st">"black"</span>) <span class="sc">+</span></span>
<span id="cb10-4"><a href="#cb10-4" aria-hidden="true" tabindex="-1"></a>  <span class="fu">labs</span>(<span class="at">title =</span> <span class="fu">paste0</span>(<span class="st">"Boxplot de "</span>, variable)) <span class="sc">+</span></span>
<span id="cb10-5"><a href="#cb10-5" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme_minimal</span>()</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<div>
<figure class="figure">
<p><img src="AdvancedPreprocessing_files/figure-html/boxplot-2.png" class="img-fluid figure-img" width="672"></p>
</figure>
</div>
</div>
</div>
</section>
<section id="z-score" class="level3" data-number="2.1.4">
<h3 data-number="2.1.4" class="anchored" data-anchor-id="z-score"><span class="header-section-number">2.1.4</span> Z-Score</h3>
<p>Un outlier es un valor amb |z| &gt; 3 deviació estándar</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb11"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb11-1"><a href="#cb11-1" aria-hidden="true" tabindex="-1"></a>variable <span class="ot">&lt;-</span> <span class="st">"Age"</span></span>
<span id="cb11-2"><a href="#cb11-2" aria-hidden="true" tabindex="-1"></a>valorEscalado <span class="ot">&lt;-</span> <span class="fu">scale</span>(dades[, variable])</span>
<span id="cb11-3"><a href="#cb11-3" aria-hidden="true" tabindex="-1"></a><span class="fu">hist</span>(valorEscalado)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<div>
<figure class="figure">
<p><img src="AdvancedPreprocessing_files/figure-html/z_score-1.png" class="img-fluid figure-img" width="672"></p>
</figure>
</div>
</div>
<div class="sourceCode cell-code" id="cb12"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb12-1"><a href="#cb12-1" aria-hidden="true" tabindex="-1"></a><span class="fu">ggplot</span>(<span class="fu">data.frame</span>(<span class="at">valor =</span> valorEscalado), <span class="fu">aes</span>(<span class="at">x =</span> valor)) <span class="sc">+</span></span>
<span id="cb12-2"><a href="#cb12-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_histogram</span>(<span class="at">binwidth =</span> <span class="fl">0.5</span>, <span class="at">fill =</span> <span class="st">"skyblue"</span>, <span class="at">color =</span> <span class="st">"black"</span>) <span class="sc">+</span>  <span class="co"># Histograma</span></span>
<span id="cb12-3"><a href="#cb12-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_vline</span>(<span class="at">xintercept =</span> <span class="fu">c</span>(<span class="dv">3</span>, <span class="sc">-</span><span class="dv">3</span>), <span class="at">linetype =</span> <span class="st">"dashed"</span>, <span class="at">color =</span> <span class="st">"red"</span>, <span class="at">size =</span> <span class="dv">1</span>) <span class="sc">+</span> <span class="co"># Líneas horizontales</span></span>
<span id="cb12-4"><a href="#cb12-4" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme_minimal</span>()</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<div>
<figure class="figure">
<p><img src="AdvancedPreprocessing_files/figure-html/z_score-2.png" class="img-fluid figure-img" width="672"></p>
</figure>
</div>
</div>
</div>
</section>
<section id="hampel-identifier" class="level3" data-number="2.1.5">
<h3 data-number="2.1.5" class="anchored" data-anchor-id="hampel-identifier"><span class="header-section-number">2.1.5</span> Hampel Identifier</h3>
<p>Utilitza la mediana i la desviació absoluta mediana (MAD) en lloc de la mitjana</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb13"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb13-1"><a href="#cb13-1" aria-hidden="true" tabindex="-1"></a>variable <span class="ot">&lt;-</span> <span class="st">"Age"</span></span>
<span id="cb13-2"><a href="#cb13-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb13-3"><a href="#cb13-3" aria-hidden="true" tabindex="-1"></a>lower_bound <span class="ot">&lt;-</span> <span class="fu">median</span>(dades[, variable]) <span class="sc">-</span> <span class="dv">3</span> <span class="sc">*</span> <span class="fu">mad</span>(dades[, variable], <span class="at">constant =</span> <span class="dv">1</span>)</span>
<span id="cb13-4"><a href="#cb13-4" aria-hidden="true" tabindex="-1"></a>upper_bound <span class="ot">&lt;-</span> <span class="fu">median</span>(dades[, variable]) <span class="sc">+</span> <span class="dv">3</span> <span class="sc">*</span> <span class="fu">mad</span>(dades[, variable], <span class="at">constant =</span> <span class="dv">1</span>)</span>
<span id="cb13-5"><a href="#cb13-5" aria-hidden="true" tabindex="-1"></a>outlier_ind <span class="ot">&lt;-</span> <span class="fu">which</span>((dades[, variable] <span class="sc">&lt;</span> lower_bound) <span class="sc">|</span> (dades[, variable] <span class="sc">&gt;</span> upper_bound))</span>
<span id="cb13-6"><a href="#cb13-6" aria-hidden="true" tabindex="-1"></a>outlier_ind</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>integer(0)</code></pre>
</div>
</div>
</section>
<section id="tests-estadístics" class="level3" data-number="2.1.6">
<h3 data-number="2.1.6" class="anchored" data-anchor-id="tests-estadístics"><span class="header-section-number">2.1.6</span> Tests Estadístics</h3>
<section id="grubbs-test" class="level4" data-number="2.1.6.1">
<h4 data-number="2.1.6.1" class="anchored" data-anchor-id="grubbs-test"><span class="header-section-number">2.1.6.1</span> Grubbs’ Test</h4>
<p>Detecta valors extrems en una distribució normal</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb15"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb15-1"><a href="#cb15-1" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(outliers)</span>
<span id="cb15-2"><a href="#cb15-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb15-3"><a href="#cb15-3" aria-hidden="true" tabindex="-1"></a>variable <span class="ot">&lt;-</span> <span class="st">"Age"</span></span>
<span id="cb15-4"><a href="#cb15-4" aria-hidden="true" tabindex="-1"></a>test <span class="ot">&lt;-</span> outliers<span class="sc">::</span><span class="fu">grubbs.test</span>(dades[, variable], <span class="at">opposite =</span> <span class="cn">TRUE</span>)</span>
<span id="cb15-5"><a href="#cb15-5" aria-hidden="true" tabindex="-1"></a><span class="co"># amb el paràmetre opposite controles quina de les dues cues están buscant</span></span>
<span id="cb15-6"><a href="#cb15-6" aria-hidden="true" tabindex="-1"></a>test</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>
    Grubbs test for one outlier

data:  dades[, variable]
G = 1.65591, U = 0.99986, p-value = 1
alternative hypothesis: highest value 40 is an outlier</code></pre>
</div>
</div>
</section>
<section id="dixons-test" class="level4" data-number="2.1.6.2">
<h4 data-number="2.1.6.2" class="anchored" data-anchor-id="dixons-test"><span class="header-section-number">2.1.6.2</span> Dixon’s Test</h4>
<p>Només utilitzar per a bbdd petites (entre 3 - 30) observacions</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb17"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb17-1"><a href="#cb17-1" aria-hidden="true" tabindex="-1"></a>variable <span class="ot">&lt;-</span> <span class="st">"Age"</span></span>
<span id="cb17-2"><a href="#cb17-2" aria-hidden="true" tabindex="-1"></a>test <span class="ot">&lt;-</span> outliers<span class="sc">::</span><span class="fu">dixon.test</span>(dades[, variable], <span class="at">opposite =</span> <span class="cn">FALSE</span>)</span>
<span id="cb17-3"><a href="#cb17-3" aria-hidden="true" tabindex="-1"></a>test</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
</section>
<section id="rosners-test" class="level4" data-number="2.1.6.3">
<h4 data-number="2.1.6.3" class="anchored" data-anchor-id="rosners-test"><span class="header-section-number">2.1.6.3</span> Rosner’s Test</h4>
<p>La prueba de Rosner para valores atípicos tiene las ventajas de que: 1. se utiliza para detectar varios valores atípicos a la vez (a diferencia de la prueba de Grubbs y Dixon, que debe realizarse de forma iterativa para detectar múltiples valores atípicos), 2. Está diseñado para evitar el problema del enmascaramiento, donde un valor atípico cercano en valor a otro valor atípico puede pasar desapercibido.</p>
<p>A diferencia de la prueba de Dixon, tenga en cuenta que la prueba de Rosner es más apropiada cuando el tamaño de la muestra es grande (n ≥ 20).</p>
<p>Esta función requiere al menos dos argumentos: - los datos - la cantidad de valores atípicos sospechosos k (k = 3 como cantidad predeterminada)</p>
<p>Asumeix normalitat de les dades</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb18"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb18-1"><a href="#cb18-1" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(EnvStats)</span>
<span id="cb18-2"><a href="#cb18-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb18-3"><a href="#cb18-3" aria-hidden="true" tabindex="-1"></a>variable <span class="ot">&lt;-</span> <span class="st">"Age"</span></span>
<span id="cb18-4"><a href="#cb18-4" aria-hidden="true" tabindex="-1"></a>test <span class="ot">&lt;-</span> EnvStats<span class="sc">::</span><span class="fu">rosnerTest</span>(dades[, variable], <span class="at">k =</span> <span class="dv">1</span>)</span>
<span id="cb18-5"><a href="#cb18-5" aria-hidden="true" tabindex="-1"></a>test</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>$distribution
[1] "Normal"

$statistic
     R.1 
1.666119 

$sample.size
[1] 20000

$parameters
k 
1 

$alpha
[1] 0.05

$crit.value
lambda.1 
4.706884 

$n.outliers
[1] 0

$alternative
[1] "Up to 1 observations are not\n                                 from the same Distribution."

$method
[1] "Rosner's Test for Outliers"

$data
    [1] 26 23 34 37 38 40 28 32 30 28 23 25 26 23 30 28 22 20 38 27 27 27 33 33
   [25] 33 38 26 33 22 27 23 37 35 34 19 23 40 19 25 25 33 24 24 21 22 36 37 38
   [49] 22 29 28 30 20 25 38 29 28 33 25 31 26 38 19 30 24 21 19 21 26 25 28 34
   [73] 18 33 22 19 34 28 37 39 26 30 26 34 38 32 29 21 31 19 21 27 19 27 26 38
   [97] 29 37 35 26 18 32 40 27 29 39 40 23 26 40 26 31 23 30 29 34 31 26 21 22
  [121] 37 28 20 21 35 18 22 36 40 24 18 33 25 34 34 33 25 24 35 20 19 20 20 19
  [145] 20 39 21 31 30 28 30 18 20 32 27 29 30 18 21 35 32 19 21 33 39 19 23 18
  [169] 31 18 37 35 32 18 26 20 24 39 20 27 38 34 39 25 25 22 26 37 40 27 34 38
  [193] 39 34 22 34 40 30 27 39 38 40 18 24 29 27 33 25 35 37 29 20 33 33 40 38
  [217] 20 20 32 36 20 32 22 36 32 35 34 30 20 39 24 23 22 29 20 35 21 40 24 21
  [241] 40 20 26 31 32 32 32 18 29 33 30 34 21 32 20 26 21 19 32 36 19 21 40 22
  [265] 19 18 36 31 28 23 23 36 29 33 40 38 31 32 39 18 33 31 30 34 28 25 36 21
  [289] 20 21 31 30 31 30 25 20 31 33 33 21 20 27 34 18 32 22 27 32 40 22 26 37
  [313] 38 18 38 29 40 31 26 28 33 28 19 29 25 31 30 24 24 20 23 20 40 36 37 27
  [337] 32 18 35 33 25 34 28 21 32 35 24 23 39 27 27 34 24 39 27 31 36 20 39 24
  [361] 25 35 29 32 40 33 30 24 29 24 20 27 18 30 19 20 33 20 28 39 34 40 21 36
  [385] 22 32 21 38 30 36 38 25 25 25 27 33 18 21 26 20 40 31 39 22 18 21 25 20
  [409] 39 20 31 37 37 24 26 36 38 33 24 23 24 32 24 24 29 23 20 20 28 40 19 20
  [433] 33 38 38 34 22 25 21 27 36 19 19 37 30 33 26 20 40 18 35 23 23 34 20 20
  [457] 29 22 37 18 22 31 25 30 34 23 38 20 18 40 35 38 33 21 32 37 34 38 36 22
  [481] 26 18 37 35 34 29 32 33 39 35 34 35 28 34 35 39 37 40 33 40 25 36 34 29
  [505] 39 23 35 23 38 20 26 34 28 30 38 32 39 30 18 28 40 37 33 24 37 39 23 24
  [529] 31 24 19 27 32 29 38 39 18 22 29 28 32 35 23 40 19 28 26 19 37 40 39 24
  [553] 23 38 24 34 24 18 40 31 27 34 25 24 40 34 27 37 39 26 26 34 38 27 38 32
  [577] 27 27 32 36 33 26 37 21 36 23 30 35 25 32 37 27 33 30 39 21 34 25 37 36
  [601] 20 21 31 26 21 33 25 19 23 36 27 36 31 23 27 20 21 39 35 33 20 35 19 36
  [625] 32 33 22 36 38 39 38 24 19 37 20 29 36 35 36 37 27 35 31 40 39 30 26 23
  [649] 34 23 25 30 38 27 23 35 33 25 23 30 39 22 28 20 31 23 18 39 29 25 20 31
  [673] 22 26 29 26 31 26 36 38 35 20 38 20 25 28 26 28 18 22 19 24 28 35 24 32
  [697] 18 23 34 30 19 39 18 22 27 32 28 20 26 35 36 38 19 40 36 31 38 18 24 19
  [721] 23 37 36 38 34 34 19 24 22 25 20 23 32 38 40 36 36 22 20 33 23 25 29 27
  [745] 40 20 30 25 32 24 28 18 20 34 28 20 40 30 25 34 31 30 31 32 20 30 33 38
  [769] 22 30 23 24 38 38 27 25 36 37 23 37 27 29 26 27 18 29 18 26 31 26 21 32
  [793] 30 37 34 28 40 29 31 32 22 26 19 25 28 37 29 33 24 18 33 19 29 18 23 28
  [817] 37 34 20 31 39 33 30 32 35 29 23 39 37 30 19 36 26 18 33 35 30 29 32 30
  [841] 20 31 32 33 23 20 33 30 39 31 30 38 31 23 39 38 20 40 40 36 18 35 38 32
  [865] 23 39 23 30 40 20 22 22 21 39 20 25 26 18 40 33 34 26 35 39 36 26 21 38
  [889] 21 31 25 32 37 20 35 34 37 31 28 31 27 19 18 33 28 26 35 26 24 19 24 33
  [913] 35 35 25 25 34 31 24 24 23 24 21 38 38 39 32 31 26 33 18 22 38 24 30 20
  [937] 27 35 25 22 22 23 40 27 38 39 18 21 35 33 39 32 31 31 32 22 28 19 32 20
  [961] 27 28 28 31 28 27 38 19 34 23 23 33 23 31 38 18 37 40 28 21 36 21 39 38
  [985] 37 21 26 29 30 27 26 39 18 25 28 32 30 29 25 19 22 24 19 35 30 23 37 22
 [1009] 20 32 38 29 30 38 25 21 20 36 30 39 28 32 23 30 21 18 22 35 37 27 29 19
 [1033] 26 29 26 18 34 34 22 35 20 40 40 34 29 31 29 20 18 23 18 24 34 36 38 40
 [1057] 22 40 22 37 33 18 40 36 36 40 38 21 32 27 35 34 29 26 27 22 28 35 37 18
 [1081] 21 26 37 25 40 19 33 39 33 28 30 34 34 37 33 36 24 21 26 34 24 27 20 38
 [1105] 22 29 37 23 24 30 37 39 24 40 30 34 27 23 19 26 28 39 27 27 24 37 35 34
 [1129] 36 40 29 19 39 21 29 23 28 38 21 19 20 19 34 40 22 35 23 31 22 26 25 22
 [1153] 35 38 31 26 38 23 28 36 26 30 24 36 34 26 24 30 38 31 31 36 33 25 37 25
 [1177] 19 28 26 37 36 26 18 28 30 40 21 26 34 29 35 35 28 40 22 36 34 31 26 24
 [1201] 34 33 31 38 38 25 38 20 30 26 34 18 26 22 18 22 35 29 29 32 31 29 34 31
 [1225] 32 21 32 18 37 18 20 25 39 32 23 23 30 29 28 20 18 32 24 21 36 23 28 38
 [1249] 20 37 22 33 27 31 36 25 39 24 20 33 40 22 23 21 37 37 26 35 40 32 35 39
 [1273] 37 20 35 38 40 18 32 39 21 27 36 29 22 21 26 25 33 23 35 23 24 22 24 32
 [1297] 31 21 26 22 38 35 28 38 38 39 28 30 37 37 29 24 33 19 20 30 33 35 32 34
 [1321] 29 31 25 19 19 21 26 33 32 32 18 18 33 40 33 28 25 27 20 26 28 32 34 34
 [1345] 21 33 23 21 25 31 22 23 37 25 37 26 19 34 28 27 28 32 35 32 30 19 26 31
 [1369] 22 40 39 30 37 26 22 36 28 23 39 30 37 21 31 32 28 28 31 37 27 29 21 22
 [1393] 35 34 20 18 21 32 24 37 22 39 30 22 30 20 25 39 38 31 36 36 34 35 37 21
 [1417] 32 25 20 23 39 37 38 32 18 32 33 20 35 38 40 18 31 25 22 31 32 31 26 38
 [1441] 20 36 33 40 40 37 40 31 32 24 19 36 32 37 26 32 31 22 20 40 22 35 28 29
 [1465] 23 27 24 30 39 39 20 23 24 40 20 28 24 31 33 31 21 24 40 18 38 21 33 40
 [1489] 30 35 33 18 32 39 24 21 33 34 27 29 22 29 37 22 19 30 39 35 22 32 35 33
 [1513] 37 40 19 31 23 20 30 36 35 39 40 18 23 32 23 36 27 35 24 27 38 24 31 36
 [1537] 32 25 33 21 38 29 21 40 21 30 31 35 27 33 27 35 36 22 38 35 22 34 28 31
 [1561] 27 33 22 29 24 21 25 21 35 20 21 35 20 25 34 31 21 38 32 18 36 35 24 40
 [1585] 32 34 26 36 39 32 29 39 34 38 30 18 33 39 23 19 21 24 33 27 32 22 22 39
 [1609] 35 18 21 29 33 20 37 23 26 37 39 24 31 25 31 26 20 24 30 39 32 21 37 40
 [1633] 39 28 20 21 35 26 38 37 34 22 40 37 18 19 29 36 34 24 40 40 32 30 35 28
 [1657] 25 32 23 35 22 36 20 39 40 19 35 28 25 31 26 25 22 22 30 32 36 27 21 29
 [1681] 37 40 37 30 30 29 30 36 24 24 18 38 22 19 30 19 37 34 31 40 36 32 25 23
 [1705] 40 36 26 20 40 21 34 26 35 37 31 23 34 32 29 34 30 24 38 32 35 28 32 36
 [1729] 18 40 31 32 39 35 21 18 25 38 26 39 39 39 24 29 27 30 32 19 35 33 20 38
 [1753] 27 29 35 38 19 33 18 30 39 40 24 38 27 20 23 27 28 34 18 36 37 22 36 35
 [1777] 38 24 32 34 29 26 37 25 22 25 36 18 20 26 38 19 22 37 18 36 28 29 25 40
 [1801] 36 31 23 30 29 28 29 20 32 22 24 39 26 28 26 19 37 39 22 34 32 24 25 29
 [1825] 22 34 25 23 26 39 32 20 39 30 24 25 32 29 38 34 23 27 34 21 20 37 20 38
 [1849] 38 32 40 35 19 25 23 23 33 37 36 35 33 30 23 31 19 29 36 38 23 32 19 28
 [1873] 19 34 19 24 37 40 35 35 35 34 32 29 29 40 35 20 37 34 22 20 20 27 23 21
 [1897] 36 32 21 27 30 32 18 32 37 23 34 24 38 19 25 21 34 32 36 40 35 34 36 26
 [1921] 36 26 32 24 29 29 21 35 37 19 30 25 34 22 20 31 39 30 21 38 20 35 36 22
 [1945] 38 35 30 23 29 26 33 39 40 40 20 27 18 29 33 33 25 38 30 33 18 27 21 34
 [1969] 30 38 34 23 29 21 37 32 20 21 20 27 22 29 33 40 30 32 39 19 27 29 39 37
 [1993] 40 37 22 25 18 35 36 19 18 38 20 33 20 25 38 39 18 27 21 26 32 37 33 38
 [2017] 37 36 40 34 34 39 34 23 37 29 22 33 38 35 31 39 35 22 24 40 37 34 35 24
 [2041] 19 36 37 35 37 34 38 23 24 24 34 27 26 22 30 21 28 26 24 31 18 18 37 30
 [2065] 34 33 19 36 31 25 28 39 25 40 22 18 36 21 29 23 19 22 36 23 30 28 40 18
 [2089] 36 23 25 33 21 30 31 22 26 28 27 22 19 22 31 40 40 39 21 37 27 36 36 39
 [2113] 27 28 35 24 24 21 18 23 27 38 26 28 22 23 32 30 39 23 20 29 40 28 23 31
 [2137] 22 29 28 18 39 32 40 30 40 40 23 33 30 39 28 29 26 40 19 40 21 31 28 29
 [2161] 37 24 28 40 20 28 22 28 30 26 39 39 24 33 33 30 23 34 19 37 24 20 28 25
 [2185] 39 30 18 29 39 36 31 18 24 29 39 36 33 35 19 39 40 31 24 21 39 36 19 33
 [2209] 28 32 32 39 36 40 35 40 25 26 40 20 18 35 29 40 18 18 38 29 29 25 27 19
 [2233] 31 22 22 40 38 23 30 24 24 39 33 40 26 30 21 33 21 18 27 28 33 20 33 19
 [2257] 35 25 38 24 26 24 26 29 20 27 39 26 31 33 31 36 34 40 40 28 38 29 32 34
 [2281] 18 27 20 23 22 19 28 19 38 35 18 33 20 24 18 33 27 39 30 30 25 20 25 22
 [2305] 32 39 40 30 19 28 36 19 39 31 25 36 24 28 32 23 29 30 35 18 21 27 35 40
 [2329] 36 29 19 28 26 26 36 27 36 26 26 29 37 36 22 22 18 24 33 23 38 40 18 30
 [2353] 22 26 33 20 28 39 25 22 40 21 40 38 30 21 35 21 19 25 22 27 38 24 28 28
 [2377] 36 22 26 22 18 19 21 39 20 27 30 21 25 18 23 34 20 34 34 21 23 23 27 31
 [2401] 31 23 24 36 29 26 28 24 35 29 38 24 35 22 20 19 20 24 32 26 32 23 28 40
 [2425] 28 36 30 26 23 40 27 26 30 23 20 39 23 40 31 36 31 19 36 33 29 32 20 22
 [2449] 31 27 35 25 35 26 30 26 35 37 22 24 30 36 39 39 29 38 27 31 31 24 28 20
 [2473] 34 19 32 24 18 26 35 40 34 36 24 34 21 22 39 35 25 32 25 38 21 25 24 22
 [2497] 31 27 22 18 33 20 27 33 38 30 35 24 26 21 25 38 21 38 39 39 28 23 24 35
 [2521] 29 33 34 40 40 27 23 39 23 37 29 33 23 30 35 38 21 31 23 40 39 18 34 25
 [2545] 37 18 24 26 39 35 25 37 39 32 27 23 22 31 32 23 32 29 31 31 33 35 31 37
 [2569] 20 36 31 19 25 37 26 38 40 20 35 35 20 18 40 36 40 28 35 18 39 32 20 35
 [2593] 21 32 35 35 25 33 23 34 31 31 22 38 24 31 38 27 24 33 18 29 29 36 19 21
 [2617] 37 38 21 26 23 36 36 31 19 18 37 26 36 27 40 35 29 23 26 34 18 19 19 18
 [2641] 38 35 25 25 34 39 22 22 28 27 18 27 33 40 37 26 21 38 23 38 30 36 33 21
 [2665] 32 33 28 38 18 29 36 26 39 34 40 29 33 24 37 22 24 25 22 27 39 40 24 35
 [2689] 37 21 32 20 27 39 39 35 35 33 33 29 30 21 23 26 35 30 26 38 32 38 26 36
 [2713] 37 28 35 19 31 33 20 19 31 25 28 30 34 25 27 37 30 31 40 29 32 35 32 32
 [2737] 22 19 39 36 19 28 26 19 18 31 38 27 24 38 32 25 26 32 36 29 27 22 32 21
 [2761] 38 18 24 21 39 28 25 38 18 20 37 21 34 24 36 21 23 19 26 35 32 27 22 33
 [2785] 34 27 18 26 24 26 22 24 30 23 30 32 26 32 39 32 34 38 26 21 18 25 36 20
 [2809] 18 40 35 18 23 31 21 24 36 28 34 31 24 26 40 30 19 20 32 35 36 27 36 27
 [2833] 30 30 32 23 23 24 24 18 31 39 34 31 30 22 27 36 32 24 36 28 19 35 23 37
 [2857] 37 31 19 40 20 35 20 30 21 29 27 35 18 27 24 21 21 28 30 19 34 38 35 32
 [2881] 37 27 37 32 23 34 29 20 39 29 19 31 33 32 29 38 38 22 35 26 29 37 34 28
 [2905] 40 20 40 19 34 26 20 40 31 36 40 30 24 25 24 26 20 20 34 33 19 36 29 29
 [2929] 23 38 21 34 29 35 18 39 22 40 30 23 38 36 34 33 32 25 24 27 35 39 23 33
 [2953] 32 23 34 34 38 34 20 33 38 30 40 22 38 35 30 40 27 20 29 27 22 30 40 35
 [2977] 22 37 33 28 26 23 24 21 33 38 36 28 26 18 37 23 18 31 20 36 36 30 39 26
 [3001] 24 21 24 36 25 29 23 23 37 27 33 21 35 19 38 36 23 19 38 31 30 30 25 39
 [3025] 32 30 36 38 23 19 34 18 29 21 33 24 34 21 40 35 38 29 35 25 27 29 36 39
 [3049] 38 31 34 31 30 21 39 24 24 28 35 28 23 26 39 38 35 23 29 29 23 28 27 18
 [3073] 36 37 31 31 35 21 27 39 18 23 38 25 34 24 29 31 34 27 36 21 31 27 21 18
 [3097] 37 23 30 32 27 35 39 39 28 34 30 22 39 37 30 39 32 24 35 24 27 30 34 28
 [3121] 19 33 37 27 23 31 34 18 18 33 20 27 29 19 20 31 31 21 32 40 25 32 20 22
 [3145] 20 31 22 24 40 28 18 26 35 27 22 24 21 19 23 23 36 37 30 29 40 36 30 19
 [3169] 22 29 22 18 33 38 31 38 20 33 26 31 30 38 37 18 19 27 30 26 39 29 20 27
 [3193] 39 23 26 28 23 22 29 36 25 37 39 30 29 40 18 19 35 21 36 33 32 21 40 19
 [3217] 21 36 40 25 27 20 35 28 22 28 29 30 40 24 28 40 20 31 33 21 21 33 31 23
 [3241] 36 39 35 23 35 33 32 20 25 20 26 38 22 18 20 28 34 37 27 37 39 39 24 19
 [3265] 27 22 27 39 33 18 32 18 38 21 22 27 26 32 33 28 37 32 23 28 23 38 32 18
 [3289] 22 25 40 39 34 31 22 30 26 38 33 22 24 20 27 34 31 22 24 18 24 28 39 23
 [3313] 32 21 24 25 28 36 26 29 38 38 37 37 35 29 32 40 23 34 18 33 18 28 26 22
 [3337] 31 30 26 25 38 35 23 19 24 26 38 37 31 25 22 19 36 32 26 22 32 22 24 34
 [3361] 37 32 34 37 21 36 31 38 29 39 23 25 18 19 21 26 25 33 34 35 38 25 32 39
 [3385] 21 34 21 32 33 36 25 39 20 40 38 23 28 28 23 39 38 20 29 21 33 33 31 26
 [3409] 24 29 40 27 32 24 20 39 21 31 23 38 27 18 23 33 35 37 26 36 36 36 40 36
 [3433] 24 23 20 22 34 19 28 38 36 37 39 36 31 38 21 39 36 40 19 19 35 38 26 26
 [3457] 28 34 32 22 38 21 36 32 27 38 19 23 20 36 32 31 38 35 30 18 20 19 39 31
 [3481] 38 40 34 19 38 33 33 25 25 26 20 35 25 32 30 24 34 20 23 39 22 33 26 31
 [3505] 29 18 31 29 37 22 39 18 40 29 23 28 29 23 27 20 25 36 36 40 25 23 21 28
 [3529] 20 21 27 39 20 27 34 26 20 35 29 25 25 19 22 36 28 18 26 39 24 18 29 35
 [3553] 24 20 33 35 37 27 28 18 25 19 28 35 21 39 33 19 26 25 29 32 29 25 19 34
 [3577] 29 19 22 22 27 29 39 36 29 33 36 39 33 30 23 35 34 38 20 23 24 36 18 31
 [3601] 32 24 39 20 18 22 25 30 32 19 19 26 26 21 19 32 31 18 32 30 19 32 40 38
 [3625] 40 35 18 38 25 40 31 28 20 25 28 22 19 38 37 19 25 27 39 40 37 24 40 37
 [3649] 24 27 20 23 30 22 26 22 32 19 24 27 35 23 37 34 20 39 20 40 35 25 25 18
 [3673] 19 18 23 20 38 36 29 27 21 37 21 26 36 22 40 32 38 21 37 23 32 32 27 25
 [3697] 19 22 30 28 30 28 24 23 34 28 24 29 38 33 39 18 22 20 35 24 25 38 29 34
 [3721] 18 27 32 19 29 29 20 35 26 35 34 28 37 24 35 28 18 37 27 28 21 23 29 26
 [3745] 39 34 31 34 24 27 25 22 18 24 29 18 37 27 37 35 32 30 27 25 18 30 35 29
 [3769] 20 33 19 38 24 28 24 36 33 40 25 37 27 34 20 23 34 36 21 26 37 24 18 37
 [3793] 24 40 37 39 38 39 32 38 24 24 24 39 22 26 18 18 19 28 22 23 28 29 34 23
 [3817] 26 22 28 29 31 26 21 38 27 36 26 31 29 27 29 32 24 18 18 38 33 39 34 18
 [3841] 26 33 28 38 22 19 24 32 28 26 36 30 22 31 21 33 37 22 18 22 40 20 37 38
 [3865] 31 19 27 22 32 30 24 18 22 36 22 35 32 30 29 38 37 28 35 18 24 28 30 28
 [3889] 29 23 36 22 33 27 38 33 24 36 32 25 19 23 28 34 32 23 32 23 22 31 20 19
 [3913] 39 35 35 30 22 40 28 26 23 27 33 21 31 37 29 30 28 27 31 32 36 27 39 18
 [3937] 35 33 20 27 24 35 40 38 35 27 20 18 37 29 19 35 21 31 25 22 37 20 38 37
 [3961] 38 30 20 34 40 35 27 33 33 29 25 39 34 18 39 23 18 31 40 32 21 29 39 19
 [3985] 31 23 23 27 20 38 23 34 19 31 23 25 20 33 39 34 40 27 32 26 36 38 31 20
 [4009] 18 20 22 32 26 35 35 24 24 27 28 18 21 36 37 23 19 18 30 39 28 30 22 36
 [4033] 18 23 36 22 36 33 31 26 23 30 34 34 37 18 39 36 18 27 23 25 23 22 37 18
 [4057] 38 28 37 35 39 27 26 24 22 20 23 37 18 30 19 19 28 18 29 21 36 33 32 39
 [4081] 34 25 20 33 24 39 27 18 24 38 23 30 27 21 23 35 25 18 35 35 32 38 38 35
 [4105] 39 36 39 29 18 23 37 32 34 24 25 35 18 18 25 36 27 40 35 20 19 19 34 19
 [4129] 20 19 40 34 40 39 29 24 39 33 20 34 40 27 25 25 25 19 31 22 39 31 26 39
 [4153] 25 28 20 22 29 32 28 27 26 24 25 19 37 37 23 38 24 32 25 29 31 38 37 32
 [4177] 21 36 32 22 39 36 39 22 34 23 36 37 29 18 35 25 21 34 33 34 24 37 33 26
 [4201] 35 21 29 38 25 37 27 32 18 25 23 18 21 24 26 31 20 28 37 22 40 19 29 39
 [4225] 21 27 31 28 33 29 26 39 22 33 27 32 19 39 37 25 18 35 24 23 20 34 21 30
 [4249] 29 38 21 25 33 29 31 25 33 22 34 28 20 36 27 35 25 19 36 28 20 26 23 21
 [4273] 36 32 34 40 29 34 31 32 36 38 37 36 21 35 18 22 22 21 30 34 32 31 38 24
 [4297] 27 34 28 27 26 28 26 27 35 38 34 36 18 20 31 26 30 30 21 23 40 40 39 27
 [4321] 27 28 32 39 32 26 39 19 24 20 22 18 38 26 29 26 40 26 21 27 20 40 27 39
 [4345] 28 29 38 38 23 25 30 33 34 36 31 35 30 30 31 39 29 36 37 36 18 27 36 18
 [4369] 33 38 31 36 32 30 21 21 38 22 37 37 28 34 18 23 22 32 18 30 30 30 33 26
 [4393] 38 28 30 37 27 31 37 22 25 39 31 23 33 21 21 22 32 35 26 21 34 25 36 23
 [4417] 31 36 37 25 35 35 29 37 34 37 23 22 21 24 20 32 21 33 24 29 23 24 35 23
 [4441] 34 29 25 35 27 20 24 23 35 20 32 30 28 20 32 23 19 26 25 33 20 39 38 27
 [4465] 29 28 21 39 35 21 36 30 18 37 36 28 21 39 37 31 23 27 39 34 36 25 22 33
 [4489] 29 23 21 29 30 37 29 23 26 19 38 23 24 35 29 27 36 19 27 24 31 39 23 24
 [4513] 19 29 30 18 37 23 20 32 31 39 22 27 23 35 36 25 26 38 37 19 25 30 38 33
 [4537] 31 39 23 37 31 18 22 27 35 26 33 26 28 23 24 32 31 24 37 27 27 21 36 24
 [4561] 19 30 23 37 26 32 39 37 24 26 38 22 22 23 37 19 18 29 19 29 19 35 22 28
 [4585] 25 30 33 26 21 32 23 20 39 24 22 33 30 26 20 38 33 40 18 30 34 28 39 40
 [4609] 28 35 23 37 40 22 25 21 34 38 28 38 40 21 24 33 20 22 20 37 25 37 18 29
 [4633] 26 25 18 26 38 30 33 31 35 29 35 21 25 35 19 25 22 30 19 25 36 37 22 29
 [4657] 32 28 21 38 27 40 29 19 24 38 39 33 33 37 29 25 25 36 33 30 39 23 33 38
 [4681] 18 34 34 33 24 38 24 26 25 33 36 28 23 22 23 26 18 24 27 24 30 29 24 24
 [4705] 31 36 31 37 28 27 26 19 29 40 19 37 21 34 29 19 35 31 30 18 30 40 26 31
 [4729] 24 31 37 32 35 30 27 31 39 31 35 33 29 19 35 37 29 33 21 29 40 38 20 24
 [4753] 33 30 31 29 18 36 40 28 25 37 23 19 25 39 22 24 25 35 24 36 28 27 26 30
 [4777] 22 24 37 26 24 28 36 20 38 29 26 32 34 33 27 33 25 34 27 22 38 22 28 28
 [4801] 23 31 36 22 40 19 39 31 26 21 39 39 29 18 19 38 39 37 39 23 31 25 22 38
 [4825] 29 18 32 20 23 24 26 35 27 36 31 31 37 35 31 37 35 30 31 20 21 22 29 23
 [4849] 19 32 26 20 18 23 33 30 32 28 39 35 29 35 36 32 38 34 23 29 30 25 18 32
 [4873] 40 33 31 27 31 26 23 19 37 22 23 22 39 38 18 32 34 25 23 23 32 30 29 38
 [4897] 21 31 34 18 34 32 27 20 35 20 25 39 30 23 37 23 29 26 21 36 22 25 37 18
 [4921] 23 35 21 21 36 27 20 29 22 25 38 38 25 30 23 40 39 29 22 19 32 25 25 39
 [4945] 26 30 37 40 31 34 28 23 35 19 31 39 23 18 20 26 37 23 27 40 25 23 29 40
 [4969] 23 30 29 26 30 18 31 26 32 34 26 39 36 24 18 39 39 19 35 24 22 38 30 37
 [4993] 39 40 19 26 32 33 21 30 24 40 21 32 30 39 20 33 28 32 25 25 26 34 29 27
 [5017] 36 30 21 29 38 36 29 34 26 34 40 31 34 22 27 28 25 35 19 30 21 21 21 37
 [5041] 38 18 37 27 29 31 31 36 32 29 35 26 34 21 18 40 38 31 34 33 40 36 37 20
 [5065] 40 22 35 26 38 23 18 23 19 40 24 22 23 32 40 40 28 25 36 23 35 29 39 21
 [5089] 32 31 28 33 31 24 28 31 27 32 20 27 18 29 33 23 33 19 27 29 29 24 19 30
 [5113] 22 28 40 30 26 36 19 32 29 34 32 25 30 39 28 40 33 28 32 25 37 37 36 33
 [5137] 22 29 31 25 29 33 21 20 31 31 40 36 34 29 25 19 36 30 36 22 35 21 26 37
 [5161] 32 32 36 34 29 23 29 23 37 27 40 37 18 27 18 19 26 35 31 34 20 29 28 38
 [5185] 26 30 21 35 28 31 40 19 40 38 31 33 37 37 28 34 33 33 18 35 24 32 35 35
 [5209] 27 28 24 32 18 38 23 19 40 37 20 38 19 40 25 38 39 37 33 22 35 23 35 34
 [5233] 22 31 20 31 20 38 35 26 21 22 33 23 23 38 24 40 23 22 25 38 23 21 40 26
 [5257] 34 33 30 33 31 23 26 39 28 32 36 29 22 28 38 22 29 21 23 30 32 34 27 19
 [5281] 19 20 39 29 36 35 27 37 21 35 21 22 26 20 39 26 27 34 37 40 35 21 29 39
 [5305] 20 24 37 24 29 18 26 35 40 35 22 30 40 25 39 31 32 23 30 25 26 23 21 24
 [5329] 24 35 25 25 30 24 29 29 23 31 25 22 23 25 23 21 19 37 26 35 40 29 21 20
 [5353] 30 23 32 24 33 21 32 18 19 28 25 31 27 38 26 27 37 22 36 27 26 38 36 36
 [5377] 31 27 20 26 19 40 22 22 29 29 36 40 30 32 20 19 26 28 37 22 40 28 27 25
 [5401] 40 30 22 32 31 39 24 37 26 31 34 39 24 35 34 21 26 33 27 40 21 20 18 33
 [5425] 26 22 35 31 29 35 35 32 30 18 31 40 38 24 26 19 33 33 40 26 25 19 26 24
 [5449] 24 21 31 27 39 23 18 18 38 20 18 38 38 34 35 33 33 32 35 35 34 30 29 27
 [5473] 35 19 21 23 31 35 26 20 36 25 33 34 25 33 28 25 38 19 22 33 29 22 22 21
 [5497] 39 22 25 39 25 36 28 20 29 21 27 33 27 24 32 33 38 18 24 35 34 35 30 25
 [5521] 23 30 30 26 33 33 40 24 29 19 40 22 24 31 34 40 25 18 29 36 20 24 40 18
 [5545] 26 23 26 30 21 24 36 32 32 40 39 26 28 30 31 28 20 25 29 33 23 20 32 39
 [5569] 32 30 33 39 28 38 20 29 39 22 39 29 21 29 30 25 32 28 19 30 30 27 24 26
 [5593] 33 34 29 25 18 21 39 36 21 19 28 30 20 21 25 34 25 24 18 19 22 24 24 26
 [5617] 37 28 24 32 37 18 25 33 30 32 32 37 38 21 39 35 35 18 30 36 39 34 34 21
 [5641] 20 25 38 30 31 25 25 25 32 26 25 19 27 32 27 19 25 37 37 32 31 36 36 39
 [5665] 30 28 30 32 34 31 35 28 27 30 32 26 40 38 25 33 33 37 38 20 38 20 28 33
 [5689] 19 29 20 26 30 22 19 25 20 31 33 32 28 26 21 19 39 27 23 35 25 18 24 28
 [5713] 34 40 34 40 20 32 30 32 36 32 18 40 23 29 22 26 32 37 32 28 40 23 35 38
 [5737] 37 32 22 19 34 35 32 18 18 37 40 29 37 21 19 21 22 29 36 18 28 36 24 32
 [5761] 35 36 39 31 28 21 36 22 25 32 29 29 24 27 33 30 34 23 33 34 27 39 36 35
 [5785] 36 19 18 38 36 34 31 29 40 31 21 36 29 30 40 31 36 29 33 34 18 27 22 26
 [5809] 24 31 35 39 20 30 33 33 39 18 39 18 28 22 20 34 31 39 25 31 35 39 37 22
 [5833] 19 30 20 33 38 40 21 21 22 36 30 34 26 22 21 33 40 24 27 23 37 19 19 24
 [5857] 38 37 37 30 23 30 21 38 32 22 23 23 28 40 21 20 29 23 31 33 19 36 28 34
 [5881] 34 31 40 31 29 39 23 28 24 19 35 39 40 32 34 31 31 18 24 39 37 38 22 24
 [5905] 22 32 32 34 32 23 20 24 18 24 21 25 31 24 26 31 19 24 34 39 20 24 25 31
 [5929] 35 23 37 33 27 21 36 33 25 33 26 38 25 23 32 23 23 33 37 18 33 25 34 32
 [5953] 33 36 30 30 38 30 20 38 35 31 35 37 29 25 20 38 30 39 21 21 25 28 34 28
 [5977] 23 31 37 24 27 28 38 22 26 20 28 20 32 19 37 40 36 21 23 20 38 29 32 19
 [6001] 32 34 35 30 25 20 38 28 20 32 40 33 34 37 19 32 40 30 33 21 38 38 38 27
 [6025] 28 26 37 26 30 33 28 40 40 38 19 23 28 29 20 34 30 34 33 23 22 40 28 25
 [6049] 27 39 25 20 27 40 28 40 35 24 32 38 24 19 26 20 36 28 31 32 33 23 31 29
 [6073] 25 19 21 34 24 39 35 38 31 24 19 38 33 30 31 40 37 20 39 38 24 30 36 33
 [6097] 21 38 29 33 20 23 35 34 29 40 35 20 37 23 35 38 21 34 28 27 38 25 29 32
 [6121] 24 30 29 22 27 40 20 29 24 32 34 36 23 29 19 20 32 33 23 35 40 37 24 34
 [6145] 25 34 37 20 28 31 19 19 34 18 29 25 21 33 37 34 23 40 24 19 32 26 39 19
 [6169] 32 39 30 36 37 26 20 26 21 23 36 39 20 25 33 32 34 25 33 31 20 35 21 30
 [6193] 28 18 27 37 37 24 25 28 27 23 24 38 24 36 35 30 40 22 19 19 21 38 18 29
 [6217] 23 30 26 33 18 28 33 36 18 35 38 21 36 24 20 24 32 35 20 29 36 32 22 25
 [6241] 40 22 19 20 35 18 30 25 22 40 24 21 24 27 24 26 27 30 24 32 40 36 27 20
 [6265] 33 22 21 23 25 29 26 36 24 21 36 40 21 32 32 34 27 30 35 35 19 34 33 33
 [6289] 31 23 21 29 33 28 34 20 18 33 30 38 22 30 39 24 23 25 36 18 19 33 28 21
 [6313] 39 31 30 27 21 31 37 37 39 34 39 31 37 40 37 20 18 27 26 32 36 22 28 24
 [6337] 40 38 22 20 33 38 36 18 40 25 28 19 32 29 27 18 25 27 22 21 35 38 21 29
 [6361] 35 33 33 30 39 22 33 31 21 40 18 31 18 30 30 23 33 19 38 36 30 22 25 29
 [6385] 22 26 28 30 34 28 25 18 18 26 25 37 29 21 27 35 36 36 20 39 39 28 32 23
 [6409] 19 24 29 35 25 25 24 28 38 35 34 22 40 21 23 18 36 20 34 20 19 18 35 24
 [6433] 34 35 28 34 29 23 36 30 25 32 25 30 37 27 37 24 20 25 34 20 34 37 18 22
 [6457] 23 32 36 39 25 34 34 34 27 19 25 35 40 37 21 27 34 20 37 23 24 25 18 18
 [6481] 31 33 23 28 20 25 40 38 25 30 40 40 28 35 23 39 18 38 18 18 26 38 32 35
 [6505] 35 39 29 32 39 22 28 24 32 20 19 37 23 31 19 19 36 25 26 38 19 27 29 30
 [6529] 20 34 30 25 33 26 31 18 31 40 29 26 33 28 24 28 22 27 27 33 39 34 35 18
 [6553] 26 38 38 20 37 39 32 23 35 20 39 34 20 22 40 28 38 19 26 36 37 21 23 36
 [6577] 20 27 39 22 33 23 19 19 35 23 22 38 35 28 24 36 25 26 34 18 25 37 19 22
 [6601] 18 21 34 23 38 22 34 36 19 23 32 38 31 40 35 19 19 27 20 22 28 21 35 27
 [6625] 32 32 20 40 31 39 27 33 29 23 30 22 36 36 33 27 34 18 35 18 26 21 28 24
 [6649] 28 33 38 26 24 30 29 33 24 40 29 32 31 36 32 35 18 34 34 30 18 22 38 30
 [6673] 32 21 27 19 34 34 29 36 23 24 29 18 21 27 38 38 22 26 40 28 18 21 20 24
 [6697] 29 39 39 19 37 20 25 39 26 33 30 34 31 27 34 34 34 19 37 18 19 23 39 27
 [6721] 38 19 37 33 21 20 21 25 27 23 22 36 29 24 25 27 31 37 26 37 24 28 30 37
 [6745] 23 27 22 35 26 28 33 40 38 24 28 28 40 31 25 20 19 30 21 24 29 25 19 25
 [6769] 20 22 25 23 23 31 36 35 27 37 31 18 27 40 22 29 39 18 33 27 33 29 30 19
 [6793] 25 39 32 36 33 39 32 28 40 20 37 21 28 32 35 23 34 19 29 26 38 38 36 36
 [6817] 20 35 22 39 23 20 22 31 24 19 18 31 18 32 32 35 28 40 27 30 40 29 35 32
 [6841] 28 38 35 38 33 38 23 18 32 23 31 39 33 23 20 34 32 32 31 36 35 21 35 26
 [6865] 33 22 37 34 26 35 36 31 22 19 36 39 38 35 38 33 28 36 18 40 18 34 36 20
 [6889] 25 38 26 25 18 29 36 22 34 23 25 24 19 40 36 39 32 36 24 27 38 27 27 21
 [6913] 30 38 18 22 30 33 38 26 21 31 25 31 40 36 40 19 39 31 20 30 28 35 37 40
 [6937] 23 37 31 28 39 34 20 29 23 22 35 27 40 33 31 24 32 36 38 20 25 35 32 39
 [6961] 37 18 35 36 34 28 21 37 18 32 39 25 22 28 32 36 25 25 40 18 27 32 22 31
 [6985] 38 36 26 23 27 35 33 21 24 30 34 38 23 39 29 40 40 33 39 38 33 19 34 33
 [7009] 30 37 28 40 39 26 20 23 40 21 31 30 21 22 32 22 31 29 30 37 31 39 21 35
 [7033] 20 23 18 21 28 34 40 31 18 32 28 27 25 32 26 34 36 33 22 39 18 18 25 28
 [7057] 33 28 25 37 31 22 25 31 34 35 24 22 26 30 24 19 23 20 31 24 18 19 29 18
 [7081] 37 25 35 23 38 23 35 39 34 18 19 34 31 26 34 40 29 19 20 31 18 32 33 36
 [7105] 30 26 29 36 40 35 34 37 36 23 22 30 18 27 31 29 34 20 25 18 35 21 30 39
 [7129] 20 21 20 31 18 35 25 38 32 24 30 24 31 35 18 25 19 32 20 31 29 29 35 27
 [7153] 21 33 39 19 18 21 29 19 29 19 21 21 18 26 21 40 21 35 32 32 31 21 34 30
 [7177] 19 29 21 23 18 29 23 36 28 37 24 18 27 25 37 33 34 25 36 20 26 32 38 38
 [7201] 37 32 20 28 21 40 26 32 23 38 30 27 38 32 38 27 35 35 28 25 28 28 20 30
 [7225] 26 30 27 22 37 31 35 38 30 19 25 29 25 30 21 24 27 18 20 32 30 31 28 24
 [7249] 37 38 33 22 26 20 34 39 32 27 28 32 29 23 34 34 32 22 34 27 30 39 26 26
 [7273] 29 31 25 31 28 37 33 24 35 24 32 20 18 29 40 19 23 37 20 32 24 40 27 21
 [7297] 33 33 29 23 21 23 22 32 23 29 32 24 39 30 28 24 34 33 27 24 22 24 31 38
 [7321] 27 32 30 25 32 35 27 25 20 36 19 31 23 35 29 36 28 23 40 25 39 29 32 31
 [7345] 31 33 34 35 26 38 37 40 40 35 31 20 33 19 39 23 19 26 31 29 19 33 38 35
 [7369] 31 23 28 35 28 19 36 32 27 21 25 23 23 40 20 33 28 28 37 33 21 18 40 33
 [7393] 36 34 35 20 31 32 39 24 20 36 34 24 29 23 33 19 23 33 37 18 40 32 23 40
 [7417] 25 25 31 34 27 20 18 30 22 21 30 26 29 25 38 21 38 28 30 18 30 23 29 28
 [7441] 20 38 25 25 24 31 31 38 25 40 27 37 34 40 28 30 21 25 35 25 25 33 21 31
 [7465] 24 27 34 18 32 38 20 26 24 19 37 33 25 33 21 22 34 33 36 28 25 35 23 29
 [7489] 23 22 21 33 26 33 40 18 21 21 33 40 27 33 37 38 32 25 18 36 20 27 40 35
 [7513] 38 36 27 21 22 40 39 28 28 29 26 22 25 24 40 25 22 32 27 19 32 27 20 40
 [7537] 21 20 37 40 29 39 30 32 23 22 19 23 35 34 32 26 26 30 28 20 35 37 28 18
 [7561] 36 23 38 27 30 19 34 28 24 18 40 34 37 19 32 38 37 20 19 36 21 22 32 28
 [7585] 35 18 32 29 30 19 39 19 34 19 18 29 23 18 27 32 24 23 20 29 18 28 18 27
 [7609] 35 33 37 19 26 37 29 36 25 30 23 38 23 27 19 26 21 29 29 37 25 28 36 22
 [7633] 38 27 38 32 21 40 25 33 23 37 40 35 20 40 33 28 36 27 27 25 27 21 37 30
 [7657] 27 38 25 36 24 21 38 36 32 23 22 32 27 32 24 19 27 32 26 24 21 39 23 20
 [7681] 39 22 28 24 32 20 35 34 32 18 27 20 33 32 34 27 40 25 19 27 40 34 23 22
 [7705] 20 24 21 26 29 38 35 37 30 40 32 35 40 38 33 40 33 33 34 20 19 39 32 32
 [7729] 21 38 22 23 34 20 18 30 29 39 40 40 33 24 37 29 34 19 20 22 27 32 20 22
 [7753] 18 29 32 25 23 30 36 34 19 26 34 19 24 39 24 37 21 21 23 25 25 27 37 28
 [7777] 18 31 21 23 23 23 30 28 21 28 33 22 27 33 23 25 39 38 30 31 29 30 25 39
 [7801] 21 19 32 19 26 30 29 25 35 30 34 31 36 34 24 37 29 32 24 36 27 20 37 28
 [7825] 27 23 26 33 36 18 23 25 36 28 40 34 21 18 20 23 39 39 33 33 25 27 21 18
 [7849] 20 40 40 32 33 19 27 32 26 38 37 21 18 33 38 30 21 28 37 35 21 21 35 34
 [7873] 26 19 32 25 19 30 38 40 18 29 38 30 40 23 28 30 32 34 18 37 26 39 37 25
 [7897] 23 27 32 38 36 34 25 19 18 31 31 23 33 35 33 26 21 31 33 36 19 22 39 18
 [7921] 31 30 18 26 32 19 29 36 22 20 19 40 33 33 19 35 28 26 29 34 31 33 26 22
 [7945] 32 31 26 27 35 37 35 35 19 35 38 29 34 21 26 19 31 35 24 23 23 39 37 29
 [7969] 27 22 24 28 31 28 22 37 23 30 35 35 22 33 30 30 28 20 30 20 26 20 40 19
 [7993] 18 27 32 19 18 34 18 40 20 23 35 36 26 34 34 27 36 35 36 24 39 21 38 30
 [8017] 29 27 33 18 31 32 32 33 32 23 20 19 36 27 26 27 40 21 30 33 27 31 32 21
 [8041] 39 23 21 30 23 21 36 21 25 25 36 23 39 21 29 33 18 37 34 32 19 37 33 40
 [8065] 21 39 21 26 26 33 24 30 37 24 20 19 25 37 33 20 26 21 25 23 23 22 31 32
 [8089] 36 40 32 30 21 23 18 36 33 22 25 25 28 22 20 28 19 20 29 20 38 22 23 32
 [8113] 39 33 28 39 23 25 24 22 25 36 35 24 20 37 26 33 35 21 25 34 30 25 29 25
 [8137] 38 40 19 40 37 26 22 30 28 25 34 24 19 20 30 30 27 25 32 18 38 37 24 22
 [8161] 34 23 26 19 25 21 18 38 31 18 36 31 30 24 38 19 22 22 34 32 28 19 24 34
 [8185] 20 26 28 24 34 37 26 30 25 20 26 40 31 18 35 25 31 40 23 35 29 22 38 40
 [8209] 31 35 30 24 22 36 32 40 18 39 36 19 31 31 35 29 19 32 32 26 22 22 36 38
 [8233] 34 28 34 19 29 32 39 36 18 26 21 33 38 19 24 28 40 39 26 29 25 23 31 23
 [8257] 25 39 20 28 39 38 29 33 25 26 18 27 21 31 37 18 20 40 28 24 23 39 25 21
 [8281] 27 38 18 31 22 36 33 38 30 19 36 37 29 25 32 40 33 28 19 23 27 29 40 21
 [8305] 38 23 37 40 40 27 20 36 34 39 25 37 38 34 25 33 22 20 31 25 38 18 24 31
 [8329] 23 22 34 39 34 39 25 39 32 20 27 39 40 39 26 39 28 24 23 19 36 26 31 23
 [8353] 24 39 25 39 33 20 27 32 31 30 23 21 26 26 23 33 27 29 37 30 39 31 26 25
 [8377] 21 19 34 38 28 35 30 23 37 25 34 35 25 27 39 20 19 32 34 20 24 34 27 19
 [8401] 25 40 24 31 31 36 25 28 35 25 36 24 39 37 28 39 36 18 29 24 37 30 36 31
 [8425] 19 39 35 37 38 28 21 35 36 35 31 36 31 37 37 20 34 27 32 22 19 30 37 40
 [8449] 40 39 21 34 19 32 32 33 36 24 21 29 25 24 30 24 27 35 40 22 18 34 33 23
 [8473] 40 36 22 36 40 21 23 36 22 25 21 23 30 37 40 30 32 23 32 22 36 31 39 35
 [8497] 28 29 25 36 33 26 28 35 33 35 34 32 30 20 24 30 34 35 26 37 39 20 19 21
 [8521] 27 31 33 30 32 29 25 20 30 23 36 22 35 37 26 27 24 27 36 21 28 32 32 23
 [8545] 23 19 34 23 33 30 29 23 18 36 38 40 22 25 40 36 26 29 25 27 40 40 29 22
 [8569] 18 31 32 26 27 31 37 28 28 24 39 34 39 32 30 37 24 30 37 18 30 28 32 34
 [8593] 29 40 34 28 21 19 30 26 22 39 19 18 31 19 33 28 40 39 22 36 21 22 20 35
 [8617] 38 21 21 33 18 23 26 36 18 34 32 22 35 30 36 31 39 33 27 34 33 34 19 35
 [8641] 22 34 20 38 38 31 29 19 37 20 28 25 38 39 28 22 32 20 33 25 37 37 40 22
 [8665] 35 36 20 33 37 24 39 29 19 23 27 36 29 26 24 33 29 38 40 28 26 34 20 24
 [8689] 30 21 20 25 22 18 36 20 36 26 18 22 26 28 34 38 37 30 37 39 31 36 32 38
 [8713] 20 34 23 37 33 38 26 38 38 27 33 20 26 30 21 23 18 30 22 37 27 21 39 31
 [8737] 20 22 36 18 38 19 29 27 36 25 37 27 32 27 29 35 19 28 24 19 28 26 18 33
 [8761] 36 30 40 34 24 30 33 40 22 39 33 28 21 26 22 31 20 25 28 25 34 20 39 31
 [8785] 28 35 34 23 23 19 29 36 38 27 33 39 32 20 24 36 38 19 20 25 36 37 27 37
 [8809] 39 30 38 20 30 40 36 23 36 39 21 31 30 40 35 34 19 30 39 21 26 35 18 20
 [8833] 20 26 29 29 20 33 38 21 19 30 21 29 20 18 24 26 29 33 21 37 34 19 23 24
 [8857] 18 32 36 21 40 39 22 39 18 39 26 25 21 34 35 36 21 37 18 23 25 27 19 25
 [8881] 25 33 33 39 40 18 34 40 36 19 18 27 33 22 21 33 21 39 20 34 31 40 29 26
 [8905] 38 21 20 39 25 30 18 33 27 28 39 20 22 35 19 28 38 38 28 36 23 28 39 36
 [8929] 34 30 38 32 29 27 23 33 23 18 37 37 18 30 33 38 40 36 40 36 38 27 22 34
 [8953] 29 31 29 32 35 24 25 40 34 22 36 32 28 40 23 23 21 22 40 30 34 35 23 30
 [8977] 25 26 31 32 36 31 38 27 38 30 31 36 40 36 29 19 19 31 29 34 34 34 25 29
 [9001] 22 32 33 20 29 35 30 35 32 30 37 39 36 38 38 25 32 34 30 29 35 29 38 25
 [9025] 37 18 38 32 36 28 37 31 30 36 21 35 28 23 34 39 23 35 18 22 27 31 20 35
 [9049] 27 30 24 38 29 34 39 21 23 32 32 34 37 27 23 33 27 39 29 36 39 29 37 38
 [9073] 38 22 38 19 31 34 20 21 28 26 28 29 19 20 26 35 34 34 33 27 26 31 35 40
 [9097] 18 18 35 25 38 29 19 34 40 38 24 20 35 27 32 33 23 40 26 30 19 37 27 22
 [9121] 33 30 32 26 25 22 30 30 36 39 27 24 34 25 35 26 38 29 37 29 22 31 19 38
 [9145] 33 27 21 29 31 29 28 37 23 29 30 25 18 32 19 26 19 38 31 20 34 21 28 34
 [9169] 33 25 25 35 19 24 39 40 35 20 37 20 31 40 30 30 32 23 20 29 36 18 31 33
 [9193] 37 26 28 25 27 37 34 29 27 37 36 18 38 28 36 26 35 37 24 26 31 31 37 40
 [9217] 37 38 36 33 32 32 27 23 26 32 27 24 27 37 39 26 30 38 23 18 23 18 39 27
 [9241] 24 19 20 23 19 21 32 40 29 18 28 37 37 28 40 26 29 39 21 35 25 35 35 27
 [9265] 37 39 33 27 39 24 23 40 29 27 40 18 20 19 37 25 18 35 21 21 32 23 34 40
 [9289] 21 34 27 29 36 25 26 38 40 36 26 34 30 35 29 20 22 39 23 29 29 23 30 20
 [9313] 40 34 35 27 27 21 38 31 22 23 40 33 35 36 19 33 30 39 26 34 20 21 23 34
 [9337] 28 25 22 34 39 38 24 34 22 36 38 18 38 34 40 24 30 34 21 39 33 23 30 35
 [9361] 21 27 38 29 19 31 39 35 31 34 35 26 21 36 31 26 32 27 24 29 28 38 33 24
 [9385] 39 33 33 30 24 33 21 25 35 37 27 18 35 31 35 40 32 23 23 39 19 33 25 33
 [9409] 35 30 23 30 22 25 18 31 27 31 19 19 35 39 40 35 37 37 27 18 20 39 36 22
 [9433] 34 26 36 38 24 32 33 23 34 26 31 37 27 30 19 25 21 22 18 29 35 32 22 21
 [9457] 32 27 31 36 28 33 40 36 22 36 32 37 29 39 32 31 33 36 35 30 40 40 39 27
 [9481] 35 37 20 31 24 37 25 37 31 22 28 35 30 40 27 30 30 27 29 37 25 23 29 23
 [9505] 22 22 28 40 35 26 36 40 34 35 40 21 18 38 27 39 31 20 22 30 29 25 27 40
 [9529] 36 39 26 24 27 26 20 31 35 35 19 40 23 24 20 32 25 33 27 26 20 34 22 35
 [9553] 36 31 38 37 23 30 22 26 28 40 36 38 39 24 39 19 38 40 21 38 18 38 19 24
 [9577] 35 30 31 26 35 20 33 29 27 18 31 40 28 19 40 23 27 33 21 37 22 27 20 37
 [9601] 35 36 18 38 34 21 26 20 26 25 39 31 28 27 29 29 38 29 21 38 19 19 39 31
 [9625] 34 28 26 34 30 40 22 29 36 22 32 32 19 32 22 18 23 21 33 23 19 26 20 19
 [9649] 33 28 39 24 23 27 38 22 24 28 19 32 39 23 27 18 19 19 32 24 38 36 22 31
 [9673] 18 27 39 35 19 18 24 34 22 26 37 28 25 29 27 27 40 29 23 20 22 31 36 25
 [9697] 27 23 33 31 36 28 24 39 19 32 22 28 26 38 34 28 30 18 36 37 26 28 29 31
 [9721] 30 39 33 30 21 20 20 18 33 28 40 28 22 36 39 25 39 19 29 30 30 22 24 27
 [9745] 39 20 29 32 26 27 23 34 31 31 27 22 38 32 39 22 30 27 21 30 28 34 35 36
 [9769] 40 31 20 19 29 33 29 34 24 18 27 20 22 39 36 39 37 21 31 33 31 38 40 22
 [9793] 26 24 31 29 36 20 27 35 23 34 31 20 39 29 31 26 23 21 32 32 40 29 36 32
 [9817] 23 35 28 34 28 31 31 39 21 34 38 27 28 28 18 27 37 38 27 23 19 25 31 18
 [9841] 19 25 35 25 18 25 31 24 30 27 35 28 32 26 26 40 35 28 28 38 31 31 34 30
 [9865] 39 19 26 36 31 30 22 18 29 38 20 31 34 23 24 19 39 26 22 40 33 36 21 40
 [9889] 38 29 20 39 23 25 35 35 39 35 35 36 37 39 24 39 39 22 20 26 29 34 29 28
 [9913] 26 35 33 35 21 25 40 38 35 26 19 24 21 22 33 19 23 25 32 30 31 27 23 36
 [9937] 39 36 29 26 24 22 29 31 23 23 30 27 19 22 24 18 26 22 35 28 34 26 22 34
 [9961] 21 28 20 21 33 35 30 26 18 28 26 27 27 33 31 32 20 36 30 19 35 38 21 18
 [9985] 39 30 32 31 22 33 32 29 34 38 26 37 36 37 22 18 37 39 25 31 20 38 22 36
[10009] 34 26 38 24 37 25 35 28 18 32 37 26 40 25 27 33 40 31 38 31 39 29 30 28
[10033] 20 39 22 24 36 26 21 21 26 18 20 39 25 29 38 39 24 34 21 20 25 38 23 28
[10057] 18 37 38 22 19 39 23 26 27 34 30 23 22 24 36 35 36 34 25 27 18 21 22 28
[10081] 37 34 34 37 25 23 23 32 23 27 35 26 39 25 22 33 19 27 26 25 19 27 24 22
[10105] 36 36 31 29 29 38 40 25 38 25 28 31 35 26 27 22 23 39 29 39 30 26 37 18
[10129] 22 20 39 34 22 40 27 34 23 36 30 20 39 29 29 28 20 32 27 33 33 28 22 28
[10153] 25 24 39 24 22 23 36 21 35 33 26 40 24 33 35 34 23 40 20 24 22 37 29 26
[10177] 31 31 33 22 23 40 29 21 27 31 24 23 24 28 35 27 33 35 21 31 22 25 39 19
[10201] 33 28 24 27 35 34 36 31 26 26 32 25 19 38 25 18 36 29 32 30 31 23 32 25
[10225] 24 35 26 39 37 34 19 38 22 39 33 40 36 33 30 28 36 39 26 29 19 20 26 28
[10249] 29 35 37 19 35 39 24 35 29 32 26 20 30 25 20 39 34 27 38 25 24 39 19 35
[10273] 20 36 19 40 39 29 19 31 38 36 23 37 23 33 24 40 38 32 40 27 19 29 32 27
[10297] 35 33 34 27 37 20 26 33 18 34 32 30 25 22 25 22 34 19 26 38 36 32 39 25
[10321] 20 30 26 32 31 18 38 32 40 33 26 40 30 25 25 32 30 36 27 24 28 26 28 40
[10345] 39 40 33 24 35 29 22 31 22 40 32 29 28 28 32 29 24 38 24 19 23 36 21 20
[10369] 24 40 26 24 25 18 36 36 20 32 24 29 18 27 23 30 39 37 20 18 20 37 28 28
[10393] 24 36 19 29 20 30 33 34 20 31 18 28 23 28 22 32 21 27 36 25 20 29 33 30
[10417] 24 37 39 29 22 36 37 32 40 38 23 26 38 32 38 34 39 33 34 34 40 22 29 31
[10441] 39 27 36 38 34 30 19 35 39 26 37 31 19 24 34 37 36 33 30 29 19 25 36 36
[10465] 26 25 40 31 28 36 30 26 22 29 30 19 34 30 39 40 25 28 28 38 34 40 23 38
[10489] 19 38 18 30 18 19 26 37 31 19 29 26 36 38 37 35 33 26 40 30 39 27 32 29
[10513] 26 29 32 26 39 38 30 34 25 19 24 30 18 35 18 38 34 18 23 36 36 40 40 32
[10537] 40 29 27 21 27 35 33 36 38 38 23 20 36 24 32 35 29 23 37 23 22 19 29 37
[10561] 32 18 32 35 24 34 35 36 19 21 35 25 18 23 35 19 38 31 23 26 32 21 35 21
[10585] 34 29 18 33 35 27 36 30 27 21 24 18 34 28 33 35 24 40 21 21 29 19 32 36
[10609] 29 29 20 21 30 20 30 19 33 23 29 33 34 19 28 40 35 27 22 24 28 25 18 26
[10633] 24 31 21 25 28 24 18 35 31 27 32 20 40 18 35 35 29 25 18 22 26 38 25 22
[10657] 40 21 34 32 20 28 24 35 19 29 20 29 24 34 26 32 29 40 38 20 21 37 30 22
[10681] 36 38 20 22 33 33 21 38 34 40 27 26 23 18 28 36 25 19 19 19 21 25 22 37
[10705] 22 33 29 31 22 26 18 32 29 34 38 30 22 27 22 28 21 29 23 39 33 18 19 27
[10729] 23 34 40 21 24 39 23 25 26 35 20 21 37 33 23 32 37 24 22 33 38 21 18 23
[10753] 35 37 25 30 29 33 22 18 28 30 26 29 35 33 33 29 29 31 25 36 29 22 31 26
[10777] 35 31 28 39 22 33 27 39 30 34 35 19 31 39 30 36 30 31 21 29 19 21 24 22
[10801] 18 31 35 29 29 29 19 37 37 27 24 23 23 21 35 25 38 31 25 33 39 37 29 33
[10825] 27 30 33 23 25 39 37 25 22 20 26 20 39 39 24 21 35 36 22 33 30 39 21 33
[10849] 24 19 23 39 24 23 28 31 40 34 23 23 28 38 31 33 33 40 29 21 18 26 28 39
[10873] 33 29 29 27 28 33 33 26 29 20 29 26 28 30 23 18 24 23 25 38 25 30 37 34
[10897] 36 32 25 35 35 20 23 33 27 40 35 24 24 25 24 19 28 29 33 33 28 40 35 38
[10921] 37 21 33 23 39 32 32 21 27 29 32 26 28 19 27 22 19 34 18 34 21 30 25 34
[10945] 18 36 19 36 32 20 34 27 19 20 26 39 29 21 28 30 25 27 37 36 23 30 22 38
[10969] 38 32 30 25 39 30 29 36 28 26 27 20 34 29 35 34 33 37 38 20 39 36 19 38
[10993] 39 35 23 24 34 38 31 30 19 29 34 37 39 40 36 23 33 35 18 33 20 28 31 35
[11017] 23 26 23 29 25 25 36 27 20 28 22 39 23 27 28 21 34 36 38 29 18 33 31 28
[11041] 24 29 33 36 25 34 21 37 40 37 28 18 39 31 18 27 23 30 37 30 20 36 33 33
[11065] 36 40 30 29 28 35 23 39 21 32 36 33 35 20 23 30 21 28 36 23 40 21 23 40
[11089] 38 28 33 37 37 37 19 27 21 39 23 33 21 24 33 18 23 39 30 38 39 23 30 18
[11113] 18 27 20 25 37 18 39 40 25 19 18 37 21 22 34 20 40 21 31 35 27 37 29 34
[11137] 18 24 26 30 35 28 32 38 20 38 30 35 36 29 21 39 35 26 22 28 28 36 30 36
[11161] 39 23 28 21 28 39 23 40 22 30 36 22 23 40 18 34 30 28 20 27 19 30 31 40
[11185] 22 30 20 34 33 36 19 26 34 21 30 24 36 38 31 21 35 19 32 30 33 27 39 32
[11209] 28 28 21 18 33 22 23 38 26 26 18 33 23 31 34 33 28 27 30 27 30 34 34 35
[11233] 29 32 30 39 20 21 24 38 40 31 37 28 22 40 30 27 28 33 32 31 24 35 39 39
[11257] 34 29 23 26 18 29 25 18 40 36 18 33 36 25 20 31 40 22 39 26 21 40 25 21
[11281] 27 40 32 35 34 34 29 25 25 21 38 19 26 20 18 18 38 30 31 37 18 37 21 26
[11305] 32 18 22 34 28 35 33 28 28 35 33 24 21 30 26 30 34 28 37 30 35 30 33 28
[11329] 19 38 28 26 39 20 18 32 39 29 33 23 21 19 34 19 20 24 30 29 31 26 20 28
[11353] 26 33 29 22 26 26 31 26 28 30 21 19 19 21 29 25 29 27 22 40 20 27 23 36
[11377] 18 24 26 18 21 21 39 24 37 28 33 40 36 24 25 23 24 38 31 32 22 25 21 29
[11401] 36 37 37 19 38 28 39 24 28 21 36 37 35 40 28 20 39 32 23 34 34 27 18 31
[11425] 20 33 33 22 22 28 18 32 23 38 23 29 19 37 30 22 38 38 39 39 35 32 20 25
[11449] 36 35 23 28 29 36 20 22 30 18 26 23 37 40 19 37 19 29 29 28 18 26 40 29
[11473] 40 40 23 31 30 22 24 19 20 26 35 32 36 39 32 23 38 34 38 23 20 21 27 20
[11497] 29 23 33 28 40 27 22 34 32 40 36 22 19 38 30 22 29 21 35 32 39 20 30 40
[11521] 21 23 36 35 37 35 30 31 34 21 32 19 37 22 29 40 19 37 40 32 18 30 35 25
[11545] 18 29 35 34 25 20 40 29 21 24 33 25 22 38 33 19 19 28 22 36 29 38 28 22
[11569] 30 27 36 23 23 40 28 37 32 32 28 31 18 26 40 35 33 26 21 22 38 39 40 30
[11593] 23 38 29 32 34 39 37 24 33 25 39 28 25 40 39 20 34 33 31 35 26 25 28 21
[11617] 27 18 19 19 34 23 24 26 36 18 20 25 26 25 32 30 21 37 30 23 25 22 32 38
[11641] 38 25 38 22 20 39 21 35 39 39 37 27 32 22 36 33 37 33 36 31 21 29 22 27
[11665] 24 37 35 36 24 18 39 28 27 18 32 38 36 33 28 30 37 21 28 35 27 34 27 38
[11689] 39 28 35 32 35 20 39 30 20 39 23 18 27 33 33 27 18 28 39 40 36 38 22 20
[11713] 38 28 24 37 22 35 31 24 27 25 38 35 38 20 20 27 20 29 24 21 29 20 20 23
[11737] 26 33 18 36 26 36 36 31 18 31 28 27 40 19 32 27 32 37 18 22 37 38 25 32
[11761] 25 20 31 33 33 40 28 26 22 34 28 24 23 40 29 22 40 36 38 25 30 36 33 24
[11785] 23 20 22 27 36 38 20 37 29 18 35 36 23 30 35 18 18 21 24 19 22 40 33 38
[11809] 32 26 24 38 34 19 31 23 39 40 31 32 23 25 40 29 22 36 23 39 27 33 34 19
[11833] 18 19 26 29 37 21 37 22 26 21 32 31 19 37 26 18 37 29 21 39 25 19 26 39
[11857] 34 18 28 37 28 31 39 37 40 21 37 36 37 19 39 24 36 21 23 29 35 35 25 33
[11881] 30 26 24 37 39 39 28 38 33 38 24 29 18 22 19 31 27 30 36 30 28 38 34 34
[11905] 19 25 29 33 33 28 37 22 30 28 40 31 20 30 22 26 18 23 22 34 18 39 19 20
[11929] 24 33 24 21 18 38 23 36 37 35 22 39 18 19 38 22 25 35 25 29 32 33 19 40
[11953] 23 39 19 40 25 31 26 18 34 33 32 27 23 23 32 29 26 38 26 30 24 22 35 28
[11977] 33 21 32 36 28 30 22 24 29 35 20 21 37 40 38 38 35 24 22 20 32 34 28 37
[12001] 33 40 23 21 24 30 19 24 32 18 19 27 39 28 38 30 18 29 31 29 29 31 35 32
[12025] 39 22 18 18 27 31 40 39 33 19 34 26 36 30 27 31 26 23 35 29 18 21 37 26
[12049] 35 19 18 32 26 31 21 25 22 18 27 37 21 35 27 38 31 39 40 19 25 18 22 39
[12073] 33 39 27 20 33 37 28 24 25 18 19 33 33 39 30 25 27 23 35 20 26 24 34 40
[12097] 36 38 39 18 24 20 40 24 19 28 37 20 30 18 38 38 25 22 30 18 31 19 28 22
[12121] 40 28 29 19 35 36 23 21 28 29 28 30 26 35 34 27 21 20 30 29 38 29 34 22
[12145] 35 33 24 24 19 29 24 21 34 25 37 40 31 34 32 34 27 21 34 24 22 18 25 26
[12169] 34 31 26 29 23 29 20 27 36 39 29 23 36 23 29 37 33 21 39 22 34 34 26 27
[12193] 39 39 21 19 27 23 27 39 37 21 37 21 30 20 31 23 28 24 35 25 22 24 34 28
[12217] 31 20 26 40 24 23 18 19 25 23 32 34 22 28 28 21 18 38 26 22 20 37 37 27
[12241] 24 35 26 21 19 21 34 25 32 22 40 19 21 32 26 40 31 37 24 31 33 30 26 33
[12265] 31 32 22 19 35 25 32 34 31 39 18 21 24 21 28 29 33 30 25 34 33 29 38 25
[12289] 23 26 30 35 30 40 38 34 33 40 37 32 32 33 38 26 25 40 30 22 31 25 38 33
[12313] 30 32 24 33 28 22 38 30 35 39 30 20 20 22 22 20 30 20 33 28 28 22 32 34
[12337] 40 26 26 31 28 26 40 39 26 31 33 37 31 22 33 20 31 34 21 32 26 19 30 38
[12361] 32 39 37 28 24 33 38 23 21 30 28 18 31 22 19 27 18 29 18 40 21 25 32 28
[12385] 24 36 39 40 20 22 33 35 28 19 37 32 36 38 33 30 27 38 23 31 18 32 30 40
[12409] 26 32 33 36 18 19 26 28 33 27 23 30 35 37 32 32 24 39 40 30 35 18 19 18
[12433] 19 23 39 26 35 40 35 30 40 22 27 36 33 25 35 35 25 24 18 37 37 23 27 28
[12457] 24 19 32 30 35 38 29 22 28 32 35 20 38 32 25 19 32 37 28 36 18 30 28 31
[12481] 24 30 27 20 25 19 19 23 26 23 31 19 33 35 19 27 34 32 39 33 34 19 38 36
[12505] 28 23 26 21 34 38 27 32 23 24 37 29 32 22 28 23 25 27 32 27 40 20 26 29
[12529] 34 22 23 38 23 40 26 19 33 24 39 36 37 33 28 32 34 35 30 32 24 23 33 31
[12553] 30 40 38 30 28 24 27 30 21 35 33 18 32 22 24 25 29 40 34 38 35 28 36 39
[12577] 40 19 32 27 36 33 33 35 39 31 25 25 27 40 40 38 26 24 18 38 27 25 18 20
[12601] 38 36 21 18 28 39 30 20 36 26 28 38 24 34 26 19 34 35 32 33 19 34 34 28
[12625] 22 33 34 27 24 31 18 24 40 40 39 28 36 18 22 26 33 24 18 35 40 31 29 30
[12649] 37 40 21 24 25 36 21 25 21 31 27 37 23 20 30 19 24 33 38 21 24 33 18 39
[12673] 24 35 37 26 40 23 22 27 38 35 31 27 18 33 21 35 23 37 36 21 37 18 29 33
[12697] 37 21 38 23 29 39 30 26 25 37 21 40 38 27 18 24 39 25 20 37 18 30 28 32
[12721] 23 21 40 35 33 20 18 36 37 30 40 40 30 25 23 21 34 19 36 18 22 21 21 40
[12745] 25 31 28 20 29 36 30 32 32 29 36 21 24 22 30 26 34 22 29 29 27 27 38 40
[12769] 27 25 22 20 33 38 28 36 36 20 29 27 21 30 20 39 19 31 40 23 27 37 21 25
[12793] 34 19 24 23 29 25 37 27 34 18 36 38 38 28 18 32 21 20 34 40 29 29 23 38
[12817] 33 27 37 29 18 26 38 21 21 35 33 23 32 36 40 26 19 25 18 19 38 39 20 25
[12841] 34 19 39 22 35 18 36 22 24 31 21 35 18 37 32 33 21 33 34 35 23 20 22 22
[12865] 20 28 32 18 32 25 33 40 40 30 18 18 19 20 37 24 28 29 29 24 35 30 40 23
[12889] 33 25 20 21 40 23 34 25 26 30 24 33 29 35 30 32 22 24 40 33 25 24 30 19
[12913] 40 24 27 27 36 23 21 30 30 20 35 28 37 32 34 32 20 21 27 24 22 22 21 32
[12937] 28 18 23 21 26 22 36 32 35 27 26 32 37 18 30 30 33 34 32 26 27 26 21 24
[12961] 27 20 22 34 37 25 34 23 21 38 21 36 27 18 27 40 19 36 27 40 33 21 26 28
[12985] 19 25 37 37 34 22 37 25 21 34 40 37 28 29 38 19 21 25 33 26 18 37 38 34
[13009] 27 36 30 35 34 38 28 20 37 35 33 31 33 29 27 34 28 18 18 31 32 21 20 40
[13033] 30 18 36 25 27 21 35 18 20 30 35 34 40 37 23 22 31 26 31 36 38 28 34 25
[13057] 38 34 33 36 32 18 21 30 33 34 22 21 40 23 20 28 36 26 35 36 19 32 33 40
[13081] 26 40 39 20 32 18 23 26 32 22 27 18 23 29 37 31 30 18 22 27 33 33 25 21
[13105] 20 23 33 32 18 30 27 31 27 39 30 37 24 32 27 28 39 40 37 26 38 31 40 40
[13129] 25 28 25 32 33 28 24 19 27 29 40 28 33 26 18 21 35 23 18 35 30 31 35 30
[13153] 33 31 39 31 32 28 29 40 35 22 25 21 34 29 25 27 18 23 34 24 39 38 33 33
[13177] 18 19 39 27 31 23 33 38 24 39 21 34 35 33 28 30 27 35 21 29 22 22 31 22
[13201] 31 22 32 34 39 34 28 25 28 33 36 33 38 31 19 25 26 36 22 20 26 34 37 29
[13225] 20 23 18 20 32 35 38 18 35 20 23 33 19 32 20 32 32 21 25 33 35 22 37 38
[13249] 20 27 23 29 27 30 38 35 21 20 18 27 21 27 25 35 34 27 24 32 32 35 18 20
[13273] 34 27 40 29 20 26 26 33 30 37 34 37 38 22 19 21 34 24 35 40 32 31 38 29
[13297] 38 22 21 33 25 36 29 38 24 30 21 38 23 27 40 28 24 30 40 32 20 38 21 19
[13321] 22 21 30 19 28 32 37 35 31 33 21 20 40 29 20 22 34 30 29 29 39 24 38 38
[13345] 23 26 25 20 23 21 33 24 22 37 24 28 27 37 21 22 21 30 34 24 18 30 18 30
[13369] 36 39 23 34 32 35 22 30 24 22 21 38 22 38 36 27 32 27 23 24 36 23 31 37
[13393] 20 31 35 35 27 24 27 39 22 26 22 27 26 26 33 35 22 30 27 36 29 26 29 18
[13417] 28 20 26 35 34 23 23 24 23 22 37 21 18 38 30 28 20 22 33 18 37 28 29 32
[13441] 39 24 19 30 36 26 21 31 24 26 20 24 24 26 40 32 19 24 27 30 20 24 27 19
[13465] 27 37 19 22 21 37 18 38 37 28 31 37 18 34 40 29 33 37 26 28 26 26 31 38
[13489] 31 23 36 35 23 39 31 23 38 32 26 38 21 30 38 28 24 38 32 38 40 40 30 20
[13513] 28 20 34 30 28 18 36 18 35 29 40 32 31 38 33 30 25 31 21 36 40 34 22 39
[13537] 24 18 21 20 22 33 18 36 36 40 25 34 39 25 31 24 29 32 39 38 36 25 25 40
[13561] 39 27 38 24 30 26 19 34 24 21 36 39 19 31 24 36 36 34 26 26 27 28 40 38
[13585] 18 25 40 40 26 37 19 19 35 22 30 24 33 28 24 18 35 33 30 25 37 39 23 38
[13609] 29 38 21 39 35 20 22 22 40 39 26 36 26 39 26 38 39 34 22 39 23 23 36 26
[13633] 39 21 39 19 34 25 39 36 40 38 40 27 31 28 37 33 34 18 21 27 29 31 21 33
[13657] 27 19 31 20 37 39 32 36 35 40 34 22 22 31 35 28 39 25 34 18 20 29 29 22
[13681] 30 27 38 32 30 18 21 21 27 30 26 38 24 24 32 27 23 22 27 27 19 20 20 39
[13705] 26 24 31 26 34 31 23 25 39 39 39 27 39 28 33 22 23 35 27 32 30 21 19 32
[13729] 38 24 39 27 25 33 36 40 39 25 25 26 26 22 38 33 21 20 38 19 34 23 37 40
[13753] 38 20 40 40 27 19 36 21 39 21 25 33 28 34 36 19 38 30 20 19 34 18 35 31
[13777] 26 27 23 25 38 28 31 21 32 34 28 26 25 35 31 21 22 40 21 36 36 29 21 39
[13801] 31 21 39 26 29 40 24 20 30 37 26 24 30 26 28 37 32 25 23 19 39 23 32 31
[13825] 26 35 37 32 30 32 38 40 25 38 27 38 30 22 26 23 22 26 22 28 19 26 29 40
[13849] 27 20 26 32 29 21 38 23 18 38 20 35 26 33 20 34 32 39 35 21 32 23 27 32
[13873] 19 29 27 40 20 35 24 23 18 39 25 40 30 23 37 36 27 23 36 22 26 32 37 28
[13897] 31 37 33 24 34 18 30 24 28 32 24 19 39 31 39 38 36 30 35 22 22 29 33 20
[13921] 38 31 37 32 24 27 30 26 32 35 31 35 40 32 26 26 30 23 31 19 18 19 39 33
[13945] 18 25 37 25 20 30 34 33 20 22 30 38 35 23 22 32 23 18 37 35 34 19 21 37
[13969] 32 22 24 35 26 32 18 29 38 24 23 27 28 38 40 23 27 18 18 20 36 31 20 37
[13993] 40 21 30 34 24 37 35 22 20 37 28 19 24 29 22 24 32 23 23 22 23 25 33 23
[14017] 40 28 23 37 34 21 20 18 39 20 30 34 34 23 30 36 30 34 40 32 36 20 38 36
[14041] 24 18 28 35 32 29 31 35 39 22 39 27 24 26 28 38 26 18 31 25 21 34 27 24
[14065] 30 33 39 39 33 25 36 18 32 30 37 32 20 30 25 22 22 40 32 38 33 27 23 28
[14089] 22 33 38 18 36 21 33 18 32 37 30 20 38 25 31 23 18 23 30 26 39 26 29 31
[14113] 36 28 19 22 40 36 39 39 20 26 29 32 20 39 40 22 26 40 26 25 21 39 36 35
[14137] 36 23 35 24 19 32 24 23 37 33 21 32 18 26 39 37 35 36 33 39 36 23 23 30
[14161] 30 37 29 34 26 25 20 23 19 21 28 22 26 28 24 26 36 25 30 40 34 20 23 28
[14185] 34 23 19 30 35 27 34 40 25 34 19 36 22 27 21 35 20 38 34 25 23 36 29 36
[14209] 20 31 21 36 40 39 25 36 36 32 34 33 20 29 35 36 35 39 33 32 40 39 34 26
[14233] 35 38 27 32 38 38 20 38 19 24 28 29 24 34 24 22 25 37 39 24 39 39 19 27
[14257] 21 39 25 28 25 34 18 20 20 22 37 39 37 33 30 29 28 27 40 27 18 25 29 38
[14281] 37 40 28 21 28 32 26 31 19 21 31 40 36 21 32 38 40 23 20 28 37 30 40 36
[14305] 27 34 39 24 29 28 27 18 29 21 21 21 28 37 32 37 32 37 32 23 28 20 40 21
[14329] 40 20 40 20 39 36 23 32 25 30 20 18 27 23 31 39 26 30 27 37 40 23 33 35
[14353] 27 21 22 28 35 34 37 29 39 32 36 29 39 34 36 24 29 36 23 36 33 32 31 36
[14377] 35 35 32 29 28 37 19 40 40 29 27 35 21 33 33 34 22 35 34 18 36 22 30 19
[14401] 34 27 34 40 35 36 30 27 30 24 35 21 23 34 32 21 32 39 26 29 36 33 29 27
[14425] 23 24 22 20 29 35 28 40 35 29 22 26 36 33 39 38 36 36 24 23 23 25 20 32
[14449] 32 30 21 21 38 29 24 28 37 25 27 38 20 32 18 33 26 23 30 29 26 37 24 20
[14473] 32 24 21 36 21 21 24 20 34 30 19 36 28 23 28 19 19 39 35 23 25 21 18 38
[14497] 27 39 22 23 28 21 35 23 36 27 40 29 27 26 25 37 28 21 36 33 22 21 34 38
[14521] 18 39 36 25 31 37 22 28 38 20 39 27 27 20 21 21 32 31 39 28 22 35 21 18
[14545] 39 22 35 32 37 32 30 34 22 30 33 26 39 40 31 20 18 27 32 22 21 33 37 26
[14569] 37 35 32 18 29 22 28 26 26 32 28 34 20 30 36 40 34 20 33 25 30 23 24 23
[14593] 33 38 27 38 34 32 18 18 22 30 22 34 19 35 24 28 19 30 22 24 35 32 25 20
[14617] 26 21 26 37 31 37 36 34 29 37 22 36 18 31 33 21 20 27 28 40 22 29 21 18
[14641] 38 23 22 34 38 26 36 38 22 18 25 21 23 23 24 27 24 40 23 26 31 18 32 21
[14665] 29 19 34 29 27 28 39 20 25 20 36 40 28 32 27 36 24 32 29 35 40 20 37 22
[14689] 40 30 20 32 34 36 28 19 36 19 38 28 25 31 18 31 38 27 39 29 23 27 32 28
[14713] 22 22 28 22 25 35 40 22 36 26 28 20 38 26 24 25 19 24 40 27 30 40 33 31
[14737] 39 37 26 33 23 28 33 20 25 39 24 33 24 21 22 18 19 39 36 25 30 25 36 32
[14761] 22 36 32 37 22 40 31 22 31 29 31 31 37 33 36 35 27 28 27 36 25 24 19 36
[14785] 40 28 34 25 19 31 22 21 26 18 20 29 31 39 30 30 34 27 29 26 39 19 26 29
[14809] 32 38 31 31 26 28 18 30 38 38 20 30 37 27 22 26 36 28 33 27 39 20 29 36
[14833] 36 30 34 28 39 29 29 20 32 20 27 37 31 25 25 25 25 34 18 22 18 23 34 34
[14857] 26 40 38 24 33 22 19 30 31 23 31 18 24 23 20 21 36 18 18 32 29 31 27 28
[14881] 33 21 25 18 30 36 39 30 39 37 28 25 40 28 37 28 37 21 27 37 22 27 37 23
[14905] 37 21 28 20 21 31 36 24 22 26 33 38 31 28 26 31 38 25 29 19 29 28 28 20
[14929] 19 29 25 34 21 27 20 26 28 30 18 18 37 25 18 40 39 32 33 18 34 33 35 40
[14953] 23 21 18 32 19 21 38 19 23 30 28 27 19 21 18 28 37 19 20 40 32 27 23 37
[14977] 26 22 26 27 33 39 26 32 37 19 22 26 33 23 21 36 39 40 24 31 28 35 30 34
[15001] 29 22 33 31 29 34 27 40 30 30 30 23 24 36 19 38 37 26 37 20 38 36 29 36
[15025] 20 21 29 21 22 20 31 18 35 28 19 28 26 32 33 35 29 23 26 31 22 21 33 37
[15049] 25 25 25 28 29 38 39 25 18 30 34 20 23 25 31 21 24 39 25 32 19 33 33 26
[15073] 24 36 36 37 37 35 28 36 26 30 39 35 36 22 32 29 18 25 37 40 39 37 35 20
[15097] 28 29 23 39 28 38 34 19 40 39 37 40 29 37 40 34 32 28 37 23 24 35 31 24
[15121] 28 32 26 39 23 21 28 19 29 25 22 25 39 33 21 35 31 35 38 36 36 18 33 28
[15145] 27 22 25 38 28 19 18 32 23 26 18 24 29 19 27 37 18 34 31 23 21 24 29 30
[15169] 33 19 27 27 26 31 40 36 19 24 21 20 33 31 28 19 21 36 38 27 26 29 36 38
[15193] 23 18 38 32 26 37 29 19 20 28 30 27 28 28 33 22 32 21 19 37 18 29 21 38
[15217] 40 37 25 20 36 27 28 30 22 24 24 28 22 30 25 31 20 26 25 26 35 19 23 37
[15241] 27 35 38 21 23 38 25 32 19 31 28 37 36 30 29 19 24 26 31 21 22 21 26 26
[15265] 26 26 32 40 26 33 20 27 39 28 39 29 36 31 31 37 36 29 20 19 21 33 22 23
[15289] 23 23 25 32 21 28 37 20 18 35 34 36 22 34 36 25 29 29 22 35 31 31 39 40
[15313] 25 31 37 35 24 39 35 20 19 35 32 25 22 39 38 29 24 29 32 19 25 31 37 20
[15337] 23 26 32 34 18 36 26 30 29 34 21 20 24 30 25 33 18 22 30 23 34 36 37 28
[15361] 28 25 34 19 40 21 29 38 29 36 32 32 19 35 22 31 28 39 34 40 38 18 27 35
[15385] 23 38 37 26 24 19 20 40 18 29 25 20 32 24 40 37 25 30 21 28 36 36 25 24
[15409] 37 30 38 27 33 22 19 29 29 35 27 24 28 28 19 19 24 40 18 19 23 19 33 18
[15433] 37 40 29 29 39 36 34 31 32 35 23 20 18 36 20 26 27 22 32 22 25 40 37 29
[15457] 38 35 35 36 28 25 28 40 38 30 31 28 27 34 30 27 18 24 37 37 35 21 28 38
[15481] 32 32 28 23 26 30 21 34 37 38 40 32 39 26 38 34 34 19 20 34 36 30 20 32
[15505] 39 20 36 24 39 39 40 25 18 24 19 21 21 38 18 22 19 40 34 29 25 34 33 22
[15529] 19 23 26 33 36 34 26 32 20 23 39 23 22 23 25 22 32 18 23 32 32 33 40 29
[15553] 29 39 24 38 34 33 25 30 18 20 29 18 40 26 36 24 39 31 22 24 31 31 30 39
[15577] 19 34 39 19 18 40 27 25 38 26 35 24 27 24 38 18 36 37 18 18 37 24 25 30
[15601] 18 25 39 32 25 39 18 24 20 36 18 20 26 37 21 18 21 22 23 24 28 22 24 22
[15625] 24 25 30 40 24 27 33 31 29 23 33 35 28 38 22 28 35 36 19 20 32 26 27 23
[15649] 21 37 28 38 27 21 30 28 29 20 24 25 29 36 35 23 23 18 35 21 28 29 24 18
[15673] 34 18 36 33 25 33 37 29 37 24 20 21 36 22 37 26 38 40 38 27 26 35 30 25
[15697] 33 31 35 23 34 21 35 33 19 40 40 32 25 37 31 24 39 36 38 34 22 34 35 31
[15721] 18 37 19 33 26 35 36 19 21 21 27 21 22 20 31 32 31 40 19 29 27 37 22 38
[15745] 32 38 25 22 39 23 18 25 26 35 39 35 18 28 30 37 20 28 36 29 33 26 25 32
[15769] 26 26 38 23 29 23 20 26 36 40 20 28 26 30 28 36 18 24 34 31 22 18 39 32
[15793] 33 34 36 30 31 28 29 35 32 20 22 24 37 38 34 40 27 18 32 37 27 31 39 21
[15817] 35 35 35 38 40 33 27 20 29 24 39 38 30 36 32 19 37 26 23 34 40 25 19 34
[15841] 22 24 25 19 35 24 25 38 21 23 34 35 27 26 37 19 18 34 27 38 32 39 21 39
[15865] 24 29 20 29 32 28 40 20 40 23 38 18 27 24 31 35 33 22 18 19 22 27 18 31
[15889] 39 25 31 21 25 24 32 39 33 39 18 31 26 30 30 27 19 35 18 23 28 39 18 20
[15913] 25 30 36 34 18 34 27 36 26 23 18 30 27 22 30 35 18 33 30 32 25 31 30 21
[15937] 39 36 23 31 22 34 38 26 36 19 18 39 24 30 24 23 34 38 29 36 32 38 40 23
[15961] 35 37 34 26 18 39 38 32 30 38 20 21 40 34 37 21 36 32 22 27 31 30 18 33
[15985] 30 30 35 28 33 37 34 33 27 32 22 36 25 27 38 20 35 36 22 28 37 38 37 22
[16009] 37 18 23 40 40 32 33 40 20 29 31 37 37 33 24 35 27 23 21 23 40 31 22 25
[16033] 19 30 36 18 20 18 20 18 19 25 26 32 26 26 40 28 29 37 18 29 33 25 18 21
[16057] 25 18 37 37 20 39 36 32 32 34 18 37 20 36 32 26 23 19 26 30 18 39 35 19
[16081] 33 25 32 39 33 31 31 23 20 39 25 30 30 32 28 23 30 36 21 35 39 31 34 30
[16105] 30 23 18 29 34 26 29 34 32 38 24 28 18 28 32 23 21 24 27 18 38 31 18 20
[16129] 39 19 33 29 34 23 22 23 25 24 30 40 33 33 33 25 21 19 27 28 22 38 28 23
[16153] 38 40 21 36 20 40 27 28 39 39 26 36 35 36 19 21 21 36 39 34 37 26 35 20
[16177] 26 23 38 36 40 28 33 26 21 34 40 23 25 19 29 39 29 34 31 26 38 40 32 27
[16201] 28 40 29 22 39 31 32 26 38 21 20 39 22 18 36 37 18 34 39 28 25 31 22 20
[16225] 40 39 20 37 39 36 40 26 34 30 21 18 20 35 39 25 22 33 26 36 22 34 20 30
[16249] 22 21 38 20 27 27 33 33 30 38 37 36 36 39 36 39 26 26 33 32 36 37 25 28
[16273] 35 32 22 29 33 19 35 37 29 34 32 24 27 26 39 25 35 24 18 26 25 28 19 33
[16297] 38 21 18 39 38 24 23 33 20 23 35 32 37 21 18 24 31 32 24 40 23 23 29 33
[16321] 19 36 25 18 39 32 28 23 24 27 28 30 39 39 38 36 26 25 40 25 36 26 35 38
[16345] 19 32 36 24 39 39 19 31 23 31 23 33 35 32 32 28 20 20 34 40 31 33 18 30
[16369] 20 28 37 22 21 30 30 24 27 28 39 38 38 35 23 25 20 28 24 34 21 29 36 21
[16393] 36 20 32 35 22 20 29 24 39 32 29 25 26 36 35 24 26 27 26 30 21 24 33 24
[16417] 18 33 36 40 35 27 23 30 36 39 20 19 31 32 25 21 20 21 39 32 21 30 21 19
[16441] 22 33 31 21 28 39 35 27 20 29 31 39 23 24 39 29 35 31 28 18 28 37 27 38
[16465] 30 31 35 28 30 39 22 26 40 36 20 32 30 20 26 31 39 26 18 29 31 22 29 22
[16489] 32 36 21 22 28 22 22 35 29 32 29 22 29 28 29 28 25 37 33 23 20 38 21 24
[16513] 29 21 19 27 27 35 29 38 25 18 19 28 37 38 38 20 31 40 18 22 37 27 23 32
[16537] 27 38 19 37 40 28 37 34 37 40 36 21 28 19 21 30 34 33 27 35 31 32 25 20
[16561] 18 37 32 26 40 19 35 33 29 31 35 23 37 20 37 22 19 35 28 31 37 28 33 36
[16585] 28 31 34 36 28 40 30 25 20 35 37 21 33 22 33 33 28 33 22 38 23 39 21 35
[16609] 26 34 36 25 37 34 26 33 27 23 34 29 34 37 29 33 20 30 35 24 20 36 19 39
[16633] 27 27 31 39 28 28 19 39 23 26 33 35 38 29 35 19 32 37 26 25 20 27 34 25
[16657] 21 37 18 24 37 30 23 26 28 32 19 20 35 34 34 26 27 22 30 29 30 39 18 23
[16681] 23 36 31 20 37 31 38 28 35 32 23 32 23 31 24 23 30 31 30 20 25 22 32 26
[16705] 35 39 23 25 18 33 21 19 22 38 40 21 36 25 22 24 35 30 23 38 20 27 19 25
[16729] 34 35 23 20 21 40 33 40 37 37 27 23 33 33 29 22 33 39 25 22 37 33 28 28
[16753] 28 32 23 37 23 40 27 25 36 36 23 32 36 37 34 18 19 25 23 25 22 40 36 25
[16777] 38 27 36 32 31 23 40 22 40 34 24 29 40 23 38 40 23 23 38 38 20 27 40 36
[16801] 26 22 24 39 36 39 19 36 35 29 21 40 39 30 38 35 36 31 30 29 29 20 30 22
[16825] 20 40 26 28 33 29 40 36 30 34 40 20 27 32 38 19 37 25 22 39 30 40 38 32
[16849] 28 31 20 25 32 24 25 35 38 21 40 39 32 40 39 20 38 40 18 21 26 27 19 36
[16873] 40 32 28 20 23 36 37 25 30 22 25 21 39 40 39 38 29 26 29 26 28 38 24 33
[16897] 40 37 23 29 22 20 33 39 29 31 25 25 31 29 23 38 39 30 18 37 38 38 35 39
[16921] 25 40 18 35 26 37 22 28 35 31 19 29 23 25 36 18 38 30 20 38 26 27 31 26
[16945] 19 35 33 30 37 34 19 19 38 35 24 21 35 35 31 29 39 29 18 31 36 37 26 19
[16969] 24 33 19 22 32 19 22 31 32 24 39 31 32 21 34 21 18 22 39 38 18 19 25 34
[16993] 37 24 31 20 34 34 39 27 25 24 35 22 23 24 39 37 23 40 23 38 37 31 22 18
[17017] 26 21 21 35 19 27 20 34 21 28 20 30 34 31 31 37 34 33 29 20 39 30 26 24
[17041] 29 30 28 31 35 34 40 32 24 20 28 22 21 29 33 20 30 24 31 34 26 38 25 32
[17065] 27 34 28 39 27 18 20 34 33 26 26 31 40 38 30 34 35 38 32 31 37 38 36 30
[17089] 35 25 18 18 20 19 36 22 18 21 20 26 31 20 40 21 30 26 33 20 25 19 19 31
[17113] 24 28 18 20 25 21 39 26 25 22 40 19 33 23 36 37 24 24 21 38 29 38 25 40
[17137] 23 27 20 19 21 22 31 32 31 27 35 36 36 34 18 36 22 36 24 29 20 19 30 23
[17161] 26 39 37 34 30 23 37 26 20 38 20 27 35 40 36 32 38 31 39 37 27 37 19 24
[17185] 31 38 19 35 33 30 24 26 39 29 22 31 31 21 34 32 25 27 23 39 34 37 25 18
[17209] 33 28 24 33 31 26 28 24 19 24 37 37 20 37 18 36 25 21 31 18 22 33 28 39
[17233] 29 29 34 18 35 23 35 22 35 33 36 32 28 21 38 32 19 20 24 40 18 26 39 32
[17257] 28 36 37 20 33 26 27 30 37 38 26 34 22 28 18 30 28 30 27 39 35 29 21 31
[17281] 28 26 24 38 18 21 32 36 37 36 33 33 20 22 38 24 38 22 20 22 27 31 37 20
[17305] 29 37 34 23 35 19 22 22 31 27 40 32 21 30 22 38 26 32 33 26 30 35 24 39
[17329] 40 23 24 20 18 33 35 35 37 24 22 25 25 32 18 21 20 25 28 39 24 30 37 27
[17353] 31 20 32 36 18 32 28 29 29 30 20 31 25 21 36 37 19 32 25 34 28 20 38 36
[17377] 21 21 22 20 35 23 23 34 40 36 33 22 18 25 34 25 32 21 38 36 35 34 19 31
[17401] 40 38 20 36 30 32 33 36 24 38 39 18 39 29 33 38 34 37 40 28 25 26 37 18
[17425] 29 38 29 39 33 29 29 34 31 30 32 27 37 18 37 19 35 34 31 31 20 22 36 20
[17449] 29 33 36 36 32 32 25 37 23 38 28 25 22 25 30 19 34 23 38 31 20 19 40 35
[17473] 19 40 38 18 39 29 26 21 26 21 40 30 28 33 20 29 37 35 20 18 34 19 25 37
[17497] 31 18 27 20 36 32 33 36 22 34 35 24 18 23 35 38 28 37 25 32 36 23 31 21
[17521] 38 19 35 38 36 27 19 21 34 23 35 26 19 22 19 40 28 30 40 26 31 35 28 31
[17545] 26 36 32 35 23 40 25 27 30 30 24 38 31 32 39 28 38 26 37 25 36 29 26 37
[17569] 31 28 36 35 35 20 34 35 28 27 34 25 22 34 33 34 20 39 34 26 28 20 38 21
[17593] 28 33 24 38 32 30 29 19 30 29 20 36 27 39 38 34 36 21 26 40 37 26 34 24
[17617] 23 36 22 34 34 20 23 36 21 25 33 32 24 29 31 32 38 24 32 35 36 33 20 36
[17641] 22 19 21 35 29 21 22 23 30 32 19 21 40 37 24 23 40 25 40 20 22 36 28 34
[17665] 20 29 36 24 37 26 34 29 19 37 40 33 30 35 31 19 21 22 29 29 22 34 25 35
[17689] 29 32 29 34 40 32 24 24 20 24 34 30 39 24 29 19 37 33 19 37 28 32 29 32
[17713] 31 34 23 29 24 26 30 33 29 33 36 28 39 33 23 26 18 18 19 38 28 40 31 18
[17737] 34 25 29 25 24 39 28 23 36 37 35 39 19 37 38 40 39 40 18 19 32 34 36 33
[17761] 20 35 26 34 29 37 28 39 21 39 36 38 20 31 38 38 29 24 25 39 40 21 23 28
[17785] 32 26 30 23 24 30 33 33 27 20 37 38 28 19 38 27 28 18 19 27 19 18 24 38
[17809] 29 30 19 25 19 26 40 31 26 22 38 37 25 36 21 20 38 22 25 19 31 25 36 25
[17833] 29 36 21 24 40 31 18 20 37 40 19 21 26 34 40 18 24 30 19 25 29 20 40 19
[17857] 22 24 29 38 39 25 30 19 20 39 40 38 18 40 27 34 40 19 21 20 27 28 21 39
[17881] 28 24 27 31 31 21 30 34 30 34 23 32 27 38 40 28 28 27 23 23 21 37 33 26
[17905] 27 28 35 21 28 22 27 25 24 32 39 36 32 24 40 25 27 32 23 36 29 24 34 40
[17929] 22 25 19 29 23 20 38 35 40 31 18 30 19 32 21 20 34 36 34 33 32 20 39 20
[17953] 20 26 20 19 31 34 24 27 21 39 28 35 34 21 26 39 26 18 35 29 18 24 39 23
[17977] 31 28 20 40 28 36 28 35 27 24 34 23 35 18 35 21 32 23 39 24 21 34 37 32
[18001] 28 38 27 37 19 20 33 28 29 26 31 18 22 38 37 38 19 25 27 33 37 28 28 36
[18025] 21 22 25 32 27 34 19 31 22 28 18 28 22 22 20 37 26 20 18 27 20 24 24 37
[18049] 38 23 19 25 23 37 28 33 23 21 36 32 40 22 20 27 20 32 23 40 27 40 27 30
[18073] 28 34 18 21 30 30 19 36 35 34 18 37 28 31 29 33 20 23 24 26 37 31 31 26
[18097] 19 19 25 27 37 25 38 20 37 32 18 31 19 18 33 31 19 30 20 26 38 28 23 27
[18121] 37 32 19 18 34 39 33 40 28 35 22 25 21 24 22 25 18 37 38 31 29 36 28 18
[18145] 25 37 31 25 25 35 38 35 35 36 33 20 20 30 22 27 21 35 29 36 26 33 28 38
[18169] 23 27 32 25 31 31 22 29 37 24 33 33 27 38 29 29 28 28 33 35 32 24 33 33
[18193] 27 29 37 33 35 22 29 34 31 25 27 22 38 25 22 36 18 22 35 31 38 25 31 32
[18217] 28 23 18 37 28 28 39 18 21 28 23 19 27 34 38 25 27 22 29 40 34 38 35 20
[18241] 25 40 28 32 20 18 38 18 35 25 18 22 27 31 31 32 22 21 24 31 31 29 24 21
[18265] 33 28 32 36 35 19 34 34 36 30 30 34 20 40 21 35 30 37 27 30 34 32 18 18
[18289] 37 38 30 29 30 40 22 22 30 30 25 30 27 23 22 35 21 31 27 25 39 19 21 35
[18313] 20 24 26 22 28 20 20 26 18 28 28 18 40 31 18 30 33 33 28 34 22 40 34 32
[18337] 39 21 30 31 39 37 33 28 19 22 27 20 37 34 31 37 28 36 34 36 30 38 27 30
[18361] 24 31 36 21 18 19 25 24 34 37 38 32 19 30 37 34 26 21 40 30 29 35 36 30
[18385] 24 27 38 21 40 24 31 40 20 36 30 25 20 25 20 38 23 35 35 25 23 32 34 40
[18409] 35 20 34 34 22 32 39 18 22 29 18 40 24 24 27 37 31 33 19 32 34 26 24 26
[18433] 38 36 37 23 19 22 36 31 35 34 31 37 27 39 30 38 25 29 38 22 25 35 18 27
[18457] 20 20 37 28 23 36 32 33 27 18 26 38 26 25 38 19 30 23 34 26 28 22 18 31
[18481] 18 39 21 32 37 27 29 30 21 30 19 20 28 18 23 29 34 34 21 36 20 29 32 24
[18505] 31 37 40 40 28 39 34 40 23 34 39 24 30 39 24 38 32 33 27 35 33 40 22 19
[18529] 33 18 31 33 25 33 26 40 25 19 35 37 32 35 30 22 34 23 40 29 31 28 38 33
[18553] 39 29 33 33 39 20 26 31 40 38 22 22 28 27 39 26 25 23 40 24 27 37 23 28
[18577] 30 19 23 27 30 18 40 38 19 21 30 22 25 37 26 29 34 27 26 20 40 37 35 18
[18601] 36 28 27 34 21 30 33 26 31 21 23 31 20 33 20 39 26 35 19 26 22 40 31 27
[18625] 24 26 29 32 37 27 35 32 23 33 33 18 29 19 30 40 32 25 19 18 31 27 38 18
[18649] 30 29 35 31 24 31 18 21 30 35 32 22 29 25 29 27 38 19 33 29 30 23 32 22
[18673] 27 21 37 37 40 40 33 28 29 19 22 23 22 19 22 19 23 36 34 32 30 21 27 20
[18697] 40 33 31 31 26 33 36 20 34 38 39 24 32 28 35 23 26 20 24 37 30 29 24 32
[18721] 22 29 23 25 35 25 39 26 33 39 36 21 29 27 35 24 22 26 30 30 28 23 33 39
[18745] 20 35 18 28 39 22 22 20 27 20 32 32 26 38 36 25 32 27 21 23 31 28 40 24
[18769] 24 31 34 21 38 24 30 33 39 32 22 37 32 23 39 36 27 31 40 29 35 37 32 39
[18793] 32 21 24 27 26 31 25 27 38 28 22 40 34 28 25 23 25 37 20 39 33 33 22 23
[18817] 24 32 37 38 38 30 18 23 35 18 35 37 20 36 30 19 25 24 36 19 39 30 39 39
[18841] 38 27 19 24 21 18 29 22 19 34 21 19 19 31 20 36 26 19 28 37 21 36 37 38
[18865] 37 32 40 36 27 27 33 34 22 40 34 19 39 34 30 21 34 21 20 34 31 35 24 38
[18889] 29 32 38 24 20 35 36 29 27 25 36 28 23 35 30 32 19 22 30 18 27 21 30 30
[18913] 30 29 22 28 34 33 37 36 36 32 19 38 35 27 20 35 38 39 26 29 20 36 30 26
[18937] 40 38 38 29 40 35 23 24 34 33 36 18 25 25 30 20 35 36 31 22 20 22 27 21
[18961] 39 22 24 29 31 18 29 21 34 31 32 29 38 35 24 40 31 34 30 29 27 25 40 22
[18985] 33 30 26 37 20 36 21 20 40 19 21 38 20 38 27 24 40 19 18 38 23 25 35 27
[19009] 20 33 23 39 34 21 20 39 33 24 39 30 37 22 25 38 36 37 18 35 38 35 26 31
[19033] 39 23 31 30 18 26 19 32 20 22 29 38 36 37 29 25 28 36 29 22 18 32 28 31
[19057] 37 27 40 37 28 30 21 20 23 39 33 31 40 35 33 38 34 23 18 38 38 40 29 32
[19081] 29 37 36 32 24 19 21 34 34 32 28 28 37 29 20 20 29 36 40 21 25 21 37 18
[19105] 31 27 33 19 28 18 18 20 25 33 37 20 23 18 18 20 23 32 18 25 25 20 24 40
[19129] 25 27 36 33 30 33 38 30 23 19 33 29 40 38 22 22 30 28 35 37 39 18 30 38
[19153] 37 36 33 38 32 19 31 30 18 38 30 40 36 34 39 40 36 33 35 20 40 23 20 23
[19177] 32 32 39 38 36 33 18 38 34 33 26 18 31 23 37 25 20 19 21 23 37 26 22 33
[19201] 20 39 33 39 18 21 40 19 34 38 18 34 35 18 23 20 40 37 24 24 31 26 18 36
[19225] 29 39 37 36 34 38 37 30 23 22 24 35 18 26 39 22 35 30 22 23 28 35 18 23
[19249] 35 26 18 37 35 26 19 23 28 37 39 33 18 34 21 26 33 32 28 34 23 37 34 35
[19273] 18 32 26 30 23 40 34 36 22 26 31 27 31 33 20 33 22 33 27 39 38 29 36 21
[19297] 22 37 21 26 36 39 31 28 36 40 34 37 24 32 22 29 30 39 26 27 28 19 37 26
[19321] 37 32 21 21 26 39 22 27 31 18 27 19 27 22 37 34 40 22 38 38 30 32 25 35
[19345] 28 30 29 25 36 36 40 20 19 18 19 22 36 22 38 38 34 28 22 39 27 34 40 32
[19369] 24 31 22 37 22 36 33 19 38 34 27 39 36 40 35 38 20 28 38 24 18 39 24 33
[19393] 31 29 27 26 39 21 37 34 22 40 34 21 32 23 29 39 23 34 40 37 25 22 23 32
[19417] 27 35 39 38 34 25 33 39 35 21 18 37 40 20 32 39 22 38 33 39 31 39 28 22
[19441] 24 39 31 28 33 30 22 26 39 32 35 29 37 34 24 28 37 26 40 18 36 35 35 31
[19465] 33 24 37 28 38 34 18 33 25 31 38 24 22 37 19 19 26 23 37 26 28 29 35 34
[19489] 18 20 24 32 21 20 36 34 35 34 19 36 19 20 32 20 29 23 26 32 37 19 33 20
[19513] 33 32 25 18 25 36 32 32 19 30 29 40 32 19 24 28 32 31 28 26 29 38 32 21
[19537] 35 26 32 35 33 20 32 34 29 31 35 31 34 29 24 31 36 40 20 31 38 28 39 18
[19561] 29 29 29 18 19 30 36 18 29 36 33 34 32 20 34 36 40 39 27 31 36 30 28 37
[19585] 36 19 40 34 24 30 21 38 23 27 25 32 26 23 24 32 33 19 30 36 40 29 21 27
[19609] 29 37 24 36 30 28 21 26 28 19 26 39 30 18 21 32 18 37 25 34 21 34 19 31
[19633] 35 29 29 37 22 39 29 25 33 27 30 33 19 28 30 26 19 27 31 28 22 20 28 27
[19657] 33 34 35 30 18 37 27 25 33 27 32 25 27 35 26 20 22 19 39 21 28 23 35 40
[19681] 33 18 25 23 29 31 25 22 32 37 18 32 19 38 36 20 24 26 30 29 26 32 25 23
[19705] 36 18 21 37 24 22 27 29 26 40 30 29 39 28 33 38 32 36 30 37 28 21 35 35
[19729] 25 40 20 27 20 30 31 33 33 19 19 37 22 27 22 36 29 40 32 21 28 35 25 24
[19753] 33 35 31 21 35 22 37 40 37 18 32 26 23 40 21 19 34 20 19 40 34 21 24 36
[19777] 28 40 19 27 19 31 39 30 28 25 22 37 22 33 38 30 35 35 21 20 25 32 24 20
[19801] 21 22 20 32 23 25 36 35 28 37 36 27 18 33 32 37 28 38 36 37 32 18 19 33
[19825] 23 26 24 35 37 37 34 31 40 20 40 25 24 19 40 19 32 40 27 34 30 23 34 25
[19849] 20 33 19 18 32 30 35 25 21 21 32 37 26 22 26 30 25 27 19 19 31 19 21 31
[19873] 28 39 36 38 33 35 38 26 19 20 27 30 26 27 31 30 26 26 40 26 34 19 37 35
[19897] 36 28 34 30 39 31 25 40 20 38 29 23 38 33 21 39 27 23 18 39 27 22 19 29
[19921] 19 26 27 29 18 25 27 35 21 19 27 18 30 37 27 37 24 35 28 38 24 19 23 35
[19945] 31 27 27 39 27 39 32 25 20 32 28 27 29 37 28 31 39 22 26 22 29 30 34 31
[19969] 20 27 23 35 24 29 21 27 40 31 20 34 33 32 31 31 32 30 38 26 25 29 35 26
[19993] 36 26 27 26 21 31 33 21

$data.name
[1] "dades[, variable]"

$bad.obs
[1] 0

$all.stats
  i  Mean.i     SD.i Value Obs.Num    R.i+1 lambda.i+1 Outlier
1 0 29.0338 6.622458    18      73 1.666119   4.706884   FALSE

attr(,"class")
[1] "gofOutlier"</code></pre>
</div>
<div class="sourceCode cell-code" id="cb20"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb20-1"><a href="#cb20-1" aria-hidden="true" tabindex="-1"></a>test<span class="sc">$</span>all.stats</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>  i  Mean.i     SD.i Value Obs.Num    R.i+1 lambda.i+1 Outlier
1 0 29.0338 6.622458    18      73 1.666119   4.706884   FALSE</code></pre>
</div>
</div>
</section>
</section>
</section>
<section id="multivariate" class="level2" data-number="2.2">
<h2 data-number="2.2" class="anchored" data-anchor-id="multivariate"><span class="header-section-number">2.2</span> Multivariate</h2>
<div class="cell">
<div class="sourceCode cell-code" id="cb22"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb22-1"><a href="#cb22-1" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(scatterplot3d)</span>
<span id="cb22-2"><a href="#cb22-2" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(readr)</span>
<span id="cb22-3"><a href="#cb22-3" aria-hidden="true" tabindex="-1"></a>dades <span class="ot">&lt;-</span> readr<span class="sc">::</span><span class="fu">read_csv</span>(<span class="st">"https://archive.ics.uci.edu/ml/machine-learning-databases/forest-fires/forestfires.csv"</span>)</span>
<span id="cb22-4"><a href="#cb22-4" aria-hidden="true" tabindex="-1"></a>dades <span class="ot">&lt;-</span> <span class="fu">data.frame</span>(dades[, <span class="fu">c</span>(<span class="st">"DC"</span>, <span class="st">"temp"</span>, <span class="st">"RH"</span>)])</span>
<span id="cb22-5"><a href="#cb22-5" aria-hidden="true" tabindex="-1"></a><span class="fu">scatterplot3d</span>(dades[,<span class="st">"DC"</span>], dades[, <span class="st">"temp"</span>],dades[, <span class="st">"RH"</span>])</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<div>
<figure class="figure">
<p><img src="AdvancedPreprocessing_files/figure-html/plot_multivariate-1.png" class="img-fluid figure-img" width="672"></p>
</figure>
</div>
</div>
</div>
<div class="cell">
<div class="sourceCode cell-code" id="cb23"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb23-1"><a href="#cb23-1" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(rgl)</span>
<span id="cb23-2"><a href="#cb23-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb23-3"><a href="#cb23-3" aria-hidden="true" tabindex="-1"></a><span class="co"># Plot</span></span>
<span id="cb23-4"><a href="#cb23-4" aria-hidden="true" tabindex="-1"></a>rgl<span class="sc">::</span><span class="fu">plot3d</span>(<span class="at">x =</span> dades[, <span class="st">"DC"</span>], <span class="at">y =</span> dades[, <span class="st">"temp"</span>], <span class="at">z =</span> dades[, <span class="st">"RH"</span>], </span>
<span id="cb23-5"><a href="#cb23-5" aria-hidden="true" tabindex="-1"></a><span class="at">col =</span> <span class="st">"black"</span>, <span class="at">type =</span> <span class="st">'p'</span>, <span class="at">radius =</span> .<span class="dv">1</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<div class="cell">
<div class="sourceCode cell-code" id="cb24"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb24-1"><a href="#cb24-1" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(plotly)</span>
<span id="cb24-2"><a href="#cb24-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb24-3"><a href="#cb24-3" aria-hidden="true" tabindex="-1"></a>(fig <span class="ot">&lt;-</span> plotly<span class="sc">::</span><span class="fu">plot_ly</span>(dades, <span class="at">x =</span> <span class="sc">~</span>DC, <span class="at">y =</span> <span class="sc">~</span>temp, <span class="at">z =</span> <span class="sc">~</span>RH, <span class="at">size =</span> <span class="dv">1</span>) <span class="sc">%&gt;%</span> </span>
<span id="cb24-4"><a href="#cb24-4" aria-hidden="true" tabindex="-1"></a>       <span class="fu">add_markers</span>())</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<div class="plotly html-widget html-fill-item" id="htmlwidget-ee6535149ad4c6730f0e" style="width:100%;height:464px;"></div>
<script type="application/json" data-for="htmlwidget-ee6535149ad4c6730f0e">{"x":{"visdat":{"1ae857792968":["function () ","plotlyVisDat"]},"cur_data":"1ae857792968","attrs":{"1ae857792968":{"x":{},"y":{},"z":{},"size":1,"alpha_stroke":1,"sizes":[10,100],"spans":[1,20],"type":"scatter3d","mode":"markers","inherit":true}},"layout":{"margin":{"b":40,"l":60,"t":25,"r":10},"scene":{"xaxis":{"title":"DC"},"yaxis":{"title":"temp"},"zaxis":{"title":"RH"}},"hovermode":"closest","showlegend":false},"source":"A","config":{"modeBarButtonsToAdd":["hoverclosest","hovercompare"],"showSendToCloud":false},"data":[{"x":[94.299999999999997,669.10000000000002,686.89999999999998,77.5,102.2,488,495.60000000000002,608.20000000000005,692.60000000000002,698.60000000000002,698.60000000000002,713,665.29999999999995,686.5,699.60000000000002,713.89999999999998,80.799999999999997,664.20000000000005,70.799999999999997,97.099999999999994,692.60000000000002,724.29999999999995,200,537.39999999999998,594.20000000000005,601.39999999999998,668,686.5,721.39999999999998,728.60000000000002,692.29999999999995,709.89999999999998,706.79999999999995,718.29999999999995,724.29999999999995,730.20000000000005,669.10000000000002,682.60000000000002,686.89999999999998,67.599999999999994,366.69999999999999,624.20000000000005,647.10000000000002,698.60000000000002,735.70000000000005,692.29999999999995,686.5,442.89999999999998,64.700000000000003,103.8,706.39999999999998,631.20000000000005,654.10000000000002,654.10000000000002,661.29999999999995,706.39999999999998,730.20000000000005,691.79999999999995,34,43,102.2,102.2,466.60000000000002,631.20000000000005,638.79999999999995,661.29999999999995,668,668,668,77.5,97.799999999999997,692.29999999999995,77.5,614.5,713.89999999999998,26.600000000000001,43,103.8,529.79999999999995,561.60000000000002,601.39999999999998,631.20000000000005,647.10000000000002,654.10000000000002,661.29999999999995,706.39999999999998,706.39999999999998,706.39999999999998,728.60000000000002,80.799999999999997,624.20000000000005,80.799999999999997,488,601.39999999999998,638.79999999999995,704.39999999999998,30.199999999999999,15.5,601.39999999999998,601.39999999999998,601.39999999999998,614.5,647.10000000000002,674.39999999999998,9.3000000000000007,57.299999999999997,74.299999999999997,631.20000000000005,698.60000000000002,709.89999999999998,57.299999999999997,77.5,704.39999999999998,724.29999999999995,67.599999999999994,67.599999999999994,80.799999999999997,80.799999999999997,86.599999999999994,466.60000000000002,608.20000000000005,608.20000000000005,680.70000000000005,671.89999999999998,692.29999999999995,691.79999999999995,103.8,728.60000000000002,673.79999999999995,691.79999999999995,87.200000000000003,64.700000000000003,102.2,685.20000000000005,67.599999999999994,594.20000000000005,680.70000000000005,686.5,313.39999999999998,692.60000000000002,686.5,513.29999999999995,529.79999999999995,296.30000000000001,513.29999999999995,578.79999999999995,86.599999999999994,671.89999999999998,647.10000000000002,685.20000000000005,433.30000000000001,355.19999999999999,424.10000000000002,692.29999999999995,721.39999999999998,647.10000000000002,721.39999999999998,654.10000000000002,654.10000000000002,668,86.599999999999994,578.79999999999995,100.40000000000001,674.39999999999998,704.39999999999998,55,654.10000000000002,570.5,97.799999999999997,578.79999999999995,699.60000000000002,609.60000000000002,601.39999999999998,686.5,624.20000000000005,624.20000000000005,55.200000000000003,631.20000000000005,735.70000000000005,614.5,680.70000000000005,664.20000000000005,48.299999999999997,696.10000000000002,586.70000000000005,692.60000000000002,102.2,686.5,89.400000000000006,92.400000000000006,97.799999999999997,578.79999999999995,647.10000000000002,699.60000000000002,647.10000000000002,586.70000000000005,55.200000000000003,706.39999999999998,692.60000000000002,665.29999999999995,692.60000000000002,83.700000000000003,32.100000000000001,673.79999999999995,100.40000000000001,706.39999999999998,594.20000000000005,692.60000000000002,668,685.20000000000005,686.89999999999998,594.20000000000005,692.29999999999995,103.8,80.799999999999997,80.799999999999997,680.70000000000005,709.89999999999998,699.60000000000002,86.599999999999994,631.20000000000005,713.89999999999998,103.8,309.89999999999998,735.70000000000005,728.60000000000002,696.10000000000002,480.80000000000001,728.60000000000002,480.80000000000001,699.60000000000002,728.60000000000002,692.60000000000002,671.89999999999998,674.39999999999998,601.39999999999998,674.39999999999998,692.60000000000002,674.39999999999998,7.9000000000000004,43.5,85.299999999999997,589.89999999999998,700.70000000000005,700.70000000000005,700.70000000000005,700.70000000000005,503.60000000000002,666.70000000000005,666.70000000000005,666.70000000000005,666.70000000000005,666.70000000000005,565.5,621.70000000000005,694.79999999999995,581.10000000000002,581.10000000000002,692.29999999999995,692.29999999999995,542,573,573,629.10000000000002,684.39999999999998,550.29999999999995,607.10000000000002,658.20000000000005,658.20000000000005,658.20000000000005,658.20000000000005,658.20000000000005,658.20000000000005,353.5,354.60000000000002,352,349.69999999999999,349.69999999999999,349.69999999999999,349.69999999999999,352.60000000000002,349.69999999999999,353.5,18.699999999999999,15.800000000000001,411.80000000000001,437.69999999999999,474.89999999999998,474.89999999999998,474.89999999999998,474.89999999999998,474.89999999999998,466.30000000000001,430.80000000000001,440.89999999999998,430.80000000000001,290.80000000000001,290.80000000000001,377.19999999999999,233.80000000000001,298.10000000000002,298.10000000000002,232.09999999999999,232.09999999999999,113.8,714.29999999999995,714.29999999999995,714.29999999999995,758.10000000000002,758.10000000000002,758.10000000000002,758.10000000000002,706.60000000000002,777.10000000000002,777.10000000000002,817.5,739.39999999999998,739.39999999999998,783.5,783.5,783.5,783.5,783.5,822.79999999999995,726.89999999999998,751.5,751.5,751.5,751.5,751.5,751.5,795.29999999999995,795.29999999999995,721.10000000000002,764,764,764,764,764,764,764,770.29999999999995,807.10000000000002,807.10000000000002,807.10000000000002,807.10000000000002,807.10000000000002,745.29999999999995,745.29999999999995,745.29999999999995,745.29999999999995,745.29999999999995,745.29999999999995,745.29999999999995,745.29999999999995,745.29999999999995,745.29999999999995,789.70000000000005,789.70000000000005,789.70000000000005,789.70000000000005,789.70000000000005,732.29999999999995,770.29999999999995,770.29999999999995,770.29999999999995,812.10000000000002,812.10000000000002,744.39999999999998,825.10000000000002,825.10000000000002,520.5,664.5,698.60000000000002,855.29999999999995,744.39999999999998,672.60000000000002,715.10000000000002,30.600000000000001,171.40000000000001,458.80000000000001,643,690,753.79999999999995,819.10000000000002,613,750.5,30.600000000000001,706.70000000000005,706.70000000000005,58.299999999999997,738.10000000000002,825.10000000000002,25.600000000000001,46.700000000000003,56.899999999999999,750.5,613,715.10000000000002,297.69999999999999,297.69999999999999,731.70000000000005,706.70000000000005,643,725.10000000000002,680.89999999999998,860.60000000000002,55,855.29999999999995,450.19999999999999,52.799999999999997,43.600000000000001,442.10000000000002,715.10000000000002,723.10000000000002,698.60000000000002,575.79999999999995,28.300000000000001,664.5,613,635.89999999999998,690,795.89999999999998,744.39999999999998,715.10000000000002,753.79999999999995,753.79999999999995,672.60000000000002,698.60000000000002,613,849.29999999999995,605.29999999999995,698.60000000000002,723.10000000000002,811.20000000000005,376.60000000000002,672.60000000000002,768.39999999999998,715.10000000000002,738.10000000000002,855.29999999999995,672.60000000000002,41.600000000000001,368.30000000000001,855.29999999999995,100.7,664.5,28.300000000000001,844,613,690,649.89999999999998,730.60000000000002,803.29999999999995,753.79999999999995,567.20000000000005,753.79999999999995,635.89999999999998,715.10000000000002,819.10000000000002,715.10000000000002,715.10000000000002,825.10000000000002,16.199999999999999,16.199999999999999,15.300000000000001,36.899999999999999,41.100000000000001,43.5,25.600000000000001,25.600000000000001,73.700000000000003,229,252.59999999999999,316.69999999999999,350.19999999999999,395,423.39999999999998,423.39999999999998,431.60000000000002,560,560,587.10000000000002,587.10000000000002,587.10000000000002,596.29999999999995,605.79999999999995,605.79999999999995,605.79999999999995,605.79999999999995,605.79999999999995,624.10000000000002,633.60000000000002,633.60000000000002,643,661.79999999999995,661.79999999999995,671.20000000000005,671.20000000000005,671.20000000000005,671.20000000000005,671.20000000000005,671.20000000000005,689.10000000000002,689.10000000000002,744.39999999999998,752.60000000000002,752.60000000000002,752.60000000000002,752.60000000000002,752.60000000000002,665.60000000000002,665.60000000000002,665.60000000000002,665.60000000000002,614.70000000000005,106.7],"y":[8.1999999999999993,18,14.6,8.3000000000000007,11.4,22.199999999999999,24.100000000000001,8,13.1,22.800000000000001,17.800000000000001,19.300000000000001,17,21.300000000000001,26.399999999999999,22.899999999999999,15.1,16.699999999999999,15.9,9.3000000000000007,18.300000000000001,19.100000000000001,21,19.5,23.699999999999999,16.300000000000001,19,19.399999999999999,30.199999999999999,22.800000000000001,25.399999999999999,11.199999999999999,20.600000000000001,17.699999999999999,21.199999999999999,18.199999999999999,21.699999999999999,11.300000000000001,17.800000000000001,14.1,23.300000000000001,18.399999999999999,16.600000000000001,19.600000000000001,12.9,25.899999999999999,14.699999999999999,23,11.800000000000001,11,20.800000000000001,21.5,20.399999999999999,20.399999999999999,17.600000000000001,27.699999999999999,17.800000000000001,13.800000000000001,13.9,12.300000000000001,11.5,5.5,18.800000000000001,20.800000000000001,23.100000000000001,18.600000000000001,23,19.600000000000001,19.600000000000001,17.199999999999999,15.800000000000001,17.699999999999999,15.6,17.300000000000001,27.600000000000001,6.7000000000000002,15.699999999999999,8.3000000000000007,14.699999999999999,21.600000000000001,19.5,17.899999999999999,18.600000000000001,16.600000000000001,20.199999999999999,21.5,25.399999999999999,22.399999999999999,25.300000000000001,17.399999999999999,14.699999999999999,17.399999999999999,20.800000000000001,18.199999999999999,23.399999999999999,17.800000000000001,12.699999999999999,17.399999999999999,11.6,19.800000000000001,19.800000000000001,14.4,20.100000000000001,24.100000000000001,5.2999999999999998,12.699999999999999,18.199999999999999,21.399999999999999,20.300000000000001,17.399999999999999,13.699999999999999,18.800000000000001,22.800000000000001,18.899999999999999,15.800000000000001,15.5,11.6,15.199999999999999,10.6,19.600000000000001,10.300000000000001,17.100000000000001,22.5,17.899999999999999,19.800000000000001,20.600000000000001,9,17.199999999999999,15.9,15.4,15.4,14,10.6,17.600000000000001,14.9,17.600000000000001,17.199999999999999,15.6,18,21.699999999999999,21.899999999999999,23.300000000000001,21.199999999999999,16.600000000000001,23.800000000000001,27.399999999999999,13.199999999999999,24.199999999999999,17.399999999999999,23.699999999999999,23.199999999999999,24.800000000000001,24.600000000000001,20.100000000000001,29.600000000000001,16.399999999999999,28.600000000000001,18.399999999999999,20.5,19,16.100000000000001,20.300000000000001,15.199999999999999,17.800000000000001,17.800000000000001,5.2999999999999998,16.600000000000001,23.399999999999999,14.6,20.699999999999999,21.899999999999999,17.399999999999999,20.100000000000001,17.699999999999999,14.199999999999999,20.300000000000001,5.7999999999999998,19.199999999999999,18.300000000000001,14.4,23.899999999999999,19.100000000000001,12.4,16.800000000000001,20.800000000000001,17.600000000000001,11.5,21,13.300000000000001,11.5,11.699999999999999,24.199999999999999,24.600000000000001,24.300000000000001,24.600000000000001,23.5,5.7999999999999998,21.5,13.9,22.600000000000001,21.600000000000001,12.4,8.8000000000000007,20.199999999999999,15.1,22.100000000000001,22.899999999999999,20.699999999999999,19.600000000000001,23.199999999999999,18.399999999999999,5.0999999999999996,20.100000000000001,11,17,17,16.899999999999999,12.4,19.399999999999999,15.199999999999999,16.199999999999999,18.600000000000001,11,13.4,15.4,22.899999999999999,16.100000000000001,20.100000000000001,28.300000000000001,16.399999999999999,26.399999999999999,27.800000000000001,18.699999999999999,24.300000000000001,17.699999999999999,19.600000000000001,18.199999999999999,18.800000000000001,25.100000000000001,13.4,15.199999999999999,16.699999999999999,15.4,21.899999999999999,22.399999999999999,26.800000000000001,25.699999999999999,20.699999999999999,28.699999999999999,21.699999999999999,26.800000000000001,24,22.100000000000001,21.399999999999999,18.899999999999999,22.300000000000001,23.899999999999999,21.399999999999999,20.600000000000001,23.699999999999999,28.300000000000001,11.199999999999999,21.399999999999999,19.300000000000001,21.800000000000001,22.100000000000001,19.399999999999999,23.699999999999999,21,19.100000000000001,21.800000000000001,20.100000000000001,20.199999999999999,4.7999999999999998,5.0999999999999996,5.0999999999999996,4.5999999999999996,4.5999999999999996,4.5999999999999996,4.5999999999999996,2.2000000000000002,5.0999999999999996,4.2000000000000002,8.8000000000000007,7.5,23.399999999999999,12.6,22.100000000000001,24.199999999999999,24.300000000000001,18.699999999999999,25.300000000000001,22.899999999999999,26.899999999999999,17.100000000000001,22.199999999999999,14.300000000000001,15.4,19.600000000000001,10.6,20.699999999999999,19.100000000000001,19.199999999999999,19.199999999999999,11.300000000000001,19,17.100000000000001,23.800000000000001,16,24.899999999999999,25.300000000000001,24.800000000000001,12.199999999999999,24.300000000000001,19.699999999999999,18.5,18.600000000000001,19.199999999999999,21.600000000000001,21.600000000000001,18.899999999999999,16.800000000000001,16.800000000000001,12.9,13.699999999999999,24.199999999999999,24.100000000000001,21.199999999999999,19.699999999999999,23.5,24.199999999999999,21.5,17.100000000000001,18.100000000000001,18,9.8000000000000007,19.300000000000001,23,22.699999999999999,20.399999999999999,19.300000000000001,15.699999999999999,20.600000000000001,15.9,12.199999999999999,16.800000000000001,21.300000000000001,10.1,17.399999999999999,12.800000000000001,10.1,15.4,20.600000000000001,19.800000000000001,18.699999999999999,20.800000000000001,20.800000000000001,15.9,19.699999999999999,21.100000000000001,18.399999999999999,17.300000000000001,15.199999999999999,15.9,21.100000000000001,19.600000000000001,15.9,16.399999999999999,16.800000000000001,13.800000000000001,13.800000000000001,14.199999999999999,10.4,20.300000000000001,10.300000000000001,15.4,21.100000000000001,21.899999999999999,8.6999999999999993,5.2000000000000002,19.300000000000001,16.199999999999999,28.199999999999999,20.5,21.300000000000001,20.899999999999999,20.600000000000001,11.6,23.300000000000001,23.300000000000001,7.5,20.699999999999999,21.899999999999999,15.199999999999999,5.2999999999999998,10.1,20.399999999999999,24.300000000000001,25.899999999999999,28,28,22.800000000000001,25,21.300000000000001,21.800000000000001,27.899999999999999,17,14.199999999999999,19.899999999999999,23.399999999999999,14.699999999999999,8.1999999999999993,22.800000000000001,26.399999999999999,24.100000000000001,27.5,26.300000000000001,13.800000000000001,24.899999999999999,24.800000000000001,26.199999999999999,30.800000000000001,29.300000000000001,22.300000000000001,26.899999999999999,20.399999999999999,20.399999999999999,27.899999999999999,26.199999999999999,24.600000000000001,19.399999999999999,23.300000000000001,23.899999999999999,20.899999999999999,22.199999999999999,23.800000000000001,26.800000000000001,14.199999999999999,23.600000000000001,19.100000000000001,16.199999999999999,25.5,10.9,14.800000000000001,16.199999999999999,17.300000000000001,19.100000000000001,8.9000000000000004,10.5,19.300000000000001,23.399999999999999,11.800000000000001,17.699999999999999,17.399999999999999,16.800000000000001,17.899999999999999,16.600000000000001,19.899999999999999,18.899999999999999,15.5,18.899999999999999,18.899999999999999,14.5,4.5999999999999996,5.0999999999999996,4.5999999999999996,10.199999999999999,11.199999999999999,13.300000000000001,13.699999999999999,17.600000000000001,18,14.300000000000001,24.5,26.399999999999999,22.699999999999999,27.199999999999999,26.100000000000001,18.199999999999999,22.600000000000001,30.199999999999999,30.199999999999999,23.399999999999999,31,33.100000000000001,30.600000000000001,24.100000000000001,26.399999999999999,19.399999999999999,20.600000000000001,28.699999999999999,32.399999999999999,32.399999999999999,27.5,30.800000000000001,23.899999999999999,32.600000000000001,32.299999999999997,33.299999999999997,27.300000000000001,21.600000000000001,21.600000000000001,20.699999999999999,29.199999999999999,28.899999999999999,26.699999999999999,18.5,25.899999999999999,25.899999999999999,21.100000000000001,18.199999999999999,27.800000000000001,27.800000000000001,21.899999999999999,21.199999999999999,25.600000000000001,11.800000000000001],"z":[51,33,33,97,99,29,27,86,63,40,51,38,72,42,21,44,27,47,35,44,40,38,44,43,32,60,34,48,24,39,24,78,37,39,32,62,24,60,27,43,37,42,54,48,74,24,70,36,35,46,17,34,42,42,45,24,63,50,40,51,39,59,35,33,31,44,37,33,33,26,27,37,25,43,30,79,43,72,66,19,39,44,51,47,45,15,27,34,36,25,59,24,32,43,22,64,48,24,87,39,39,66,40,29,78,52,29,33,45,56,43,18,39,35,27,27,30,27,30,36,74,43,42,45,50,24,49,43,46,35,40,39,46,42,38,52,58,66,42,38,39,31,51,53,32,22,40,28,43,25,39,29,43,47,27,47,27,45,35,34,29,41,31,56,67,70,47,33,26,45,35,50,39,39,53,39,54,44,45,66,32,32,53,45,34,46,39,42,42,60,33,28,22,25,22,36,54,15,59,38,33,54,68,37,64,34,31,37,33,26,25,96,47,46,27,27,60,73,19,27,59,49,46,79,57,39,44,34,26,43,21,27,43,36,25,41,46,40,27,75,51,20,66,73,54,38,39,70,28,40,25,36,37,38,41,46,41,44,59,40,32,84,42,39,53,54,55,24,32,53,56,58,47,57,61,61,21,21,21,21,59,24,51,35,46,40,90,49,32,30,53,39,40,28,67,48,46,45,43,90,25,39,38,38,94,52,53,35,45,27,27,28,78,27,41,30,24,24,27,28,34,28,28,39,56,27,27,32,35,27,27,28,41,54,51,86,44,34,35,41,44,51,37,51,66,43,35,75,57,64,75,53,43,47,50,35,35,55,39,39,42,45,64,53,35,45,38,27,47,77,77,58,75,42,78,57,54,42,51,100,39,63,29,58,44,50,55,48,34,34,71,46,43,19,68,62,55,33,32,34,34,46,36,41,34,27,67,46,44,31,42,53,27,33,50,27,39,24,42,36,36,19,27,48,31,56,56,33,34,44,45,40,38,66,45,51,35,73,53,46,58,29,64,78,58,80,70,35,77,61,49,88,65,54,56,48,59,50,64,72,64,64,76,82,77,59,45,41,27,33,27,40,79,50,35,40,28,45,82,57,25,22,40,27,25,28,43,34,71,58,33,21,27,29,30,42,26,27,26,63,65,65,69,30,29,35,73,41,41,71,62,35,32,71,70,42,31],"type":"scatter3d","mode":"markers","marker":{"color":"rgba(31,119,180,1)","size":[55,55,55,55,55,55,55,55,55,55,55,55,55,55,55,55,55,55,55,55,55,55,55,55,55,55,55,55,55,55,55,55,55,55,55,55,55,55,55,55,55,55,55,55,55,55,55,55,55,55,55,55,55,55,55,55,55,55,55,55,55,55,55,55,55,55,55,55,55,55,55,55,55,55,55,55,55,55,55,55,55,55,55,55,55,55,55,55,55,55,55,55,55,55,55,55,55,55,55,55,55,55,55,55,55,55,55,55,55,55,55,55,55,55,55,55,55,55,55,55,55,55,55,55,55,55,55,55,55,55,55,55,55,55,55,55,55,55,55,55,55,55,55,55,55,55,55,55,55,55,55,55,55,55,55,55,55,55,55,55,55,55,55,55,55,55,55,55,55,55,55,55,55,55,55,55,55,55,55,55,55,55,55,55,55,55,55,55,55,55,55,55,55,55,55,55,55,55,55,55,55,55,55,55,55,55,55,55,55,55,55,55,55,55,55,55,55,55,55,55,55,55,55,55,55,55,55,55,55,55,55,55,55,55,55,55,55,55,55,55,55,55,55,55,55,55,55,55,55,55,55,55,55,55,55,55,55,55,55,55,55,55,55,55,55,55,55,55,55,55,55,55,55,55,55,55,55,55,55,55,55,55,55,55,55,55,55,55,55,55,55,55,55,55,55,55,55,55,55,55,55,55,55,55,55,55,55,55,55,55,55,55,55,55,55,55,55,55,55,55,55,55,55,55,55,55,55,55,55,55,55,55,55,55,55,55,55,55,55,55,55,55,55,55,55,55,55,55,55,55,55,55,55,55,55,55,55,55,55,55,55,55,55,55,55,55,55,55,55,55,55,55,55,55,55,55,55,55,55,55,55,55,55,55,55,55,55,55,55,55,55,55,55,55,55,55,55,55,55,55,55,55,55,55,55,55,55,55,55,55,55,55,55,55,55,55,55,55,55,55,55,55,55,55,55,55,55,55,55,55,55,55,55,55,55,55,55,55,55,55,55,55,55,55,55,55,55,55,55,55,55,55,55,55,55,55,55,55,55,55,55,55,55,55,55,55,55,55,55,55,55,55,55,55,55,55,55,55,55,55,55,55,55,55,55,55,55,55,55,55,55,55,55,55,55,55,55,55,55,55,55,55,55,55,55,55,55,55,55,55,55,55,55,55,55,55,55],"sizemode":"area","line":{"color":"rgba(31,119,180,1)"}},"textfont":{"size":55},"error_y":{"color":"rgba(31,119,180,1)","width":55},"error_x":{"color":"rgba(31,119,180,1)","width":55},"line":{"color":"rgba(31,119,180,1)","width":55},"frame":null}],"highlight":{"on":"plotly_click","persistent":false,"dynamic":false,"selectize":false,"opacityDim":0.20000000000000001,"selected":{"opacity":1},"debounce":0},"shinyEvents":["plotly_hover","plotly_click","plotly_selected","plotly_relayout","plotly_brushed","plotly_brushing","plotly_clickannotation","plotly_doubleclick","plotly_deselect","plotly_afterplot","plotly_sunburstclick"],"base_url":"https://plot.ly"},"evals":[],"jsHooks":[]}</script>
</div>
</div>
</section>
<section id="cas-general" class="level2" data-number="2.3">
<h2 data-number="2.3" class="anchored" data-anchor-id="cas-general"><span class="header-section-number">2.3</span> Cas general</h2>
<div class="cell">
<div class="sourceCode cell-code" id="cb25"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb25-1"><a href="#cb25-1" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(mvoutlier)</span>
<span id="cb25-2"><a href="#cb25-2" aria-hidden="true" tabindex="-1"></a>dades2 <span class="ot">&lt;-</span> dades; Y <span class="ot">&lt;-</span> <span class="fu">as.matrix</span>(dades2)</span>
<span id="cb25-3"><a href="#cb25-3" aria-hidden="true" tabindex="-1"></a>distances <span class="ot">&lt;-</span> <span class="fu">dd.plot</span>(Y,<span class="at">quan=</span><span class="dv">1</span><span class="sc">/</span><span class="dv">2</span>, <span class="at">alpha=</span><span class="fl">0.025</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<div>
<figure class="figure">
<p><img src="AdvancedPreprocessing_files/figure-html/deteccio_outliers-1.png" class="img-fluid figure-img" width="672"></p>
</figure>
</div>
</div>
<div class="sourceCode cell-code" id="cb26"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb26-1"><a href="#cb26-1" aria-hidden="true" tabindex="-1"></a>distances<span class="sc">$</span>md.cla</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>  [1] 2.1512048 1.3379825 2.1172116 3.8246066 4.1575569 1.0214128 1.2694422
  [8] 2.7595383 1.6355391 0.7435067 0.8384635 0.9832367 1.8368465 0.5815850
 [15] 1.5811197 0.8448810 2.2378066 0.8891432 2.0349346 2.1415420 0.9637216
 [22] 1.0652484 2.0207355 0.1516285 0.9211263 0.9991636 1.0865045 0.6181512
 [29] 1.9793545 0.8189627 1.3860142 2.3444645 0.8378744 1.2409837 1.1152316
 [36] 1.3406612 1.4257126 1.8975023 1.8395299 1.9442325 1.5246648 0.5432011
 [43] 0.8329662 0.6613403 2.1071830 1.4175912 1.7140652 1.1449734 2.2130392
 [50] 1.9026888 2.1219783 0.7044810 0.4459360 0.4459360 0.7512874 1.6047252
 [57] 1.3885461 1.5468641 2.1002115 2.0633162 2.0167931 2.4299533 0.7010824
 [64] 0.8008038 0.9015124 0.6025597 0.7374479 1.0558439 1.0558439 2.2428749
 [71] 2.1585402 1.2384809 2.3062269 0.6858624 1.5046259 2.9334983 2.1118951
 [78] 2.4255957 1.3308234 1.6266383 0.4465482 0.5872994 0.5867873 0.8654335
 [85] 0.4631097 2.1760160 1.2790069 0.8809271 1.1237454 2.2646990 1.1262982
 [92] 2.2986587 0.8051529 0.4352584 1.4074557 1.3971864 2.0931182 2.5313223
 [99] 2.6371026 0.4134452 0.4134452 1.4052058 0.4979006 1.0797643 2.9624567
[106] 2.0237801 2.2067698 0.7659111 0.6120329 1.0306586 1.9840817 2.5398227
[113] 0.7583594 1.2612702 2.2550289 2.2630901 2.3986605 2.2333581 2.5154080
[120] 0.6164195 2.0776908 0.7059860 0.6907049 0.7447968 0.6961495 1.6092699
[127] 2.0621329 1.2085780 1.1273125 1.8393167 1.8994420 1.9919912 1.9422520
[134] 0.9727646 1.9913779 0.5248409 1.0284115 1.4808298 1.0140768 0.6869463
[141] 0.6472623 1.0173741 1.0022887 1.2393227 1.0774778 1.7008576 1.9173406
[148] 1.1253466 0.8016034 1.2873884 1.2708888 1.7937650 1.7535716 0.6123247
[155] 1.8615127 0.8772978 1.6878607 0.5740120 0.7635284 1.0865045 2.1190046
[162] 0.2598342 2.0279375 0.9019672 1.5828523 2.6275057 0.8654335 0.8812522
[169] 2.2615419 0.4126382 0.8242294 0.5192159 0.3914657 1.1041732 1.1545360
[176] 0.4488220 2.5007877 0.3735133 0.9842039 1.4052058 0.9619567 1.1900212
[183] 2.0712298 1.0688091 0.6509067 0.8710078 2.0167931 0.5721858 1.8734132
[190] 2.0455397 2.2223974 1.1169353 1.4160636 1.3115436 1.4160636 0.8402910
[197] 2.5007877 2.1760160 1.4576505 0.6739897 0.9174610 1.9459779 2.4916974
[204] 0.7477589 2.4314093 0.8863790 0.8707309 0.7715035 1.0558439 1.2380805
[211] 1.8688756 3.4063203 0.6123247 1.9026888 2.1987798 2.1987798 1.1310435
[218] 2.0474931 2.1657213 2.2160825 1.0026014 0.8037506 1.9026888 2.4507631
[225] 1.3683752 0.8261645 1.2511671 0.6967559 1.6506914 0.5608519 1.5811197
[232] 1.5634876 0.7688811 0.9334464 1.9579191 0.3124014 0.6834758 0.8748825
[239] 1.2285607 3.1928408 2.1998017 2.4581678 1.3489065 2.4697383 1.2347779
[246] 1.4312779 1.2250285 2.3230787 1.7396325 0.5648614 1.4690388 0.8842203
[253] 0.6571482 0.4842651 0.4929435 0.7917183 1.0180851 0.5284808 1.2853576
[260] 0.8651401 1.9285065 2.4490604 0.4759367 0.5746102 1.0670200 1.3483202
[267] 0.8323413 1.3050887 0.9206251 0.7215715 1.2665824 1.1392373 0.5009500
[274] 2.5915741 2.4562117 2.4533198 4.3204916 4.3204916 4.3204916 4.3204916
[281] 3.1279535 4.0240805 2.9005429 2.6536444 2.4875865 1.4261032 2.9289704
[288] 1.2602955 1.2582225 1.2913573 0.8064294 1.5973586 1.1013307 1.9199488
[295] 1.6791747 1.3933199 1.0945785 1.0435959 0.9079748 3.1489768 1.6067994
[302] 1.1813530 1.4983957 1.4983957 3.7793529 0.8403912 1.0098248 0.9263502
[309] 1.5109206 1.3378955 1.3510446 1.2935832 2.2628304 1.3807921 1.0992508
[316] 2.0043758 2.0723786 1.9693414 1.5822400 1.5224026 1.5667415 2.3115444
[323] 2.3115444 2.7030650 1.6165510 1.3156217 1.3162506 1.2162273 1.2460084
[330] 1.3295084 1.3156217 1.5777655 1.6136293 0.9647550 1.1032109 2.9002933
[337] 1.0052333 1.0565707 1.0247083 0.9592401 1.0052333 1.4799833 1.2766433
[344] 1.6119247 2.2102537 1.6489460 1.2846146 2.4626101 1.1856617 1.8722498
[351] 2.4626101 1.4018743 0.8164050 0.8427082 0.9426092 1.0749215 1.0749215
[358] 1.5076101 1.2309112 1.0752235 1.3174101 1.4108121 1.5390601 1.4262600
[365] 1.1474900 0.9851802 2.0608206 2.5616952 1.2350960 2.3991992 2.3991992
[372] 0.9636042 2.2156559 0.6405978 2.8472072 1.4027365 1.0146283 0.7065577
[379] 2.2524889 3.6873905 0.5056023 1.2273610 1.6242278 1.2826760 1.1054025
[386] 0.7217604 1.1213620 2.1008998 0.9016456 0.9016456 2.5306142 0.7783752
[393] 1.1204441 2.7312638 2.6070900 2.2217968 1.1074819 0.9756355 1.2224428
[400] 2.7386289 2.7386289 0.9215108 1.0612070 0.4646294 0.9617825 1.5893047
[407] 1.9402502 2.0059941 1.3786885 1.2066435 2.0204233 2.2514669 1.2539158
[414] 1.2942327 1.3207677 1.5193393 1.5408538 2.5836481 1.1581001 1.0629563
[421] 1.3292082 2.1547964 1.8064456 0.9532013 1.3835120 1.1658931 1.1658931
[428] 1.6023373 1.2601133 1.2353069 1.3882029 0.8093320 0.8875183 1.8162538
[435] 1.0718102 2.1192709 1.3990278 2.0596422 1.3930155 0.8712025 1.7654778
[442] 1.2064497 2.3516796 2.3766534 1.7654778 3.6831554 1.8781162 2.6231962
[449] 2.7624742 1.2571769 1.1315694 2.7292269 1.4988128 1.3645685 1.2487224
[456] 0.2760227 1.3354776 0.5711344 1.4684949 2.0850998 1.4684949 1.4684949
[463] 2.3204115 3.1150249 2.9179968 2.6863547 2.1762693 2.1608622 2.4512056
[470] 2.2700598 2.4203373 2.1340683 2.7610866 2.7243416 2.3384447 1.5379530
[477] 2.1017212 2.1939930 2.9836682 1.9994740 2.2210057 2.2179387 0.8614322
[484] 2.3467527 2.7820672 2.2514710 1.0877247 1.3927841 2.0228082 1.2372504
[491] 1.8863196 2.5240480 2.5562991 1.5504217 2.2311298 0.9425752 2.5338080
[498] 2.4657745 2.6692880 2.8486431 1.8598956 1.8598956 2.0117051 1.8215322
[505] 1.7567235 1.3587946 2.0685362 1.3162443 1.3162443 2.1979471 1.3911676
[512] 1.6202613 1.5794635 2.3509350 2.1643692 1.3910454 2.2803773</code></pre>
</div>
<div class="sourceCode cell-code" id="cb28"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb28-1"><a href="#cb28-1" aria-hidden="true" tabindex="-1"></a>distances<span class="sc">$</span>md.rob</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>  [1] 8.2157063 1.6301206 2.5927006 8.7074405 8.4305593 2.4131242 2.2677777
  [8] 3.5465258 1.7618316 0.5640203 0.7009379 0.8879920 2.2292868 0.1551463
 [15] 1.6122568 0.8823011 7.8819613 1.0741592 7.6935630 8.1537779 0.9463274
 [22] 0.9930106 5.6883551 1.7830105 1.1389196 1.7054315 1.2689717 0.3929892
 [29] 2.2821365 0.8087114 1.3567522 2.5487554 0.6616880 1.2461023 1.0917446
 [36] 1.5038041 1.5930573 2.1694506 2.2059985 7.8152918 3.6288603 1.0804302
 [43] 1.1331551 0.4178624 2.2342008 1.3909220 1.9335813 2.7410709 8.3315088
 [50] 7.7723462 2.4649409 0.8600525 0.3581614 0.3581614 0.9090681 1.6896377
 [57] 1.5454964 1.7296222 8.2698337 8.2217135 7.8649425 8.4360084 2.8650931
 [64] 1.0618142 0.8732263 0.6670303 0.4821334 1.2010922 1.2010922 7.6603786
 [71] 7.5939776 1.3602058 7.9060422 1.3889142 1.6766843 9.0342033 7.9236794
 [78] 7.9552566 2.6860109 2.4573528 1.1848045 1.0624264 0.7875436 1.1490070
 [85] 0.3059888 2.5202367 1.2684147 0.7229385 1.3017097 7.6246013 1.6925358
 [92] 7.6522631 2.4586887 1.2914784 1.5606376 1.5774550 8.3501267 8.3858393
 [99] 3.4202364 1.1279366 1.1279366 2.0225251 0.5860946 0.9498146 9.3747753
[106] 8.0042550 7.5080277 0.9509607 0.2662519 0.9717070 7.9816607 7.6885325
[113] 0.5881634 1.2813352 7.9291458 7.9707388 8.3405097 7.8674589 8.4531841
[120] 2.7190157 2.8323876 1.4897117 0.4801052 0.7783254 0.5601142 1.8191839
[127] 8.0224812 1.1488887 1.3199856 2.1943586 7.4800868 7.9251227 7.8497015
[134] 1.0134693 7.7967344 1.3976338 1.1000734 1.6510473 4.5524693 0.3744225
[141] 0.2942177 1.9978997 1.9915017 4.8510143 1.9650389 1.7813716 7.7651241
[148] 1.0128859 1.1389993 1.2677583 2.8594690 3.7699709 3.0964572 0.3419226
[155] 2.1672916 1.2420105 1.9283729 0.7278137 0.8383210 1.2689717 7.6229208
[162] 1.2436442 7.5391699 0.9694854 1.8389077 8.8702041 1.1490070 1.3377451
[169] 7.8021768 1.2243510 0.6254693 1.2536495 1.0758740 1.2006624 1.7968090
[176] 0.8097497 8.9738594 0.7656994 0.8372706 2.0225251 0.7872045 1.4281055
[183] 8.1349516 1.0719965 1.3511167 0.7897428 7.8649425 0.1006548 7.6830528
[190] 7.7041955 8.0468280 1.4253214 1.4455696 1.2942278 1.4455696 1.1315623
[197] 8.9738594 2.5202367 1.5507476 0.3998531 0.7934616 7.7225329 8.6898201
[204] 0.6729101 7.3401343 0.7313357 1.2005866 0.5753968 1.2010922 1.2191654
[211] 2.2341036 4.3439349 0.3419226 7.7723462 7.6226334 7.6226334 1.2376389
[218] 2.1997155 2.5641247 7.8035716 1.4484463 0.5987993 7.7723462 5.4377862
[225] 1.2912976 0.8264241 1.3381767 2.5574766 1.9021290 2.8662752 1.6122568
[232] 1.7948921 0.6174913 0.7730502 2.4187140 1.0869098 0.6461858 0.8002264
[239] 1.1237513 8.6804322 7.9203264 7.8232250 2.1318851 3.1432113 1.4900889
[246] 1.6284259 1.3516616 3.3785762 1.7661100 0.2235938 1.3926630 0.6973112
[253] 0.3886249 1.3555949 1.0294052 0.7528347 1.3244015 1.1808389 1.5292418
[260] 0.7777983 2.1524233 3.4065074 1.2438199 0.9814537 1.2219665 2.0478026
[267] 1.3464787 1.3297142 0.9883371 0.8295569 1.5217910 1.3754096 0.4405954
[274] 6.1191808 5.9436337 5.9674829 7.9240497 7.9240497 7.9240497 7.9240497
[281] 6.6707462 7.6051455 6.4542151 9.3221740 9.2822318 3.1220294 4.7475686
[288] 2.5612214 2.3893762 2.4146280 2.6506927 2.5009851 2.4807670 2.9676485
[295] 3.5326586 3.0298057 5.2123227 5.0776808 3.6566395 6.7286092 4.7921000
[302] 4.6577486 5.4328510 5.4328510 8.1145477 0.7352526 0.8870954 0.8683079
[309] 1.4948587 1.5921329 1.6257463 1.5461321 2.4944242 1.7285717 1.2036855
[316] 2.3519796 2.3716572 2.2385864 1.8657511 1.7978546 1.7387780 2.6272422
[323] 2.6272422 2.9709197 1.6027909 1.4991915 1.4963063 1.2920596 1.2827263
[330] 1.4920590 1.4991915 1.9104816 1.7320072 0.8777790 1.0878941 3.0972045
[337] 1.0095365 1.2710524 1.2243430 1.0216210 1.0095365 1.4306690 1.6256760
[344] 1.6944177 2.2387272 1.7907724 1.6777179 2.5400737 1.1772680 1.8565204
[351] 2.5400737 1.3144652 0.7736309 0.7922019 0.8656220 1.0775349 1.0775349
[358] 1.5327420 1.4134151 1.3608060 1.4303565 1.4745843 1.5632731 1.3756478
[365] 1.2928977 1.0560837 2.2734361 2.9506793 1.1408481 2.7494115 2.7494115
[372] 2.6585856 2.5915964 0.2859186 3.0384855 1.3264608 1.1576615 0.5548502
[379] 8.8379406 8.0047752 2.7728449 1.5869296 1.7102709 1.6361218 1.6955705
[386] 1.0860546 1.3977195 8.4811265 0.7680764 0.7680764 8.5500507 0.7492957
[393] 1.8107260 8.7268752 8.9704335 8.2617904 1.3615027 0.9947617 1.3039687
[400] 4.5322201 4.5322201 1.1056697 1.0836389 0.4212128 0.8857965 1.6000059
[407] 2.6049474 7.9135709 2.0553305 2.6971923 7.9288514 8.7374402 2.9247081
[414] 1.4293907 1.6915854 1.5751506 1.7459313 8.7440972 1.1963003 1.0766232
[421] 1.3067784 2.2908143 2.6026554 1.2100382 1.5260517 1.4601269 1.4601269
[428] 1.6726862 1.3123943 1.3896346 1.9752446 0.9759090 0.7983458 2.3001027
[435] 1.7262508 3.8221951 1.4273152 2.2326354 1.7639182 0.7243175 2.1746276
[442] 1.0879861 8.3518095 4.7687156 2.1746276 7.7082555 2.3184326 9.2029703
[449] 2.9222732 1.7396517 1.3004394 3.2912419 1.7013126 1.5480203 1.2065761
[456] 1.6118910 1.3402572 0.8055922 1.7284307 2.4764389 1.7284307 1.7284307
[463] 2.7157733 9.4021626 9.3190081 9.5136889 8.6514786 8.5380896 8.5611742
[470] 8.5336824 8.1756216 7.3768976 6.2780301 5.2036864 4.2458609 3.8429164
[477] 3.3654341 3.3213773 4.6178209 3.4097509 2.2935763 2.2743959 1.1648570
[484] 2.4055707 2.8867780 2.3051858 1.2552220 1.4103238 2.6423464 1.7033756
[491] 1.9444397 2.5749001 2.7090937 1.4875413 2.3631233 0.8971715 2.7553091
[498] 2.7178706 2.9674546 3.5872517 2.3123520 2.3123520 2.5043740 1.9885769
[505] 1.8866382 1.7367897 2.5726948 1.8058369 1.8058369 2.8863013 1.6014070
[512] 1.7055864 1.6057526 2.9520098 2.7068229 1.5144614 7.9984070</code></pre>
</div>
<div class="sourceCode cell-code" id="cb30"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb30-1"><a href="#cb30-1" aria-hidden="true" tabindex="-1"></a>res <span class="ot">&lt;-</span> <span class="fu">aq.plot</span>(Y,<span class="at">delta=</span><span class="fu">qchisq</span>(<span class="fl">0.975</span>,<span class="at">df=</span><span class="fu">ncol</span>(Y)),<span class="at">quan=</span><span class="dv">1</span><span class="sc">/</span><span class="dv">2</span>,<span class="at">alpha=</span><span class="fl">0.05</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>Projection to the first and second robust principal components.
Proportion of total variation (explained variance): 0.9692463</code></pre>
</div>
<div class="cell-output-display">
<div>
<figure class="figure">
<p><img src="AdvancedPreprocessing_files/figure-html/deteccio_outliers-2.png" class="img-fluid figure-img" width="672"></p>
</figure>
</div>
</div>
<div class="sourceCode cell-code" id="cb32"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb32-1"><a href="#cb32-1" aria-hidden="true" tabindex="-1"></a><span class="fu">str</span>(res)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>List of 1
 $ outliers: logi [1:517] TRUE FALSE FALSE TRUE TRUE FALSE ...</code></pre>
</div>
<div class="sourceCode cell-code" id="cb34"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb34-1"><a href="#cb34-1" aria-hidden="true" tabindex="-1"></a>res<span class="sc">$</span>outliers</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>  [1]  TRUE FALSE FALSE  TRUE  TRUE FALSE FALSE  TRUE FALSE FALSE FALSE FALSE
 [13] FALSE FALSE FALSE FALSE  TRUE FALSE  TRUE  TRUE FALSE FALSE  TRUE FALSE
 [25] FALSE FALSE FALSE FALSE FALSE FALSE FALSE FALSE FALSE FALSE FALSE FALSE
 [37] FALSE FALSE FALSE  TRUE  TRUE FALSE FALSE FALSE FALSE FALSE FALSE FALSE
 [49]  TRUE  TRUE FALSE FALSE FALSE FALSE FALSE FALSE FALSE FALSE  TRUE  TRUE
 [61]  TRUE  TRUE FALSE FALSE FALSE FALSE FALSE FALSE FALSE  TRUE  TRUE FALSE
 [73]  TRUE FALSE FALSE  TRUE  TRUE  TRUE FALSE FALSE FALSE FALSE FALSE FALSE
 [85] FALSE FALSE FALSE FALSE FALSE  TRUE FALSE  TRUE FALSE FALSE FALSE FALSE
 [97]  TRUE  TRUE  TRUE FALSE FALSE FALSE FALSE FALSE  TRUE  TRUE  TRUE FALSE
[109] FALSE FALSE  TRUE  TRUE FALSE FALSE  TRUE  TRUE  TRUE  TRUE  TRUE FALSE
[121] FALSE FALSE FALSE FALSE FALSE FALSE  TRUE FALSE FALSE FALSE  TRUE  TRUE
[133]  TRUE FALSE  TRUE FALSE FALSE FALSE  TRUE FALSE FALSE FALSE FALSE  TRUE
[145] FALSE FALSE  TRUE FALSE FALSE FALSE FALSE  TRUE FALSE FALSE FALSE FALSE
[157] FALSE FALSE FALSE FALSE  TRUE FALSE  TRUE FALSE FALSE  TRUE FALSE FALSE
[169]  TRUE FALSE FALSE FALSE FALSE FALSE FALSE FALSE  TRUE FALSE FALSE FALSE
[181] FALSE FALSE  TRUE FALSE FALSE FALSE  TRUE FALSE  TRUE  TRUE  TRUE FALSE
[193] FALSE FALSE FALSE FALSE  TRUE FALSE FALSE FALSE FALSE  TRUE  TRUE FALSE
[205]  TRUE FALSE FALSE FALSE FALSE FALSE FALSE  TRUE FALSE  TRUE  TRUE  TRUE
[217] FALSE FALSE FALSE  TRUE FALSE FALSE  TRUE  TRUE FALSE FALSE FALSE FALSE
[229] FALSE FALSE FALSE FALSE FALSE FALSE FALSE FALSE FALSE FALSE FALSE  TRUE
[241]  TRUE  TRUE FALSE FALSE FALSE FALSE FALSE FALSE FALSE FALSE FALSE FALSE
[253] FALSE FALSE FALSE FALSE FALSE FALSE FALSE FALSE FALSE  TRUE FALSE FALSE
[265] FALSE FALSE FALSE FALSE FALSE FALSE FALSE FALSE FALSE  TRUE  TRUE  TRUE
[277]  TRUE  TRUE  TRUE  TRUE  TRUE  TRUE  TRUE  TRUE  TRUE FALSE  TRUE FALSE
[289] FALSE FALSE FALSE FALSE FALSE FALSE  TRUE FALSE  TRUE  TRUE  TRUE  TRUE
[301]  TRUE  TRUE  TRUE  TRUE  TRUE FALSE FALSE FALSE FALSE FALSE FALSE FALSE
[313] FALSE FALSE FALSE FALSE FALSE FALSE FALSE FALSE FALSE FALSE FALSE FALSE
[325] FALSE FALSE FALSE FALSE FALSE FALSE FALSE FALSE FALSE FALSE FALSE FALSE
[337] FALSE FALSE FALSE FALSE FALSE FALSE FALSE FALSE FALSE FALSE FALSE FALSE
[349] FALSE FALSE FALSE FALSE FALSE FALSE FALSE FALSE FALSE FALSE FALSE FALSE
[361] FALSE FALSE FALSE FALSE FALSE FALSE FALSE FALSE FALSE FALSE FALSE FALSE
[373] FALSE FALSE FALSE FALSE FALSE FALSE  TRUE  TRUE FALSE FALSE FALSE FALSE
[385] FALSE FALSE FALSE  TRUE FALSE FALSE  TRUE FALSE FALSE  TRUE  TRUE  TRUE
[397] FALSE FALSE FALSE  TRUE  TRUE FALSE FALSE FALSE FALSE FALSE FALSE  TRUE
[409] FALSE FALSE  TRUE  TRUE FALSE FALSE FALSE FALSE FALSE  TRUE FALSE FALSE
[421] FALSE FALSE FALSE FALSE FALSE FALSE FALSE FALSE FALSE FALSE FALSE FALSE
[433] FALSE FALSE FALSE  TRUE FALSE FALSE FALSE FALSE FALSE FALSE  TRUE  TRUE
[445] FALSE  TRUE FALSE  TRUE FALSE FALSE FALSE FALSE FALSE FALSE FALSE FALSE
[457] FALSE FALSE FALSE FALSE FALSE FALSE FALSE  TRUE  TRUE  TRUE  TRUE  TRUE
[469]  TRUE  TRUE  TRUE  TRUE  TRUE  TRUE  TRUE  TRUE FALSE FALSE  TRUE  TRUE
[481] FALSE FALSE FALSE FALSE FALSE FALSE FALSE FALSE FALSE FALSE FALSE FALSE
[493] FALSE FALSE FALSE FALSE FALSE FALSE FALSE  TRUE FALSE FALSE FALSE FALSE
[505] FALSE FALSE FALSE FALSE FALSE FALSE FALSE FALSE FALSE FALSE FALSE FALSE
[517]  TRUE</code></pre>
</div>
<div class="sourceCode cell-code" id="cb36"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb36-1"><a href="#cb36-1" aria-hidden="true" tabindex="-1"></a><span class="fu">table</span>(res<span class="sc">$</span>outliers)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>
FALSE  TRUE 
  388   129 </code></pre>
</div>
<div class="sourceCode cell-code" id="cb38"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb38-1"><a href="#cb38-1" aria-hidden="true" tabindex="-1"></a><span class="co">#windows()</span></span>
<span id="cb38-2"><a href="#cb38-2" aria-hidden="true" tabindex="-1"></a><span class="fu">par</span>(<span class="at">mfrow=</span><span class="fu">c</span>(<span class="dv">1</span>, <span class="dv">1</span>))</span>
<span id="cb38-3"><a href="#cb38-3" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(MVN)</span>
<span id="cb38-4"><a href="#cb38-4" aria-hidden="true" tabindex="-1"></a><span class="co"># mvnoutliers &lt;- mvn(dades, multivariateOutlierMethod = "adj", showOutliers = TRUE, </span></span>
<span id="cb38-5"><a href="#cb38-5" aria-hidden="true" tabindex="-1"></a><span class="co">#                   showNewData = TRUE)</span></span>
<span id="cb38-6"><a href="#cb38-6" aria-hidden="true" tabindex="-1"></a>mvnoutliers <span class="ot">&lt;-</span> <span class="fu">mvn</span>(<span class="at">data =</span> dades, <span class="at">mvn_test =</span> <span class="st">"royston"</span>, </span>
<span id="cb38-7"><a href="#cb38-7" aria-hidden="true" tabindex="-1"></a>                   <span class="at">univariate_test =</span> <span class="st">"AD"</span>, </span>
<span id="cb38-8"><a href="#cb38-8" aria-hidden="true" tabindex="-1"></a>              <span class="at">multivariate_outlier_method =</span> <span class="st">"adj"</span>,</span>
<span id="cb38-9"><a href="#cb38-9" aria-hidden="true" tabindex="-1"></a>              <span class="at">show_new_data =</span> <span class="cn">TRUE</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<p>Visualitzem tots els outliers detectats com a true</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb39"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb39-1"><a href="#cb39-1" aria-hidden="true" tabindex="-1"></a><span class="fu">summary</span>(mvnoutliers, <span class="at">select =</span> <span class="st">"outliers"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>    Observation Mahalanobis.Distance
1           466               95.620
2           464               92.910
3           105               92.347
4           284               91.668
5           465               91.312
6           285               90.872
7           448               89.349
8            76               85.582
9           177               85.110
10          197               85.110
11          395               84.820
12          166               82.912
13          379               82.172
14          412               80.371
15          418               80.180
16          394               79.742
17          203               79.121
18            4               79.053
19          467               78.658
20          240               78.246
21          469               76.910
22          391               76.746
23          468               76.551
24          470               76.236
25          119               75.377
26          388               75.344
27           62               75.271
28            5               73.796
29          117               73.244
30           98               73.243
31           49               72.952
32          443               72.902
33           97               72.889
34          396               71.492
35           59               71.469
36            1               71.192
37           60               70.684
38           20               70.109
39          471               69.553
40          183               69.161
41          305               68.417
42          191               68.156
43          127               67.840
44          277               67.386
45          278               67.386
46          279               67.386
47          280               67.386
48          517               67.373
49          380               67.118
50          106               66.945
51          111               66.582
52          116               66.430
53           78               66.389
54          115               65.699
55          132               65.676
56          411               65.587
57           73               65.387
58           77               65.351
59          408               65.339
60          241               65.243
61           61               65.055
62          187               65.055
63           17               65.028
64          133               64.804
65          118               64.776
66          242               63.968
67          169               63.822
68           40               63.798
69          220               63.737
70           50               63.488
71          214               63.488
72          223               63.488
73          135               63.471
74          147               63.165
75          202               62.350
76          190               62.077
77          282               62.062
78          189               61.798
79           19               61.726
80          112               61.540
81          446               61.359
82           70               61.172
83           92               61.051
84          161               60.679
85           90               60.596
86          215               60.585
87          216               60.585
88           71               60.301
89          163               59.452
90          107               58.594
91          131               58.351
92          472               56.439
93          205               55.917
94          281               47.755
95          300               47.138
96          283               44.684
97          473               40.862
98          274               40.080
99          276               38.049
100         275               37.750
101          23               33.308
102         224               30.706
103         303               30.572
104         304               30.572
105         297               28.501
106         474               27.684
107         298               26.969
108         144               24.440
109         301               23.821
110         444               23.544
111         287               23.359
112         302               22.481
113         479               21.975
114         139               21.533
115         400               20.893
116         401               20.893
117         212               19.743
118         475               18.348
119         476               15.110
120         436               14.908
121         152               14.508
122         299               13.807
123         500               13.600
124          41               13.455
125           8               13.137
126         295               12.864
127          99               12.083</code></pre>
</div>
</div>
<p>Visualitzem les variables originals quines han donat els que no son outliers</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb41"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb41-1"><a href="#cb41-1" aria-hidden="true" tabindex="-1"></a><span class="fu">summary</span>(mvnoutliers, <span class="at">select =</span> <span class="st">"new_data"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>       DC temp RH
2   669.1 18.0 33
3   686.9 14.6 33
6   488.0 22.2 29
7   495.6 24.1 27
9   692.6 13.1 63
10  698.6 22.8 40
11  698.6 17.8 51
12  713.0 19.3 38
13  665.3 17.0 72
14  686.5 21.3 42
15  699.6 26.4 21
16  713.9 22.9 44
18  664.2 16.7 47
21  692.6 18.3 40
22  724.3 19.1 38
24  537.4 19.5 43
25  594.2 23.7 32
26  601.4 16.3 60
27  668.0 19.0 34
28  686.5 19.4 48
29  721.4 30.2 24
30  728.6 22.8 39
31  692.3 25.4 24
32  709.9 11.2 78
33  706.8 20.6 37
34  718.3 17.7 39
35  724.3 21.2 32
36  730.2 18.2 62
37  669.1 21.7 24
38  682.6 11.3 60
39  686.9 17.8 27
42  624.2 18.4 42
43  647.1 16.6 54
44  698.6 19.6 48
45  735.7 12.9 74
46  692.3 25.9 24
47  686.5 14.7 70
48  442.9 23.0 36
51  706.4 20.8 17
52  631.2 21.5 34
53  654.1 20.4 42
54  654.1 20.4 42
55  661.3 17.6 45
56  706.4 27.7 24
57  730.2 17.8 63
58  691.8 13.8 50
63  466.6 18.8 35
64  631.2 20.8 33
65  638.8 23.1 31
66  661.3 18.6 44
67  668.0 23.0 37
68  668.0 19.6 33
69  668.0 19.6 33
72  692.3 17.7 37
74  614.5 17.3 43
75  713.9 27.6 30
79  529.8 14.7 66
80  561.6 21.6 19
81  601.4 19.5 39
82  631.2 17.9 44
83  647.1 18.6 51
84  654.1 16.6 47
85  661.3 20.2 45
86  706.4 21.5 15
87  706.4 25.4 27
88  706.4 22.4 34
89  728.6 25.3 36
91  624.2 14.7 59
93  488.0 20.8 32
94  601.4 18.2 43
95  638.8 23.4 22
96  704.4 17.8 64
100 601.4 19.8 39
101 601.4 19.8 39
102 614.5 14.4 66
103 647.1 20.1 40
104 674.4 24.1 29
108 631.2 21.4 33
109 698.6 20.3 45
110 709.9 17.4 56
113 704.4 22.8 39
114 724.3 18.9 35
120 466.6 19.6 36
121 608.2 10.3 74
122 608.2 17.1 43
123 680.7 22.5 42
124 671.9 17.9 45
125 692.3 19.8 50
126 691.8 20.6 24
128 728.6 17.2 43
129 673.8 15.9 46
130 691.8 15.4 35
134 685.2 17.6 42
136 594.2 17.6 52
137 680.7 17.2 58
138 686.5 15.6 66
140 692.6 21.7 38
141 686.5 21.9 39
142 513.3 23.3 31
143 529.8 21.2 51
145 513.3 23.8 32
146 578.8 27.4 22
148 671.9 24.2 28
149 647.1 17.4 43
150 685.2 23.7 25
151 433.3 23.2 39
153 424.1 24.6 43
154 692.3 20.1 47
155 721.4 29.6 27
156 647.1 16.4 47
157 721.4 28.6 27
158 654.1 18.4 45
159 654.1 20.5 35
160 668.0 19.0 34
162 578.8 20.3 41
164 674.4 17.8 56
165 704.4 17.8 67
167 654.1 16.6 47
168 570.5 23.4 33
170 578.8 20.7 45
171 699.6 21.9 35
172 609.6 17.4 50
173 601.4 20.1 39
174 686.5 17.7 39
175 624.2 14.2 53
176 624.2 20.3 39
178 631.2 19.2 44
179 735.7 18.3 45
180 614.5 14.4 66
181 680.7 23.9 32
182 664.2 19.1 32
184 696.1 16.8 45
185 586.7 20.8 34
186 692.6 17.6 46
188 686.5 21.0 42
192 578.8 24.2 28
193 647.1 24.6 22
194 699.6 24.3 25
195 647.1 24.6 22
196 586.7 23.5 36
198 706.4 21.5 15
199 692.6 13.9 59
200 665.3 22.6 38
201 692.6 21.6 33
204 673.8 20.2 37
206 706.4 22.1 34
207 594.2 22.9 31
208 692.6 20.7 37
209 668.0 19.6 33
210 685.2 23.2 26
211 686.9 18.4 25
213 692.3 20.1 47
217 680.7 16.9 60
218 709.9 12.4 73
219 699.6 19.4 19
221 631.2 16.2 59
222 713.9 18.6 49
225 735.7 15.4 57
226 728.6 22.9 39
227 696.1 16.1 44
228 480.8 20.1 34
229 728.6 28.3 26
230 480.8 16.4 43
231 699.6 26.4 21
232 728.6 27.8 27
233 692.6 18.7 43
234 671.9 24.3 36
235 674.4 17.7 25
236 601.4 19.6 41
237 674.4 18.2 46
238 692.6 18.8 40
239 674.4 25.1 27
243 589.9 15.4 66
244 700.7 21.9 73
245 700.7 22.4 54
246 700.7 26.8 38
247 700.7 25.7 39
248 503.6 20.7 70
249 666.7 28.7 28
250 666.7 21.7 40
251 666.7 26.8 25
252 666.7 24.0 36
253 666.7 22.1 37
254 565.5 21.4 38
255 621.7 18.9 41
256 694.8 22.3 46
257 581.1 23.9 41
258 581.1 21.4 44
259 692.3 20.6 59
260 692.3 23.7 40
261 542.0 28.3 32
262 573.0 11.2 84
263 573.0 21.4 42
264 629.1 19.3 39
265 684.4 21.8 53
266 550.3 22.1 54
267 607.1 19.4 55
268 658.2 23.7 24
269 658.2 21.0 32
270 658.2 19.1 53
271 658.2 21.8 56
272 658.2 20.1 58
273 658.2 20.2 47
286 411.8 23.4 40
288 474.9 22.1 49
289 474.9 24.2 32
290 474.9 24.3 30
291 474.9 18.7 53
292 474.9 25.3 39
293 466.3 22.9 40
294 430.8 26.9 28
296 430.8 22.2 48
306 714.3 19.0 52
307 714.3 17.1 53
308 714.3 23.8 35
309 758.1 16.0 45
310 758.1 24.9 27
311 758.1 25.3 27
312 758.1 24.8 28
313 706.6 12.2 78
314 777.1 24.3 27
315 777.1 19.7 41
316 817.5 18.5 30
317 739.4 18.6 24
318 739.4 19.2 24
319 783.5 21.6 27
320 783.5 21.6 28
321 783.5 18.9 34
322 783.5 16.8 28
323 783.5 16.8 28
324 822.8 12.9 39
325 726.9 13.7 56
326 751.5 24.2 27
327 751.5 24.1 27
328 751.5 21.2 32
329 751.5 19.7 35
330 751.5 23.5 27
331 751.5 24.2 27
332 795.3 21.5 28
333 795.3 17.1 41
334 721.1 18.1 54
335 764.0 18.0 51
336 764.0  9.8 86
337 764.0 19.3 44
338 764.0 23.0 34
339 764.0 22.7 35
340 764.0 20.4 41
341 764.0 19.3 44
342 770.3 15.7 51
343 807.1 20.6 37
344 807.1 15.9 51
345 807.1 12.2 66
346 807.1 16.8 43
347 807.1 21.3 35
348 745.3 10.1 75
349 745.3 17.4 57
350 745.3 12.8 64
351 745.3 10.1 75
352 745.3 15.4 53
353 745.3 20.6 43
354 745.3 19.8 47
355 745.3 18.7 50
356 745.3 20.8 35
357 745.3 20.8 35
358 789.7 15.9 55
359 789.7 19.7 39
360 789.7 21.1 39
361 789.7 18.4 42
362 789.7 17.3 45
363 732.3 15.2 64
364 770.3 15.9 53
365 770.3 21.1 35
366 770.3 19.6 45
367 812.1 15.9 38
368 812.1 16.4 27
369 744.4 16.8 47
370 825.1 13.8 77
371 825.1 13.8 77
372 520.5 14.2 58
373 664.5 10.4 75
374 698.6 20.3 42
375 855.3 10.3 78
376 744.4 15.4 57
377 672.6 21.1 54
378 715.1 21.9 42
381 458.8 19.3 39
382 643.0 16.2 63
383 690.0 28.2 29
384 753.8 20.5 58
385 819.1 21.3 44
386 613.0 20.9 50
387 750.5 20.6 55
389 706.7 23.3 34
390 706.7 23.3 34
392 738.1 20.7 46
393 825.1 21.9 43
397 750.5 20.4 55
398 613.0 24.3 33
399 715.1 25.9 32
402 731.7 22.8 46
403 706.7 25.0 36
404 643.0 21.3 41
405 725.1 21.8 34
406 680.9 27.9 27
407 860.6 17.0 67
409 855.3 19.9 44
410 450.2 23.4 31
413 442.1 22.8 27
414 715.1 26.4 33
415 723.1 24.1 50
416 698.6 27.5 27
417 575.8 26.3 39
419 664.5 24.9 42
420 613.0 24.8 36
421 635.9 26.2 36
422 690.0 30.8 19
423 795.9 29.3 27
424 744.4 22.3 48
425 715.1 26.9 31
426 753.8 20.4 56
427 753.8 20.4 56
428 672.6 27.9 33
429 698.6 26.2 34
430 613.0 24.6 44
431 849.3 19.4 45
432 605.3 23.3 40
433 698.6 23.9 38
434 723.1 20.9 66
435 811.2 22.2 45
437 672.6 26.8 35
438 768.4 14.2 73
439 715.1 23.6 53
440 738.1 19.1 46
441 855.3 16.2 58
442 672.6 25.5 29
445 855.3 16.2 58
447 664.5 19.1 70
449 844.0 10.5 77
450 613.0 19.3 61
451 690.0 23.4 49
452 649.9 11.8 88
453 730.6 17.7 65
454 803.3 17.4 54
455 753.8 16.8 56
456 567.2 17.9 48
457 753.8 16.6 59
458 635.9 19.9 50
459 715.1 18.9 64
460 819.1 15.5 72
461 715.1 18.9 64
462 715.1 18.9 64
463 825.1 14.5 76
477 395.0 27.2 28
478 423.4 26.1 45
480 431.6 22.6 57
481 560.0 30.2 25
482 560.0 30.2 22
483 587.1 23.4 40
484 587.1 31.0 27
485 587.1 33.1 25
486 596.3 30.6 28
487 605.8 24.1 43
488 605.8 26.4 34
489 605.8 19.4 71
490 605.8 20.6 58
491 605.8 28.7 33
492 624.1 32.4 21
493 633.6 32.4 27
494 633.6 27.5 29
495 643.0 30.8 30
496 661.8 23.9 42
497 661.8 32.6 26
498 671.2 32.3 27
499 671.2 33.3 26
501 671.2 21.6 65
502 671.2 21.6 65
503 671.2 20.7 69
504 689.1 29.2 30
505 689.1 28.9 29
506 744.4 26.7 35
507 752.6 18.5 73
508 752.6 25.9 41
509 752.6 25.9 41
510 752.6 21.1 71
511 752.6 18.2 62
512 665.6 27.8 35
513 665.6 27.8 32
514 665.6 21.9 71
515 665.6 21.2 70
516 614.7 25.6 42</code></pre>
</div>
</div>
<p>Visualitzem els resultats del test de normalitat univariant</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb43"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb43-1"><a href="#cb43-1" aria-hidden="true" tabindex="-1"></a><span class="fu">summary</span>(mvnoutliers, <span class="at">select =</span> <span class="st">"mvn"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>     Test Statistic p.value     Method          MVN
1 Royston   162.918  &lt;0.001 asymptotic ✗ Not normal</code></pre>
</div>
</div>
<p>i multivariant</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb45"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb45-1"><a href="#cb45-1" aria-hidden="true" tabindex="-1"></a><span class="fu">summary</span>(mvnoutliers, <span class="at">select =</span> <span class="st">"univariate"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>              Test Variable Statistic p.value    Normality
1 Anderson-Darling       DC    43.098  &lt;0.001 ✗ Not normal
2 Anderson-Darling     temp     1.812  &lt;0.001 ✗ Not normal
3 Anderson-Darling       RH     7.871  &lt;0.001 ✗ Not normal</code></pre>
</div>
</div>
</section>
<section id="pca" class="level2" data-number="2.4">
<h2 data-number="2.4" class="anchored" data-anchor-id="pca"><span class="header-section-number">2.4</span> PCA</h2>
<p>Métodes basats en correlacions ens permeten detectar outliers</p>
</section>
<section id="distancia-de-mahalanobis" class="level2" data-number="2.5">
<h2 data-number="2.5" class="anchored" data-anchor-id="distancia-de-mahalanobis"><span class="header-section-number">2.5</span> Distancia de Mahalanobis</h2>
<p>Medeix la distancia de un punt respecte a la mitjana considerant la covariança</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb47"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb47-1"><a href="#cb47-1" aria-hidden="true" tabindex="-1"></a>distancia_mahalanobis <span class="ot">&lt;-</span> <span class="fu">mahalanobis</span>(dades, <span class="fu">colMeans</span>(dades), <span class="fu">cov</span>(dades))</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<p>Grafiquem el plot de la densitat de les distancies</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb48"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb48-1"><a href="#cb48-1" aria-hidden="true" tabindex="-1"></a><span class="fu">plot</span>(<span class="fu">density</span>(distancia_mahalanobis))</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<div>
<figure class="figure">
<p><img src="AdvancedPreprocessing_files/figure-html/plot_density_mahalanobis-1.png" class="img-fluid figure-img" width="672"></p>
</figure>
</div>
</div>
</div>
<p>Es mostren els valors de la bbdd que queden per sobre de el 99% de la distribució chi-cuadrat</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb49"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb49-1"><a href="#cb49-1" aria-hidden="true" tabindex="-1"></a>cutoff <span class="ot">&lt;-</span> <span class="fu">qchisq</span>(<span class="at">p =</span> <span class="fl">0.99</span>, <span class="at">df =</span> <span class="fu">ncol</span>(dades))</span>
<span id="cb49-2"><a href="#cb49-2" aria-hidden="true" tabindex="-1"></a>dades[distancia_mahalanobis<span class="sc">&gt;</span>cutoff, ]</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>       DC temp  RH
4    77.5  8.3  97
5   102.2 11.4  99
212 594.2  5.1  96
277 349.7  4.6  21
278 349.7  4.6  21
279 349.7  4.6  21
280 349.7  4.6  21
282 349.7  5.1  24
305 113.8 11.3  94
380 171.4  5.2 100
446 100.7 17.3  80</code></pre>
</div>
</div>
<p>Ordenamos de forma decreciente, según el score de Mahalanobis</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb51"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb51-1"><a href="#cb51-1" aria-hidden="true" tabindex="-1"></a>dades <span class="ot">&lt;-</span> dades[<span class="fu">order</span>(distancia_mahalanobis, <span class="at">decreasing =</span> <span class="cn">TRUE</span>),]</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<p>Visualitzem l’histograma de les distancies per veure on tallem els outliers</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb52"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb52-1"><a href="#cb52-1" aria-hidden="true" tabindex="-1"></a><span class="fu">par</span>(<span class="at">mfrow=</span><span class="fu">c</span>(<span class="dv">1</span>,<span class="dv">1</span>))</span>
<span id="cb52-2"><a href="#cb52-2" aria-hidden="true" tabindex="-1"></a><span class="fu">hist</span>(distancia_mahalanobis)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<div>
<figure class="figure">
<p><img src="AdvancedPreprocessing_files/figure-html/plot_mahalanobis-1.png" class="img-fluid figure-img" width="672"></p>
</figure>
</div>
</div>
</div>
<p>Descartamos los outliers según un umbral</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb53"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb53-1"><a href="#cb53-1" aria-hidden="true" tabindex="-1"></a>umbral <span class="ot">&lt;-</span> <span class="dv">8</span></span>
<span id="cb53-2"><a href="#cb53-2" aria-hidden="true" tabindex="-1"></a>dades[, <span class="st">"outlier"</span>] <span class="ot">&lt;-</span> (distancia_mahalanobis <span class="sc">&gt;</span> umbral)</span>
<span id="cb53-3"><a href="#cb53-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb53-4"><a href="#cb53-4" aria-hidden="true" tabindex="-1"></a>dades[, <span class="st">"color"</span>] <span class="ot">&lt;-</span> <span class="fu">ifelse</span>(dades[, <span class="st">"outlier"</span>], <span class="st">"red"</span>, <span class="st">"black"</span>)</span>
<span id="cb53-5"><a href="#cb53-5" aria-hidden="true" tabindex="-1"></a><span class="fu">scatterplot3d</span>(dades[, <span class="st">"DC"</span>], dades[, <span class="st">"temp"</span>], dades[, <span class="st">"RH"</span>], </span>
<span id="cb53-6"><a href="#cb53-6" aria-hidden="true" tabindex="-1"></a>              <span class="at">color =</span> dades[, <span class="st">"color"</span>])</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<div>
<figure class="figure">
<p><img src="AdvancedPreprocessing_files/figure-html/umbral_mahalanobis-1.png" class="img-fluid figure-img" width="672"></p>
</figure>
</div>
</div>
<div class="sourceCode cell-code" id="cb54"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb54-1"><a href="#cb54-1" aria-hidden="true" tabindex="-1"></a>(fig <span class="ot">&lt;-</span> plotly<span class="sc">::</span><span class="fu">plot_ly</span>(dades, <span class="at">x =</span> <span class="sc">~</span>DC, <span class="at">y =</span> <span class="sc">~</span>temp, <span class="at">z =</span> <span class="sc">~</span>RH, </span>
<span id="cb54-2"><a href="#cb54-2" aria-hidden="true" tabindex="-1"></a>                       <span class="at">color =</span> <span class="sc">~</span>color, <span class="at">colors =</span> <span class="fu">c</span>(<span class="st">'#0C4B8E'</span>, <span class="st">'#BF382A'</span>)) <span class="sc">%&gt;%</span> </span>
<span id="cb54-3"><a href="#cb54-3" aria-hidden="true" tabindex="-1"></a>                        <span class="fu">add_markers</span>())</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<div class="plotly html-widget html-fill-item" id="htmlwidget-1d031261bad5dc9c85f6" style="width:100%;height:464px;"></div>
<script type="application/json" data-for="htmlwidget-1d031261bad5dc9c85f6">{"x":{"visdat":{"1ae860b4194f":["function () ","plotlyVisDat"]},"cur_data":"1ae860b4194f","attrs":{"1ae860b4194f":{"x":{},"y":{},"z":{},"color":{},"colors":["#0C4B8E","#BF382A"],"alpha_stroke":1,"sizes":[10,100],"spans":[1,20],"type":"scatter3d","mode":"markers","inherit":true}},"layout":{"margin":{"b":40,"l":60,"t":25,"r":10},"scene":{"xaxis":{"title":"DC"},"yaxis":{"title":"temp"},"zaxis":{"title":"RH"}},"hovermode":"closest","showlegend":true},"source":"A","config":{"modeBarButtonsToAdd":["hoverclosest","hovercompare"],"showSendToCloud":false},"data":[{"x":[349.69999999999999,349.69999999999999,349.69999999999999,349.69999999999999,77.5,113.8,171.40000000000001,100.7,594.20000000000005,7.9000000000000004,233.80000000000001,352.60000000000002,16.199999999999999,423.39999999999998,9.3000000000000007,26.600000000000001,437.69999999999999,16.199999999999999,353.5,764,671.20000000000005,855.29999999999995,587.10000000000002,844,229,608.20000000000005,297.69999999999999,297.69999999999999,25.600000000000001,649.89999999999998,252.59999999999999,822.79999999999995,15.300000000000001,671.20000000000005,18.699999999999999,601.39999999999998,55,28.300000000000001,46.700000000000003,353.5,28.300000000000001,812.10000000000002,633.60000000000002,77.5,661.79999999999995,15.5,58.299999999999997,624.10000000000002,86.599999999999994,55.200000000000003,55.200000000000003,32.100000000000001,15.800000000000001,700.70000000000005,671.20000000000005,745.29999999999995,745.29999999999995,85.299999999999997,354.60000000000002,352,43.5,309.89999999999998,573,100.40000000000001,102.2,103.8,25.600000000000001,825.10000000000002,825.10000000000002,80.799999999999997,368.30000000000001,41.600000000000001,665.60000000000002,709.89999999999998,316.69999999999999,503.60000000000002,825.10000000000002,783.5,783.5,77.5,80.799999999999997,106.7,25.600000000000001,80.799999999999997,67.599999999999994,706.60000000000002,97.799999999999997,67.599999999999994,30.600000000000001,596.29999999999995,43.600000000000001,77.5,80.799999999999997,80.799999999999997,643,97.799999999999997,56.899999999999999,560,560,86.599999999999994,664.5,807.10000000000002,74.299999999999997,43.5,80.799999999999997,80.799999999999997,752.60000000000002,423.39999999999998,36.899999999999999,706.39999999999998,706.39999999999998,699.60000000000002,665.60000000000002,41.100000000000001,97.799999999999997,690,94.299999999999997,97.099999999999994,73.700000000000003,706.39999999999998,376.60000000000002,86.599999999999994,686.89999999999998,43,735.70000000000005,395,30.600000000000001,34,30.199999999999999,819.10000000000002,608.20000000000005,739.39999999999998,48.299999999999997,752.60000000000002,43,103.8,812.10000000000002,768.39999999999998,709.89999999999998,92.400000000000006,70.799999999999997,100.40000000000001,57.299999999999997,605.79999999999995,200,52.799999999999997,102.2,102.2,671.20000000000005,55,817.5,431.60000000000002,64.700000000000003,67.599999999999994,57.299999999999997,721.39999999999998,739.39999999999998,674.39999999999998,83.700000000000003,67.599999999999994,102.2,860.60000000000002,542,430.80000000000001,86.599999999999994,103.8,103.8,103.8,87.200000000000003,682.60000000000002,605.79999999999995,664.5,89.400000000000006,745.29999999999995,686.89999999999998,721.39999999999998,671.20000000000005,671.20000000000005,686.89999999999998,691.79999999999995,665.29999999999995,689.10000000000002,723.10000000000002,795.89999999999998,355.19999999999999,855.29999999999995,855.29999999999995,689.10000000000002,424.10000000000002,666.70000000000005,686.5,578.79999999999995,721.39999999999998,440.89999999999998,728.60000000000002,807.10000000000002,692.60000000000002,561.60000000000002,690,665.60000000000002,726.89999999999998,795.29999999999995,807.10000000000002,691.79999999999995,298.10000000000002,706.39999999999998,672.60000000000002,680.89999999999998,704.39999999999998,783.5,699.60000000000002,699.60000000000002,665.60000000000002,795.29999999999995,783.5,728.60000000000002,633.60000000000002,691.79999999999995,575.79999999999995,732.29999999999995,350.19999999999999,366.69999999999999,783.5,698.60000000000002,758.10000000000002,789.70000000000005,713.89999999999998,730.60000000000002,232.09999999999999,232.09999999999999,686.5,770.29999999999995,666.70000000000005,715.10000000000002,715.10000000000002,692.60000000000002,700.70000000000005,770.29999999999995,411.80000000000001,669.10000000000002,692.29999999999995,647.10000000000002,647.10000000000002,789.70000000000005,638.79999999999995,614.5,614.5,744.39999999999998,745.29999999999995,672.60000000000002,704.39999999999998,430.80000000000001,715.10000000000002,605.79999999999995,752.60000000000002,614.70000000000005,730.20000000000005,849.29999999999995,692.29999999999995,715.10000000000002,777.10000000000002,855.29999999999995,735.70000000000005,803.29999999999995,744.39999999999998,758.10000000000002,589.89999999999998,550.29999999999995,730.20000000000005,669.10000000000002,751.5,752.60000000000002,752.60000000000002,751.5,699.60000000000002,658.20000000000005,715.10000000000002,758.10000000000002,474.89999999999998,685.20000000000005,692.29999999999995,807.10000000000002,753.79999999999995,706.39999999999998,807.10000000000002,495.60000000000002,658.20000000000005,724.29999999999995,474.89999999999998,474.89999999999998,613,442.10000000000002,696.10000000000002,753.79999999999995,751.5,718.29999999999995,296.30000000000001,692.29999999999995,685.20000000000005,605.79999999999995,613,744.39999999999998,700.70000000000005,789.70000000000005,674.39999999999998,643,700.70000000000005,715.10000000000002,751.5,728.60000000000002,450.19999999999999,672.60000000000002,664.20000000000005,745.29999999999995,298.10000000000002,753.79999999999995,753.79999999999995,664.5,624.20000000000005,442.89999999999998,658.20000000000005,690,680.70000000000005,673.79999999999995,624.20000000000005,671.89999999999998,728.60000000000002,750.5,825.10000000000002,578.79999999999995,724.29999999999995,750.5,819.10000000000002,686.5,764,466.30000000000001,777.10000000000002,290.80000000000001,605.79999999999995,668,668,674.39999999999998,513.29999999999995,789.70000000000005,745.29999999999995,745.29999999999995,811.20000000000005,696.10000000000002,684.39999999999998,724.29999999999995,613,706.70000000000005,764,668,668,668,290.80000000000001,680.70000000000005,764,488,581.10000000000002,672.60000000000002,313.39999999999998,714.29999999999995,764,764,631.20000000000005,529.79999999999995,601.39999999999998,770.29999999999995,735.70000000000005,713,613,685.20000000000005,721.10000000000002,692.60000000000002,520.5,680.70000000000005,725.10000000000002,764,744.39999999999998,745.29999999999995,661.79999999999995,671.89999999999998,714.29999999999995,731.70000000000005,594.20000000000005,658.20000000000005,692.60000000000002,377.19999999999999,674.39999999999998,706.70000000000005,706.70000000000005,638.79999999999995,664.20000000000005,698.60000000000002,706.39999999999998,666.70000000000005,570.5,706.39999999999998,647.10000000000002,692.60000000000002,738.10000000000002,692.60000000000002,594.20000000000005,654.10000000000002,654.10000000000002,692.29999999999995,587.10000000000002,713.89999999999998,745.29999999999995,714.29999999999995,586.70000000000005,698.60000000000002,706.79999999999995,647.10000000000002,607.10000000000002,728.60000000000002,699.60000000000002,728.60000000000002,745.29999999999995,605.29999999999995,474.89999999999998,488,713.89999999999998,647.10000000000002,694.79999999999995,738.10000000000002,692.60000000000002,692.60000000000002,631.20000000000005,654.10000000000002,704.39999999999998,661.29999999999995,673.79999999999995,671.89999999999998,698.60000000000002,668,613,658.20000000000005,715.10000000000002,608.20000000000005,631.20000000000005,692.29999999999995,680.70000000000005,692.60000000000002,614.5,674.39999999999998,665.29999999999995,698.60000000000002,666.70000000000005,586.70000000000005,686.5,698.60000000000002,686.5,466.60000000000002,692.29999999999995,698.60000000000002,661.29999999999995,631.20000000000005,647.10000000000002,686.5,629.10000000000002,654.10000000000002,686.5,635.89999999999998,666.70000000000005,480.80000000000001,624.20000000000005,581.10000000000002,594.20000000000005,609.60000000000002,458.80000000000001,658.20000000000005,647.10000000000002,621.70000000000005,573,643,661.29999999999995,624.20000000000005,601.39999999999998,654.10000000000002,654.10000000000002,601.39999999999998,601.39999999999998,601.39999999999998,578.79999999999995,601.39999999999998,631.20000000000005,601.39999999999998,567.20000000000005,578.79999999999995,537.39999999999998],"y":[4.5999999999999996,4.5999999999999996,4.5999999999999996,5.0999999999999996,8.3000000000000007,11.300000000000001,5.2000000000000002,17.300000000000001,5.0999999999999996,13.4,10.6,2.2000000000000002,4.5999999999999996,18.199999999999999,5.2999999999999998,6.7000000000000002,12.6,5.0999999999999996,4.2000000000000002,9.8000000000000007,27.300000000000001,10.300000000000001,33.100000000000001,10.5,14.300000000000001,8,28,28,15.199999999999999,11.800000000000001,24.5,12.9,4.5999999999999996,33.299999999999997,8.8000000000000007,11.6,5.2999999999999998,8.9000000000000004,5.2999999999999998,4.7999999999999998,13.800000000000001,16.399999999999999,32.399999999999999,18.800000000000001,32.600000000000001,17.399999999999999,7.5,32.399999999999999,10.6,5.7999999999999998,5.7999999999999998,8.8000000000000007,7.5,21.899999999999999,32.299999999999997,10.1,10.1,16.699999999999999,5.0999999999999996,5.0999999999999996,13.300000000000001,13.4,11.199999999999999,15.1,5.5,8.3000000000000007,17.600000000000001,13.800000000000001,13.800000000000001,11.6,14.800000000000001,10.9,21.899999999999999,11.199999999999999,26.399999999999999,20.699999999999999,14.5,16.800000000000001,16.800000000000001,15.6,17.399999999999999,11.800000000000001,13.699999999999999,17.399999999999999,15.5,12.199999999999999,14.6,15.800000000000001,8.6999999999999993,30.600000000000001,8.1999999999999993,17.199999999999999,15.1,15.199999999999999,30.800000000000001,11.699999999999999,10.1,30.199999999999999,30.199999999999999,15.199999999999999,10.4,12.199999999999999,18.199999999999999,15.199999999999999,17,17,21.100000000000001,26.100000000000001,10.199999999999999,21.5,21.5,19.399999999999999,21.199999999999999,11.199999999999999,15.800000000000001,30.800000000000001,8.1999999999999993,9.3000000000000007,18,20.800000000000001,23.800000000000001,16.100000000000001,14.6,15.699999999999999,12.9,27.199999999999999,11.6,13.9,12.699999999999999,15.5,10.300000000000001,18.600000000000001,12.4,18.5,12.300000000000001,9,15.9,14.199999999999999,12.4,11.5,15.9,15.199999999999999,12.699999999999999,19.399999999999999,21,14.699999999999999,11.5,11.5,20.699999999999999,14.199999999999999,18.5,22.600000000000001,14,14.9,13.699999999999999,30.199999999999999,19.199999999999999,17.699999999999999,12.4,14.1,10.6,17,28.300000000000001,26.899999999999999,13.199999999999999,11,11,11,15.4,11.300000000000001,28.699999999999999,19.100000000000001,13.300000000000001,12.800000000000001,18.399999999999999,29.600000000000001,21.600000000000001,21.600000000000001,17.800000000000001,15.4,17,29.199999999999999,20.899999999999999,29.300000000000001,24.800000000000001,16.199999999999999,16.199999999999999,28.899999999999999,24.600000000000001,28.699999999999999,14.699999999999999,27.399999999999999,28.600000000000001,17.100000000000001,28.300000000000001,16.800000000000001,13.1,21.600000000000001,28.199999999999999,27.800000000000001,13.699999999999999,17.100000000000001,15.9,20.600000000000001,20.699999999999999,27.699999999999999,27.899999999999999,27.899999999999999,17.800000000000001,21.600000000000001,26.399999999999999,26.399999999999999,27.800000000000001,21.5,18.899999999999999,27.800000000000001,27.5,13.800000000000001,26.300000000000001,15.199999999999999,22.699999999999999,23.300000000000001,21.600000000000001,27.5,16,15.9,27.600000000000001,17.699999999999999,19.199999999999999,19.199999999999999,15.6,15.699999999999999,26.800000000000001,18.899999999999999,18.899999999999999,13.9,26.800000000000001,15.9,23.399999999999999,21.699999999999999,25.899999999999999,24.600000000000001,24.600000000000001,17.300000000000001,23.399999999999999,14.4,14.4,15.4,15.4,26.800000000000001,17.800000000000001,22.199999999999999,23.600000000000001,26.399999999999999,18.199999999999999,25.600000000000001,17.800000000000001,19.399999999999999,25.399999999999999,26.899999999999999,24.300000000000001,19.899999999999999,15.4,17.399999999999999,26.699999999999999,25.300000000000001,15.4,22.100000000000001,18.199999999999999,18,24.100000000000001,25.899999999999999,25.899999999999999,24.199999999999999,24.300000000000001,23.699999999999999,26.399999999999999,24.800000000000001,24.300000000000001,23.699999999999999,20.600000000000001,21.300000000000001,20.5,25.399999999999999,20.600000000000001,24.100000000000001,21.800000000000001,18.899999999999999,22.100000000000001,24.199999999999999,19.300000000000001,22.800000000000001,16.100000000000001,16.800000000000001,19.699999999999999,17.699999999999999,16.600000000000001,17.699999999999999,23.199999999999999,20.600000000000001,24.600000000000001,16.800000000000001,22.399999999999999,19.699999999999999,25.100000000000001,16.199999999999999,25.699999999999999,25.899999999999999,21.199999999999999,17.199999999999999,23.399999999999999,25.5,19.100000000000001,17.399999999999999,19.100000000000001,20.399999999999999,20.399999999999999,24.899999999999999,14.199999999999999,23,20.100000000000001,23.399999999999999,16.899999999999999,15.9,14.699999999999999,24.199999999999999,25.300000000000001,20.600000000000001,21.899999999999999,24.199999999999999,21.199999999999999,20.399999999999999,21.300000000000001,17.699999999999999,18,22.899999999999999,19.699999999999999,14.300000000000001,24.100000000000001,19,19,24.100000000000001,23.800000000000001,21.100000000000001,20.800000000000001,20.800000000000001,22.199999999999999,16.800000000000001,21.800000000000001,19.100000000000001,24.800000000000001,25,23,19.600000000000001,19.600000000000001,19.600000000000001,15.4,17.199999999999999,22.699999999999999,22.199999999999999,23.899999999999999,21.100000000000001,18,17.100000000000001,19.300000000000001,19.300000000000001,16.199999999999999,21.199999999999999,16.300000000000001,19.600000000000001,18.300000000000001,19.300000000000001,24.300000000000001,17.600000000000001,18.100000000000001,18.300000000000001,14.199999999999999,23.899999999999999,21.800000000000001,20.399999999999999,22.300000000000001,18.699999999999999,23.899999999999999,24.300000000000001,23.800000000000001,22.800000000000001,23.699999999999999,21,21.600000000000001,19.600000000000001,17.800000000000001,23.300000000000001,23.300000000000001,23.100000000000001,16.699999999999999,23.899999999999999,22.100000000000001,24,23.399999999999999,22.399999999999999,16.399999999999999,18.800000000000001,19.100000000000001,17.600000000000001,22.899999999999999,16.600000000000001,16.600000000000001,23.699999999999999,23.399999999999999,22.899999999999999,19.800000000000001,19,23.5,17.800000000000001,20.600000000000001,16.600000000000001,19.399999999999999,22.899999999999999,21.899999999999999,22.800000000000001,20.600000000000001,23.300000000000001,18.699999999999999,20.800000000000001,18.600000000000001,17.399999999999999,22.300000000000001,20.699999999999999,20.699999999999999,18.699999999999999,21.399999999999999,20.5,22.800000000000001,17.600000000000001,20.199999999999999,17.899999999999999,22.800000000000001,23,20.899999999999999,19.100000000000001,21.899999999999999,17.100000000000001,21.5,19.800000000000001,22.5,21.699999999999999,17.300000000000001,18.199999999999999,22.600000000000001,19.600000000000001,22.100000000000001,20.800000000000001,21.899999999999999,20.300000000000001,19.399999999999999,19.600000000000001,20.100000000000001,20.300000000000001,18.600000000000001,17.899999999999999,18.600000000000001,21.300000000000001,19.300000000000001,18.399999999999999,21,19.899999999999999,21.699999999999999,16.399999999999999,18.399999999999999,21.399999999999999,17.600000000000001,17.399999999999999,19.300000000000001,20.199999999999999,20.100000000000001,18.899999999999999,21.399999999999999,21.300000000000001,20.199999999999999,20.300000000000001,19.5,20.399999999999999,20.399999999999999,18.199999999999999,19.800000000000001,19.800000000000001,20.699999999999999,20.100000000000001,19.199999999999999,19.600000000000001,17.899999999999999,20.300000000000001,19.5],"z":[21,21,21,24,97,94,100,80,96,75,90,59,82,82,78,79,90,77,51,86,63,78,25,77,79,86,34,34,19,88,50,39,59,26,35,87,70,35,68,57,24,27,27,18,26,24,71,21,30,54,54,68,46,73,27,75,75,20,61,61,27,79,84,64,59,72,27,77,77,30,78,64,71,78,35,70,76,28,28,25,24,31,33,25,27,78,26,27,51,28,53,26,27,27,30,33,62,25,22,27,75,66,29,51,27,27,71,45,45,15,15,19,70,41,27,19,51,44,40,17,51,29,33,43,74,28,48,40,48,72,74,24,53,73,51,49,38,73,73,60,35,31,52,71,44,42,39,39,69,46,30,57,39,38,43,24,24,25,54,43,46,67,32,28,40,46,46,46,40,60,33,70,42,64,25,27,65,65,27,35,72,30,66,27,29,58,58,29,43,28,70,22,27,67,26,43,63,19,29,35,56,41,51,24,25,24,33,27,67,27,21,21,32,28,34,27,29,50,39,64,40,37,28,27,45,55,30,65,38,38,66,51,25,64,64,59,38,53,40,24,24,22,22,45,22,66,66,57,53,35,64,48,53,34,62,42,63,45,24,31,27,44,57,54,35,27,66,54,62,33,27,41,41,27,25,24,33,28,30,25,59,35,58,27,37,27,56,35,49,32,61,27,44,56,35,39,53,37,26,58,44,47,54,39,27,63,39,32,32,43,31,29,32,57,39,56,56,42,53,36,58,49,60,46,59,28,36,55,43,28,32,55,44,39,51,40,41,46,43,34,34,29,32,39,35,35,45,45,53,38,36,36,34,33,33,33,45,58,35,29,41,54,42,53,44,44,59,51,60,45,45,38,33,42,54,40,58,32,34,41,48,50,42,36,35,46,32,32,33,43,56,34,34,31,47,38,34,36,33,34,47,40,46,46,31,47,47,40,40,44,47,52,36,51,37,54,55,39,35,39,43,40,53,32,49,43,46,46,37,43,33,35,39,45,37,45,40,37,50,53,42,43,34,50,42,38,43,46,38,48,37,34,39,42,48,36,47,45,44,44,51,42,39,45,42,50,40,43,42,44,52,50,39,47,40,41,42,41,45,39,39,42,42,43,39,39,45,39,44,41,48,41,43],"type":"scatter3d","mode":"markers","name":"black","marker":{"color":"rgba(12,75,142,1)","line":{"color":"rgba(12,75,142,1)"}},"textfont":{"color":"rgba(12,75,142,1)"},"error_y":{"color":"rgba(12,75,142,1)"},"error_x":{"color":"rgba(12,75,142,1)"},"line":{"color":"rgba(12,75,142,1)"},"frame":null},{"x":[349.69999999999999,102.2,587.10000000000002,64.700000000000003,474.89999999999998,715.10000000000002,758.10000000000002,753.79999999999995,529.79999999999995,751.5,635.89999999999998,723.10000000000002,789.70000000000005,751.5,433.30000000000001,698.60000000000002,770.29999999999995,709.89999999999998,513.29999999999995,631.20000000000005,466.60000000000002,480.80000000000001,692.29999999999995,565.5],"y":[4.5999999999999996,11.4,31,11.800000000000001,25.300000000000001,18.899999999999999,24.899999999999999,16.600000000000001,14.699999999999999,23.5,26.199999999999999,24.100000000000001,18.399999999999999,24.199999999999999,23.199999999999999,26.199999999999999,21.100000000000001,17.399999999999999,23.300000000000001,20.800000000000001,18.800000000000001,20.100000000000001,20.100000000000001,21.399999999999999],"z":[21,99,27,35,39,64,27,59,66,27,36,50,42,27,39,34,35,56,31,33,35,34,47,38],"type":"scatter3d","mode":"markers","name":"red","marker":{"color":"rgba(191,56,42,1)","line":{"color":"rgba(191,56,42,1)"}},"textfont":{"color":"rgba(191,56,42,1)"},"error_y":{"color":"rgba(191,56,42,1)"},"error_x":{"color":"rgba(191,56,42,1)"},"line":{"color":"rgba(191,56,42,1)"},"frame":null}],"highlight":{"on":"plotly_click","persistent":false,"dynamic":false,"selectize":false,"opacityDim":0.20000000000000001,"selected":{"opacity":1},"debounce":0},"shinyEvents":["plotly_hover","plotly_click","plotly_selected","plotly_relayout","plotly_brushed","plotly_brushing","plotly_clickannotation","plotly_doubleclick","plotly_deselect","plotly_afterplot","plotly_sunburstclick"],"base_url":"https://plot.ly"},"evals":[],"jsHooks":[]}</script>
</div>
<div class="sourceCode cell-code" id="cb55"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb55-1"><a href="#cb55-1" aria-hidden="true" tabindex="-1"></a>(quienes <span class="ot">&lt;-</span> <span class="fu">which</span>(dades[, <span class="st">"outlier"</span>] <span class="sc">==</span> <span class="cn">TRUE</span>))</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code> [1]   4   5  76 105 212 240 277 278 279 280 281 282 283 287 300 305 336 375 380
[20] 446 464 465 479 500</code></pre>
</div>
</div>
<section id="mahalanobis-robusto" class="level3" data-number="2.5.1">
<h3 data-number="2.5.1" class="anchored" data-anchor-id="mahalanobis-robusto"><span class="header-section-number">2.5.1</span> Mahalanobis Robusto</h3>
<div class="cell">
<div class="sourceCode cell-code" id="cb57"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb57-1"><a href="#cb57-1" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(chemometrics)</span>
<span id="cb57-2"><a href="#cb57-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb57-3"><a href="#cb57-3" aria-hidden="true" tabindex="-1"></a>dis <span class="ot">&lt;-</span> chemometrics<span class="sc">::</span><span class="fu">Moutlier</span>(dades[, <span class="fu">c</span>(<span class="st">"DC"</span>, <span class="st">"temp"</span>, <span class="st">"RH"</span>)], <span class="at">quantile =</span> <span class="fl">0.99</span>, <span class="at">plot =</span> <span class="cn">TRUE</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<div>
<figure class="figure">
<p><img src="AdvancedPreprocessing_files/figure-html/mahalanobis_robusto-1.png" class="img-fluid figure-img" width="672"></p>
</figure>
</div>
</div>
<div class="sourceCode cell-code" id="cb58"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb58-1"><a href="#cb58-1" aria-hidden="true" tabindex="-1"></a><span class="fu">par</span>(<span class="at">mfrow =</span> <span class="fu">c</span>(<span class="dv">1</span>, <span class="dv">1</span>))</span>
<span id="cb58-2"><a href="#cb58-2" aria-hidden="true" tabindex="-1"></a><span class="fu">plot</span>(dis<span class="sc">$</span>md, dis<span class="sc">$</span>rd, <span class="at">type =</span> <span class="st">"n"</span>)</span>
<span id="cb58-3"><a href="#cb58-3" aria-hidden="true" tabindex="-1"></a><span class="fu">text</span>(dis<span class="sc">$</span>md, dis<span class="sc">$</span>rd, <span class="at">labels =</span> <span class="fu">rownames</span>(dades))</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<div>
<figure class="figure">
<p><img src="AdvancedPreprocessing_files/figure-html/mahalanobis_robusto-2.png" class="img-fluid figure-img" width="672"></p>
</figure>
</div>
</div>
<div class="sourceCode cell-code" id="cb59"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb59-1"><a href="#cb59-1" aria-hidden="true" tabindex="-1"></a>a <span class="ot">&lt;-</span> <span class="fu">which</span>(dis<span class="sc">$</span>rd <span class="sc">&gt;</span> <span class="dv">7</span>)</span>
<span id="cb59-2"><a href="#cb59-2" aria-hidden="true" tabindex="-1"></a><span class="fu">print</span>(a)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>277 278 279 280   5 282   4 305 380 446 240 464 105  76 465 394 466 284 166 448 
  1   2   3   4   5   6   7   8   9  10  12  15  17  18  20  31  35  37  39  40 
395 418 112  98 391 119 177 197 203 285 242 469 205  62  78 471 117 443  73  92 
 41  43  46  48  49  51  52  53  54  55  60  63  66  67  68  69  72  74  83  84 
517 470  90 116 169 115 379 412  70  17 118 191 396 220  49 107 241 215 216 467 
 85  86  87  88  90  91  92  94  95  96  97  99 100 103 105 107 108 109 110 113 
468  71   1  20 472 161  77 388  59  97 183  60 127 190  19 163 106 411  61 187 
118 119 121 122 123 126 128 131 132 133 137 139 140 144 145 146 147 150 151 152 
408 132 135 111 202  40 133 147  50 214 223 131 189 
154 157 158 159 163 164 165 169 170 171 172 173 177 </code></pre>
</div>
</div>
</section>
</section>
<section id="regresió-lineal-i-residus" class="level2" data-number="2.6">
<h2 data-number="2.6" class="anchored" data-anchor-id="regresió-lineal-i-residus"><span class="header-section-number">2.6</span> Regresió Lineal i residus</h2>
<p>Un punt amb un residu gran pot considerar-se un outlier</p>
</section>
<section id="distancia-de-cook" class="level2" data-number="2.7">
<h2 data-number="2.7" class="anchored" data-anchor-id="distancia-de-cook"><span class="header-section-number">2.7</span> Distancia de Cook</h2>
<p>Identifica punts amb gran influència en la regresió. Un valor de Cook D_i &gt; 1 és un outliers.</p>
</section>
<section id="k-nearest-neighbors-knn-outlier-score" class="level2" data-number="2.8">
<h2 data-number="2.8" class="anchored" data-anchor-id="k-nearest-neighbors-knn-outlier-score"><span class="header-section-number">2.8</span> K-Nearest Neighbors (KNN) Outlier Score</h2>
<p>Basats en la densitat local de les dades</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb61"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb61-1"><a href="#cb61-1" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(adamethods)</span>
<span id="cb61-2"><a href="#cb61-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb61-3"><a href="#cb61-3" aria-hidden="true" tabindex="-1"></a><span class="fu">do_knno</span>(dades[, <span class="fu">c</span>(<span class="st">"DC"</span>, <span class="st">"temp"</span>, <span class="st">"RH"</span>)], <span class="at">k=</span><span class="dv">1</span>, <span class="at">top_n =</span> <span class="dv">30</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code> [1]   9 149  64  65   7  33  73  79 130  32  16  19 274 167 198  22 142  63 106
[20]  35  11 273 245 227   5   8  13  27  10 279</code></pre>
</div>
</div>
</section>
<section id="local-outlier-factor-lof" class="level2" data-number="2.9">
<h2 data-number="2.9" class="anchored" data-anchor-id="local-outlier-factor-lof"><span class="header-section-number">2.9</span> Local Outlier Factor (LOF)</h2>
<p>Compara la densidat de un punt amb la densidat dels seus veïns. Un valor LOF alt</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb63"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb63-1"><a href="#cb63-1" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(DMwR2)</span>
<span id="cb63-2"><a href="#cb63-2" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(dplyr)</span>
<span id="cb63-3"><a href="#cb63-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb63-4"><a href="#cb63-4" aria-hidden="true" tabindex="-1"></a>outlier.scores <span class="ot">&lt;-</span> <span class="fu">lofactor</span>(dades[, <span class="fu">c</span>(<span class="st">"DC"</span>, <span class="st">"temp"</span>, <span class="st">"RH"</span>)], <span class="at">k =</span> <span class="dv">5</span>)</span>
<span id="cb63-5"><a href="#cb63-5" aria-hidden="true" tabindex="-1"></a><span class="fu">par</span>(<span class="at">mfrow=</span><span class="fu">c</span>(<span class="dv">1</span>,<span class="dv">1</span>))</span>
<span id="cb63-6"><a href="#cb63-6" aria-hidden="true" tabindex="-1"></a><span class="fu">plot</span>(<span class="fu">density</span>(outlier.scores))</span>
<span id="cb63-7"><a href="#cb63-7" aria-hidden="true" tabindex="-1"></a>outlier.scores</span>
<span id="cb63-8"><a href="#cb63-8" aria-hidden="true" tabindex="-1"></a>outliers <span class="ot">&lt;-</span> <span class="fu">order</span>(outlier.scores, <span class="at">decreasing=</span>T)</span>
<span id="cb63-9"><a href="#cb63-9" aria-hidden="true" tabindex="-1"></a>outliers <span class="ot">&lt;-</span> <span class="fu">order</span>(outlier.scores, <span class="at">decreasing=</span>T)[<span class="dv">1</span><span class="sc">:</span><span class="dv">5</span>]</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<p>Aprofitarem el ACP per poder visualizar els outliers</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb64"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb64-1"><a href="#cb64-1" aria-hidden="true" tabindex="-1"></a>n <span class="ot">&lt;-</span> <span class="fu">nrow</span>(dades[, <span class="fu">c</span>(<span class="st">"DC"</span>, <span class="st">"temp"</span>, <span class="st">"RH"</span>)]); labels <span class="ot">&lt;-</span> <span class="dv">1</span><span class="sc">:</span>n; labels[<span class="sc">-</span>outliers] <span class="ot">&lt;-</span> <span class="st">"."</span></span>
<span id="cb64-2"><a href="#cb64-2" aria-hidden="true" tabindex="-1"></a><span class="fu">biplot</span>(<span class="fu">prcomp</span>(dades[, <span class="fu">c</span>(<span class="st">"DC"</span>, <span class="st">"temp"</span>, <span class="st">"RH"</span>)]), <span class="at">cex =</span> .<span class="dv">8</span>, <span class="at">xlabs =</span> labels)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<p>Grafiquem les correlacions per veure els gráfics</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb65"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb65-1"><a href="#cb65-1" aria-hidden="true" tabindex="-1"></a>pch <span class="ot">&lt;-</span> <span class="fu">rep</span>(<span class="st">"."</span>, n)</span>
<span id="cb65-2"><a href="#cb65-2" aria-hidden="true" tabindex="-1"></a>pch[outliers] <span class="ot">&lt;-</span> <span class="st">"+"</span></span>
<span id="cb65-3"><a href="#cb65-3" aria-hidden="true" tabindex="-1"></a>col <span class="ot">&lt;-</span> <span class="fu">rep</span>(<span class="st">"black"</span>, n)</span>
<span id="cb65-4"><a href="#cb65-4" aria-hidden="true" tabindex="-1"></a>col[outliers] <span class="ot">&lt;-</span> <span class="st">"red"</span></span>
<span id="cb65-5"><a href="#cb65-5" aria-hidden="true" tabindex="-1"></a><span class="fu">pairs</span>(dades[, <span class="fu">c</span>(<span class="st">"DC"</span>, <span class="st">"temp"</span>, <span class="st">"RH"</span>)], <span class="at">pch =</span> pch, <span class="at">col =</span> col)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<p>Ho visualitzem en 3D</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb66"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb66-1"><a href="#cb66-1" aria-hidden="true" tabindex="-1"></a><span class="fu">plot3d</span>(dades[, <span class="st">"DC"</span>], dades[, <span class="st">"temp"</span>], dades[, <span class="st">"RH"</span>], <span class="at">type =</span> <span class="st">"s"</span>, <span class="at">col =</span> col, <span class="at">size =</span> <span class="dv">1</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<section id="nueva-versión-de-lof" class="level3" data-number="2.9.1">
<h3 data-number="2.9.1" class="anchored" data-anchor-id="nueva-versión-de-lof"><span class="header-section-number">2.9.1</span> Nueva versión de LOF</h3>
<div class="cell">
<div class="sourceCode cell-code" id="cb67"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb67-1"><a href="#cb67-1" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(Rlof)</span>
<span id="cb67-2"><a href="#cb67-2" aria-hidden="true" tabindex="-1"></a>outliers.scores <span class="ot">&lt;-</span> Rlof<span class="sc">::</span><span class="fu">lof</span>(dades[, <span class="fu">c</span>(<span class="st">"DC"</span>, <span class="st">"temp"</span>, <span class="st">"RH"</span>)], <span class="at">k =</span> <span class="dv">5</span>)</span>
<span id="cb67-3"><a href="#cb67-3" aria-hidden="true" tabindex="-1"></a><span class="fu">plot</span>(<span class="fu">density</span>(outliers.scores))</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<div>
<figure class="figure">
<p><img src="AdvancedPreprocessing_files/figure-html/lof2-1.png" class="img-fluid figure-img" width="672"></p>
</figure>
</div>
</div>
<div class="sourceCode cell-code" id="cb68"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb68-1"><a href="#cb68-1" aria-hidden="true" tabindex="-1"></a><span class="co">#outlier.scores &lt;- lof(dades[, c("DC", "temp", "RH")], k=c(5:10))</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
</section>
</section>
<section id="isolation-forest" class="level2" data-number="2.10">
<h2 data-number="2.10" class="anchored" data-anchor-id="isolation-forest"><span class="header-section-number">2.10</span> Isolation Forest</h2>
<div class="cell">
<div class="sourceCode cell-code" id="cb69"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb69-1"><a href="#cb69-1" aria-hidden="true" tabindex="-1"></a><span class="do">### Cargamos las librerias necesarias</span></span>
<span id="cb69-2"><a href="#cb69-2" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(R.matlab)   <span class="co"># Lectura de archivos .mat</span></span>
<span id="cb69-3"><a href="#cb69-3" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(solitude)   <span class="co"># Modelo isolation forest</span></span>
<span id="cb69-4"><a href="#cb69-4" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(tidyverse)  <span class="co"># Preparación de datos y gráficos</span></span>
<span id="cb69-5"><a href="#cb69-5" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(MLmetrics)</span>
<span id="cb69-6"><a href="#cb69-6" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb69-7"><a href="#cb69-7" aria-hidden="true" tabindex="-1"></a><span class="co"># Carreguem les dades</span></span>
<span id="cb69-8"><a href="#cb69-8" aria-hidden="true" tabindex="-1"></a>cardio_mat  <span class="ot">&lt;-</span> <span class="fu">readMat</span>(<span class="st">"https://www.dropbox.com/s/galg3ihvxklf0qi/cardio.mat?dl=1"</span>)</span>
<span id="cb69-9"><a href="#cb69-9" aria-hidden="true" tabindex="-1"></a>df_cardio   <span class="ot">&lt;-</span> <span class="fu">as.data.frame</span>(cardio_mat<span class="sc">$</span>X)</span>
<span id="cb69-10"><a href="#cb69-10" aria-hidden="true" tabindex="-1"></a>df_cardio<span class="sc">$</span>y <span class="ot">&lt;-</span> <span class="fu">as.character</span>(cardio_mat<span class="sc">$</span>y)</span>
<span id="cb69-11"><a href="#cb69-11" aria-hidden="true" tabindex="-1"></a>datos <span class="ot">&lt;-</span> df_cardio</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<div class="cell">
<div class="sourceCode cell-code" id="cb70"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb70-1"><a href="#cb70-1" aria-hidden="true" tabindex="-1"></a>isoforest <span class="ot">&lt;-</span> isolationForest<span class="sc">$</span><span class="fu">new</span>(</span>
<span id="cb70-2"><a href="#cb70-2" aria-hidden="true" tabindex="-1"></a>  <span class="at">sample_size =</span> <span class="fu">as.integer</span>(<span class="fu">nrow</span>(datos)<span class="sc">/</span><span class="dv">2</span>),</span>
<span id="cb70-3"><a href="#cb70-3" aria-hidden="true" tabindex="-1"></a>  <span class="at">num_trees   =</span> <span class="dv">500</span>, </span>
<span id="cb70-4"><a href="#cb70-4" aria-hidden="true" tabindex="-1"></a>  <span class="at">replace     =</span> <span class="cn">TRUE</span>,</span>
<span id="cb70-5"><a href="#cb70-5" aria-hidden="true" tabindex="-1"></a>  <span class="at">seed        =</span> <span class="dv">123</span></span>
<span id="cb70-6"><a href="#cb70-6" aria-hidden="true" tabindex="-1"></a>)</span>
<span id="cb70-7"><a href="#cb70-7" aria-hidden="true" tabindex="-1"></a>isoforest<span class="sc">$</span><span class="fu">fit</span>(<span class="at">dataset =</span> datos <span class="sc">%&gt;%</span> <span class="fu">select</span>(<span class="sc">-</span>y))</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<p>Ara anem a realitzar les prediccions.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb71"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb71-1"><a href="#cb71-1" aria-hidden="true" tabindex="-1"></a>predicciones <span class="ot">&lt;-</span> isoforest<span class="sc">$</span><span class="fu">predict</span>(</span>
<span id="cb71-2"><a href="#cb71-2" aria-hidden="true" tabindex="-1"></a>  <span class="at">data =</span> datos <span class="sc">%&gt;%</span> <span class="fu">select</span>(<span class="sc">-</span>y)</span>
<span id="cb71-3"><a href="#cb71-3" aria-hidden="true" tabindex="-1"></a>)</span>
<span id="cb71-4"><a href="#cb71-4" aria-hidden="true" tabindex="-1"></a><span class="fu">head</span>(predicciones)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>      id average_depth anomaly_score
   &lt;int&gt;         &lt;num&gt;         &lt;num&gt;
1:     1         9.816     0.5875006
2:     2         9.738     0.5899888
3:     3         9.528     0.5967405
4:     4         9.728     0.5903086
5:     5         9.860     0.5861016
6:     6         9.796     0.5881376</code></pre>
</div>
</div>
<div class="cell">
<div class="sourceCode cell-code" id="cb73"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb73-1"><a href="#cb73-1" aria-hidden="true" tabindex="-1"></a><span class="fu">ggplot</span>(<span class="at">data =</span> predicciones, <span class="fu">aes</span>(<span class="at">x =</span> average_depth)) <span class="sc">+</span></span>
<span id="cb73-2"><a href="#cb73-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_histogram</span>(<span class="at">color =</span> <span class="st">"gray40"</span>) <span class="sc">+</span></span>
<span id="cb73-3"><a href="#cb73-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_vline</span>(</span>
<span id="cb73-4"><a href="#cb73-4" aria-hidden="true" tabindex="-1"></a>    <span class="at">xintercept =</span> <span class="fu">quantile</span>(predicciones<span class="sc">$</span>average_depth, <span class="fu">seq</span>(<span class="dv">0</span>, <span class="dv">1</span>, <span class="fl">0.1</span>)),</span>
<span id="cb73-5"><a href="#cb73-5" aria-hidden="true" tabindex="-1"></a>    <span class="at">color      =</span> <span class="st">"red"</span>,</span>
<span id="cb73-6"><a href="#cb73-6" aria-hidden="true" tabindex="-1"></a>    <span class="at">linetype   =</span> <span class="st">"dashed"</span>) <span class="sc">+</span></span>
<span id="cb73-7"><a href="#cb73-7" aria-hidden="true" tabindex="-1"></a>  <span class="fu">labs</span>(</span>
<span id="cb73-8"><a href="#cb73-8" aria-hidden="true" tabindex="-1"></a>    <span class="at">title =</span> <span class="st">"Distribución de las distancias medias del Isolation Forest"</span>,</span>
<span id="cb73-9"><a href="#cb73-9" aria-hidden="true" tabindex="-1"></a>    <span class="at">subtitle =</span> <span class="st">"Cuantiles marcados en rojo"</span>  ) <span class="sc">+</span></span>
<span id="cb73-10"><a href="#cb73-10" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme_bw</span>() <span class="sc">+</span></span>
<span id="cb73-11"><a href="#cb73-11" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme</span>(<span class="at">plot.title =</span> <span class="fu">element_text</span>(<span class="at">size =</span> <span class="dv">11</span>))</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<div>
<figure class="figure">
<p><img src="AdvancedPreprocessing_files/figure-html/plot_isolationForest-1.png" class="img-fluid figure-img" width="672"></p>
</figure>
</div>
</div>
<div class="sourceCode cell-code" id="cb74"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb74-1"><a href="#cb74-1" aria-hidden="true" tabindex="-1"></a>cuantiles <span class="ot">&lt;-</span> <span class="fu">quantile</span>(<span class="at">x =</span> predicciones<span class="sc">$</span>average_depth, <span class="at">probs =</span> <span class="fu">seq</span>(<span class="dv">0</span>, <span class="dv">1</span>, <span class="fl">0.05</span>))</span>
<span id="cb74-2"><a href="#cb74-2" aria-hidden="true" tabindex="-1"></a>cuantiles</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>   0%    5%   10%   15%   20%   25%   30%   35%   40%   45%   50%   55%   60% 
7.556 8.952 9.264 9.451 9.548 9.629 9.694 9.744 9.790 9.824 9.852 9.870 9.888 
  65%   70%   75%   80%   85%   90%   95%  100% 
9.904 9.920 9.934 9.948 9.958 9.970 9.980 9.998 </code></pre>
</div>
</div>
</section>
<section id="tips-detección-de-anomalías" class="level2" data-number="2.11">
<h2 data-number="2.11" class="anchored" data-anchor-id="tips-detección-de-anomalías"><span class="header-section-number">2.11</span> TIPS: Detección de anomalías</h2>
<p>Una vez que la distancia de separación ha sido calculado, se puede emplear como criterio para identificar anomalías. Asumiendo que las observaciones con valores atípicos en una o más de sus variables se separan del resto con mayor facilidad, aquellas observaciones con menor distancia promedio deberían ser las más atípicas.</p>
<p>En la práctica, si se está empleando esta estrategia de detección es porque no se dispone de datos etiquetados, es decir, no se conoce qué observaciones son realmente anomalías. Sin embargo, como en este ejemplo se dispone de la clasificación real, se puede verificar si realmente los datos anómalos tienen menores distancias.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb76"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb76-1"><a href="#cb76-1" aria-hidden="true" tabindex="-1"></a>datos <span class="ot">&lt;-</span> datos <span class="sc">%&gt;%</span></span>
<span id="cb76-2"><a href="#cb76-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">bind_cols</span>(predicciones)</span>
<span id="cb76-3"><a href="#cb76-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb76-4"><a href="#cb76-4" aria-hidden="true" tabindex="-1"></a><span class="fu">ggplot</span>(<span class="at">data =</span> datos,</span>
<span id="cb76-5"><a href="#cb76-5" aria-hidden="true" tabindex="-1"></a>       <span class="fu">aes</span>(<span class="at">x =</span> y, <span class="at">y =</span> average_depth)) <span class="sc">+</span></span>
<span id="cb76-6"><a href="#cb76-6" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_jitter</span>(<span class="fu">aes</span>(<span class="at">color =</span> y), <span class="at">width =</span> <span class="fl">0.03</span>, <span class="at">alpha =</span> <span class="fl">0.3</span>) <span class="sc">+</span> </span>
<span id="cb76-7"><a href="#cb76-7" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_violin</span>(<span class="at">alpha =</span> <span class="dv">0</span>) <span class="sc">+</span></span>
<span id="cb76-8"><a href="#cb76-8" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_boxplot</span>(<span class="at">width =</span> <span class="fl">0.2</span>, <span class="at">outlier.shape =</span> <span class="cn">NA</span>, <span class="at">alpha =</span> <span class="dv">0</span>) <span class="sc">+</span></span>
<span id="cb76-9"><a href="#cb76-9" aria-hidden="true" tabindex="-1"></a>  <span class="fu">stat_summary</span>(<span class="at">fun =</span> <span class="st">"mean"</span>, <span class="at">colour =</span> <span class="st">"orangered2"</span>, <span class="at">size =</span> <span class="dv">3</span>, <span class="at">geom =</span> <span class="st">"point"</span>) <span class="sc">+</span></span>
<span id="cb76-10"><a href="#cb76-10" aria-hidden="true" tabindex="-1"></a>  <span class="fu">labs</span>(<span class="at">title =</span> <span class="st">"Distancia promedio en el modelo Isolation Forest"</span>,</span>
<span id="cb76-11"><a href="#cb76-11" aria-hidden="true" tabindex="-1"></a>       <span class="at">x =</span> <span class="st">"clasificación (0 = normal, 1 = anomalía)"</span>,</span>
<span id="cb76-12"><a href="#cb76-12" aria-hidden="true" tabindex="-1"></a>       <span class="at">y =</span> <span class="st">"Distancia promedio"</span>) <span class="sc">+</span></span>
<span id="cb76-13"><a href="#cb76-13" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme_bw</span>() <span class="sc">+</span> </span>
<span id="cb76-14"><a href="#cb76-14" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme</span>(<span class="at">legend.position =</span> <span class="st">"none"</span>,</span>
<span id="cb76-15"><a href="#cb76-15" aria-hidden="true" tabindex="-1"></a>        <span class="at">plot.title =</span> <span class="fu">element_text</span>(<span class="at">size =</span> <span class="dv">11</span>)</span>
<span id="cb76-16"><a href="#cb76-16" aria-hidden="true" tabindex="-1"></a>  )</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<div>
<figure class="figure">
<p><img src="AdvancedPreprocessing_files/figure-html/plot_deteccionAnomalias-1.png" class="img-fluid figure-img" width="672"></p>
</figure>
</div>
</div>
</div>
<p>La distancia promedio en el grupo de las anomalías (1) es claramente inferior. Sin embargo, al existir solapamiento, si se clasifican las n observaciones con menor distancia como anomalías, se incurriría en errores de falsos positivos.</p>
<p>Acorde a la documentación, el set de datos Cardiotocogrpahy contiene 176 anomalías. Véase la matriz de confusión resultante si se clasifican como anomalías las 176 observaciones con menor distancia predicha.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb77"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb77-1"><a href="#cb77-1" aria-hidden="true" tabindex="-1"></a>resultados <span class="ot">&lt;-</span> datos <span class="sc">%&gt;%</span></span>
<span id="cb77-2"><a href="#cb77-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">select</span>(y, average_depth) <span class="sc">%&gt;%</span></span>
<span id="cb77-3"><a href="#cb77-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">arrange</span>(average_depth) <span class="sc">%&gt;%</span></span>
<span id="cb77-4"><a href="#cb77-4" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">clasificacion =</span> <span class="fu">if_else</span>(average_depth <span class="sc">&lt;=</span> <span class="fl">8.5</span>, <span class="st">"1"</span>, <span class="st">"0"</span>))</span>
<span id="cb77-5"><a href="#cb77-5" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb77-6"><a href="#cb77-6" aria-hidden="true" tabindex="-1"></a>mat_confusion <span class="ot">&lt;-</span> MLmetrics<span class="sc">::</span><span class="fu">ConfusionMatrix</span>(</span>
<span id="cb77-7"><a href="#cb77-7" aria-hidden="true" tabindex="-1"></a>  <span class="at">y_pred =</span> resultados<span class="sc">$</span>clasificacion,</span>
<span id="cb77-8"><a href="#cb77-8" aria-hidden="true" tabindex="-1"></a>  <span class="at">y_true =</span> resultados<span class="sc">$</span>y)</span>
<span id="cb77-9"><a href="#cb77-9" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb77-10"><a href="#cb77-10" aria-hidden="true" tabindex="-1"></a>mat_confusion</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>      y_pred
y_true    0    1
     0 1638   17
     1  158   18</code></pre>
</div>
</div>
</section>
</section>
<section id="imputation-methods" class="level1" data-number="3">
<h1 data-number="3"><span class="header-section-number">3</span> Imputation Methods</h1>
<section id="generate-data-with-nas" class="level2" data-number="3.1">
<h2 data-number="3.1" class="anchored" data-anchor-id="generate-data-with-nas"><span class="header-section-number">3.1</span> Generate data with NA’s</h2>
<div class="cell">
<div class="sourceCode cell-code" id="cb79"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb79-1"><a href="#cb79-1" aria-hidden="true" tabindex="-1"></a><span class="fu">colSums</span>(<span class="fu">is.na</span>(iris))</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>Sepal.Length  Sepal.Width Petal.Length  Petal.Width      Species 
           0            0            0            0            0 </code></pre>
</div>
<div class="sourceCode cell-code" id="cb81"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb81-1"><a href="#cb81-1" aria-hidden="true" tabindex="-1"></a>iris.mis <span class="ot">&lt;-</span> missForest<span class="sc">::</span><span class="fu">prodNA</span>(iris, <span class="at">noNA =</span> <span class="fl">0.1</span>)</span>
<span id="cb81-2"><a href="#cb81-2" aria-hidden="true" tabindex="-1"></a><span class="fu">colSums</span>((<span class="fu">is.na</span>(iris.mis)))</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>Sepal.Length  Sepal.Width Petal.Length  Petal.Width      Species 
          12           15           16           16           16 </code></pre>
</div>
</div>
<p>Otra forma de crear missings en el dataframe</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb83"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb83-1"><a href="#cb83-1" aria-hidden="true" tabindex="-1"></a>iris.mis <span class="ot">&lt;-</span> mi<span class="sc">::</span><span class="fu">create.missing</span>(iris, <span class="at">pct.mis =</span> <span class="dv">10</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
</section>
<section id="little-test" class="level2" data-number="3.2">
<h2 data-number="3.2" class="anchored" data-anchor-id="little-test"><span class="header-section-number">3.2</span> Little Test</h2>
<p>Es un test que nos permite detectar con que tipo de NA’s estamos enfrente:</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb84"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb84-1"><a href="#cb84-1" aria-hidden="true" tabindex="-1"></a>naniar<span class="sc">::</span><span class="fu">mcar_test</span>(iris.mis)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<p>Si el valor p de la prova és inferior a 0 això vol dir que les dades amb NAs s’han generat aleatòriament.</p>
</section>
<section id="patrons-descriptius-de-na-en-una-base-de-dades" class="level2" data-number="3.3">
<h2 data-number="3.3" class="anchored" data-anchor-id="patrons-descriptius-de-na-en-una-base-de-dades"><span class="header-section-number">3.3</span> Patrons descriptius de NA en una base de dades</h2>
<section id="explorar-les-relacions-de-nas" class="level3" data-number="3.3.1">
<h3 data-number="3.3.1" class="anchored" data-anchor-id="explorar-les-relacions-de-nas"><span class="header-section-number">3.3.1</span> Explorar les relacions de NA’s</h3>
<div class="cell">
<div class="sourceCode cell-code" id="cb85"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb85-1"><a href="#cb85-1" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(visdat)</span>
<span id="cb85-2"><a href="#cb85-2" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(ggplot2)</span>
<span id="cb85-3"><a href="#cb85-3" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(naniar)</span>
<span id="cb85-4"><a href="#cb85-4" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb85-5"><a href="#cb85-5" aria-hidden="true" tabindex="-1"></a><span class="fu">vis_dat</span>(airquality);</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<div>
<figure class="figure">
<p><img src="AdvancedPreprocessing_files/figure-html/vis_na_total-1.png" class="img-fluid figure-img" width="672"></p>
</figure>
</div>
</div>
<div class="sourceCode cell-code" id="cb86"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb86-1"><a href="#cb86-1" aria-hidden="true" tabindex="-1"></a><span class="fu">vis_dat</span>(iris.mis)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<div>
<figure class="figure">
<p><img src="AdvancedPreprocessing_files/figure-html/vis_na_total-2.png" class="img-fluid figure-img" width="672"></p>
</figure>
</div>
</div>
<div class="sourceCode cell-code" id="cb87"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb87-1"><a href="#cb87-1" aria-hidden="true" tabindex="-1"></a><span class="fu">vis_miss</span>(airquality);</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<div>
<figure class="figure">
<p><img src="AdvancedPreprocessing_files/figure-html/vis_na_total-3.png" class="img-fluid figure-img" width="672"></p>
</figure>
</div>
</div>
<div class="sourceCode cell-code" id="cb88"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb88-1"><a href="#cb88-1" aria-hidden="true" tabindex="-1"></a><span class="fu">vis_miss</span>(iris.mis)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<div>
<figure class="figure">
<p><img src="AdvancedPreprocessing_files/figure-html/vis_na_total-4.png" class="img-fluid figure-img" width="672"></p>
</figure>
</div>
</div>
<div class="sourceCode cell-code" id="cb89"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb89-1"><a href="#cb89-1" aria-hidden="true" tabindex="-1"></a><span class="fu">ggplot</span>(airquality, <span class="fu">aes</span>(<span class="at">x =</span> Solar.R,<span class="at">y =</span> Ozone)) <span class="sc">+</span> </span>
<span id="cb89-2"><a href="#cb89-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_point</span>()</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<div>
<figure class="figure">
<p><img src="AdvancedPreprocessing_files/figure-html/vis_na_total-5.png" class="img-fluid figure-img" width="672"></p>
</figure>
</div>
</div>
<div class="sourceCode cell-code" id="cb90"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb90-1"><a href="#cb90-1" aria-hidden="true" tabindex="-1"></a><span class="fu">ggplot</span>(airquality, <span class="fu">aes</span>(<span class="at">x =</span> Solar.R,  <span class="at">y =</span> Ozone)) <span class="sc">+</span> </span>
<span id="cb90-2"><a href="#cb90-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_miss_point</span>()</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<div>
<figure class="figure">
<p><img src="AdvancedPreprocessing_files/figure-html/vis_na_total-6.png" class="img-fluid figure-img" width="672"></p>
</figure>
</div>
</div>
<div class="sourceCode cell-code" id="cb91"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb91-1"><a href="#cb91-1" aria-hidden="true" tabindex="-1"></a><span class="fu">ggplot</span>(airquality, <span class="fu">aes</span>(<span class="at">x =</span> Solar.R, <span class="at">y =</span> Ozone)) <span class="sc">+</span> </span>
<span id="cb91-2"><a href="#cb91-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_miss_point</span>() <span class="sc">+</span> </span>
<span id="cb91-3"><a href="#cb91-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">facet_wrap</span>(<span class="sc">~</span>Month)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<div>
<figure class="figure">
<p><img src="AdvancedPreprocessing_files/figure-html/vis_na_total-7.png" class="img-fluid figure-img" width="672"></p>
</figure>
</div>
</div>
<div class="sourceCode cell-code" id="cb92"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb92-1"><a href="#cb92-1" aria-hidden="true" tabindex="-1"></a><span class="fu">ggplot</span>(airquality, <span class="fu">aes</span>(<span class="at">x =</span> Solar.R, <span class="at">y =</span> Ozone)) <span class="sc">+</span> </span>
<span id="cb92-2"><a href="#cb92-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_miss_point</span>() <span class="sc">+</span> </span>
<span id="cb92-3"><a href="#cb92-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">facet_wrap</span>(<span class="sc">~</span>Month) <span class="sc">+</span> </span>
<span id="cb92-4"><a href="#cb92-4" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme_dark</span>()</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<div>
<figure class="figure">
<p><img src="AdvancedPreprocessing_files/figure-html/vis_na_total-8.png" class="img-fluid figure-img" width="672"></p>
</figure>
</div>
</div>
</div>
</section>
<section id="visualització-dels-nas-per-variables" class="level3" data-number="3.3.2">
<h3 data-number="3.3.2" class="anchored" data-anchor-id="visualització-dels-nas-per-variables"><span class="header-section-number">3.3.2</span> Visualització dels NA’s per variables</h3>
<div class="cell">
<div class="sourceCode cell-code" id="cb93"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb93-1"><a href="#cb93-1" aria-hidden="true" tabindex="-1"></a><span class="fu">gg_miss_var</span>(airquality) <span class="sc">+</span> <span class="fu">labs</span>(<span class="at">y =</span> <span class="st">"Look at all the missing ones"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<div>
<figure class="figure">
<p><img src="AdvancedPreprocessing_files/figure-html/vis_na_variables-1.png" class="img-fluid figure-img" width="672"></p>
</figure>
</div>
</div>
</div>
</section>
<section id="detecció-de-nas-en-la-base-de-dades" class="level3" data-number="3.3.3">
<h3 data-number="3.3.3" class="anchored" data-anchor-id="detecció-de-nas-en-la-base-de-dades"><span class="header-section-number">3.3.3</span> Detecció de NA’s en la base de dades</h3>
<div class="cell">
<div class="sourceCode cell-code" id="cb94"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb94-1"><a href="#cb94-1" aria-hidden="true" tabindex="-1"></a>aq_shadow <span class="ot">&lt;-</span> <span class="fu">bind_shadow</span>(airquality)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<p>Imprimeix el gràfic amb diferència a les NA i no a les NA,</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb95"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb95-1"><a href="#cb95-1" aria-hidden="true" tabindex="-1"></a>airquality <span class="sc">%&gt;%</span></span>
<span id="cb95-2"><a href="#cb95-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">bind_shadow</span>() <span class="sc">%&gt;%</span></span>
<span id="cb95-3"><a href="#cb95-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">group_by</span>(Ozone_NA) <span class="sc">%&gt;%</span></span>
<span id="cb95-4"><a href="#cb95-4" aria-hidden="true" tabindex="-1"></a>  <span class="fu">summarise_at</span>(<span class="at">.vars =</span> <span class="st">"Solar.R"</span>,</span>
<span id="cb95-5"><a href="#cb95-5" aria-hidden="true" tabindex="-1"></a>               <span class="at">.funs =</span> <span class="fu">c</span>(<span class="st">"mean"</span>, <span class="st">"sd"</span>, <span class="st">"var"</span>, <span class="st">"min"</span>, <span class="st">"max"</span>),</span>
<span id="cb95-6"><a href="#cb95-6" aria-hidden="true" tabindex="-1"></a>               <span class="at">na.rm =</span> <span class="cn">TRUE</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code># A tibble: 2 × 6
  Ozone_NA  mean    sd   var   min   max
  &lt;fct&gt;    &lt;dbl&gt; &lt;dbl&gt; &lt;dbl&gt; &lt;int&gt; &lt;int&gt;
1 !NA       185.  91.2 8309.     7   334
2 NA        190.  87.7 7690.    31   332</code></pre>
</div>
<div class="sourceCode cell-code" id="cb97"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb97-1"><a href="#cb97-1" aria-hidden="true" tabindex="-1"></a><span class="fu">ggplot</span>(aq_shadow,</span>
<span id="cb97-2"><a href="#cb97-2" aria-hidden="true" tabindex="-1"></a>       <span class="fu">aes</span>(<span class="at">x =</span> Temp,</span>
<span id="cb97-3"><a href="#cb97-3" aria-hidden="true" tabindex="-1"></a>           <span class="at">colour =</span> Ozone_NA)) <span class="sc">+</span> </span>
<span id="cb97-4"><a href="#cb97-4" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_density</span>()</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<div>
<figure class="figure">
<p><img src="AdvancedPreprocessing_files/figure-html/grafico_detec_na-1.png" class="img-fluid figure-img" width="672"></p>
</figure>
</div>
</div>
</div>
</section>
<section id="extreu-estadístiques-amb-nas-de-la-base-de-dades" class="level3" data-number="3.3.4">
<h3 data-number="3.3.4" class="anchored" data-anchor-id="extreu-estadístiques-amb-nas-de-la-base-de-dades"><span class="header-section-number">3.3.4</span> Extreu estadístiques amb NAs de la base de dades</h3>
<div class="cell">
<div class="sourceCode cell-code" id="cb98"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb98-1"><a href="#cb98-1" aria-hidden="true" tabindex="-1"></a><span class="fu">prop_miss_case</span>(airquality)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>[1] 0.2745098</code></pre>
</div>
<div class="sourceCode cell-code" id="cb100"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb100-1"><a href="#cb100-1" aria-hidden="true" tabindex="-1"></a><span class="fu">pct_miss_case</span>(airquality)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>[1] 27.45098</code></pre>
</div>
<div class="sourceCode cell-code" id="cb102"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb102-1"><a href="#cb102-1" aria-hidden="true" tabindex="-1"></a><span class="fu">miss_case_summary</span>(airquality)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code># A tibble: 153 × 3
    case n_miss pct_miss
   &lt;int&gt;  &lt;int&gt;    &lt;dbl&gt;
 1     5      2     33.3
 2    27      2     33.3
 3     6      1     16.7
 4    10      1     16.7
 5    11      1     16.7
 6    25      1     16.7
 7    26      1     16.7
 8    32      1     16.7
 9    33      1     16.7
10    34      1     16.7
# ℹ 143 more rows</code></pre>
</div>
<div class="sourceCode cell-code" id="cb104"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb104-1"><a href="#cb104-1" aria-hidden="true" tabindex="-1"></a><span class="fu">miss_case_table</span>(airquality)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code># A tibble: 3 × 3
  n_miss_in_case n_cases pct_cases
           &lt;int&gt;   &lt;int&gt;     &lt;dbl&gt;
1              0     111     72.5 
2              1      40     26.1 
3              2       2      1.31</code></pre>
</div>
<div class="sourceCode cell-code" id="cb106"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb106-1"><a href="#cb106-1" aria-hidden="true" tabindex="-1"></a><span class="fu">prop_miss_var</span>(airquality)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>[1] 0.3333333</code></pre>
</div>
<div class="sourceCode cell-code" id="cb108"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb108-1"><a href="#cb108-1" aria-hidden="true" tabindex="-1"></a><span class="fu">pct_miss_var</span>(airquality)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>[1] 33.33333</code></pre>
</div>
<div class="sourceCode cell-code" id="cb110"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb110-1"><a href="#cb110-1" aria-hidden="true" tabindex="-1"></a><span class="fu">miss_var_summary</span>(airquality)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code># A tibble: 6 × 3
  variable n_miss pct_miss
  &lt;chr&gt;     &lt;int&gt;    &lt;num&gt;
1 Ozone        37    24.2 
2 Solar.R       7     4.58
3 Wind          0     0   
4 Temp          0     0   
5 Month         0     0   
6 Day           0     0   </code></pre>
</div>
<div class="sourceCode cell-code" id="cb112"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb112-1"><a href="#cb112-1" aria-hidden="true" tabindex="-1"></a><span class="fu">miss_var_table</span>(airquality)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code># A tibble: 3 × 3
  n_miss_in_var n_vars pct_vars
          &lt;int&gt;  &lt;int&gt;    &lt;dbl&gt;
1             0      4     66.7
2             7      1     16.7
3            37      1     16.7</code></pre>
</div>
</div>
</section>
</section>
<section id="imputació-bàsica" class="level2" data-number="3.4">
<h2 data-number="3.4" class="anchored" data-anchor-id="imputació-bàsica"><span class="header-section-number">3.4</span> Imputació bàsica</h2>
<section id="imputar-amb-valor-mitjà" class="level3" data-number="3.4.1">
<h3 data-number="3.4.1" class="anchored" data-anchor-id="imputar-amb-valor-mitjà"><span class="header-section-number">3.4.1</span> Imputar amb valor mitjà</h3>
<div class="cell">
<div class="sourceCode cell-code" id="cb114"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb114-1"><a href="#cb114-1" aria-hidden="true" tabindex="-1"></a>iris.mis[, <span class="st">"imputed_Sepal.Length"</span>] <span class="ot">&lt;-</span> <span class="fu">with</span>(iris.mis, Hmisc<span class="sc">::</span><span class="fu">impute</span>(Sepal.Length, mean))</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
</section>
</section>
</section>
<section id="imputar-amb-valor-aleatori" class="level1" data-number="4">
<h1 data-number="4"><span class="header-section-number">4</span> Imputar amb valor aleatori</h1>
<div class="cell">
<div class="sourceCode cell-code" id="cb115"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb115-1"><a href="#cb115-1" aria-hidden="true" tabindex="-1"></a>iris.mis[, <span class="st">"imputed_Sepal.Length2"</span>] <span class="ot">&lt;-</span> <span class="fu">with</span>(iris.mis, Hmisc<span class="sc">::</span><span class="fu">impute</span>(Sepal.Length, <span class="st">'random'</span>))</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<p>De manera similar podeu utilitzar la mediana min, max, per imputar el valor que manca.</p>
<section id="representa-la-distribució-a-variables-reals-i-dimputació-a-través-del-gráfico-de-densidad-con-ggplot2" class="level3" data-number="4.0.1">
<h3 data-number="4.0.1" class="anchored" data-anchor-id="representa-la-distribució-a-variables-reals-i-dimputació-a-través-del-gráfico-de-densidad-con-ggplot2"><span class="header-section-number">4.0.1</span> Representa la distribució a variables reals i d’imputació a través del gráfico de densidad con ggplot2</h3>
<div class="cell">
<div class="sourceCode cell-code" id="cb116"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb116-1"><a href="#cb116-1" aria-hidden="true" tabindex="-1"></a>df_long <span class="ot">&lt;-</span> iris.mis <span class="sc">%&gt;%</span></span>
<span id="cb116-2"><a href="#cb116-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">select</span>(Sepal.Length, imputed_Sepal.Length, imputed_Sepal.Length2) <span class="sc">%&gt;%</span></span>
<span id="cb116-3"><a href="#cb116-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">pivot_longer</span>(<span class="at">cols =</span> <span class="fu">everything</span>(), <span class="at">names_to =</span> <span class="st">"Variable"</span>, <span class="at">values_to =</span> <span class="st">"Valor"</span>)</span>
<span id="cb116-4"><a href="#cb116-4" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb116-5"><a href="#cb116-5" aria-hidden="true" tabindex="-1"></a><span class="fu">ggplot</span>(df_long, <span class="fu">aes</span>(<span class="at">x =</span> Valor, <span class="at">fill =</span> Variable)) <span class="sc">+</span></span>
<span id="cb116-6"><a href="#cb116-6" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_density</span>(<span class="at">alpha =</span> <span class="fl">0.3</span>) <span class="sc">+</span>  <span class="co"># Transparencia para mejor visualización</span></span>
<span id="cb116-7"><a href="#cb116-7" aria-hidden="true" tabindex="-1"></a>  <span class="fu">labs</span>(<span class="at">title =</span> <span class="st">"Densidad de las tres variables"</span>,</span>
<span id="cb116-8"><a href="#cb116-8" aria-hidden="true" tabindex="-1"></a>       <span class="at">x =</span> <span class="st">"Valor"</span>,</span>
<span id="cb116-9"><a href="#cb116-9" aria-hidden="true" tabindex="-1"></a>       <span class="at">y =</span> <span class="st">"Densidad"</span>) <span class="sc">+</span></span>
<span id="cb116-10"><a href="#cb116-10" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme_minimal</span>() <span class="sc">+</span></span>
<span id="cb116-11"><a href="#cb116-11" aria-hidden="true" tabindex="-1"></a>  <span class="fu">scale_fill_manual</span>(<span class="at">values =</span> <span class="fu">c</span>(<span class="st">"blue"</span>, <span class="st">"red"</span>, <span class="st">"green"</span>))</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<div>
<figure class="figure">
<p><img src="AdvancedPreprocessing_files/figure-html/grafico_imputacion-1.png" class="img-fluid figure-img" width="672"></p>
</figure>
</div>
</div>
<div class="sourceCode cell-code" id="cb117"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb117-1"><a href="#cb117-1" aria-hidden="true" tabindex="-1"></a>iris.mis[, <span class="fu">c</span>(<span class="st">"imputed_Sepal.Length"</span>, <span class="st">"imputed_Sepal.Length2"</span>)] <span class="ot">&lt;-</span> <span class="cn">NULL</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<p>Otra forma es usando el paquete <code>argImpute</code>.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb118"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb118-1"><a href="#cb118-1" aria-hidden="true" tabindex="-1"></a>(impute_arg <span class="ot">&lt;-</span> Hmisc<span class="sc">::</span><span class="fu">aregImpute</span>(<span class="sc">~</span> Sepal.Length <span class="sc">+</span> Sepal.Width <span class="sc">+</span> Petal.Length <span class="sc">+</span> Petal.Width <span class="sc">+</span></span>
<span id="cb118-2"><a href="#cb118-2" aria-hidden="true" tabindex="-1"></a>                           Species, <span class="at">data =</span> iris.mis, <span class="at">n.impute =</span> <span class="dv">5</span>))</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>Iteration 1 
Iteration 2 
Iteration 3 
Iteration 4 
Iteration 5 
Iteration 6 
Iteration 7 
Iteration 8 </code></pre>
</div>
<div class="cell-output cell-output-stdout">
<pre><code>
Multiple Imputation using Bootstrap and PMM

Hmisc::aregImpute(formula = ~Sepal.Length + Sepal.Width + Petal.Length + 
    Petal.Width + Species, data = iris.mis, n.impute = 5)

n: 150  p: 5    Imputations: 5      nk: 3 

Number of NAs:
Sepal.Length  Sepal.Width Petal.Length  Petal.Width      Species 
          12           15           16           16           16 

             type d.f.
Sepal.Length    s    2
Sepal.Width     s    2
Petal.Length    s    2
Petal.Width     s    2
Species         c    2

Transformation of Target Variables Forced to be Linear

R-squares for Predicting Non-Missing Values for Each Variable
Using Last Imputations of Predictors
Sepal.Length  Sepal.Width Petal.Length  Petal.Width      Species 
       0.825        0.632        0.982        0.974        0.990 </code></pre>
</div>
</div>
<p>Revisamos la variable <code>Sepal.Length</code> con la imputación realizada en cada una de las rondas.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb121"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb121-1"><a href="#cb121-1" aria-hidden="true" tabindex="-1"></a>impute_arg<span class="sc">$</span>imputed<span class="sc">$</span>Sepal.Length</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>    [,1] [,2] [,3] [,4] [,5]
6    5.8  5.1  4.6  5.1  5.0
52   5.8  6.1  6.0  6.7  6.5
61   5.1  5.1  5.7  5.0  5.4
62   6.0  5.6  6.3  5.8  6.3
74   6.7  5.6  5.8  6.4  5.6
81   5.2  6.0  5.5  5.1  5.2
116  6.1  6.1  6.0  6.3  6.3
118  5.1  5.1  7.7  7.7  7.7
132  7.6  7.6  7.2  7.7  7.3
133  6.0  6.7  6.9  6.9  6.8
136  6.3  7.2  6.9  6.8  6.7
138  6.5  6.3  6.3  6.9  6.7</code></pre>
</div>
</div>
<p>Calculamos la media para las 5 simulaciones.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb123"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb123-1"><a href="#cb123-1" aria-hidden="true" tabindex="-1"></a>imputed_Sepal.Length <span class="ot">&lt;-</span> <span class="fu">rowMeans</span>(impute_arg<span class="sc">$</span>imputed<span class="sc">$</span>Sepal.Length)</span>
<span id="cb123-2"><a href="#cb123-2" aria-hidden="true" tabindex="-1"></a>new_var_imputed <span class="ot">&lt;-</span> iris<span class="sc">$</span>Sepal.Length</span>
<span id="cb123-3"><a href="#cb123-3" aria-hidden="true" tabindex="-1"></a>new_var_imputed[<span class="fu">as.numeric</span>(<span class="fu">names</span>(imputed_Sepal.Length))] <span class="ot">&lt;-</span> imputed_Sepal.Length</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<p>Revisamos la diferencia entre las dos imputaciones.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb124"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb124-1"><a href="#cb124-1" aria-hidden="true" tabindex="-1"></a>newBD <span class="ot">&lt;-</span> <span class="fu">data.frame</span>(<span class="at">real =</span> iris[, <span class="st">"Sepal.Length"</span>], <span class="at">imputed =</span> new_var_imputed)</span>
<span id="cb124-2"><a href="#cb124-2" aria-hidden="true" tabindex="-1"></a>df_long <span class="ot">&lt;-</span> newBD <span class="sc">%&gt;%</span></span>
<span id="cb124-3"><a href="#cb124-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">pivot_longer</span>(<span class="at">cols =</span> <span class="fu">everything</span>(), <span class="at">names_to =</span> <span class="st">"Variable"</span>, <span class="at">values_to =</span> <span class="st">"Valor"</span>)</span>
<span id="cb124-4"><a href="#cb124-4" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb124-5"><a href="#cb124-5" aria-hidden="true" tabindex="-1"></a><span class="fu">ggplot</span>(df_long, <span class="fu">aes</span>(<span class="at">x =</span> Valor, <span class="at">fill =</span> Variable)) <span class="sc">+</span></span>
<span id="cb124-6"><a href="#cb124-6" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_density</span>(<span class="at">alpha =</span> <span class="fl">0.3</span>) <span class="sc">+</span>  <span class="co"># Transparencia para mejor visualización</span></span>
<span id="cb124-7"><a href="#cb124-7" aria-hidden="true" tabindex="-1"></a>  <span class="fu">labs</span>(<span class="at">title =</span> <span class="st">"Densidad de las tres variables"</span>,</span>
<span id="cb124-8"><a href="#cb124-8" aria-hidden="true" tabindex="-1"></a>       <span class="at">x =</span> <span class="st">"Valor"</span>,</span>
<span id="cb124-9"><a href="#cb124-9" aria-hidden="true" tabindex="-1"></a>       <span class="at">y =</span> <span class="st">"Densidad"</span>) <span class="sc">+</span></span>
<span id="cb124-10"><a href="#cb124-10" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme_minimal</span>() <span class="sc">+</span></span>
<span id="cb124-11"><a href="#cb124-11" aria-hidden="true" tabindex="-1"></a>  <span class="fu">scale_fill_manual</span>(<span class="at">values =</span> <span class="fu">c</span>(<span class="st">"blue"</span>, <span class="st">"red"</span>))</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<div>
<figure class="figure">
<p><img src="AdvancedPreprocessing_files/figure-html/grafico_media_simulaciones-1.png" class="img-fluid figure-img" width="672"></p>
</figure>
</div>
</div>
</div>
</section>
<section id="multiple-iterative-regression-imputation-mi-method" class="level2" data-number="4.1">
<h2 data-number="4.1" class="anchored" data-anchor-id="multiple-iterative-regression-imputation-mi-method"><span class="header-section-number">4.1</span> Multiple Iterative Regression Imputation (MI method)</h2>
<p>Imputamos los valores NA’s con mi</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb125"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb125-1"><a href="#cb125-1" aria-hidden="true" tabindex="-1"></a>mi_data <span class="ot">&lt;-</span> mi<span class="sc">::</span><span class="fu">mi</span>(iris.mis, <span class="at">seed =</span> <span class="dv">335</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<p>Revisamos la información de las imputaciones.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb126"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb126-1"><a href="#cb126-1" aria-hidden="true" tabindex="-1"></a><span class="fu">summary</span>(mi_data)</span>
<span id="cb126-2"><a href="#cb126-2" aria-hidden="true" tabindex="-1"></a><span class="fu">plot</span>(mi_data)</span>
<span id="cb126-3"><a href="#cb126-3" aria-hidden="true" tabindex="-1"></a><span class="fu">par</span>(<span class="at">ask =</span> <span class="cn">FALSE</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<p>Revisamos las interaciones de la base de datos</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb127"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb127-1"><a href="#cb127-1" aria-hidden="true" tabindex="-1"></a>mi_data<span class="sc">@</span>data</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
</section>
<section id="media-con-una-variable-target" class="level2" data-number="4.2">
<h2 data-number="4.2" class="anchored" data-anchor-id="media-con-una-variable-target"><span class="header-section-number">4.2</span> Media con una variable target</h2>
<p>Definimos la variable target</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb128"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb128-1"><a href="#cb128-1" aria-hidden="true" tabindex="-1"></a>target <span class="ot">=</span> <span class="st">"Species"</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<p>Definimos la base de datos con NA’s</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb129"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb129-1"><a href="#cb129-1" aria-hidden="true" tabindex="-1"></a>data <span class="ot">&lt;-</span> <span class="fu">subset</span>(iris, <span class="at">select =</span> <span class="sc">-</span><span class="fu">c</span>(<span class="fu">get</span>(target)))</span>
<span id="cb129-2"><a href="#cb129-2" aria-hidden="true" tabindex="-1"></a>data <span class="ot">&lt;-</span> missForest<span class="sc">::</span><span class="fu">prodNA</span>(data, <span class="at">noNA =</span> <span class="fl">0.1</span>)</span>
<span id="cb129-3"><a href="#cb129-3" aria-hidden="true" tabindex="-1"></a>data<span class="sc">$</span>Species <span class="ot">&lt;-</span> iris[, target]</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<p>Definir variables a imputar (excluyendo la variable target)</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb130"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb130-1"><a href="#cb130-1" aria-hidden="true" tabindex="-1"></a>varImp <span class="ot">&lt;-</span> <span class="fu">colnames</span>(data)[<span class="fu">which</span>(<span class="sc">!</span><span class="fu">colnames</span>(data) <span class="sc">%in%</span> target)]</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<p>Calcular las medias por grupo</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb131"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb131-1"><a href="#cb131-1" aria-hidden="true" tabindex="-1"></a>means <span class="ot">&lt;-</span> <span class="fu">aggregate</span>(data[, varImp], <span class="fu">list</span>(data[, target]), mean, <span class="at">na.rm =</span> <span class="cn">TRUE</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<p>Imputar valores faltantes</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb132"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb132-1"><a href="#cb132-1" aria-hidden="true" tabindex="-1"></a><span class="cf">for</span> (c <span class="cf">in</span> varImp) {</span>
<span id="cb132-2"><a href="#cb132-2" aria-hidden="true" tabindex="-1"></a>  <span class="cf">for</span> (g <span class="cf">in</span> means[, <span class="st">"Group.1"</span>]) {</span>
<span id="cb132-3"><a href="#cb132-3" aria-hidden="true" tabindex="-1"></a>    cond <span class="ot">&lt;-</span> data[, target] <span class="sc">==</span> g  <span class="co"># Condición booleana en vez de which()</span></span>
<span id="cb132-4"><a href="#cb132-4" aria-hidden="true" tabindex="-1"></a>    na_index <span class="ot">&lt;-</span> <span class="fu">is.na</span>(data[, c]) <span class="sc">&amp;</span> cond  <span class="co"># Seleccionar NA dentro del grupo</span></span>
<span id="cb132-5"><a href="#cb132-5" aria-hidden="true" tabindex="-1"></a>    </span>
<span id="cb132-6"><a href="#cb132-6" aria-hidden="true" tabindex="-1"></a>    <span class="co"># Asignar valores imputados</span></span>
<span id="cb132-7"><a href="#cb132-7" aria-hidden="true" tabindex="-1"></a>    data[na_index, c] <span class="ot">&lt;-</span> means[means[, <span class="st">"Group.1"</span>] <span class="sc">==</span> g, c]</span>
<span id="cb132-8"><a href="#cb132-8" aria-hidden="true" tabindex="-1"></a>  }</span>
<span id="cb132-9"><a href="#cb132-9" aria-hidden="true" tabindex="-1"></a>}</span>
<span id="cb132-10"><a href="#cb132-10" aria-hidden="true" tabindex="-1"></a><span class="fu">summary</span>(data)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>  Sepal.Length    Sepal.Width     Petal.Length    Petal.Width   
 Min.   :4.300   Min.   :2.000   Min.   :1.000   Min.   :0.100  
 1st Qu.:5.100   1st Qu.:2.800   1st Qu.:1.500   1st Qu.:0.300  
 Median :5.800   Median :3.000   Median :4.300   Median :1.326  
 Mean   :5.833   Mean   :3.034   Mean   :3.757   Mean   :1.202  
 3rd Qu.:6.400   3rd Qu.:3.300   3rd Qu.:5.100   3rd Qu.:1.800  
 Max.   :7.900   Max.   :4.100   Max.   :6.900   Max.   :2.500  
       Species  
 setosa    :50  
 versicolor:50  
 virginica :50  
                
                
                </code></pre>
</div>
</div>
<p>Visualizamos la diferencia entre las imputaciones</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb134"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb134-1"><a href="#cb134-1" aria-hidden="true" tabindex="-1"></a>iris[, <span class="st">"Tipo"</span>] <span class="ot">&lt;-</span> <span class="st">"original"</span></span>
<span id="cb134-2"><a href="#cb134-2" aria-hidden="true" tabindex="-1"></a>data[, <span class="st">"Tipo"</span>] <span class="ot">&lt;-</span> <span class="st">"imputed"</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<p>Unimos en un mismo dataframe</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb135"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb135-1"><a href="#cb135-1" aria-hidden="true" tabindex="-1"></a>data_long <span class="ot">&lt;-</span> <span class="fu">bind_rows</span>(iris, data)</span>
<span id="cb135-2"><a href="#cb135-2" aria-hidden="true" tabindex="-1"></a>cols_numeric <span class="ot">&lt;-</span> <span class="fu">names</span>(data_long)[<span class="fu">sapply</span>(data_long, is.numeric) <span class="sc">&amp;</span> <span class="fu">names</span>(data_long) <span class="sc">!=</span> <span class="st">"Tipo"</span>]</span>
<span id="cb135-3"><a href="#cb135-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb135-4"><a href="#cb135-4" aria-hidden="true" tabindex="-1"></a><span class="co"># Convert a large data</span></span>
<span id="cb135-5"><a href="#cb135-5" aria-hidden="true" tabindex="-1"></a>data_long <span class="ot">&lt;-</span> data_long <span class="sc">%&gt;%</span></span>
<span id="cb135-6"><a href="#cb135-6" aria-hidden="true" tabindex="-1"></a>  <span class="fu">pivot_longer</span>(<span class="at">cols =</span> <span class="fu">all_of</span>(cols_numeric), <span class="at">names_to =</span> <span class="st">"Variable"</span>, <span class="at">values_to =</span> <span class="st">"Valor"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<p>Creamos el gráfico con ggplot</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb136"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb136-1"><a href="#cb136-1" aria-hidden="true" tabindex="-1"></a><span class="fu">ggplot</span>(data_long, <span class="fu">aes</span>(<span class="at">x =</span> Valor, <span class="at">fill =</span> Tipo)) <span class="sc">+</span></span>
<span id="cb136-2"><a href="#cb136-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_density</span>(<span class="at">alpha =</span> <span class="fl">0.3</span>) <span class="sc">+</span>  <span class="co"># Transparencia para comparación</span></span>
<span id="cb136-3"><a href="#cb136-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">facet_wrap</span>(<span class="sc">~</span>Variable, <span class="at">scales =</span> <span class="st">"free"</span>) <span class="sc">+</span>  <span class="co"># Un gráfico por variable</span></span>
<span id="cb136-4"><a href="#cb136-4" aria-hidden="true" tabindex="-1"></a>  <span class="fu">labs</span>(<span class="at">title =</span> <span class="st">"Comparación de Distribuciones: Original vs Imputado"</span>,</span>
<span id="cb136-5"><a href="#cb136-5" aria-hidden="true" tabindex="-1"></a>       <span class="at">x =</span> <span class="st">"Valor"</span>,</span>
<span id="cb136-6"><a href="#cb136-6" aria-hidden="true" tabindex="-1"></a>       <span class="at">y =</span> <span class="st">"Densidad"</span>) <span class="sc">+</span></span>
<span id="cb136-7"><a href="#cb136-7" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme_minimal</span>() <span class="sc">+</span></span>
<span id="cb136-8"><a href="#cb136-8" aria-hidden="true" tabindex="-1"></a>  <span class="fu">scale_fill_manual</span>(<span class="at">values =</span> <span class="fu">c</span>(<span class="st">"blue"</span>, <span class="st">"red"</span>))</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<div>
<figure class="figure">
<p><img src="AdvancedPreprocessing_files/figure-html/unnamed-chunk-8-1.png" class="img-fluid figure-img" width="672"></p>
</figure>
</div>
</div>
</div>
<p>Removemos la tipologia de variable</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb137"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb137-1"><a href="#cb137-1" aria-hidden="true" tabindex="-1"></a>iris.mis[, <span class="st">"Tipo"</span>] <span class="ot">&lt;-</span> <span class="cn">NULL</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
</section>
<section id="multiple-imputation-by-chained-equations-mice" class="level2" data-number="4.3">
<h2 data-number="4.3" class="anchored" data-anchor-id="multiple-imputation-by-chained-equations-mice"><span class="header-section-number">4.3</span> Multiple Imputation by Chained Equations (MICE)</h2>
<p>Eliminamos las variables categoricas</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb138"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb138-1"><a href="#cb138-1" aria-hidden="true" tabindex="-1"></a>quiCat <span class="ot">&lt;-</span> <span class="fu">which</span>(<span class="fu">lapply</span>(iris.mis, class) <span class="sc">%in%</span> <span class="fu">c</span>(<span class="st">"character"</span>, <span class="st">"factor"</span>))</span>
<span id="cb138-2"><a href="#cb138-2" aria-hidden="true" tabindex="-1"></a>categories <span class="ot">&lt;-</span> <span class="fu">names</span>(iris.mis)[quiCat]</span>
<span id="cb138-3"><a href="#cb138-3" aria-hidden="true" tabindex="-1"></a>iris.mis2 <span class="ot">&lt;-</span> <span class="fu">subset</span>(iris.mis, <span class="at">select =</span> <span class="sc">-</span><span class="fu">c</span>(<span class="fu">get</span>(categories)))</span>
<span id="cb138-4"><a href="#cb138-4" aria-hidden="true" tabindex="-1"></a><span class="fu">summary</span>(iris.mis2)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>  Sepal.Length    Sepal.Width     Petal.Length    Petal.Width   
 Min.   :4.300   Min.   :2.000   Min.   :1.000   Min.   :0.100  
 1st Qu.:5.100   1st Qu.:2.800   1st Qu.:1.500   1st Qu.:0.300  
 Median :5.700   Median :3.000   Median :4.300   Median :1.300  
 Mean   :5.795   Mean   :3.032   Mean   :3.697   Mean   :1.208  
 3rd Qu.:6.375   3rd Qu.:3.300   3rd Qu.:5.100   3rd Qu.:1.800  
 Max.   :7.700   Max.   :4.400   Max.   :6.700   Max.   :2.500  
 NA's   :12      NA's   :15      NA's   :16      NA's   :16     </code></pre>
</div>
</div>
<p>Visualizamos los patrones de NA’s de la base de datos</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb140"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb140-1"><a href="#cb140-1" aria-hidden="true" tabindex="-1"></a><span class="fu">par</span>(<span class="at">mfrow =</span> <span class="fu">c</span>(<span class="dv">1</span>, <span class="dv">1</span>))</span>
<span id="cb140-2"><a href="#cb140-2" aria-hidden="true" tabindex="-1"></a>mice<span class="sc">::</span><span class="fu">md.pattern</span>(iris.mis2, <span class="at">rotate.names =</span> <span class="cn">TRUE</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<div>
<figure class="figure">
<p><img src="AdvancedPreprocessing_files/figure-html/unnamed-chunk-11-1.png" class="img-fluid figure-img" width="672"></p>
</figure>
</div>
</div>
<div class="cell-output cell-output-stdout">
<pre><code>   Sepal.Length Sepal.Width Petal.Length Petal.Width   
99            1           1            1           1  0
12            1           1            1           0  1
15            1           1            0           1  1
9             1           0            1           1  1
2             1           0            1           0  2
1             1           0            0           1  2
7             0           1            1           1  1
2             0           1            1           0  2
3             0           0            1           1  2
             12          15           16          16 59</code></pre>
</div>
</div>
<p>También lo podemos visualizar con el paquete VIM</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb142"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb142-1"><a href="#cb142-1" aria-hidden="true" tabindex="-1"></a>mice_plot <span class="ot">&lt;-</span> VIM<span class="sc">::</span><span class="fu">aggr</span>(iris.mis2, <span class="at">col=</span><span class="fu">c</span>(<span class="st">'navyblue'</span>,<span class="st">'yellow'</span>),</span>
<span id="cb142-2"><a href="#cb142-2" aria-hidden="true" tabindex="-1"></a>                  <span class="at">numbers=</span><span class="cn">TRUE</span>, <span class="at">sortVars=</span><span class="cn">TRUE</span>,</span>
<span id="cb142-3"><a href="#cb142-3" aria-hidden="true" tabindex="-1"></a>                  <span class="at">labels=</span><span class="fu">names</span>(iris.mis), <span class="at">cex.axis=</span>.<span class="dv">7</span>,</span>
<span id="cb142-4"><a href="#cb142-4" aria-hidden="true" tabindex="-1"></a>                  <span class="at">gap=</span><span class="dv">3</span>, <span class="at">ylab=</span><span class="fu">c</span>(<span class="st">"Missing data"</span>,<span class="st">"Pattern"</span>))</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<div>
<figure class="figure">
<p><img src="AdvancedPreprocessing_files/figure-html/unnamed-chunk-12-1.png" class="img-fluid figure-img" width="672"></p>
</figure>
</div>
</div>
<div class="cell-output cell-output-stdout">
<pre><code>
 Variables sorted by number of missings: 
     Variable     Count
 Petal.Length 0.1066667
  Petal.Width 0.1066667
  Sepal.Width 0.1000000
 Sepal.Length 0.0800000</code></pre>
</div>
</div>
<p>A continuación realizamos la imputación de los valores faltanes de manera multivariada</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb144"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb144-1"><a href="#cb144-1" aria-hidden="true" tabindex="-1"></a>imputed_Data <span class="ot">&lt;-</span> mice<span class="sc">::</span><span class="fu">mice</span>(iris.mis2, <span class="at">m=</span><span class="dv">5</span>, <span class="at">maxit =</span> <span class="dv">50</span>, <span class="at">method =</span> <span class="st">'pmm'</span>, <span class="at">seed =</span> <span class="dv">500</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>
 iter imp variable
  1   1  Sepal.Length  Sepal.Width  Petal.Length  Petal.Width
  1   2  Sepal.Length  Sepal.Width  Petal.Length  Petal.Width
  1   3  Sepal.Length  Sepal.Width  Petal.Length  Petal.Width
  1   4  Sepal.Length  Sepal.Width  Petal.Length  Petal.Width
  1   5  Sepal.Length  Sepal.Width  Petal.Length  Petal.Width
  2   1  Sepal.Length  Sepal.Width  Petal.Length  Petal.Width
  2   2  Sepal.Length  Sepal.Width  Petal.Length  Petal.Width
  2   3  Sepal.Length  Sepal.Width  Petal.Length  Petal.Width
  2   4  Sepal.Length  Sepal.Width  Petal.Length  Petal.Width
  2   5  Sepal.Length  Sepal.Width  Petal.Length  Petal.Width
  3   1  Sepal.Length  Sepal.Width  Petal.Length  Petal.Width
  3   2  Sepal.Length  Sepal.Width  Petal.Length  Petal.Width
  3   3  Sepal.Length  Sepal.Width  Petal.Length  Petal.Width
  3   4  Sepal.Length  Sepal.Width  Petal.Length  Petal.Width
  3   5  Sepal.Length  Sepal.Width  Petal.Length  Petal.Width
  4   1  Sepal.Length  Sepal.Width  Petal.Length  Petal.Width
  4   2  Sepal.Length  Sepal.Width  Petal.Length  Petal.Width
  4   3  Sepal.Length  Sepal.Width  Petal.Length  Petal.Width
  4   4  Sepal.Length  Sepal.Width  Petal.Length  Petal.Width
  4   5  Sepal.Length  Sepal.Width  Petal.Length  Petal.Width
  5   1  Sepal.Length  Sepal.Width  Petal.Length  Petal.Width
  5   2  Sepal.Length  Sepal.Width  Petal.Length  Petal.Width
  5   3  Sepal.Length  Sepal.Width  Petal.Length  Petal.Width
  5   4  Sepal.Length  Sepal.Width  Petal.Length  Petal.Width
  5   5  Sepal.Length  Sepal.Width  Petal.Length  Petal.Width
  6   1  Sepal.Length  Sepal.Width  Petal.Length  Petal.Width
  6   2  Sepal.Length  Sepal.Width  Petal.Length  Petal.Width
  6   3  Sepal.Length  Sepal.Width  Petal.Length  Petal.Width
  6   4  Sepal.Length  Sepal.Width  Petal.Length  Petal.Width
  6   5  Sepal.Length  Sepal.Width  Petal.Length  Petal.Width
  7   1  Sepal.Length  Sepal.Width  Petal.Length  Petal.Width
  7   2  Sepal.Length  Sepal.Width  Petal.Length  Petal.Width
  7   3  Sepal.Length  Sepal.Width  Petal.Length  Petal.Width
  7   4  Sepal.Length  Sepal.Width  Petal.Length  Petal.Width
  7   5  Sepal.Length  Sepal.Width  Petal.Length  Petal.Width
  8   1  Sepal.Length  Sepal.Width  Petal.Length  Petal.Width
  8   2  Sepal.Length  Sepal.Width  Petal.Length  Petal.Width
  8   3  Sepal.Length  Sepal.Width  Petal.Length  Petal.Width
  8   4  Sepal.Length  Sepal.Width  Petal.Length  Petal.Width
  8   5  Sepal.Length  Sepal.Width  Petal.Length  Petal.Width
  9   1  Sepal.Length  Sepal.Width  Petal.Length  Petal.Width
  9   2  Sepal.Length  Sepal.Width  Petal.Length  Petal.Width
  9   3  Sepal.Length  Sepal.Width  Petal.Length  Petal.Width
  9   4  Sepal.Length  Sepal.Width  Petal.Length  Petal.Width
  9   5  Sepal.Length  Sepal.Width  Petal.Length  Petal.Width
  10   1  Sepal.Length  Sepal.Width  Petal.Length  Petal.Width
  10   2  Sepal.Length  Sepal.Width  Petal.Length  Petal.Width
  10   3  Sepal.Length  Sepal.Width  Petal.Length  Petal.Width
  10   4  Sepal.Length  Sepal.Width  Petal.Length  Petal.Width
  10   5  Sepal.Length  Sepal.Width  Petal.Length  Petal.Width
  11   1  Sepal.Length  Sepal.Width  Petal.Length  Petal.Width
  11   2  Sepal.Length  Sepal.Width  Petal.Length  Petal.Width
  11   3  Sepal.Length  Sepal.Width  Petal.Length  Petal.Width
  11   4  Sepal.Length  Sepal.Width  Petal.Length  Petal.Width
  11   5  Sepal.Length  Sepal.Width  Petal.Length  Petal.Width
  12   1  Sepal.Length  Sepal.Width  Petal.Length  Petal.Width
  12   2  Sepal.Length  Sepal.Width  Petal.Length  Petal.Width
  12   3  Sepal.Length  Sepal.Width  Petal.Length  Petal.Width
  12   4  Sepal.Length  Sepal.Width  Petal.Length  Petal.Width
  12   5  Sepal.Length  Sepal.Width  Petal.Length  Petal.Width
  13   1  Sepal.Length  Sepal.Width  Petal.Length  Petal.Width
  13   2  Sepal.Length  Sepal.Width  Petal.Length  Petal.Width
  13   3  Sepal.Length  Sepal.Width  Petal.Length  Petal.Width
  13   4  Sepal.Length  Sepal.Width  Petal.Length  Petal.Width
  13   5  Sepal.Length  Sepal.Width  Petal.Length  Petal.Width
  14   1  Sepal.Length  Sepal.Width  Petal.Length  Petal.Width
  14   2  Sepal.Length  Sepal.Width  Petal.Length  Petal.Width
  14   3  Sepal.Length  Sepal.Width  Petal.Length  Petal.Width
  14   4  Sepal.Length  Sepal.Width  Petal.Length  Petal.Width
  14   5  Sepal.Length  Sepal.Width  Petal.Length  Petal.Width
  15   1  Sepal.Length  Sepal.Width  Petal.Length  Petal.Width
  15   2  Sepal.Length  Sepal.Width  Petal.Length  Petal.Width
  15   3  Sepal.Length  Sepal.Width  Petal.Length  Petal.Width
  15   4  Sepal.Length  Sepal.Width  Petal.Length  Petal.Width
  15   5  Sepal.Length  Sepal.Width  Petal.Length  Petal.Width
  16   1  Sepal.Length  Sepal.Width  Petal.Length  Petal.Width
  16   2  Sepal.Length  Sepal.Width  Petal.Length  Petal.Width
  16   3  Sepal.Length  Sepal.Width  Petal.Length  Petal.Width
  16   4  Sepal.Length  Sepal.Width  Petal.Length  Petal.Width
  16   5  Sepal.Length  Sepal.Width  Petal.Length  Petal.Width
  17   1  Sepal.Length  Sepal.Width  Petal.Length  Petal.Width
  17   2  Sepal.Length  Sepal.Width  Petal.Length  Petal.Width
  17   3  Sepal.Length  Sepal.Width  Petal.Length  Petal.Width
  17   4  Sepal.Length  Sepal.Width  Petal.Length  Petal.Width
  17   5  Sepal.Length  Sepal.Width  Petal.Length  Petal.Width
  18   1  Sepal.Length  Sepal.Width  Petal.Length  Petal.Width
  18   2  Sepal.Length  Sepal.Width  Petal.Length  Petal.Width
  18   3  Sepal.Length  Sepal.Width  Petal.Length  Petal.Width
  18   4  Sepal.Length  Sepal.Width  Petal.Length  Petal.Width
  18   5  Sepal.Length  Sepal.Width  Petal.Length  Petal.Width
  19   1  Sepal.Length  Sepal.Width  Petal.Length  Petal.Width
  19   2  Sepal.Length  Sepal.Width  Petal.Length  Petal.Width
  19   3  Sepal.Length  Sepal.Width  Petal.Length  Petal.Width
  19   4  Sepal.Length  Sepal.Width  Petal.Length  Petal.Width
  19   5  Sepal.Length  Sepal.Width  Petal.Length  Petal.Width
  20   1  Sepal.Length  Sepal.Width  Petal.Length  Petal.Width
  20   2  Sepal.Length  Sepal.Width  Petal.Length  Petal.Width
  20   3  Sepal.Length  Sepal.Width  Petal.Length  Petal.Width
  20   4  Sepal.Length  Sepal.Width  Petal.Length  Petal.Width
  20   5  Sepal.Length  Sepal.Width  Petal.Length  Petal.Width
  21   1  Sepal.Length  Sepal.Width  Petal.Length  Petal.Width
  21   2  Sepal.Length  Sepal.Width  Petal.Length  Petal.Width
  21   3  Sepal.Length  Sepal.Width  Petal.Length  Petal.Width
  21   4  Sepal.Length  Sepal.Width  Petal.Length  Petal.Width
  21   5  Sepal.Length  Sepal.Width  Petal.Length  Petal.Width
  22   1  Sepal.Length  Sepal.Width  Petal.Length  Petal.Width
  22   2  Sepal.Length  Sepal.Width  Petal.Length  Petal.Width
  22   3  Sepal.Length  Sepal.Width  Petal.Length  Petal.Width
  22   4  Sepal.Length  Sepal.Width  Petal.Length  Petal.Width
  22   5  Sepal.Length  Sepal.Width  Petal.Length  Petal.Width
  23   1  Sepal.Length  Sepal.Width  Petal.Length  Petal.Width
  23   2  Sepal.Length  Sepal.Width  Petal.Length  Petal.Width
  23   3  Sepal.Length  Sepal.Width  Petal.Length  Petal.Width
  23   4  Sepal.Length  Sepal.Width  Petal.Length  Petal.Width
  23   5  Sepal.Length  Sepal.Width  Petal.Length  Petal.Width
  24   1  Sepal.Length  Sepal.Width  Petal.Length  Petal.Width
  24   2  Sepal.Length  Sepal.Width  Petal.Length  Petal.Width
  24   3  Sepal.Length  Sepal.Width  Petal.Length  Petal.Width
  24   4  Sepal.Length  Sepal.Width  Petal.Length  Petal.Width
  24   5  Sepal.Length  Sepal.Width  Petal.Length  Petal.Width
  25   1  Sepal.Length  Sepal.Width  Petal.Length  Petal.Width
  25   2  Sepal.Length  Sepal.Width  Petal.Length  Petal.Width
  25   3  Sepal.Length  Sepal.Width  Petal.Length  Petal.Width
  25   4  Sepal.Length  Sepal.Width  Petal.Length  Petal.Width
  25   5  Sepal.Length  Sepal.Width  Petal.Length  Petal.Width
  26   1  Sepal.Length  Sepal.Width  Petal.Length  Petal.Width
  26   2  Sepal.Length  Sepal.Width  Petal.Length  Petal.Width
  26   3  Sepal.Length  Sepal.Width  Petal.Length  Petal.Width
  26   4  Sepal.Length  Sepal.Width  Petal.Length  Petal.Width
  26   5  Sepal.Length  Sepal.Width  Petal.Length  Petal.Width
  27   1  Sepal.Length  Sepal.Width  Petal.Length  Petal.Width
  27   2  Sepal.Length  Sepal.Width  Petal.Length  Petal.Width
  27   3  Sepal.Length  Sepal.Width  Petal.Length  Petal.Width
  27   4  Sepal.Length  Sepal.Width  Petal.Length  Petal.Width
  27   5  Sepal.Length  Sepal.Width  Petal.Length  Petal.Width
  28   1  Sepal.Length  Sepal.Width  Petal.Length  Petal.Width
  28   2  Sepal.Length  Sepal.Width  Petal.Length  Petal.Width
  28   3  Sepal.Length  Sepal.Width  Petal.Length  Petal.Width
  28   4  Sepal.Length  Sepal.Width  Petal.Length  Petal.Width
  28   5  Sepal.Length  Sepal.Width  Petal.Length  Petal.Width
  29   1  Sepal.Length  Sepal.Width  Petal.Length  Petal.Width
  29   2  Sepal.Length  Sepal.Width  Petal.Length  Petal.Width
  29   3  Sepal.Length  Sepal.Width  Petal.Length  Petal.Width
  29   4  Sepal.Length  Sepal.Width  Petal.Length  Petal.Width
  29   5  Sepal.Length  Sepal.Width  Petal.Length  Petal.Width
  30   1  Sepal.Length  Sepal.Width  Petal.Length  Petal.Width
  30   2  Sepal.Length  Sepal.Width  Petal.Length  Petal.Width
  30   3  Sepal.Length  Sepal.Width  Petal.Length  Petal.Width
  30   4  Sepal.Length  Sepal.Width  Petal.Length  Petal.Width
  30   5  Sepal.Length  Sepal.Width  Petal.Length  Petal.Width
  31   1  Sepal.Length  Sepal.Width  Petal.Length  Petal.Width
  31   2  Sepal.Length  Sepal.Width  Petal.Length  Petal.Width
  31   3  Sepal.Length  Sepal.Width  Petal.Length  Petal.Width
  31   4  Sepal.Length  Sepal.Width  Petal.Length  Petal.Width
  31   5  Sepal.Length  Sepal.Width  Petal.Length  Petal.Width
  32   1  Sepal.Length  Sepal.Width  Petal.Length  Petal.Width
  32   2  Sepal.Length  Sepal.Width  Petal.Length  Petal.Width
  32   3  Sepal.Length  Sepal.Width  Petal.Length  Petal.Width
  32   4  Sepal.Length  Sepal.Width  Petal.Length  Petal.Width
  32   5  Sepal.Length  Sepal.Width  Petal.Length  Petal.Width
  33   1  Sepal.Length  Sepal.Width  Petal.Length  Petal.Width
  33   2  Sepal.Length  Sepal.Width  Petal.Length  Petal.Width
  33   3  Sepal.Length  Sepal.Width  Petal.Length  Petal.Width
  33   4  Sepal.Length  Sepal.Width  Petal.Length  Petal.Width
  33   5  Sepal.Length  Sepal.Width  Petal.Length  Petal.Width
  34   1  Sepal.Length  Sepal.Width  Petal.Length  Petal.Width
  34   2  Sepal.Length  Sepal.Width  Petal.Length  Petal.Width
  34   3  Sepal.Length  Sepal.Width  Petal.Length  Petal.Width
  34   4  Sepal.Length  Sepal.Width  Petal.Length  Petal.Width
  34   5  Sepal.Length  Sepal.Width  Petal.Length  Petal.Width
  35   1  Sepal.Length  Sepal.Width  Petal.Length  Petal.Width
  35   2  Sepal.Length  Sepal.Width  Petal.Length  Petal.Width
  35   3  Sepal.Length  Sepal.Width  Petal.Length  Petal.Width
  35   4  Sepal.Length  Sepal.Width  Petal.Length  Petal.Width
  35   5  Sepal.Length  Sepal.Width  Petal.Length  Petal.Width
  36   1  Sepal.Length  Sepal.Width  Petal.Length  Petal.Width
  36   2  Sepal.Length  Sepal.Width  Petal.Length  Petal.Width
  36   3  Sepal.Length  Sepal.Width  Petal.Length  Petal.Width
  36   4  Sepal.Length  Sepal.Width  Petal.Length  Petal.Width
  36   5  Sepal.Length  Sepal.Width  Petal.Length  Petal.Width
  37   1  Sepal.Length  Sepal.Width  Petal.Length  Petal.Width
  37   2  Sepal.Length  Sepal.Width  Petal.Length  Petal.Width
  37   3  Sepal.Length  Sepal.Width  Petal.Length  Petal.Width
  37   4  Sepal.Length  Sepal.Width  Petal.Length  Petal.Width
  37   5  Sepal.Length  Sepal.Width  Petal.Length  Petal.Width
  38   1  Sepal.Length  Sepal.Width  Petal.Length  Petal.Width
  38   2  Sepal.Length  Sepal.Width  Petal.Length  Petal.Width
  38   3  Sepal.Length  Sepal.Width  Petal.Length  Petal.Width
  38   4  Sepal.Length  Sepal.Width  Petal.Length  Petal.Width
  38   5  Sepal.Length  Sepal.Width  Petal.Length  Petal.Width
  39   1  Sepal.Length  Sepal.Width  Petal.Length  Petal.Width
  39   2  Sepal.Length  Sepal.Width  Petal.Length  Petal.Width
  39   3  Sepal.Length  Sepal.Width  Petal.Length  Petal.Width
  39   4  Sepal.Length  Sepal.Width  Petal.Length  Petal.Width
  39   5  Sepal.Length  Sepal.Width  Petal.Length  Petal.Width
  40   1  Sepal.Length  Sepal.Width  Petal.Length  Petal.Width
  40   2  Sepal.Length  Sepal.Width  Petal.Length  Petal.Width
  40   3  Sepal.Length  Sepal.Width  Petal.Length  Petal.Width
  40   4  Sepal.Length  Sepal.Width  Petal.Length  Petal.Width
  40   5  Sepal.Length  Sepal.Width  Petal.Length  Petal.Width
  41   1  Sepal.Length  Sepal.Width  Petal.Length  Petal.Width
  41   2  Sepal.Length  Sepal.Width  Petal.Length  Petal.Width
  41   3  Sepal.Length  Sepal.Width  Petal.Length  Petal.Width
  41   4  Sepal.Length  Sepal.Width  Petal.Length  Petal.Width
  41   5  Sepal.Length  Sepal.Width  Petal.Length  Petal.Width
  42   1  Sepal.Length  Sepal.Width  Petal.Length  Petal.Width
  42   2  Sepal.Length  Sepal.Width  Petal.Length  Petal.Width
  42   3  Sepal.Length  Sepal.Width  Petal.Length  Petal.Width
  42   4  Sepal.Length  Sepal.Width  Petal.Length  Petal.Width
  42   5  Sepal.Length  Sepal.Width  Petal.Length  Petal.Width
  43   1  Sepal.Length  Sepal.Width  Petal.Length  Petal.Width
  43   2  Sepal.Length  Sepal.Width  Petal.Length  Petal.Width
  43   3  Sepal.Length  Sepal.Width  Petal.Length  Petal.Width
  43   4  Sepal.Length  Sepal.Width  Petal.Length  Petal.Width
  43   5  Sepal.Length  Sepal.Width  Petal.Length  Petal.Width
  44   1  Sepal.Length  Sepal.Width  Petal.Length  Petal.Width
  44   2  Sepal.Length  Sepal.Width  Petal.Length  Petal.Width
  44   3  Sepal.Length  Sepal.Width  Petal.Length  Petal.Width
  44   4  Sepal.Length  Sepal.Width  Petal.Length  Petal.Width
  44   5  Sepal.Length  Sepal.Width  Petal.Length  Petal.Width
  45   1  Sepal.Length  Sepal.Width  Petal.Length  Petal.Width
  45   2  Sepal.Length  Sepal.Width  Petal.Length  Petal.Width
  45   3  Sepal.Length  Sepal.Width  Petal.Length  Petal.Width
  45   4  Sepal.Length  Sepal.Width  Petal.Length  Petal.Width
  45   5  Sepal.Length  Sepal.Width  Petal.Length  Petal.Width
  46   1  Sepal.Length  Sepal.Width  Petal.Length  Petal.Width
  46   2  Sepal.Length  Sepal.Width  Petal.Length  Petal.Width
  46   3  Sepal.Length  Sepal.Width  Petal.Length  Petal.Width
  46   4  Sepal.Length  Sepal.Width  Petal.Length  Petal.Width
  46   5  Sepal.Length  Sepal.Width  Petal.Length  Petal.Width
  47   1  Sepal.Length  Sepal.Width  Petal.Length  Petal.Width
  47   2  Sepal.Length  Sepal.Width  Petal.Length  Petal.Width
  47   3  Sepal.Length  Sepal.Width  Petal.Length  Petal.Width
  47   4  Sepal.Length  Sepal.Width  Petal.Length  Petal.Width
  47   5  Sepal.Length  Sepal.Width  Petal.Length  Petal.Width
  48   1  Sepal.Length  Sepal.Width  Petal.Length  Petal.Width
  48   2  Sepal.Length  Sepal.Width  Petal.Length  Petal.Width
  48   3  Sepal.Length  Sepal.Width  Petal.Length  Petal.Width
  48   4  Sepal.Length  Sepal.Width  Petal.Length  Petal.Width
  48   5  Sepal.Length  Sepal.Width  Petal.Length  Petal.Width
  49   1  Sepal.Length  Sepal.Width  Petal.Length  Petal.Width
  49   2  Sepal.Length  Sepal.Width  Petal.Length  Petal.Width
  49   3  Sepal.Length  Sepal.Width  Petal.Length  Petal.Width
  49   4  Sepal.Length  Sepal.Width  Petal.Length  Petal.Width
  49   5  Sepal.Length  Sepal.Width  Petal.Length  Petal.Width
  50   1  Sepal.Length  Sepal.Width  Petal.Length  Petal.Width
  50   2  Sepal.Length  Sepal.Width  Petal.Length  Petal.Width
  50   3  Sepal.Length  Sepal.Width  Petal.Length  Petal.Width
  50   4  Sepal.Length  Sepal.Width  Petal.Length  Petal.Width
  50   5  Sepal.Length  Sepal.Width  Petal.Length  Petal.Width</code></pre>
</div>
<div class="sourceCode cell-code" id="cb146"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb146-1"><a href="#cb146-1" aria-hidden="true" tabindex="-1"></a><span class="fu">summary</span>(imputed_Data)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>Class: mids
Number of multiple imputations:  5 
Imputation methods:
Sepal.Length  Sepal.Width Petal.Length  Petal.Width 
       "pmm"        "pmm"        "pmm"        "pmm" 
PredictorMatrix:
             Sepal.Length Sepal.Width Petal.Length Petal.Width
Sepal.Length            0           1            1           1
Sepal.Width             1           0            1           1
Petal.Length            1           1            0           1
Petal.Width             1           1            1           0</code></pre>
</div>
</div>
<p>Inspeccionamos la calidad de las imputaciones</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb148"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb148-1"><a href="#cb148-1" aria-hidden="true" tabindex="-1"></a>mice<span class="sc">::</span><span class="fu">stripplot</span>(imputed_Data, Sepal.Width, <span class="at">pch =</span> <span class="dv">19</span>, <span class="at">xlab =</span> <span class="st">"Imputation number"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<div>
<figure class="figure">
<p><img src="AdvancedPreprocessing_files/figure-html/unnamed-chunk-14-1.png" class="img-fluid figure-img" width="672"></p>
</figure>
</div>
</div>
<div class="sourceCode cell-code" id="cb149"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb149-1"><a href="#cb149-1" aria-hidden="true" tabindex="-1"></a>imputed_Data<span class="sc">$</span>imp<span class="sc">$</span>Sepal.Width</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>      1   2   3   4   5
1   3.6 3.6 4.1 3.5 3.0
5   3.4 3.0 2.6 3.0 3.4
6   2.3 3.1 3.4 3.5 3.5
17  4.4 3.8 4.2 3.5 3.7
26  2.9 3.1 3.2 2.9 3.3
31  2.8 2.8 2.8 2.8 3.1
38  3.1 3.3 2.9 2.9 3.1
70  3.0 2.9 2.3 2.4 2.4
101 2.5 2.9 3.0 2.7 3.2
112 2.9 3.2 3.0 3.0 2.7
116 2.8 4.2 3.2 3.1 3.2
121 3.4 2.8 2.8 3.8 3.2
130 2.8 3.4 3.1 4.1 3.3
132 2.7 2.7 2.7 2.5 2.9
146 3.4 3.0 3.8 3.5 3.3</code></pre>
</div>
</div>
<p>Al final seleccionamos una de las iteracciones y la dejamos como imputación de los valores faltantes.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb151"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb151-1"><a href="#cb151-1" aria-hidden="true" tabindex="-1"></a>completeData <span class="ot">&lt;-</span> mice<span class="sc">::</span><span class="fu">complete</span>(imputed_Data, <span class="at">action =</span> <span class="st">"long"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<section id="exercices" class="level3" data-number="4.3.1">
<h3 data-number="4.3.1" class="anchored" data-anchor-id="exercices"><span class="header-section-number">4.3.1</span> Exercices:</h3>
<ol type="1">
<li>Deploy the multiple plot to compare te imputation and not imputation with all numeric vars in dataframe</li>
</ol>
</section>
</section>
<section id="knn" class="level2" data-number="4.4">
<h2 data-number="4.4" class="anchored" data-anchor-id="knn"><span class="header-section-number">4.4</span> KNN</h2>
<div class="cell">
<div class="sourceCode cell-code" id="cb152"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb152-1"><a href="#cb152-1" aria-hidden="true" tabindex="-1"></a>tipos <span class="ot">&lt;-</span> <span class="fu">sapply</span>(iris.mis, class)</span>
<span id="cb152-2"><a href="#cb152-2" aria-hidden="true" tabindex="-1"></a>varNum <span class="ot">&lt;-</span> <span class="fu">names</span>(tipos)[<span class="fu">which</span>(tipos <span class="sc">%in%</span> <span class="fu">c</span>(<span class="st">"numeric"</span>, <span class="st">"integer"</span>))]</span>
<span id="cb152-3"><a href="#cb152-3" aria-hidden="true" tabindex="-1"></a>data_knn_imputation <span class="ot">&lt;-</span> multiUS<span class="sc">::</span><span class="fu">KNNimp</span>(iris.mis[, varNum], <span class="at">k =</span> <span class="dv">1</span>)</span>
<span id="cb152-4"><a href="#cb152-4" aria-hidden="true" tabindex="-1"></a><span class="fu">summary</span>(data_knn_imputation)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>  Sepal.Length    Sepal.Width     Petal.Length    Petal.Width   
 Min.   :4.300   Min.   :2.000   Min.   :1.000   Min.   :0.100  
 1st Qu.:5.100   1st Qu.:2.800   1st Qu.:1.600   1st Qu.:0.300  
 Median :5.800   Median :3.000   Median :4.400   Median :1.300  
 Mean   :5.841   Mean   :3.045   Mean   :3.767   Mean   :1.191  
 3rd Qu.:6.475   3rd Qu.:3.375   3rd Qu.:5.100   3rd Qu.:1.800  
 Max.   :7.700   Max.   :4.400   Max.   :6.700   Max.   :2.500  </code></pre>
</div>
</div>
<p>Visualizamos la diferencia entre las dos imputaciones.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb154"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb154-1"><a href="#cb154-1" aria-hidden="true" tabindex="-1"></a>newBD <span class="ot">&lt;-</span> <span class="fu">data.frame</span>(<span class="at">real =</span> iris[, <span class="st">"Sepal.Length"</span>], <span class="at">imputed =</span> data_knn_imputation[, <span class="st">"Sepal.Length"</span>])</span>
<span id="cb154-2"><a href="#cb154-2" aria-hidden="true" tabindex="-1"></a>df_long <span class="ot">&lt;-</span> newBD <span class="sc">%&gt;%</span></span>
<span id="cb154-3"><a href="#cb154-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">pivot_longer</span>(<span class="at">cols =</span> <span class="fu">everything</span>(), <span class="at">names_to =</span> <span class="st">"Variable"</span>, <span class="at">values_to =</span> <span class="st">"Valor"</span>)</span>
<span id="cb154-4"><a href="#cb154-4" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb154-5"><a href="#cb154-5" aria-hidden="true" tabindex="-1"></a><span class="fu">ggplot</span>(df_long, <span class="fu">aes</span>(<span class="at">x =</span> Valor, <span class="at">fill =</span> Variable)) <span class="sc">+</span></span>
<span id="cb154-6"><a href="#cb154-6" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_density</span>(<span class="at">alpha =</span> <span class="fl">0.3</span>) <span class="sc">+</span>  <span class="co"># Transparencia para mejor visualización</span></span>
<span id="cb154-7"><a href="#cb154-7" aria-hidden="true" tabindex="-1"></a>  <span class="fu">labs</span>(<span class="at">title =</span> <span class="st">"Densidad de las tres variables"</span>,</span>
<span id="cb154-8"><a href="#cb154-8" aria-hidden="true" tabindex="-1"></a>       <span class="at">x =</span> <span class="st">"Valor"</span>,</span>
<span id="cb154-9"><a href="#cb154-9" aria-hidden="true" tabindex="-1"></a>       <span class="at">y =</span> <span class="st">"Densidad"</span>) <span class="sc">+</span></span>
<span id="cb154-10"><a href="#cb154-10" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme_minimal</span>() <span class="sc">+</span></span>
<span id="cb154-11"><a href="#cb154-11" aria-hidden="true" tabindex="-1"></a>  <span class="fu">scale_fill_manual</span>(<span class="at">values =</span> <span class="fu">c</span>(<span class="st">"blue"</span>, <span class="st">"red"</span>))</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<div>
<figure class="figure">
<p><img src="AdvancedPreprocessing_files/figure-html/unnamed-chunk-17-1.png" class="img-fluid figure-img" width="672"></p>
</figure>
</div>
</div>
</div>
<section id="exercices-1" class="level3" data-number="4.4.1">
<h3 data-number="4.4.1" class="anchored" data-anchor-id="exercices-1"><span class="header-section-number">4.4.1</span> Exercices:</h3>
<ol type="1">
<li>Deploy the multiple plot to compare the imputation and not imputation with all numeric vars in dataframe</li>
</ol>
</section>
</section>
<section id="missforest" class="level2" data-number="4.5">
<h2 data-number="4.5" class="anchored" data-anchor-id="missforest"><span class="header-section-number">4.5</span> missForest</h2>
<p>Imputamos los missings usando todos los parametros con los valores por defectos.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb155"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb155-1"><a href="#cb155-1" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(missForest)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stderr">
<pre><code>Warning: package 'missForest' was built under R version 4.4.3</code></pre>
</div>
<div class="sourceCode cell-code" id="cb157"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb157-1"><a href="#cb157-1" aria-hidden="true" tabindex="-1"></a>iris.imp <span class="ot">&lt;-</span> <span class="fu">missForest</span>(iris.mis, <span class="at">variablewise =</span> T, <span class="at">verbose =</span> T) </span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>  missForest iteration 1 in progress...done!
    estimated error(s): 0.1785301 0.09607199 0.1616973 0.032296 0.05223881 
    difference(s): 0.005511064 0.08 
    time: 0.06 seconds

  missForest iteration 2 in progress...done!
    estimated error(s): 0.1241168 0.08722486 0.06218984 0.02937162 0.04477612 
    difference(s): 0.0001018209 0 
    time: 0.04 seconds

  missForest iteration 3 in progress...done!
    estimated error(s): 0.1310795 0.08576933 0.0644648 0.02911535 0.03731343 
    difference(s): 1.120453e-05 0 
    time: 0.07 seconds

  missForest iteration 4 in progress...done!
    estimated error(s): 0.1240951 0.08841871 0.06278651 0.02825258 0.04477612 
    difference(s): 1.038555e-05 0 
    time: 0.04 seconds

  missForest iteration 5 in progress...done!
    estimated error(s): 0.1255279 0.09103837 0.06693245 0.0299239 0.04477612 
    difference(s): 6.865365e-06 0 
    time: 0.07 seconds

  missForest iteration 6 in progress...done!
    estimated error(s): 0.1239506 0.08867171 0.06091633 0.02916087 0.04477612 
    difference(s): 6.449324e-06 0 
    time: 0.04 seconds

  missForest iteration 7 in progress...done!
    estimated error(s): 0.1228071 0.08399709 0.06295863 0.03010765 0.05223881 
    difference(s): 1.060512e-05 0 
    time: 0.05 seconds</code></pre>
</div>
</div>
<p>Visualizamos los valores imputados</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb159"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb159-1"><a href="#cb159-1" aria-hidden="true" tabindex="-1"></a>iris.imp<span class="sc">$</span>ximp</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>    Sepal.Length Sepal.Width Petal.Length Petal.Width    Species
1       5.100000    3.503897     1.504231   0.2000000     setosa
2       4.900000    3.000000     1.400000   0.2000000     setosa
3       4.700000    3.200000     1.300000   0.2000000     setosa
4       4.600000    3.100000     1.500000   0.2000000     setosa
5       5.000000    3.302965     1.400000   0.2057000     setosa
6       5.209333    3.597583     1.700000   0.4000000     setosa
7       4.600000    3.400000     1.400000   0.3000000     setosa
8       5.000000    3.400000     1.500000   0.2000000     setosa
9       4.400000    2.900000     1.400000   0.2000000     setosa
10      4.900000    3.100000     1.500000   0.1000000     setosa
11      5.400000    3.700000     1.500000   0.2667614     setosa
12      4.800000    3.400000     1.600000   0.2000000     setosa
13      4.800000    3.000000     1.400000   0.1000000     setosa
14      4.300000    3.000000     1.100000   0.1000000     setosa
15      5.800000    4.000000     1.200000   0.3362333     setosa
16      5.700000    4.400000     1.500000   0.4000000     setosa
17      5.400000    3.694333     1.300000   0.4000000     setosa
18      5.100000    3.500000     1.442550   0.3000000     setosa
19      5.700000    3.800000     1.700000   0.3000000     setosa
20      5.100000    3.800000     1.500000   0.3000000     setosa
21      5.400000    3.400000     1.700000   0.2000000     setosa
22      5.100000    3.700000     1.500000   0.4000000     setosa
23      4.600000    3.600000     1.000000   0.2000000     setosa
24      5.100000    3.300000     1.700000   0.5000000     setosa
25      4.800000    3.400000     1.900000   0.2938250     setosa
26      5.000000    3.435417     1.600000   0.2000000     setosa
27      5.000000    3.400000     1.600000   0.4000000     setosa
28      5.200000    3.500000     1.500000   0.2000000     setosa
29      5.200000    3.400000     1.400000   0.2000000     setosa
30      4.700000    3.200000     1.600000   0.2000000     setosa
31      4.800000    3.306800     1.600000   0.2000000     setosa
32      5.400000    3.400000     1.500000   0.2217281     setosa
33      5.200000    4.100000     1.500000   0.1000000     setosa
34      5.500000    4.200000     1.400000   0.2000000     setosa
35      4.900000    3.100000     1.500000   0.2000000     setosa
36      5.000000    3.200000     1.200000   0.2000000     setosa
37      5.500000    3.500000     1.300000   0.2000000     setosa
38      4.900000    3.071380     1.400000   0.1000000     setosa
39      4.400000    3.000000     1.300000   0.1940821     setosa
40      5.100000    3.400000     1.500000   0.2000000     setosa
41      5.000000    3.500000     1.300000   0.3000000     setosa
42      4.500000    2.300000     1.300000   0.3000000     setosa
43      4.400000    3.200000     1.300000   0.2000000     setosa
44      5.000000    3.500000     1.600000   0.6000000     setosa
45      5.100000    3.800000     1.900000   0.4000000     setosa
46      4.800000    3.000000     1.400000   0.3000000     setosa
47      5.100000    3.800000     1.600000   0.2000000     setosa
48      4.600000    3.200000     1.400000   0.2000000     setosa
49      5.300000    3.700000     1.500000   0.2000000     setosa
50      5.000000    3.300000     1.400000   0.2000000     setosa
51      7.000000    3.200000     4.657098   1.4000000 versicolor
52      6.224267    3.200000     4.500000   1.5000000 versicolor
53      6.900000    3.100000     4.900000   1.5000000 versicolor
54      5.500000    2.300000     4.009955   1.3000000 versicolor
55      6.500000    2.800000     4.785000   1.5000000 versicolor
56      5.700000    2.800000     4.500000   1.3000000 versicolor
57      6.300000    3.300000     4.723100   1.6000000 versicolor
58      4.900000    2.400000     3.300000   1.0000000 versicolor
59      6.600000    2.900000     4.600000   1.3000000 versicolor
60      5.200000    2.700000     3.900000   1.4000000 versicolor
61      5.415833    2.000000     3.500000   1.0000000 versicolor
62      5.721783    3.000000     4.200000   1.5000000 versicolor
63      6.000000    2.200000     4.000000   1.0000000 versicolor
64      6.100000    2.900000     4.700000   1.4000000 versicolor
65      5.600000    2.900000     4.224271   1.3000000 versicolor
66      6.700000    3.100000     4.400000   1.4000000 versicolor
67      5.600000    3.000000     4.500000   1.4176667 versicolor
68      5.800000    2.700000     4.100000   1.0000000 versicolor
69      6.200000    2.200000     4.500000   1.5000000 versicolor
70      5.600000    2.473683     3.900000   1.1000000 versicolor
71      5.900000    3.200000     4.800000   1.8000000 versicolor
72      6.100000    2.800000     4.000000   1.3000000 versicolor
73      6.300000    2.500000     4.900000   1.5000000 versicolor
74      6.294995    2.800000     4.700000   1.4422000 versicolor
75      6.400000    2.900000     4.300000   1.3419000 versicolor
76      6.600000    3.000000     4.400000   1.4000000 versicolor
77      6.800000    2.800000     4.800000   1.4000000 versicolor
78      6.700000    3.000000     5.000000   1.7000000 versicolor
79      6.000000    2.900000     4.647900   1.5000000 versicolor
80      5.700000    2.600000     3.500000   1.0000000 versicolor
81      5.440450    2.400000     3.800000   1.1000000 versicolor
82      5.500000    2.400000     3.700000   1.0000000 versicolor
83      5.800000    2.700000     3.900000   1.2000000 versicolor
84      6.000000    2.700000     5.100000   1.6000000 versicolor
85      5.400000    3.000000     4.500000   1.5000000 versicolor
86      6.000000    3.400000     4.500000   1.6000000 versicolor
87      6.700000    3.100000     4.700000   1.4577000 versicolor
88      6.300000    2.300000     4.400000   1.3000000 versicolor
89      5.600000    3.000000     4.100000   1.3000000 versicolor
90      5.500000    2.500000     4.000000   1.3000000 versicolor
91      5.500000    2.600000     4.400000   1.2000000 versicolor
92      6.100000    3.000000     4.526114   1.4000000 versicolor
93      5.800000    2.600000     4.000000   1.2000000 versicolor
94      5.000000    2.300000     3.300000   1.0000000 versicolor
95      5.600000    2.700000     4.200000   1.3000000 versicolor
96      5.700000    3.000000     4.139935   1.2000000 versicolor
97      5.700000    2.900000     4.200000   1.3000000 versicolor
98      6.200000    2.900000     4.300000   1.3000000 versicolor
99      5.100000    2.500000     3.725717   1.1000000 versicolor
100     5.700000    2.800000     4.287783   1.3000000 versicolor
101     6.300000    3.327167     6.000000   2.5000000  virginica
102     5.800000    2.700000     5.100000   1.9000000  virginica
103     7.100000    3.000000     5.900000   2.1000000  virginica
104     6.300000    2.900000     5.600000   1.8000000  virginica
105     6.500000    3.000000     5.800000   2.2000000  virginica
106     7.600000    3.000000     6.600000   2.1000000  virginica
107     4.900000    2.500000     4.500000   1.7000000  virginica
108     7.300000    2.900000     6.300000   1.8000000  virginica
109     6.700000    2.500000     5.800000   1.8000000  virginica
110     7.200000    3.600000     6.100000   2.5000000  virginica
111     6.500000    3.200000     5.100000   2.0000000  virginica
112     6.400000    2.756000     5.300000   1.9000000  virginica
113     6.800000    3.000000     5.500000   2.1000000  virginica
114     5.700000    2.500000     5.000000   2.0000000  virginica
115     5.800000    2.800000     5.100000   2.4000000  virginica
116     6.736750    3.133500     5.300000   2.3000000  virginica
117     6.500000    3.000000     5.500000   1.8000000  virginica
118     7.345200    3.800000     6.700000   2.2000000  virginica
119     7.700000    2.600000     6.322667   2.3000000  virginica
120     6.000000    2.200000     5.000000   1.5000000  virginica
121     6.900000    3.186500     5.700000   2.3000000  virginica
122     5.600000    2.800000     4.900000   1.8892000  virginica
123     7.700000    2.800000     6.700000   2.0000000  virginica
124     6.300000    2.700000     5.410267   1.8000000  virginica
125     6.700000    3.300000     5.700000   2.1000000  virginica
126     7.200000    3.200000     6.000000   1.8000000  virginica
127     6.200000    2.800000     4.800000   1.7237000  virginica
128     6.100000    3.000000     4.900000   1.8000000  virginica
129     6.400000    2.800000     5.600000   2.1000000  virginica
130     7.200000    3.045971     5.800000   2.0216667  virginica
131     7.400000    2.800000     6.326700   1.9000000  virginica
132     7.477000    2.862000     6.400000   2.0000000  virginica
133     6.409000    2.800000     5.600000   2.2000000  virginica
134     6.300000    2.800000     5.100000   1.5000000  virginica
135     6.100000    2.600000     5.600000   1.9045667  virginica
136     7.186500    3.000000     6.100000   2.0358333  virginica
137     6.300000    3.400000     5.600000   2.4000000  virginica
138     6.586857    3.100000     5.500000   1.8000000  virginica
139     6.000000    3.000000     4.800000   1.8000000  virginica
140     6.900000    3.100000     5.400000   2.1000000  virginica
141     6.700000    3.100000     5.317300   2.4000000  virginica
142     6.900000    3.100000     5.100000   2.3000000  virginica
143     5.800000    2.700000     5.100000   1.9000000  virginica
144     6.800000    3.200000     5.900000   2.3000000  virginica
145     6.700000    3.300000     5.700000   2.5000000  virginica
146     6.700000    3.118500     5.200000   2.3000000  virginica
147     6.300000    2.500000     5.000000   1.9000000  virginica
148     6.500000    3.000000     5.200000   1.9456667  virginica
149     6.200000    3.400000     5.400000   2.3000000  virginica
150     5.900000    3.000000     5.100000   1.8000000  virginica</code></pre>
</div>
</div>
<p>Visualizamos el error cometido en las imputaciones.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb161"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb161-1"><a href="#cb161-1" aria-hidden="true" tabindex="-1"></a>iris.imp<span class="sc">$</span>OOBerror</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>       MSE        MSE        MSE        MSE        PFC 
0.12395058 0.08867171 0.06091633 0.02916087 0.04477612 </code></pre>
</div>
</div>
<p>NRMSE és un error normalitzat mitjà al quadrat. S’utilitza per representar l’error derivat d’imputar valors continus. El PFC (proporció de falsament classificada) s’utilitza per representar l’error derivat d’imputar valors categòrics.</p>
<p>Comparamos el accuracy actual,</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb163"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb163-1"><a href="#cb163-1" aria-hidden="true" tabindex="-1"></a>(iris.err <span class="ot">&lt;-</span> <span class="fu">mixError</span>(iris.imp<span class="sc">$</span>ximp, iris.mis, iris))</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>    NRMSE       PFC 
0.1403915 0.0000000 </code></pre>
</div>
</div>
<p>Miramos la diferencia entre las dos imputaciones</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb165"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb165-1"><a href="#cb165-1" aria-hidden="true" tabindex="-1"></a>newBD <span class="ot">&lt;-</span> <span class="fu">data.frame</span>(<span class="at">real =</span> iris[, <span class="st">"Sepal.Length"</span>], <span class="at">imputed =</span>  iris.imp<span class="sc">$</span>ximp[, <span class="st">"Sepal.Length"</span>])</span>
<span id="cb165-2"><a href="#cb165-2" aria-hidden="true" tabindex="-1"></a>df_long <span class="ot">&lt;-</span> newBD <span class="sc">%&gt;%</span></span>
<span id="cb165-3"><a href="#cb165-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">pivot_longer</span>(<span class="at">cols =</span> <span class="fu">everything</span>(), <span class="at">names_to =</span> <span class="st">"Variable"</span>, <span class="at">values_to =</span> <span class="st">"Valor"</span>)</span>
<span id="cb165-4"><a href="#cb165-4" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb165-5"><a href="#cb165-5" aria-hidden="true" tabindex="-1"></a><span class="fu">ggplot</span>(df_long, <span class="fu">aes</span>(<span class="at">x =</span> Valor, <span class="at">fill =</span> Variable)) <span class="sc">+</span></span>
<span id="cb165-6"><a href="#cb165-6" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_density</span>(<span class="at">alpha =</span> <span class="fl">0.3</span>) <span class="sc">+</span>  <span class="co"># Transparencia para mejor visualización</span></span>
<span id="cb165-7"><a href="#cb165-7" aria-hidden="true" tabindex="-1"></a>  <span class="fu">labs</span>(<span class="at">title =</span> <span class="st">"Densidad de las tres variables"</span>,</span>
<span id="cb165-8"><a href="#cb165-8" aria-hidden="true" tabindex="-1"></a>       <span class="at">x =</span> <span class="st">"Valor"</span>,</span>
<span id="cb165-9"><a href="#cb165-9" aria-hidden="true" tabindex="-1"></a>       <span class="at">y =</span> <span class="st">"Densidad"</span>) <span class="sc">+</span></span>
<span id="cb165-10"><a href="#cb165-10" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme_minimal</span>() <span class="sc">+</span></span>
<span id="cb165-11"><a href="#cb165-11" aria-hidden="true" tabindex="-1"></a>  <span class="fu">scale_fill_manual</span>(<span class="at">values =</span> <span class="fu">c</span>(<span class="st">"blue"</span>, <span class="st">"red"</span>))</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<div>
<figure class="figure">
<p><img src="AdvancedPreprocessing_files/figure-html/unnamed-chunk-22-1.png" class="img-fluid figure-img" width="672"></p>
</figure>
</div>
</div>
</div>
<section id="exercises" class="level3" data-number="4.5.1">
<h3 data-number="4.5.1" class="anchored" data-anchor-id="exercises"><span class="header-section-number">4.5.1</span> Exercises:</h3>
<ol type="1">
<li>Deploy the multiple plot to compare te imputation and not imputation with all numeric vars in dataframe</li>
</ol>
</section>
<section id="extra" class="level3" data-number="4.5.2">
<h3 data-number="4.5.2" class="anchored" data-anchor-id="extra"><span class="header-section-number">4.5.2</span> Extra:</h3>
<p>Quan es tracta de valors que manquen, és possible que vulgueu reemplaçar valors per valors que manquen (NA). Això és útil en els casos en què es coneix l’origen de les dades i es pot estar segur de quins valors han de faltar. Per exemple, podríeu saber que tots els valors de «N/A», «N A» i «No disponible», o -99 o -1 se suposa que falten.</p>
<p>naniar proporciona funcions per treballar específicament en aquest tipus de problemes utilitzant la funció replace.with.na. Aquesta funció és el compliment a tidyr::replace els NA’s, que reemplaça un valor NA per un valor especificat, mentre que naniar::replace,with_na reemplaça un valor per un NA:</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb166"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb166-1"><a href="#cb166-1" aria-hidden="true" tabindex="-1"></a>tidyr<span class="sc">::</span>replace_na<span class="sc">:</span> Missing values turns into a <span class="fu">value</span> (<span class="cn">NA</span> –<span class="sc">&gt;</span> <span class="sc">-</span><span class="dv">99</span>)</span>
<span id="cb166-2"><a href="#cb166-2" aria-hidden="true" tabindex="-1"></a>naniar<span class="sc">::</span>replace_with_na<span class="sc">:</span> Value becomes a missing <span class="fu">value</span> (<span class="sc">-</span><span class="dv">99</span> –<span class="sc">&gt;</span> <span class="cn">NA</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
</section>
</section>
</section>
<section id="bibliografía" class="level1" data-number="5">
<h1 data-number="5"><span class="header-section-number">5</span> Bibliografía</h1>
<section id="outliers-1" class="level2" data-number="5.1">
<h2 data-number="5.1" class="anchored" data-anchor-id="outliers-1"><span class="header-section-number">5.1</span> Outliers</h2>
<ul>
<li>https://statsandr.com/blog/outliers-detection-in-r/#z-scores</li>
<li>https://m-mburu.github.io/datacamp/anomaly_detection_R/anomaly_detection.html</li>
<li>https://github.com/pridiltal/ctv-AnomalyDetection</li>
</ul>
</section>
<section id="imputación" class="level2" data-number="5.2">
<h2 data-number="5.2" class="anchored" data-anchor-id="imputación"><span class="header-section-number">5.2</span> Imputación</h2>
<ul>
<li>http://naniar.njtierney.com/articles/replace-with-na.html</li>
<li>https://cran.r-project.org/web/packages/visdat/vignettes/using_visdat.html</li>
<li>https://cran.r-project.org/web/packages/DMwR2/DMwR2.pdf</li>
<li>https://ltorgo.github.io/DMwR2/RintroDM.html#data_pre-processing</li>
<li>https://www.rdocumentation.org/packages/DMwR/versions/0.4.1/topics/knnImputation</li>
<li>https://amices.org/mice/</li>
</ul>


</section>
</section>

<p>Esta web está creada por Dante Conti y Sergi Ramírez, (c) 2025</p></main> <!-- /main -->
<script id="quarto-html-after-body" type="application/javascript">
window.document.addEventListener("DOMContentLoaded", function (event) {
  const toggleBodyColorMode = (bsSheetEl) => {
    const mode = bsSheetEl.getAttribute("data-mode");
    const bodyEl = window.document.querySelector("body");
    if (mode === "dark") {
      bodyEl.classList.add("quarto-dark");
      bodyEl.classList.remove("quarto-light");
    } else {
      bodyEl.classList.add("quarto-light");
      bodyEl.classList.remove("quarto-dark");
    }
  }
  const toggleBodyColorPrimary = () => {
    const bsSheetEl = window.document.querySelector("link#quarto-bootstrap");
    if (bsSheetEl) {
      toggleBodyColorMode(bsSheetEl);
    }
  }
  toggleBodyColorPrimary();  
  const icon = "";
  const anchorJS = new window.AnchorJS();
  anchorJS.options = {
    placement: 'right',
    icon: icon
  };
  anchorJS.add('.anchored');
  const isCodeAnnotation = (el) => {
    for (const clz of el.classList) {
      if (clz.startsWith('code-annotation-')) {                     
        return true;
      }
    }
    return false;
  }
  const onCopySuccess = function(e) {
    // button target
    const button = e.trigger;
    // don't keep focus
    button.blur();
    // flash "checked"
    button.classList.add('code-copy-button-checked');
    var currentTitle = button.getAttribute("title");
    button.setAttribute("title", "Copied!");
    let tooltip;
    if (window.bootstrap) {
      button.setAttribute("data-bs-toggle", "tooltip");
      button.setAttribute("data-bs-placement", "left");
      button.setAttribute("data-bs-title", "Copied!");
      tooltip = new bootstrap.Tooltip(button, 
        { trigger: "manual", 
          customClass: "code-copy-button-tooltip",
          offset: [0, -8]});
      tooltip.show();    
    }
    setTimeout(function() {
      if (tooltip) {
        tooltip.hide();
        button.removeAttribute("data-bs-title");
        button.removeAttribute("data-bs-toggle");
        button.removeAttribute("data-bs-placement");
      }
      button.setAttribute("title", currentTitle);
      button.classList.remove('code-copy-button-checked');
    }, 1000);
    // clear code selection
    e.clearSelection();
  }
  const getTextToCopy = function(trigger) {
      const codeEl = trigger.previousElementSibling.cloneNode(true);
      for (const childEl of codeEl.children) {
        if (isCodeAnnotation(childEl)) {
          childEl.remove();
        }
      }
      return codeEl.innerText;
  }
  const clipboard = new window.ClipboardJS('.code-copy-button:not([data-in-quarto-modal])', {
    text: getTextToCopy
  });
  clipboard.on('success', onCopySuccess);
  if (window.document.getElementById('quarto-embedded-source-code-modal')) {
    const clipboardModal = new window.ClipboardJS('.code-copy-button[data-in-quarto-modal]', {
      text: getTextToCopy,
      container: window.document.getElementById('quarto-embedded-source-code-modal')
    });
    clipboardModal.on('success', onCopySuccess);
  }
    var localhostRegex = new RegExp(/^(?:http|https):\/\/localhost\:?[0-9]*\//);
    var mailtoRegex = new RegExp(/^mailto:/);
      var filterRegex = new RegExp('/' + window.location.host + '/');
    var isInternal = (href) => {
        return filterRegex.test(href) || localhostRegex.test(href) || mailtoRegex.test(href);
    }
    // Inspect non-navigation links and adorn them if external
 	var links = window.document.querySelectorAll('a[href]:not(.nav-link):not(.navbar-brand):not(.toc-action):not(.sidebar-link):not(.sidebar-item-toggle):not(.pagination-link):not(.no-external):not([aria-hidden]):not(.dropdown-item):not(.quarto-navigation-tool):not(.about-link)');
    for (var i=0; i<links.length; i++) {
      const link = links[i];
      if (!isInternal(link.href)) {
        // undo the damage that might have been done by quarto-nav.js in the case of
        // links that we want to consider external
        if (link.dataset.originalHref !== undefined) {
          link.href = link.dataset.originalHref;
        }
      }
    }
  function tippyHover(el, contentFn, onTriggerFn, onUntriggerFn) {
    const config = {
      allowHTML: true,
      maxWidth: 500,
      delay: 100,
      arrow: false,
      appendTo: function(el) {
          return el.parentElement;
      },
      interactive: true,
      interactiveBorder: 10,
      theme: 'quarto',
      placement: 'bottom-start',
    };
    if (contentFn) {
      config.content = contentFn;
    }
    if (onTriggerFn) {
      config.onTrigger = onTriggerFn;
    }
    if (onUntriggerFn) {
      config.onUntrigger = onUntriggerFn;
    }
    window.tippy(el, config); 
  }
  const noterefs = window.document.querySelectorAll('a[role="doc-noteref"]');
  for (var i=0; i<noterefs.length; i++) {
    const ref = noterefs[i];
    tippyHover(ref, function() {
      // use id or data attribute instead here
      let href = ref.getAttribute('data-footnote-href') || ref.getAttribute('href');
      try { href = new URL(href).hash; } catch {}
      const id = href.replace(/^#\/?/, "");
      const note = window.document.getElementById(id);
      if (note) {
        return note.innerHTML;
      } else {
        return "";
      }
    });
  }
  const xrefs = window.document.querySelectorAll('a.quarto-xref');
  const processXRef = (id, note) => {
    // Strip column container classes
    const stripColumnClz = (el) => {
      el.classList.remove("page-full", "page-columns");
      if (el.children) {
        for (const child of el.children) {
          stripColumnClz(child);
        }
      }
    }
    stripColumnClz(note)
    if (id === null || id.startsWith('sec-')) {
      // Special case sections, only their first couple elements
      const container = document.createElement("div");
      if (note.children && note.children.length > 2) {
        container.appendChild(note.children[0].cloneNode(true));
        for (let i = 1; i < note.children.length; i++) {
          const child = note.children[i];
          if (child.tagName === "P" && child.innerText === "") {
            continue;
          } else {
            container.appendChild(child.cloneNode(true));
            break;
          }
        }
        if (window.Quarto?.typesetMath) {
          window.Quarto.typesetMath(container);
        }
        return container.innerHTML
      } else {
        if (window.Quarto?.typesetMath) {
          window.Quarto.typesetMath(note);
        }
        return note.innerHTML;
      }
    } else {
      // Remove any anchor links if they are present
      const anchorLink = note.querySelector('a.anchorjs-link');
      if (anchorLink) {
        anchorLink.remove();
      }
      if (window.Quarto?.typesetMath) {
        window.Quarto.typesetMath(note);
      }
      if (note.classList.contains("callout")) {
        return note.outerHTML;
      } else {
        return note.innerHTML;
      }
    }
  }
  for (var i=0; i<xrefs.length; i++) {
    const xref = xrefs[i];
    tippyHover(xref, undefined, function(instance) {
      instance.disable();
      let url = xref.getAttribute('href');
      let hash = undefined; 
      if (url.startsWith('#')) {
        hash = url;
      } else {
        try { hash = new URL(url).hash; } catch {}
      }
      if (hash) {
        const id = hash.replace(/^#\/?/, "");
        const note = window.document.getElementById(id);
        if (note !== null) {
          try {
            const html = processXRef(id, note.cloneNode(true));
            instance.setContent(html);
          } finally {
            instance.enable();
            instance.show();
          }
        } else {
          // See if we can fetch this
          fetch(url.split('#')[0])
          .then(res => res.text())
          .then(html => {
            const parser = new DOMParser();
            const htmlDoc = parser.parseFromString(html, "text/html");
            const note = htmlDoc.getElementById(id);
            if (note !== null) {
              const html = processXRef(id, note);
              instance.setContent(html);
            } 
          }).finally(() => {
            instance.enable();
            instance.show();
          });
        }
      } else {
        // See if we can fetch a full url (with no hash to target)
        // This is a special case and we should probably do some content thinning / targeting
        fetch(url)
        .then(res => res.text())
        .then(html => {
          const parser = new DOMParser();
          const htmlDoc = parser.parseFromString(html, "text/html");
          const note = htmlDoc.querySelector('main.content');
          if (note !== null) {
            // This should only happen for chapter cross references
            // (since there is no id in the URL)
            // remove the first header
            if (note.children.length > 0 && note.children[0].tagName === "HEADER") {
              note.children[0].remove();
            }
            const html = processXRef(null, note);
            instance.setContent(html);
          } 
        }).finally(() => {
          instance.enable();
          instance.show();
        });
      }
    }, function(instance) {
    });
  }
      let selectedAnnoteEl;
      const selectorForAnnotation = ( cell, annotation) => {
        let cellAttr = 'data-code-cell="' + cell + '"';
        let lineAttr = 'data-code-annotation="' +  annotation + '"';
        const selector = 'span[' + cellAttr + '][' + lineAttr + ']';
        return selector;
      }
      const selectCodeLines = (annoteEl) => {
        const doc = window.document;
        const targetCell = annoteEl.getAttribute("data-target-cell");
        const targetAnnotation = annoteEl.getAttribute("data-target-annotation");
        const annoteSpan = window.document.querySelector(selectorForAnnotation(targetCell, targetAnnotation));
        const lines = annoteSpan.getAttribute("data-code-lines").split(",");
        const lineIds = lines.map((line) => {
          return targetCell + "-" + line;
        })
        let top = null;
        let height = null;
        let parent = null;
        if (lineIds.length > 0) {
            //compute the position of the single el (top and bottom and make a div)
            const el = window.document.getElementById(lineIds[0]);
            top = el.offsetTop;
            height = el.offsetHeight;
            parent = el.parentElement.parentElement;
          if (lineIds.length > 1) {
            const lastEl = window.document.getElementById(lineIds[lineIds.length - 1]);
            const bottom = lastEl.offsetTop + lastEl.offsetHeight;
            height = bottom - top;
          }
          if (top !== null && height !== null && parent !== null) {
            // cook up a div (if necessary) and position it 
            let div = window.document.getElementById("code-annotation-line-highlight");
            if (div === null) {
              div = window.document.createElement("div");
              div.setAttribute("id", "code-annotation-line-highlight");
              div.style.position = 'absolute';
              parent.appendChild(div);
            }
            div.style.top = top - 2 + "px";
            div.style.height = height + 4 + "px";
            div.style.left = 0;
            let gutterDiv = window.document.getElementById("code-annotation-line-highlight-gutter");
            if (gutterDiv === null) {
              gutterDiv = window.document.createElement("div");
              gutterDiv.setAttribute("id", "code-annotation-line-highlight-gutter");
              gutterDiv.style.position = 'absolute';
              const codeCell = window.document.getElementById(targetCell);
              const gutter = codeCell.querySelector('.code-annotation-gutter');
              gutter.appendChild(gutterDiv);
            }
            gutterDiv.style.top = top - 2 + "px";
            gutterDiv.style.height = height + 4 + "px";
          }
          selectedAnnoteEl = annoteEl;
        }
      };
      const unselectCodeLines = () => {
        const elementsIds = ["code-annotation-line-highlight", "code-annotation-line-highlight-gutter"];
        elementsIds.forEach((elId) => {
          const div = window.document.getElementById(elId);
          if (div) {
            div.remove();
          }
        });
        selectedAnnoteEl = undefined;
      };
        // Handle positioning of the toggle
    window.addEventListener(
      "resize",
      throttle(() => {
        elRect = undefined;
        if (selectedAnnoteEl) {
          selectCodeLines(selectedAnnoteEl);
        }
      }, 10)
    );
    function throttle(fn, ms) {
    let throttle = false;
    let timer;
      return (...args) => {
        if(!throttle) { // first call gets through
            fn.apply(this, args);
            throttle = true;
        } else { // all the others get throttled
            if(timer) clearTimeout(timer); // cancel #2
            timer = setTimeout(() => {
              fn.apply(this, args);
              timer = throttle = false;
            }, ms);
        }
      };
    }
      // Attach click handler to the DT
      const annoteDls = window.document.querySelectorAll('dt[data-target-cell]');
      for (const annoteDlNode of annoteDls) {
        annoteDlNode.addEventListener('click', (event) => {
          const clickedEl = event.target;
          if (clickedEl !== selectedAnnoteEl) {
            unselectCodeLines();
            const activeEl = window.document.querySelector('dt[data-target-cell].code-annotation-active');
            if (activeEl) {
              activeEl.classList.remove('code-annotation-active');
            }
            selectCodeLines(clickedEl);
            clickedEl.classList.add('code-annotation-active');
          } else {
            // Unselect the line
            unselectCodeLines();
            clickedEl.classList.remove('code-annotation-active');
          }
        });
      }
  const findCites = (el) => {
    const parentEl = el.parentElement;
    if (parentEl) {
      const cites = parentEl.dataset.cites;
      if (cites) {
        return {
          el,
          cites: cites.split(' ')
        };
      } else {
        return findCites(el.parentElement)
      }
    } else {
      return undefined;
    }
  };
  var bibliorefs = window.document.querySelectorAll('a[role="doc-biblioref"]');
  for (var i=0; i<bibliorefs.length; i++) {
    const ref = bibliorefs[i];
    const citeInfo = findCites(ref);
    if (citeInfo) {
      tippyHover(citeInfo.el, function() {
        var popup = window.document.createElement('div');
        citeInfo.cites.forEach(function(cite) {
          var citeDiv = window.document.createElement('div');
          citeDiv.classList.add('hanging-indent');
          citeDiv.classList.add('csl-entry');
          var biblioDiv = window.document.getElementById('ref-' + cite);
          if (biblioDiv) {
            citeDiv.innerHTML = biblioDiv.innerHTML;
          }
          popup.appendChild(citeDiv);
        });
        return popup.innerHTML;
      });
    }
  }
});
</script>
</div> <!-- /content -->




</body></html>
{
  "hash": "5831be9d2a50aeaa868949e7afb7c348",
  "result": {
    "engine": "knitr",
    "markdown": "---\ntitle: \"Advance Preprocessing\"\nauthor: Dante Conti, Sergi Ramirez, (c) IDEAI\ndate: \"2025-09-30\"\ndate-modified: \"2025-09-30\"\ntoc: true\n# language: es\nnumber-sections: true\nformat: \n  html: \n    theme: cerulean\neditor: visual\n#execute: \n#  freeze: auto\n---\n\n\n\n# Descripción del problema\n\nPara hacer el apartado de preprocessing vamos a utilizar la base de datos [`valentine_dataset.csv`](https://www.kaggle.com/datasets/anyasorc/valentine-dataset).\n\n\n\n::: {.cell}\n\n:::\n\n\n\n# Outliers\n\n## Univariate\n\n### Max and Min\n\n\n\n::: {.cell}\n\n```{.r .cell-code}\nmapply(function(x, name) {\n  cat(\"var. \", name, \": \\n\\t min: \", min(x), \"\\n\\t max: \", max(x), \"\\n\")\n  invisible(NULL)  # Evita la salida de valores NULL\n}, dades[, varNum], colnames(dades[, varNum]))\n```\n\n::: {.cell-output .cell-output-stdout}\n\n```\nvar.  Age : \n\t min:  18 \n\t max:  40 \nvar.  Income : \n\t min:  20004 \n\t max:  79998 \nvar.  Appearance_Score : \n\t min:  0 \n\t max:  99.99 \nvar.  Interests_Score : \n\t min:  0.01 \n\t max:  100 \nvar.  Confidence_Score : \n\t min:  0.01 \n\t max:  100 \n```\n\n\n:::\n\n::: {.cell-output .cell-output-stdout}\n\n```\n$Age\nNULL\n\n$Income\nNULL\n\n$Appearance_Score\nNULL\n\n$Interests_Score\nNULL\n\n$Confidence_Score\nNULL\n```\n\n\n:::\n:::\n\n\n\n### IQR\n\nEs defineixen outliers els punts fora de $[Q1 - 1.5xIQR, Q3 + 1.5xIQR]$\n\n\n\n::: {.cell}\n\n```{.r .cell-code}\nlibrary(EnvStats)\n\nIQROutlier <- function(variable, rmnas = TRUE) {\n  IQ <- iqr(variable, na.rm = rmnas)\n  intInf <- quantile(variable, probs = c(0.25, 0.75))[[1]] - 1.5*IQ\n  intSup <- quantile(variable, probs = c(0.25, 0.75))[[2]] + 1.5*IQ\n  posicions <- which(variable >= intSup | variable <= intInf)\n  if (length(posicions) > 0) {\n    cat(\"Existeixen outliers en les posicions:\", paste0(posicions, collapse = \", \"))\n  } else {\n    cat(\"No existeixen outliers\")\n  }\n  return(posicions)\n}\n```\n:::\n\n::: {.cell}\n::: {.cell-output .cell-output-stdout}\n\n```\nNo existeixen outliers\n```\n\n\n:::\n\n::: {.cell-output .cell-output-stdout}\n\n```\ninteger(0)\n```\n\n\n:::\n:::\n\n\n\n### Boxplot\n\nVisualització basada en IQR per detectar outliers.\n\n\n\n::: {.cell}\n\n```{.r .cell-code}\nlibrary(ggplot2)\n\nvariable <- \"Age\"\n\nboxplot(dades[, variable])\n```\n\n::: {.cell-output-display}\n![](AdvancedPreprocessing_files/figure-html/boxplot-1.png){width=672}\n:::\n\n```{.r .cell-code}\nboxplot.stats(dades[, variable])$out\n```\n\n::: {.cell-output .cell-output-stdout}\n\n```\ninteger(0)\n```\n\n\n:::\n\n```{.r .cell-code}\n# Crear un boxplot\nggplot(dades, aes(y = get(variable))) +\n  geom_boxplot(fill = \"skyblue\", color = \"black\") +\n  labs(title = paste0(\"Boxplot de \", variable)) +\n  theme_minimal()\n```\n\n::: {.cell-output-display}\n![](AdvancedPreprocessing_files/figure-html/boxplot-2.png){width=672}\n:::\n:::\n\n\n\n### Z-Score\n\nUn outlier es un valor amb \\|z\\| \\> 3 deviació estándar\n\n\n\n::: {.cell}\n\n```{.r .cell-code}\nvariable <- \"Age\"\nvalorEscalado <- scale(dades[, variable])\nhist(valorEscalado)\n```\n\n::: {.cell-output-display}\n![](AdvancedPreprocessing_files/figure-html/z_score-1.png){width=672}\n:::\n\n```{.r .cell-code}\nggplot(data.frame(valor = valorEscalado), aes(x = valor)) +\n  geom_histogram(binwidth = 0.5, fill = \"skyblue\", color = \"black\") +  # Histograma\n  geom_vline(xintercept = c(3, -3), linetype = \"dashed\", color = \"red\", size = 1) + # Líneas horizontales\n  theme_minimal()\n```\n\n::: {.cell-output-display}\n![](AdvancedPreprocessing_files/figure-html/z_score-2.png){width=672}\n:::\n:::\n\n\n\n### Hampel Identifier\n\nUtilitza la mediana i la desviació absoluta mediana (MAD) en lloc de la mitjana\n\n\n\n::: {.cell}\n\n```{.r .cell-code}\nvariable <- \"Age\"\n\nlower_bound <- median(dades[, variable]) - 3 * mad(dades[, variable], constant = 1)\nupper_bound <- median(dades[, variable]) + 3 * mad(dades[, variable], constant = 1)\noutlier_ind <- which((dades[, variable] < lower_bound) | (dades[, variable] > upper_bound))\noutlier_ind\n```\n\n::: {.cell-output .cell-output-stdout}\n\n```\ninteger(0)\n```\n\n\n:::\n:::\n\n\n\n### Tests Estadístics\n\n#### Grubbs' Test\n\nDetecta valors extrems en una distribució normal\n\n\n\n::: {.cell}\n\n```{.r .cell-code}\nlibrary(outliers)\n\nvariable <- \"Age\"\ntest <- outliers::grubbs.test(dades[, variable], opposite = TRUE)\n# amb el paràmetre opposite controles quina de les dues cues están buscant\ntest\n```\n\n::: {.cell-output .cell-output-stdout}\n\n```\n\n\tGrubbs test for one outlier\n\ndata:  dades[, variable]\nG = 1.65591, U = 0.99986, p-value = 1\nalternative hypothesis: highest value 40 is an outlier\n```\n\n\n:::\n:::\n\n\n\n#### Dixon's Test\n\nNomés utilitzar per a bbdd petites (entre 3 - 30) observacions\n\n\n\n::: {.cell}\n\n```{.r .cell-code}\nvariable <- \"Age\"\ntest <- outliers::dixon.test(dades[, variable], opposite = FALSE)\ntest\n```\n:::\n\n\n\n#### Rosner's Test\n\nLa prueba de Rosner para valores atípicos tiene las ventajas de que: 1. se utiliza para detectar varios valores atípicos a la vez (a diferencia de la prueba de Grubbs y Dixon, que debe realizarse de forma iterativa para detectar múltiples valores atípicos), 2. Está diseñado para evitar el problema del enmascaramiento, donde un valor atípico cercano en valor a otro valor atípico puede pasar desapercibido.\n\nA diferencia de la prueba de Dixon, tenga en cuenta que la prueba de Rosner es más apropiada cuando el tamaño de la muestra es grande (n ≥ 20).\n\nEsta función requiere al menos dos argumentos: - los datos - la cantidad de valores atípicos sospechosos k (k = 3 como cantidad predeterminada)\n\nAsumeix normalitat de les dades\n\n\n\n::: {.cell}\n\n```{.r .cell-code}\nlibrary(EnvStats)\n\nvariable <- \"Age\"\ntest <- EnvStats::rosnerTest(dades[, variable], k = 1)\ntest\n```\n\n::: {.cell-output .cell-output-stdout}\n\n```\n$distribution\n[1] \"Normal\"\n\n$statistic\n     R.1 \n1.666119 \n\n$sample.size\n[1] 20000\n\n$parameters\nk \n1 \n\n$alpha\n[1] 0.05\n\n$crit.value\nlambda.1 \n4.706884 \n\n$n.outliers\n[1] 0\n\n$alternative\n[1] \"Up to 1 observations are not\\n                                 from the same Distribution.\"\n\n$method\n[1] \"Rosner's Test for Outliers\"\n\n$data\n    [1] 26 23 34 37 38 40 28 32 30 28 23 25 26 23 30 28 22 20 38 27 27 27 33 33\n   [25] 33 38 26 33 22 27 23 37 35 34 19 23 40 19 25 25 33 24 24 21 22 36 37 38\n   [49] 22 29 28 30 20 25 38 29 28 33 25 31 26 38 19 30 24 21 19 21 26 25 28 34\n   [73] 18 33 22 19 34 28 37 39 26 30 26 34 38 32 29 21 31 19 21 27 19 27 26 38\n   [97] 29 37 35 26 18 32 40 27 29 39 40 23 26 40 26 31 23 30 29 34 31 26 21 22\n  [121] 37 28 20 21 35 18 22 36 40 24 18 33 25 34 34 33 25 24 35 20 19 20 20 19\n  [145] 20 39 21 31 30 28 30 18 20 32 27 29 30 18 21 35 32 19 21 33 39 19 23 18\n  [169] 31 18 37 35 32 18 26 20 24 39 20 27 38 34 39 25 25 22 26 37 40 27 34 38\n  [193] 39 34 22 34 40 30 27 39 38 40 18 24 29 27 33 25 35 37 29 20 33 33 40 38\n  [217] 20 20 32 36 20 32 22 36 32 35 34 30 20 39 24 23 22 29 20 35 21 40 24 21\n  [241] 40 20 26 31 32 32 32 18 29 33 30 34 21 32 20 26 21 19 32 36 19 21 40 22\n  [265] 19 18 36 31 28 23 23 36 29 33 40 38 31 32 39 18 33 31 30 34 28 25 36 21\n  [289] 20 21 31 30 31 30 25 20 31 33 33 21 20 27 34 18 32 22 27 32 40 22 26 37\n  [313] 38 18 38 29 40 31 26 28 33 28 19 29 25 31 30 24 24 20 23 20 40 36 37 27\n  [337] 32 18 35 33 25 34 28 21 32 35 24 23 39 27 27 34 24 39 27 31 36 20 39 24\n  [361] 25 35 29 32 40 33 30 24 29 24 20 27 18 30 19 20 33 20 28 39 34 40 21 36\n  [385] 22 32 21 38 30 36 38 25 25 25 27 33 18 21 26 20 40 31 39 22 18 21 25 20\n  [409] 39 20 31 37 37 24 26 36 38 33 24 23 24 32 24 24 29 23 20 20 28 40 19 20\n  [433] 33 38 38 34 22 25 21 27 36 19 19 37 30 33 26 20 40 18 35 23 23 34 20 20\n  [457] 29 22 37 18 22 31 25 30 34 23 38 20 18 40 35 38 33 21 32 37 34 38 36 22\n  [481] 26 18 37 35 34 29 32 33 39 35 34 35 28 34 35 39 37 40 33 40 25 36 34 29\n  [505] 39 23 35 23 38 20 26 34 28 30 38 32 39 30 18 28 40 37 33 24 37 39 23 24\n  [529] 31 24 19 27 32 29 38 39 18 22 29 28 32 35 23 40 19 28 26 19 37 40 39 24\n  [553] 23 38 24 34 24 18 40 31 27 34 25 24 40 34 27 37 39 26 26 34 38 27 38 32\n  [577] 27 27 32 36 33 26 37 21 36 23 30 35 25 32 37 27 33 30 39 21 34 25 37 36\n  [601] 20 21 31 26 21 33 25 19 23 36 27 36 31 23 27 20 21 39 35 33 20 35 19 36\n  [625] 32 33 22 36 38 39 38 24 19 37 20 29 36 35 36 37 27 35 31 40 39 30 26 23\n  [649] 34 23 25 30 38 27 23 35 33 25 23 30 39 22 28 20 31 23 18 39 29 25 20 31\n  [673] 22 26 29 26 31 26 36 38 35 20 38 20 25 28 26 28 18 22 19 24 28 35 24 32\n  [697] 18 23 34 30 19 39 18 22 27 32 28 20 26 35 36 38 19 40 36 31 38 18 24 19\n  [721] 23 37 36 38 34 34 19 24 22 25 20 23 32 38 40 36 36 22 20 33 23 25 29 27\n  [745] 40 20 30 25 32 24 28 18 20 34 28 20 40 30 25 34 31 30 31 32 20 30 33 38\n  [769] 22 30 23 24 38 38 27 25 36 37 23 37 27 29 26 27 18 29 18 26 31 26 21 32\n  [793] 30 37 34 28 40 29 31 32 22 26 19 25 28 37 29 33 24 18 33 19 29 18 23 28\n  [817] 37 34 20 31 39 33 30 32 35 29 23 39 37 30 19 36 26 18 33 35 30 29 32 30\n  [841] 20 31 32 33 23 20 33 30 39 31 30 38 31 23 39 38 20 40 40 36 18 35 38 32\n  [865] 23 39 23 30 40 20 22 22 21 39 20 25 26 18 40 33 34 26 35 39 36 26 21 38\n  [889] 21 31 25 32 37 20 35 34 37 31 28 31 27 19 18 33 28 26 35 26 24 19 24 33\n  [913] 35 35 25 25 34 31 24 24 23 24 21 38 38 39 32 31 26 33 18 22 38 24 30 20\n  [937] 27 35 25 22 22 23 40 27 38 39 18 21 35 33 39 32 31 31 32 22 28 19 32 20\n  [961] 27 28 28 31 28 27 38 19 34 23 23 33 23 31 38 18 37 40 28 21 36 21 39 38\n  [985] 37 21 26 29 30 27 26 39 18 25 28 32 30 29 25 19 22 24 19 35 30 23 37 22\n [1009] 20 32 38 29 30 38 25 21 20 36 30 39 28 32 23 30 21 18 22 35 37 27 29 19\n [1033] 26 29 26 18 34 34 22 35 20 40 40 34 29 31 29 20 18 23 18 24 34 36 38 40\n [1057] 22 40 22 37 33 18 40 36 36 40 38 21 32 27 35 34 29 26 27 22 28 35 37 18\n [1081] 21 26 37 25 40 19 33 39 33 28 30 34 34 37 33 36 24 21 26 34 24 27 20 38\n [1105] 22 29 37 23 24 30 37 39 24 40 30 34 27 23 19 26 28 39 27 27 24 37 35 34\n [1129] 36 40 29 19 39 21 29 23 28 38 21 19 20 19 34 40 22 35 23 31 22 26 25 22\n [1153] 35 38 31 26 38 23 28 36 26 30 24 36 34 26 24 30 38 31 31 36 33 25 37 25\n [1177] 19 28 26 37 36 26 18 28 30 40 21 26 34 29 35 35 28 40 22 36 34 31 26 24\n [1201] 34 33 31 38 38 25 38 20 30 26 34 18 26 22 18 22 35 29 29 32 31 29 34 31\n [1225] 32 21 32 18 37 18 20 25 39 32 23 23 30 29 28 20 18 32 24 21 36 23 28 38\n [1249] 20 37 22 33 27 31 36 25 39 24 20 33 40 22 23 21 37 37 26 35 40 32 35 39\n [1273] 37 20 35 38 40 18 32 39 21 27 36 29 22 21 26 25 33 23 35 23 24 22 24 32\n [1297] 31 21 26 22 38 35 28 38 38 39 28 30 37 37 29 24 33 19 20 30 33 35 32 34\n [1321] 29 31 25 19 19 21 26 33 32 32 18 18 33 40 33 28 25 27 20 26 28 32 34 34\n [1345] 21 33 23 21 25 31 22 23 37 25 37 26 19 34 28 27 28 32 35 32 30 19 26 31\n [1369] 22 40 39 30 37 26 22 36 28 23 39 30 37 21 31 32 28 28 31 37 27 29 21 22\n [1393] 35 34 20 18 21 32 24 37 22 39 30 22 30 20 25 39 38 31 36 36 34 35 37 21\n [1417] 32 25 20 23 39 37 38 32 18 32 33 20 35 38 40 18 31 25 22 31 32 31 26 38\n [1441] 20 36 33 40 40 37 40 31 32 24 19 36 32 37 26 32 31 22 20 40 22 35 28 29\n [1465] 23 27 24 30 39 39 20 23 24 40 20 28 24 31 33 31 21 24 40 18 38 21 33 40\n [1489] 30 35 33 18 32 39 24 21 33 34 27 29 22 29 37 22 19 30 39 35 22 32 35 33\n [1513] 37 40 19 31 23 20 30 36 35 39 40 18 23 32 23 36 27 35 24 27 38 24 31 36\n [1537] 32 25 33 21 38 29 21 40 21 30 31 35 27 33 27 35 36 22 38 35 22 34 28 31\n [1561] 27 33 22 29 24 21 25 21 35 20 21 35 20 25 34 31 21 38 32 18 36 35 24 40\n [1585] 32 34 26 36 39 32 29 39 34 38 30 18 33 39 23 19 21 24 33 27 32 22 22 39\n [1609] 35 18 21 29 33 20 37 23 26 37 39 24 31 25 31 26 20 24 30 39 32 21 37 40\n [1633] 39 28 20 21 35 26 38 37 34 22 40 37 18 19 29 36 34 24 40 40 32 30 35 28\n [1657] 25 32 23 35 22 36 20 39 40 19 35 28 25 31 26 25 22 22 30 32 36 27 21 29\n [1681] 37 40 37 30 30 29 30 36 24 24 18 38 22 19 30 19 37 34 31 40 36 32 25 23\n [1705] 40 36 26 20 40 21 34 26 35 37 31 23 34 32 29 34 30 24 38 32 35 28 32 36\n [1729] 18 40 31 32 39 35 21 18 25 38 26 39 39 39 24 29 27 30 32 19 35 33 20 38\n [1753] 27 29 35 38 19 33 18 30 39 40 24 38 27 20 23 27 28 34 18 36 37 22 36 35\n [1777] 38 24 32 34 29 26 37 25 22 25 36 18 20 26 38 19 22 37 18 36 28 29 25 40\n [1801] 36 31 23 30 29 28 29 20 32 22 24 39 26 28 26 19 37 39 22 34 32 24 25 29\n [1825] 22 34 25 23 26 39 32 20 39 30 24 25 32 29 38 34 23 27 34 21 20 37 20 38\n [1849] 38 32 40 35 19 25 23 23 33 37 36 35 33 30 23 31 19 29 36 38 23 32 19 28\n [1873] 19 34 19 24 37 40 35 35 35 34 32 29 29 40 35 20 37 34 22 20 20 27 23 21\n [1897] 36 32 21 27 30 32 18 32 37 23 34 24 38 19 25 21 34 32 36 40 35 34 36 26\n [1921] 36 26 32 24 29 29 21 35 37 19 30 25 34 22 20 31 39 30 21 38 20 35 36 22\n [1945] 38 35 30 23 29 26 33 39 40 40 20 27 18 29 33 33 25 38 30 33 18 27 21 34\n [1969] 30 38 34 23 29 21 37 32 20 21 20 27 22 29 33 40 30 32 39 19 27 29 39 37\n [1993] 40 37 22 25 18 35 36 19 18 38 20 33 20 25 38 39 18 27 21 26 32 37 33 38\n [2017] 37 36 40 34 34 39 34 23 37 29 22 33 38 35 31 39 35 22 24 40 37 34 35 24\n [2041] 19 36 37 35 37 34 38 23 24 24 34 27 26 22 30 21 28 26 24 31 18 18 37 30\n [2065] 34 33 19 36 31 25 28 39 25 40 22 18 36 21 29 23 19 22 36 23 30 28 40 18\n [2089] 36 23 25 33 21 30 31 22 26 28 27 22 19 22 31 40 40 39 21 37 27 36 36 39\n [2113] 27 28 35 24 24 21 18 23 27 38 26 28 22 23 32 30 39 23 20 29 40 28 23 31\n [2137] 22 29 28 18 39 32 40 30 40 40 23 33 30 39 28 29 26 40 19 40 21 31 28 29\n [2161] 37 24 28 40 20 28 22 28 30 26 39 39 24 33 33 30 23 34 19 37 24 20 28 25\n [2185] 39 30 18 29 39 36 31 18 24 29 39 36 33 35 19 39 40 31 24 21 39 36 19 33\n [2209] 28 32 32 39 36 40 35 40 25 26 40 20 18 35 29 40 18 18 38 29 29 25 27 19\n [2233] 31 22 22 40 38 23 30 24 24 39 33 40 26 30 21 33 21 18 27 28 33 20 33 19\n [2257] 35 25 38 24 26 24 26 29 20 27 39 26 31 33 31 36 34 40 40 28 38 29 32 34\n [2281] 18 27 20 23 22 19 28 19 38 35 18 33 20 24 18 33 27 39 30 30 25 20 25 22\n [2305] 32 39 40 30 19 28 36 19 39 31 25 36 24 28 32 23 29 30 35 18 21 27 35 40\n [2329] 36 29 19 28 26 26 36 27 36 26 26 29 37 36 22 22 18 24 33 23 38 40 18 30\n [2353] 22 26 33 20 28 39 25 22 40 21 40 38 30 21 35 21 19 25 22 27 38 24 28 28\n [2377] 36 22 26 22 18 19 21 39 20 27 30 21 25 18 23 34 20 34 34 21 23 23 27 31\n [2401] 31 23 24 36 29 26 28 24 35 29 38 24 35 22 20 19 20 24 32 26 32 23 28 40\n [2425] 28 36 30 26 23 40 27 26 30 23 20 39 23 40 31 36 31 19 36 33 29 32 20 22\n [2449] 31 27 35 25 35 26 30 26 35 37 22 24 30 36 39 39 29 38 27 31 31 24 28 20\n [2473] 34 19 32 24 18 26 35 40 34 36 24 34 21 22 39 35 25 32 25 38 21 25 24 22\n [2497] 31 27 22 18 33 20 27 33 38 30 35 24 26 21 25 38 21 38 39 39 28 23 24 35\n [2521] 29 33 34 40 40 27 23 39 23 37 29 33 23 30 35 38 21 31 23 40 39 18 34 25\n [2545] 37 18 24 26 39 35 25 37 39 32 27 23 22 31 32 23 32 29 31 31 33 35 31 37\n [2569] 20 36 31 19 25 37 26 38 40 20 35 35 20 18 40 36 40 28 35 18 39 32 20 35\n [2593] 21 32 35 35 25 33 23 34 31 31 22 38 24 31 38 27 24 33 18 29 29 36 19 21\n [2617] 37 38 21 26 23 36 36 31 19 18 37 26 36 27 40 35 29 23 26 34 18 19 19 18\n [2641] 38 35 25 25 34 39 22 22 28 27 18 27 33 40 37 26 21 38 23 38 30 36 33 21\n [2665] 32 33 28 38 18 29 36 26 39 34 40 29 33 24 37 22 24 25 22 27 39 40 24 35\n [2689] 37 21 32 20 27 39 39 35 35 33 33 29 30 21 23 26 35 30 26 38 32 38 26 36\n [2713] 37 28 35 19 31 33 20 19 31 25 28 30 34 25 27 37 30 31 40 29 32 35 32 32\n [2737] 22 19 39 36 19 28 26 19 18 31 38 27 24 38 32 25 26 32 36 29 27 22 32 21\n [2761] 38 18 24 21 39 28 25 38 18 20 37 21 34 24 36 21 23 19 26 35 32 27 22 33\n [2785] 34 27 18 26 24 26 22 24 30 23 30 32 26 32 39 32 34 38 26 21 18 25 36 20\n [2809] 18 40 35 18 23 31 21 24 36 28 34 31 24 26 40 30 19 20 32 35 36 27 36 27\n [2833] 30 30 32 23 23 24 24 18 31 39 34 31 30 22 27 36 32 24 36 28 19 35 23 37\n [2857] 37 31 19 40 20 35 20 30 21 29 27 35 18 27 24 21 21 28 30 19 34 38 35 32\n [2881] 37 27 37 32 23 34 29 20 39 29 19 31 33 32 29 38 38 22 35 26 29 37 34 28\n [2905] 40 20 40 19 34 26 20 40 31 36 40 30 24 25 24 26 20 20 34 33 19 36 29 29\n [2929] 23 38 21 34 29 35 18 39 22 40 30 23 38 36 34 33 32 25 24 27 35 39 23 33\n [2953] 32 23 34 34 38 34 20 33 38 30 40 22 38 35 30 40 27 20 29 27 22 30 40 35\n [2977] 22 37 33 28 26 23 24 21 33 38 36 28 26 18 37 23 18 31 20 36 36 30 39 26\n [3001] 24 21 24 36 25 29 23 23 37 27 33 21 35 19 38 36 23 19 38 31 30 30 25 39\n [3025] 32 30 36 38 23 19 34 18 29 21 33 24 34 21 40 35 38 29 35 25 27 29 36 39\n [3049] 38 31 34 31 30 21 39 24 24 28 35 28 23 26 39 38 35 23 29 29 23 28 27 18\n [3073] 36 37 31 31 35 21 27 39 18 23 38 25 34 24 29 31 34 27 36 21 31 27 21 18\n [3097] 37 23 30 32 27 35 39 39 28 34 30 22 39 37 30 39 32 24 35 24 27 30 34 28\n [3121] 19 33 37 27 23 31 34 18 18 33 20 27 29 19 20 31 31 21 32 40 25 32 20 22\n [3145] 20 31 22 24 40 28 18 26 35 27 22 24 21 19 23 23 36 37 30 29 40 36 30 19\n [3169] 22 29 22 18 33 38 31 38 20 33 26 31 30 38 37 18 19 27 30 26 39 29 20 27\n [3193] 39 23 26 28 23 22 29 36 25 37 39 30 29 40 18 19 35 21 36 33 32 21 40 19\n [3217] 21 36 40 25 27 20 35 28 22 28 29 30 40 24 28 40 20 31 33 21 21 33 31 23\n [3241] 36 39 35 23 35 33 32 20 25 20 26 38 22 18 20 28 34 37 27 37 39 39 24 19\n [3265] 27 22 27 39 33 18 32 18 38 21 22 27 26 32 33 28 37 32 23 28 23 38 32 18\n [3289] 22 25 40 39 34 31 22 30 26 38 33 22 24 20 27 34 31 22 24 18 24 28 39 23\n [3313] 32 21 24 25 28 36 26 29 38 38 37 37 35 29 32 40 23 34 18 33 18 28 26 22\n [3337] 31 30 26 25 38 35 23 19 24 26 38 37 31 25 22 19 36 32 26 22 32 22 24 34\n [3361] 37 32 34 37 21 36 31 38 29 39 23 25 18 19 21 26 25 33 34 35 38 25 32 39\n [3385] 21 34 21 32 33 36 25 39 20 40 38 23 28 28 23 39 38 20 29 21 33 33 31 26\n [3409] 24 29 40 27 32 24 20 39 21 31 23 38 27 18 23 33 35 37 26 36 36 36 40 36\n [3433] 24 23 20 22 34 19 28 38 36 37 39 36 31 38 21 39 36 40 19 19 35 38 26 26\n [3457] 28 34 32 22 38 21 36 32 27 38 19 23 20 36 32 31 38 35 30 18 20 19 39 31\n [3481] 38 40 34 19 38 33 33 25 25 26 20 35 25 32 30 24 34 20 23 39 22 33 26 31\n [3505] 29 18 31 29 37 22 39 18 40 29 23 28 29 23 27 20 25 36 36 40 25 23 21 28\n [3529] 20 21 27 39 20 27 34 26 20 35 29 25 25 19 22 36 28 18 26 39 24 18 29 35\n [3553] 24 20 33 35 37 27 28 18 25 19 28 35 21 39 33 19 26 25 29 32 29 25 19 34\n [3577] 29 19 22 22 27 29 39 36 29 33 36 39 33 30 23 35 34 38 20 23 24 36 18 31\n [3601] 32 24 39 20 18 22 25 30 32 19 19 26 26 21 19 32 31 18 32 30 19 32 40 38\n [3625] 40 35 18 38 25 40 31 28 20 25 28 22 19 38 37 19 25 27 39 40 37 24 40 37\n [3649] 24 27 20 23 30 22 26 22 32 19 24 27 35 23 37 34 20 39 20 40 35 25 25 18\n [3673] 19 18 23 20 38 36 29 27 21 37 21 26 36 22 40 32 38 21 37 23 32 32 27 25\n [3697] 19 22 30 28 30 28 24 23 34 28 24 29 38 33 39 18 22 20 35 24 25 38 29 34\n [3721] 18 27 32 19 29 29 20 35 26 35 34 28 37 24 35 28 18 37 27 28 21 23 29 26\n [3745] 39 34 31 34 24 27 25 22 18 24 29 18 37 27 37 35 32 30 27 25 18 30 35 29\n [3769] 20 33 19 38 24 28 24 36 33 40 25 37 27 34 20 23 34 36 21 26 37 24 18 37\n [3793] 24 40 37 39 38 39 32 38 24 24 24 39 22 26 18 18 19 28 22 23 28 29 34 23\n [3817] 26 22 28 29 31 26 21 38 27 36 26 31 29 27 29 32 24 18 18 38 33 39 34 18\n [3841] 26 33 28 38 22 19 24 32 28 26 36 30 22 31 21 33 37 22 18 22 40 20 37 38\n [3865] 31 19 27 22 32 30 24 18 22 36 22 35 32 30 29 38 37 28 35 18 24 28 30 28\n [3889] 29 23 36 22 33 27 38 33 24 36 32 25 19 23 28 34 32 23 32 23 22 31 20 19\n [3913] 39 35 35 30 22 40 28 26 23 27 33 21 31 37 29 30 28 27 31 32 36 27 39 18\n [3937] 35 33 20 27 24 35 40 38 35 27 20 18 37 29 19 35 21 31 25 22 37 20 38 37\n [3961] 38 30 20 34 40 35 27 33 33 29 25 39 34 18 39 23 18 31 40 32 21 29 39 19\n [3985] 31 23 23 27 20 38 23 34 19 31 23 25 20 33 39 34 40 27 32 26 36 38 31 20\n [4009] 18 20 22 32 26 35 35 24 24 27 28 18 21 36 37 23 19 18 30 39 28 30 22 36\n [4033] 18 23 36 22 36 33 31 26 23 30 34 34 37 18 39 36 18 27 23 25 23 22 37 18\n [4057] 38 28 37 35 39 27 26 24 22 20 23 37 18 30 19 19 28 18 29 21 36 33 32 39\n [4081] 34 25 20 33 24 39 27 18 24 38 23 30 27 21 23 35 25 18 35 35 32 38 38 35\n [4105] 39 36 39 29 18 23 37 32 34 24 25 35 18 18 25 36 27 40 35 20 19 19 34 19\n [4129] 20 19 40 34 40 39 29 24 39 33 20 34 40 27 25 25 25 19 31 22 39 31 26 39\n [4153] 25 28 20 22 29 32 28 27 26 24 25 19 37 37 23 38 24 32 25 29 31 38 37 32\n [4177] 21 36 32 22 39 36 39 22 34 23 36 37 29 18 35 25 21 34 33 34 24 37 33 26\n [4201] 35 21 29 38 25 37 27 32 18 25 23 18 21 24 26 31 20 28 37 22 40 19 29 39\n [4225] 21 27 31 28 33 29 26 39 22 33 27 32 19 39 37 25 18 35 24 23 20 34 21 30\n [4249] 29 38 21 25 33 29 31 25 33 22 34 28 20 36 27 35 25 19 36 28 20 26 23 21\n [4273] 36 32 34 40 29 34 31 32 36 38 37 36 21 35 18 22 22 21 30 34 32 31 38 24\n [4297] 27 34 28 27 26 28 26 27 35 38 34 36 18 20 31 26 30 30 21 23 40 40 39 27\n [4321] 27 28 32 39 32 26 39 19 24 20 22 18 38 26 29 26 40 26 21 27 20 40 27 39\n [4345] 28 29 38 38 23 25 30 33 34 36 31 35 30 30 31 39 29 36 37 36 18 27 36 18\n [4369] 33 38 31 36 32 30 21 21 38 22 37 37 28 34 18 23 22 32 18 30 30 30 33 26\n [4393] 38 28 30 37 27 31 37 22 25 39 31 23 33 21 21 22 32 35 26 21 34 25 36 23\n [4417] 31 36 37 25 35 35 29 37 34 37 23 22 21 24 20 32 21 33 24 29 23 24 35 23\n [4441] 34 29 25 35 27 20 24 23 35 20 32 30 28 20 32 23 19 26 25 33 20 39 38 27\n [4465] 29 28 21 39 35 21 36 30 18 37 36 28 21 39 37 31 23 27 39 34 36 25 22 33\n [4489] 29 23 21 29 30 37 29 23 26 19 38 23 24 35 29 27 36 19 27 24 31 39 23 24\n [4513] 19 29 30 18 37 23 20 32 31 39 22 27 23 35 36 25 26 38 37 19 25 30 38 33\n [4537] 31 39 23 37 31 18 22 27 35 26 33 26 28 23 24 32 31 24 37 27 27 21 36 24\n [4561] 19 30 23 37 26 32 39 37 24 26 38 22 22 23 37 19 18 29 19 29 19 35 22 28\n [4585] 25 30 33 26 21 32 23 20 39 24 22 33 30 26 20 38 33 40 18 30 34 28 39 40\n [4609] 28 35 23 37 40 22 25 21 34 38 28 38 40 21 24 33 20 22 20 37 25 37 18 29\n [4633] 26 25 18 26 38 30 33 31 35 29 35 21 25 35 19 25 22 30 19 25 36 37 22 29\n [4657] 32 28 21 38 27 40 29 19 24 38 39 33 33 37 29 25 25 36 33 30 39 23 33 38\n [4681] 18 34 34 33 24 38 24 26 25 33 36 28 23 22 23 26 18 24 27 24 30 29 24 24\n [4705] 31 36 31 37 28 27 26 19 29 40 19 37 21 34 29 19 35 31 30 18 30 40 26 31\n [4729] 24 31 37 32 35 30 27 31 39 31 35 33 29 19 35 37 29 33 21 29 40 38 20 24\n [4753] 33 30 31 29 18 36 40 28 25 37 23 19 25 39 22 24 25 35 24 36 28 27 26 30\n [4777] 22 24 37 26 24 28 36 20 38 29 26 32 34 33 27 33 25 34 27 22 38 22 28 28\n [4801] 23 31 36 22 40 19 39 31 26 21 39 39 29 18 19 38 39 37 39 23 31 25 22 38\n [4825] 29 18 32 20 23 24 26 35 27 36 31 31 37 35 31 37 35 30 31 20 21 22 29 23\n [4849] 19 32 26 20 18 23 33 30 32 28 39 35 29 35 36 32 38 34 23 29 30 25 18 32\n [4873] 40 33 31 27 31 26 23 19 37 22 23 22 39 38 18 32 34 25 23 23 32 30 29 38\n [4897] 21 31 34 18 34 32 27 20 35 20 25 39 30 23 37 23 29 26 21 36 22 25 37 18\n [4921] 23 35 21 21 36 27 20 29 22 25 38 38 25 30 23 40 39 29 22 19 32 25 25 39\n [4945] 26 30 37 40 31 34 28 23 35 19 31 39 23 18 20 26 37 23 27 40 25 23 29 40\n [4969] 23 30 29 26 30 18 31 26 32 34 26 39 36 24 18 39 39 19 35 24 22 38 30 37\n [4993] 39 40 19 26 32 33 21 30 24 40 21 32 30 39 20 33 28 32 25 25 26 34 29 27\n [5017] 36 30 21 29 38 36 29 34 26 34 40 31 34 22 27 28 25 35 19 30 21 21 21 37\n [5041] 38 18 37 27 29 31 31 36 32 29 35 26 34 21 18 40 38 31 34 33 40 36 37 20\n [5065] 40 22 35 26 38 23 18 23 19 40 24 22 23 32 40 40 28 25 36 23 35 29 39 21\n [5089] 32 31 28 33 31 24 28 31 27 32 20 27 18 29 33 23 33 19 27 29 29 24 19 30\n [5113] 22 28 40 30 26 36 19 32 29 34 32 25 30 39 28 40 33 28 32 25 37 37 36 33\n [5137] 22 29 31 25 29 33 21 20 31 31 40 36 34 29 25 19 36 30 36 22 35 21 26 37\n [5161] 32 32 36 34 29 23 29 23 37 27 40 37 18 27 18 19 26 35 31 34 20 29 28 38\n [5185] 26 30 21 35 28 31 40 19 40 38 31 33 37 37 28 34 33 33 18 35 24 32 35 35\n [5209] 27 28 24 32 18 38 23 19 40 37 20 38 19 40 25 38 39 37 33 22 35 23 35 34\n [5233] 22 31 20 31 20 38 35 26 21 22 33 23 23 38 24 40 23 22 25 38 23 21 40 26\n [5257] 34 33 30 33 31 23 26 39 28 32 36 29 22 28 38 22 29 21 23 30 32 34 27 19\n [5281] 19 20 39 29 36 35 27 37 21 35 21 22 26 20 39 26 27 34 37 40 35 21 29 39\n [5305] 20 24 37 24 29 18 26 35 40 35 22 30 40 25 39 31 32 23 30 25 26 23 21 24\n [5329] 24 35 25 25 30 24 29 29 23 31 25 22 23 25 23 21 19 37 26 35 40 29 21 20\n [5353] 30 23 32 24 33 21 32 18 19 28 25 31 27 38 26 27 37 22 36 27 26 38 36 36\n [5377] 31 27 20 26 19 40 22 22 29 29 36 40 30 32 20 19 26 28 37 22 40 28 27 25\n [5401] 40 30 22 32 31 39 24 37 26 31 34 39 24 35 34 21 26 33 27 40 21 20 18 33\n [5425] 26 22 35 31 29 35 35 32 30 18 31 40 38 24 26 19 33 33 40 26 25 19 26 24\n [5449] 24 21 31 27 39 23 18 18 38 20 18 38 38 34 35 33 33 32 35 35 34 30 29 27\n [5473] 35 19 21 23 31 35 26 20 36 25 33 34 25 33 28 25 38 19 22 33 29 22 22 21\n [5497] 39 22 25 39 25 36 28 20 29 21 27 33 27 24 32 33 38 18 24 35 34 35 30 25\n [5521] 23 30 30 26 33 33 40 24 29 19 40 22 24 31 34 40 25 18 29 36 20 24 40 18\n [5545] 26 23 26 30 21 24 36 32 32 40 39 26 28 30 31 28 20 25 29 33 23 20 32 39\n [5569] 32 30 33 39 28 38 20 29 39 22 39 29 21 29 30 25 32 28 19 30 30 27 24 26\n [5593] 33 34 29 25 18 21 39 36 21 19 28 30 20 21 25 34 25 24 18 19 22 24 24 26\n [5617] 37 28 24 32 37 18 25 33 30 32 32 37 38 21 39 35 35 18 30 36 39 34 34 21\n [5641] 20 25 38 30 31 25 25 25 32 26 25 19 27 32 27 19 25 37 37 32 31 36 36 39\n [5665] 30 28 30 32 34 31 35 28 27 30 32 26 40 38 25 33 33 37 38 20 38 20 28 33\n [5689] 19 29 20 26 30 22 19 25 20 31 33 32 28 26 21 19 39 27 23 35 25 18 24 28\n [5713] 34 40 34 40 20 32 30 32 36 32 18 40 23 29 22 26 32 37 32 28 40 23 35 38\n [5737] 37 32 22 19 34 35 32 18 18 37 40 29 37 21 19 21 22 29 36 18 28 36 24 32\n [5761] 35 36 39 31 28 21 36 22 25 32 29 29 24 27 33 30 34 23 33 34 27 39 36 35\n [5785] 36 19 18 38 36 34 31 29 40 31 21 36 29 30 40 31 36 29 33 34 18 27 22 26\n [5809] 24 31 35 39 20 30 33 33 39 18 39 18 28 22 20 34 31 39 25 31 35 39 37 22\n [5833] 19 30 20 33 38 40 21 21 22 36 30 34 26 22 21 33 40 24 27 23 37 19 19 24\n [5857] 38 37 37 30 23 30 21 38 32 22 23 23 28 40 21 20 29 23 31 33 19 36 28 34\n [5881] 34 31 40 31 29 39 23 28 24 19 35 39 40 32 34 31 31 18 24 39 37 38 22 24\n [5905] 22 32 32 34 32 23 20 24 18 24 21 25 31 24 26 31 19 24 34 39 20 24 25 31\n [5929] 35 23 37 33 27 21 36 33 25 33 26 38 25 23 32 23 23 33 37 18 33 25 34 32\n [5953] 33 36 30 30 38 30 20 38 35 31 35 37 29 25 20 38 30 39 21 21 25 28 34 28\n [5977] 23 31 37 24 27 28 38 22 26 20 28 20 32 19 37 40 36 21 23 20 38 29 32 19\n [6001] 32 34 35 30 25 20 38 28 20 32 40 33 34 37 19 32 40 30 33 21 38 38 38 27\n [6025] 28 26 37 26 30 33 28 40 40 38 19 23 28 29 20 34 30 34 33 23 22 40 28 25\n [6049] 27 39 25 20 27 40 28 40 35 24 32 38 24 19 26 20 36 28 31 32 33 23 31 29\n [6073] 25 19 21 34 24 39 35 38 31 24 19 38 33 30 31 40 37 20 39 38 24 30 36 33\n [6097] 21 38 29 33 20 23 35 34 29 40 35 20 37 23 35 38 21 34 28 27 38 25 29 32\n [6121] 24 30 29 22 27 40 20 29 24 32 34 36 23 29 19 20 32 33 23 35 40 37 24 34\n [6145] 25 34 37 20 28 31 19 19 34 18 29 25 21 33 37 34 23 40 24 19 32 26 39 19\n [6169] 32 39 30 36 37 26 20 26 21 23 36 39 20 25 33 32 34 25 33 31 20 35 21 30\n [6193] 28 18 27 37 37 24 25 28 27 23 24 38 24 36 35 30 40 22 19 19 21 38 18 29\n [6217] 23 30 26 33 18 28 33 36 18 35 38 21 36 24 20 24 32 35 20 29 36 32 22 25\n [6241] 40 22 19 20 35 18 30 25 22 40 24 21 24 27 24 26 27 30 24 32 40 36 27 20\n [6265] 33 22 21 23 25 29 26 36 24 21 36 40 21 32 32 34 27 30 35 35 19 34 33 33\n [6289] 31 23 21 29 33 28 34 20 18 33 30 38 22 30 39 24 23 25 36 18 19 33 28 21\n [6313] 39 31 30 27 21 31 37 37 39 34 39 31 37 40 37 20 18 27 26 32 36 22 28 24\n [6337] 40 38 22 20 33 38 36 18 40 25 28 19 32 29 27 18 25 27 22 21 35 38 21 29\n [6361] 35 33 33 30 39 22 33 31 21 40 18 31 18 30 30 23 33 19 38 36 30 22 25 29\n [6385] 22 26 28 30 34 28 25 18 18 26 25 37 29 21 27 35 36 36 20 39 39 28 32 23\n [6409] 19 24 29 35 25 25 24 28 38 35 34 22 40 21 23 18 36 20 34 20 19 18 35 24\n [6433] 34 35 28 34 29 23 36 30 25 32 25 30 37 27 37 24 20 25 34 20 34 37 18 22\n [6457] 23 32 36 39 25 34 34 34 27 19 25 35 40 37 21 27 34 20 37 23 24 25 18 18\n [6481] 31 33 23 28 20 25 40 38 25 30 40 40 28 35 23 39 18 38 18 18 26 38 32 35\n [6505] 35 39 29 32 39 22 28 24 32 20 19 37 23 31 19 19 36 25 26 38 19 27 29 30\n [6529] 20 34 30 25 33 26 31 18 31 40 29 26 33 28 24 28 22 27 27 33 39 34 35 18\n [6553] 26 38 38 20 37 39 32 23 35 20 39 34 20 22 40 28 38 19 26 36 37 21 23 36\n [6577] 20 27 39 22 33 23 19 19 35 23 22 38 35 28 24 36 25 26 34 18 25 37 19 22\n [6601] 18 21 34 23 38 22 34 36 19 23 32 38 31 40 35 19 19 27 20 22 28 21 35 27\n [6625] 32 32 20 40 31 39 27 33 29 23 30 22 36 36 33 27 34 18 35 18 26 21 28 24\n [6649] 28 33 38 26 24 30 29 33 24 40 29 32 31 36 32 35 18 34 34 30 18 22 38 30\n [6673] 32 21 27 19 34 34 29 36 23 24 29 18 21 27 38 38 22 26 40 28 18 21 20 24\n [6697] 29 39 39 19 37 20 25 39 26 33 30 34 31 27 34 34 34 19 37 18 19 23 39 27\n [6721] 38 19 37 33 21 20 21 25 27 23 22 36 29 24 25 27 31 37 26 37 24 28 30 37\n [6745] 23 27 22 35 26 28 33 40 38 24 28 28 40 31 25 20 19 30 21 24 29 25 19 25\n [6769] 20 22 25 23 23 31 36 35 27 37 31 18 27 40 22 29 39 18 33 27 33 29 30 19\n [6793] 25 39 32 36 33 39 32 28 40 20 37 21 28 32 35 23 34 19 29 26 38 38 36 36\n [6817] 20 35 22 39 23 20 22 31 24 19 18 31 18 32 32 35 28 40 27 30 40 29 35 32\n [6841] 28 38 35 38 33 38 23 18 32 23 31 39 33 23 20 34 32 32 31 36 35 21 35 26\n [6865] 33 22 37 34 26 35 36 31 22 19 36 39 38 35 38 33 28 36 18 40 18 34 36 20\n [6889] 25 38 26 25 18 29 36 22 34 23 25 24 19 40 36 39 32 36 24 27 38 27 27 21\n [6913] 30 38 18 22 30 33 38 26 21 31 25 31 40 36 40 19 39 31 20 30 28 35 37 40\n [6937] 23 37 31 28 39 34 20 29 23 22 35 27 40 33 31 24 32 36 38 20 25 35 32 39\n [6961] 37 18 35 36 34 28 21 37 18 32 39 25 22 28 32 36 25 25 40 18 27 32 22 31\n [6985] 38 36 26 23 27 35 33 21 24 30 34 38 23 39 29 40 40 33 39 38 33 19 34 33\n [7009] 30 37 28 40 39 26 20 23 40 21 31 30 21 22 32 22 31 29 30 37 31 39 21 35\n [7033] 20 23 18 21 28 34 40 31 18 32 28 27 25 32 26 34 36 33 22 39 18 18 25 28\n [7057] 33 28 25 37 31 22 25 31 34 35 24 22 26 30 24 19 23 20 31 24 18 19 29 18\n [7081] 37 25 35 23 38 23 35 39 34 18 19 34 31 26 34 40 29 19 20 31 18 32 33 36\n [7105] 30 26 29 36 40 35 34 37 36 23 22 30 18 27 31 29 34 20 25 18 35 21 30 39\n [7129] 20 21 20 31 18 35 25 38 32 24 30 24 31 35 18 25 19 32 20 31 29 29 35 27\n [7153] 21 33 39 19 18 21 29 19 29 19 21 21 18 26 21 40 21 35 32 32 31 21 34 30\n [7177] 19 29 21 23 18 29 23 36 28 37 24 18 27 25 37 33 34 25 36 20 26 32 38 38\n [7201] 37 32 20 28 21 40 26 32 23 38 30 27 38 32 38 27 35 35 28 25 28 28 20 30\n [7225] 26 30 27 22 37 31 35 38 30 19 25 29 25 30 21 24 27 18 20 32 30 31 28 24\n [7249] 37 38 33 22 26 20 34 39 32 27 28 32 29 23 34 34 32 22 34 27 30 39 26 26\n [7273] 29 31 25 31 28 37 33 24 35 24 32 20 18 29 40 19 23 37 20 32 24 40 27 21\n [7297] 33 33 29 23 21 23 22 32 23 29 32 24 39 30 28 24 34 33 27 24 22 24 31 38\n [7321] 27 32 30 25 32 35 27 25 20 36 19 31 23 35 29 36 28 23 40 25 39 29 32 31\n [7345] 31 33 34 35 26 38 37 40 40 35 31 20 33 19 39 23 19 26 31 29 19 33 38 35\n [7369] 31 23 28 35 28 19 36 32 27 21 25 23 23 40 20 33 28 28 37 33 21 18 40 33\n [7393] 36 34 35 20 31 32 39 24 20 36 34 24 29 23 33 19 23 33 37 18 40 32 23 40\n [7417] 25 25 31 34 27 20 18 30 22 21 30 26 29 25 38 21 38 28 30 18 30 23 29 28\n [7441] 20 38 25 25 24 31 31 38 25 40 27 37 34 40 28 30 21 25 35 25 25 33 21 31\n [7465] 24 27 34 18 32 38 20 26 24 19 37 33 25 33 21 22 34 33 36 28 25 35 23 29\n [7489] 23 22 21 33 26 33 40 18 21 21 33 40 27 33 37 38 32 25 18 36 20 27 40 35\n [7513] 38 36 27 21 22 40 39 28 28 29 26 22 25 24 40 25 22 32 27 19 32 27 20 40\n [7537] 21 20 37 40 29 39 30 32 23 22 19 23 35 34 32 26 26 30 28 20 35 37 28 18\n [7561] 36 23 38 27 30 19 34 28 24 18 40 34 37 19 32 38 37 20 19 36 21 22 32 28\n [7585] 35 18 32 29 30 19 39 19 34 19 18 29 23 18 27 32 24 23 20 29 18 28 18 27\n [7609] 35 33 37 19 26 37 29 36 25 30 23 38 23 27 19 26 21 29 29 37 25 28 36 22\n [7633] 38 27 38 32 21 40 25 33 23 37 40 35 20 40 33 28 36 27 27 25 27 21 37 30\n [7657] 27 38 25 36 24 21 38 36 32 23 22 32 27 32 24 19 27 32 26 24 21 39 23 20\n [7681] 39 22 28 24 32 20 35 34 32 18 27 20 33 32 34 27 40 25 19 27 40 34 23 22\n [7705] 20 24 21 26 29 38 35 37 30 40 32 35 40 38 33 40 33 33 34 20 19 39 32 32\n [7729] 21 38 22 23 34 20 18 30 29 39 40 40 33 24 37 29 34 19 20 22 27 32 20 22\n [7753] 18 29 32 25 23 30 36 34 19 26 34 19 24 39 24 37 21 21 23 25 25 27 37 28\n [7777] 18 31 21 23 23 23 30 28 21 28 33 22 27 33 23 25 39 38 30 31 29 30 25 39\n [7801] 21 19 32 19 26 30 29 25 35 30 34 31 36 34 24 37 29 32 24 36 27 20 37 28\n [7825] 27 23 26 33 36 18 23 25 36 28 40 34 21 18 20 23 39 39 33 33 25 27 21 18\n [7849] 20 40 40 32 33 19 27 32 26 38 37 21 18 33 38 30 21 28 37 35 21 21 35 34\n [7873] 26 19 32 25 19 30 38 40 18 29 38 30 40 23 28 30 32 34 18 37 26 39 37 25\n [7897] 23 27 32 38 36 34 25 19 18 31 31 23 33 35 33 26 21 31 33 36 19 22 39 18\n [7921] 31 30 18 26 32 19 29 36 22 20 19 40 33 33 19 35 28 26 29 34 31 33 26 22\n [7945] 32 31 26 27 35 37 35 35 19 35 38 29 34 21 26 19 31 35 24 23 23 39 37 29\n [7969] 27 22 24 28 31 28 22 37 23 30 35 35 22 33 30 30 28 20 30 20 26 20 40 19\n [7993] 18 27 32 19 18 34 18 40 20 23 35 36 26 34 34 27 36 35 36 24 39 21 38 30\n [8017] 29 27 33 18 31 32 32 33 32 23 20 19 36 27 26 27 40 21 30 33 27 31 32 21\n [8041] 39 23 21 30 23 21 36 21 25 25 36 23 39 21 29 33 18 37 34 32 19 37 33 40\n [8065] 21 39 21 26 26 33 24 30 37 24 20 19 25 37 33 20 26 21 25 23 23 22 31 32\n [8089] 36 40 32 30 21 23 18 36 33 22 25 25 28 22 20 28 19 20 29 20 38 22 23 32\n [8113] 39 33 28 39 23 25 24 22 25 36 35 24 20 37 26 33 35 21 25 34 30 25 29 25\n [8137] 38 40 19 40 37 26 22 30 28 25 34 24 19 20 30 30 27 25 32 18 38 37 24 22\n [8161] 34 23 26 19 25 21 18 38 31 18 36 31 30 24 38 19 22 22 34 32 28 19 24 34\n [8185] 20 26 28 24 34 37 26 30 25 20 26 40 31 18 35 25 31 40 23 35 29 22 38 40\n [8209] 31 35 30 24 22 36 32 40 18 39 36 19 31 31 35 29 19 32 32 26 22 22 36 38\n [8233] 34 28 34 19 29 32 39 36 18 26 21 33 38 19 24 28 40 39 26 29 25 23 31 23\n [8257] 25 39 20 28 39 38 29 33 25 26 18 27 21 31 37 18 20 40 28 24 23 39 25 21\n [8281] 27 38 18 31 22 36 33 38 30 19 36 37 29 25 32 40 33 28 19 23 27 29 40 21\n [8305] 38 23 37 40 40 27 20 36 34 39 25 37 38 34 25 33 22 20 31 25 38 18 24 31\n [8329] 23 22 34 39 34 39 25 39 32 20 27 39 40 39 26 39 28 24 23 19 36 26 31 23\n [8353] 24 39 25 39 33 20 27 32 31 30 23 21 26 26 23 33 27 29 37 30 39 31 26 25\n [8377] 21 19 34 38 28 35 30 23 37 25 34 35 25 27 39 20 19 32 34 20 24 34 27 19\n [8401] 25 40 24 31 31 36 25 28 35 25 36 24 39 37 28 39 36 18 29 24 37 30 36 31\n [8425] 19 39 35 37 38 28 21 35 36 35 31 36 31 37 37 20 34 27 32 22 19 30 37 40\n [8449] 40 39 21 34 19 32 32 33 36 24 21 29 25 24 30 24 27 35 40 22 18 34 33 23\n [8473] 40 36 22 36 40 21 23 36 22 25 21 23 30 37 40 30 32 23 32 22 36 31 39 35\n [8497] 28 29 25 36 33 26 28 35 33 35 34 32 30 20 24 30 34 35 26 37 39 20 19 21\n [8521] 27 31 33 30 32 29 25 20 30 23 36 22 35 37 26 27 24 27 36 21 28 32 32 23\n [8545] 23 19 34 23 33 30 29 23 18 36 38 40 22 25 40 36 26 29 25 27 40 40 29 22\n [8569] 18 31 32 26 27 31 37 28 28 24 39 34 39 32 30 37 24 30 37 18 30 28 32 34\n [8593] 29 40 34 28 21 19 30 26 22 39 19 18 31 19 33 28 40 39 22 36 21 22 20 35\n [8617] 38 21 21 33 18 23 26 36 18 34 32 22 35 30 36 31 39 33 27 34 33 34 19 35\n [8641] 22 34 20 38 38 31 29 19 37 20 28 25 38 39 28 22 32 20 33 25 37 37 40 22\n [8665] 35 36 20 33 37 24 39 29 19 23 27 36 29 26 24 33 29 38 40 28 26 34 20 24\n [8689] 30 21 20 25 22 18 36 20 36 26 18 22 26 28 34 38 37 30 37 39 31 36 32 38\n [8713] 20 34 23 37 33 38 26 38 38 27 33 20 26 30 21 23 18 30 22 37 27 21 39 31\n [8737] 20 22 36 18 38 19 29 27 36 25 37 27 32 27 29 35 19 28 24 19 28 26 18 33\n [8761] 36 30 40 34 24 30 33 40 22 39 33 28 21 26 22 31 20 25 28 25 34 20 39 31\n [8785] 28 35 34 23 23 19 29 36 38 27 33 39 32 20 24 36 38 19 20 25 36 37 27 37\n [8809] 39 30 38 20 30 40 36 23 36 39 21 31 30 40 35 34 19 30 39 21 26 35 18 20\n [8833] 20 26 29 29 20 33 38 21 19 30 21 29 20 18 24 26 29 33 21 37 34 19 23 24\n [8857] 18 32 36 21 40 39 22 39 18 39 26 25 21 34 35 36 21 37 18 23 25 27 19 25\n [8881] 25 33 33 39 40 18 34 40 36 19 18 27 33 22 21 33 21 39 20 34 31 40 29 26\n [8905] 38 21 20 39 25 30 18 33 27 28 39 20 22 35 19 28 38 38 28 36 23 28 39 36\n [8929] 34 30 38 32 29 27 23 33 23 18 37 37 18 30 33 38 40 36 40 36 38 27 22 34\n [8953] 29 31 29 32 35 24 25 40 34 22 36 32 28 40 23 23 21 22 40 30 34 35 23 30\n [8977] 25 26 31 32 36 31 38 27 38 30 31 36 40 36 29 19 19 31 29 34 34 34 25 29\n [9001] 22 32 33 20 29 35 30 35 32 30 37 39 36 38 38 25 32 34 30 29 35 29 38 25\n [9025] 37 18 38 32 36 28 37 31 30 36 21 35 28 23 34 39 23 35 18 22 27 31 20 35\n [9049] 27 30 24 38 29 34 39 21 23 32 32 34 37 27 23 33 27 39 29 36 39 29 37 38\n [9073] 38 22 38 19 31 34 20 21 28 26 28 29 19 20 26 35 34 34 33 27 26 31 35 40\n [9097] 18 18 35 25 38 29 19 34 40 38 24 20 35 27 32 33 23 40 26 30 19 37 27 22\n [9121] 33 30 32 26 25 22 30 30 36 39 27 24 34 25 35 26 38 29 37 29 22 31 19 38\n [9145] 33 27 21 29 31 29 28 37 23 29 30 25 18 32 19 26 19 38 31 20 34 21 28 34\n [9169] 33 25 25 35 19 24 39 40 35 20 37 20 31 40 30 30 32 23 20 29 36 18 31 33\n [9193] 37 26 28 25 27 37 34 29 27 37 36 18 38 28 36 26 35 37 24 26 31 31 37 40\n [9217] 37 38 36 33 32 32 27 23 26 32 27 24 27 37 39 26 30 38 23 18 23 18 39 27\n [9241] 24 19 20 23 19 21 32 40 29 18 28 37 37 28 40 26 29 39 21 35 25 35 35 27\n [9265] 37 39 33 27 39 24 23 40 29 27 40 18 20 19 37 25 18 35 21 21 32 23 34 40\n [9289] 21 34 27 29 36 25 26 38 40 36 26 34 30 35 29 20 22 39 23 29 29 23 30 20\n [9313] 40 34 35 27 27 21 38 31 22 23 40 33 35 36 19 33 30 39 26 34 20 21 23 34\n [9337] 28 25 22 34 39 38 24 34 22 36 38 18 38 34 40 24 30 34 21 39 33 23 30 35\n [9361] 21 27 38 29 19 31 39 35 31 34 35 26 21 36 31 26 32 27 24 29 28 38 33 24\n [9385] 39 33 33 30 24 33 21 25 35 37 27 18 35 31 35 40 32 23 23 39 19 33 25 33\n [9409] 35 30 23 30 22 25 18 31 27 31 19 19 35 39 40 35 37 37 27 18 20 39 36 22\n [9433] 34 26 36 38 24 32 33 23 34 26 31 37 27 30 19 25 21 22 18 29 35 32 22 21\n [9457] 32 27 31 36 28 33 40 36 22 36 32 37 29 39 32 31 33 36 35 30 40 40 39 27\n [9481] 35 37 20 31 24 37 25 37 31 22 28 35 30 40 27 30 30 27 29 37 25 23 29 23\n [9505] 22 22 28 40 35 26 36 40 34 35 40 21 18 38 27 39 31 20 22 30 29 25 27 40\n [9529] 36 39 26 24 27 26 20 31 35 35 19 40 23 24 20 32 25 33 27 26 20 34 22 35\n [9553] 36 31 38 37 23 30 22 26 28 40 36 38 39 24 39 19 38 40 21 38 18 38 19 24\n [9577] 35 30 31 26 35 20 33 29 27 18 31 40 28 19 40 23 27 33 21 37 22 27 20 37\n [9601] 35 36 18 38 34 21 26 20 26 25 39 31 28 27 29 29 38 29 21 38 19 19 39 31\n [9625] 34 28 26 34 30 40 22 29 36 22 32 32 19 32 22 18 23 21 33 23 19 26 20 19\n [9649] 33 28 39 24 23 27 38 22 24 28 19 32 39 23 27 18 19 19 32 24 38 36 22 31\n [9673] 18 27 39 35 19 18 24 34 22 26 37 28 25 29 27 27 40 29 23 20 22 31 36 25\n [9697] 27 23 33 31 36 28 24 39 19 32 22 28 26 38 34 28 30 18 36 37 26 28 29 31\n [9721] 30 39 33 30 21 20 20 18 33 28 40 28 22 36 39 25 39 19 29 30 30 22 24 27\n [9745] 39 20 29 32 26 27 23 34 31 31 27 22 38 32 39 22 30 27 21 30 28 34 35 36\n [9769] 40 31 20 19 29 33 29 34 24 18 27 20 22 39 36 39 37 21 31 33 31 38 40 22\n [9793] 26 24 31 29 36 20 27 35 23 34 31 20 39 29 31 26 23 21 32 32 40 29 36 32\n [9817] 23 35 28 34 28 31 31 39 21 34 38 27 28 28 18 27 37 38 27 23 19 25 31 18\n [9841] 19 25 35 25 18 25 31 24 30 27 35 28 32 26 26 40 35 28 28 38 31 31 34 30\n [9865] 39 19 26 36 31 30 22 18 29 38 20 31 34 23 24 19 39 26 22 40 33 36 21 40\n [9889] 38 29 20 39 23 25 35 35 39 35 35 36 37 39 24 39 39 22 20 26 29 34 29 28\n [9913] 26 35 33 35 21 25 40 38 35 26 19 24 21 22 33 19 23 25 32 30 31 27 23 36\n [9937] 39 36 29 26 24 22 29 31 23 23 30 27 19 22 24 18 26 22 35 28 34 26 22 34\n [9961] 21 28 20 21 33 35 30 26 18 28 26 27 27 33 31 32 20 36 30 19 35 38 21 18\n [9985] 39 30 32 31 22 33 32 29 34 38 26 37 36 37 22 18 37 39 25 31 20 38 22 36\n[10009] 34 26 38 24 37 25 35 28 18 32 37 26 40 25 27 33 40 31 38 31 39 29 30 28\n[10033] 20 39 22 24 36 26 21 21 26 18 20 39 25 29 38 39 24 34 21 20 25 38 23 28\n[10057] 18 37 38 22 19 39 23 26 27 34 30 23 22 24 36 35 36 34 25 27 18 21 22 28\n[10081] 37 34 34 37 25 23 23 32 23 27 35 26 39 25 22 33 19 27 26 25 19 27 24 22\n[10105] 36 36 31 29 29 38 40 25 38 25 28 31 35 26 27 22 23 39 29 39 30 26 37 18\n[10129] 22 20 39 34 22 40 27 34 23 36 30 20 39 29 29 28 20 32 27 33 33 28 22 28\n[10153] 25 24 39 24 22 23 36 21 35 33 26 40 24 33 35 34 23 40 20 24 22 37 29 26\n[10177] 31 31 33 22 23 40 29 21 27 31 24 23 24 28 35 27 33 35 21 31 22 25 39 19\n[10201] 33 28 24 27 35 34 36 31 26 26 32 25 19 38 25 18 36 29 32 30 31 23 32 25\n[10225] 24 35 26 39 37 34 19 38 22 39 33 40 36 33 30 28 36 39 26 29 19 20 26 28\n[10249] 29 35 37 19 35 39 24 35 29 32 26 20 30 25 20 39 34 27 38 25 24 39 19 35\n[10273] 20 36 19 40 39 29 19 31 38 36 23 37 23 33 24 40 38 32 40 27 19 29 32 27\n[10297] 35 33 34 27 37 20 26 33 18 34 32 30 25 22 25 22 34 19 26 38 36 32 39 25\n[10321] 20 30 26 32 31 18 38 32 40 33 26 40 30 25 25 32 30 36 27 24 28 26 28 40\n[10345] 39 40 33 24 35 29 22 31 22 40 32 29 28 28 32 29 24 38 24 19 23 36 21 20\n[10369] 24 40 26 24 25 18 36 36 20 32 24 29 18 27 23 30 39 37 20 18 20 37 28 28\n[10393] 24 36 19 29 20 30 33 34 20 31 18 28 23 28 22 32 21 27 36 25 20 29 33 30\n[10417] 24 37 39 29 22 36 37 32 40 38 23 26 38 32 38 34 39 33 34 34 40 22 29 31\n[10441] 39 27 36 38 34 30 19 35 39 26 37 31 19 24 34 37 36 33 30 29 19 25 36 36\n[10465] 26 25 40 31 28 36 30 26 22 29 30 19 34 30 39 40 25 28 28 38 34 40 23 38\n[10489] 19 38 18 30 18 19 26 37 31 19 29 26 36 38 37 35 33 26 40 30 39 27 32 29\n[10513] 26 29 32 26 39 38 30 34 25 19 24 30 18 35 18 38 34 18 23 36 36 40 40 32\n[10537] 40 29 27 21 27 35 33 36 38 38 23 20 36 24 32 35 29 23 37 23 22 19 29 37\n[10561] 32 18 32 35 24 34 35 36 19 21 35 25 18 23 35 19 38 31 23 26 32 21 35 21\n[10585] 34 29 18 33 35 27 36 30 27 21 24 18 34 28 33 35 24 40 21 21 29 19 32 36\n[10609] 29 29 20 21 30 20 30 19 33 23 29 33 34 19 28 40 35 27 22 24 28 25 18 26\n[10633] 24 31 21 25 28 24 18 35 31 27 32 20 40 18 35 35 29 25 18 22 26 38 25 22\n[10657] 40 21 34 32 20 28 24 35 19 29 20 29 24 34 26 32 29 40 38 20 21 37 30 22\n[10681] 36 38 20 22 33 33 21 38 34 40 27 26 23 18 28 36 25 19 19 19 21 25 22 37\n[10705] 22 33 29 31 22 26 18 32 29 34 38 30 22 27 22 28 21 29 23 39 33 18 19 27\n[10729] 23 34 40 21 24 39 23 25 26 35 20 21 37 33 23 32 37 24 22 33 38 21 18 23\n[10753] 35 37 25 30 29 33 22 18 28 30 26 29 35 33 33 29 29 31 25 36 29 22 31 26\n[10777] 35 31 28 39 22 33 27 39 30 34 35 19 31 39 30 36 30 31 21 29 19 21 24 22\n[10801] 18 31 35 29 29 29 19 37 37 27 24 23 23 21 35 25 38 31 25 33 39 37 29 33\n[10825] 27 30 33 23 25 39 37 25 22 20 26 20 39 39 24 21 35 36 22 33 30 39 21 33\n[10849] 24 19 23 39 24 23 28 31 40 34 23 23 28 38 31 33 33 40 29 21 18 26 28 39\n[10873] 33 29 29 27 28 33 33 26 29 20 29 26 28 30 23 18 24 23 25 38 25 30 37 34\n[10897] 36 32 25 35 35 20 23 33 27 40 35 24 24 25 24 19 28 29 33 33 28 40 35 38\n[10921] 37 21 33 23 39 32 32 21 27 29 32 26 28 19 27 22 19 34 18 34 21 30 25 34\n[10945] 18 36 19 36 32 20 34 27 19 20 26 39 29 21 28 30 25 27 37 36 23 30 22 38\n[10969] 38 32 30 25 39 30 29 36 28 26 27 20 34 29 35 34 33 37 38 20 39 36 19 38\n[10993] 39 35 23 24 34 38 31 30 19 29 34 37 39 40 36 23 33 35 18 33 20 28 31 35\n[11017] 23 26 23 29 25 25 36 27 20 28 22 39 23 27 28 21 34 36 38 29 18 33 31 28\n[11041] 24 29 33 36 25 34 21 37 40 37 28 18 39 31 18 27 23 30 37 30 20 36 33 33\n[11065] 36 40 30 29 28 35 23 39 21 32 36 33 35 20 23 30 21 28 36 23 40 21 23 40\n[11089] 38 28 33 37 37 37 19 27 21 39 23 33 21 24 33 18 23 39 30 38 39 23 30 18\n[11113] 18 27 20 25 37 18 39 40 25 19 18 37 21 22 34 20 40 21 31 35 27 37 29 34\n[11137] 18 24 26 30 35 28 32 38 20 38 30 35 36 29 21 39 35 26 22 28 28 36 30 36\n[11161] 39 23 28 21 28 39 23 40 22 30 36 22 23 40 18 34 30 28 20 27 19 30 31 40\n[11185] 22 30 20 34 33 36 19 26 34 21 30 24 36 38 31 21 35 19 32 30 33 27 39 32\n[11209] 28 28 21 18 33 22 23 38 26 26 18 33 23 31 34 33 28 27 30 27 30 34 34 35\n[11233] 29 32 30 39 20 21 24 38 40 31 37 28 22 40 30 27 28 33 32 31 24 35 39 39\n[11257] 34 29 23 26 18 29 25 18 40 36 18 33 36 25 20 31 40 22 39 26 21 40 25 21\n[11281] 27 40 32 35 34 34 29 25 25 21 38 19 26 20 18 18 38 30 31 37 18 37 21 26\n[11305] 32 18 22 34 28 35 33 28 28 35 33 24 21 30 26 30 34 28 37 30 35 30 33 28\n[11329] 19 38 28 26 39 20 18 32 39 29 33 23 21 19 34 19 20 24 30 29 31 26 20 28\n[11353] 26 33 29 22 26 26 31 26 28 30 21 19 19 21 29 25 29 27 22 40 20 27 23 36\n[11377] 18 24 26 18 21 21 39 24 37 28 33 40 36 24 25 23 24 38 31 32 22 25 21 29\n[11401] 36 37 37 19 38 28 39 24 28 21 36 37 35 40 28 20 39 32 23 34 34 27 18 31\n[11425] 20 33 33 22 22 28 18 32 23 38 23 29 19 37 30 22 38 38 39 39 35 32 20 25\n[11449] 36 35 23 28 29 36 20 22 30 18 26 23 37 40 19 37 19 29 29 28 18 26 40 29\n[11473] 40 40 23 31 30 22 24 19 20 26 35 32 36 39 32 23 38 34 38 23 20 21 27 20\n[11497] 29 23 33 28 40 27 22 34 32 40 36 22 19 38 30 22 29 21 35 32 39 20 30 40\n[11521] 21 23 36 35 37 35 30 31 34 21 32 19 37 22 29 40 19 37 40 32 18 30 35 25\n[11545] 18 29 35 34 25 20 40 29 21 24 33 25 22 38 33 19 19 28 22 36 29 38 28 22\n[11569] 30 27 36 23 23 40 28 37 32 32 28 31 18 26 40 35 33 26 21 22 38 39 40 30\n[11593] 23 38 29 32 34 39 37 24 33 25 39 28 25 40 39 20 34 33 31 35 26 25 28 21\n[11617] 27 18 19 19 34 23 24 26 36 18 20 25 26 25 32 30 21 37 30 23 25 22 32 38\n[11641] 38 25 38 22 20 39 21 35 39 39 37 27 32 22 36 33 37 33 36 31 21 29 22 27\n[11665] 24 37 35 36 24 18 39 28 27 18 32 38 36 33 28 30 37 21 28 35 27 34 27 38\n[11689] 39 28 35 32 35 20 39 30 20 39 23 18 27 33 33 27 18 28 39 40 36 38 22 20\n[11713] 38 28 24 37 22 35 31 24 27 25 38 35 38 20 20 27 20 29 24 21 29 20 20 23\n[11737] 26 33 18 36 26 36 36 31 18 31 28 27 40 19 32 27 32 37 18 22 37 38 25 32\n[11761] 25 20 31 33 33 40 28 26 22 34 28 24 23 40 29 22 40 36 38 25 30 36 33 24\n[11785] 23 20 22 27 36 38 20 37 29 18 35 36 23 30 35 18 18 21 24 19 22 40 33 38\n[11809] 32 26 24 38 34 19 31 23 39 40 31 32 23 25 40 29 22 36 23 39 27 33 34 19\n[11833] 18 19 26 29 37 21 37 22 26 21 32 31 19 37 26 18 37 29 21 39 25 19 26 39\n[11857] 34 18 28 37 28 31 39 37 40 21 37 36 37 19 39 24 36 21 23 29 35 35 25 33\n[11881] 30 26 24 37 39 39 28 38 33 38 24 29 18 22 19 31 27 30 36 30 28 38 34 34\n[11905] 19 25 29 33 33 28 37 22 30 28 40 31 20 30 22 26 18 23 22 34 18 39 19 20\n[11929] 24 33 24 21 18 38 23 36 37 35 22 39 18 19 38 22 25 35 25 29 32 33 19 40\n[11953] 23 39 19 40 25 31 26 18 34 33 32 27 23 23 32 29 26 38 26 30 24 22 35 28\n[11977] 33 21 32 36 28 30 22 24 29 35 20 21 37 40 38 38 35 24 22 20 32 34 28 37\n[12001] 33 40 23 21 24 30 19 24 32 18 19 27 39 28 38 30 18 29 31 29 29 31 35 32\n[12025] 39 22 18 18 27 31 40 39 33 19 34 26 36 30 27 31 26 23 35 29 18 21 37 26\n[12049] 35 19 18 32 26 31 21 25 22 18 27 37 21 35 27 38 31 39 40 19 25 18 22 39\n[12073] 33 39 27 20 33 37 28 24 25 18 19 33 33 39 30 25 27 23 35 20 26 24 34 40\n[12097] 36 38 39 18 24 20 40 24 19 28 37 20 30 18 38 38 25 22 30 18 31 19 28 22\n[12121] 40 28 29 19 35 36 23 21 28 29 28 30 26 35 34 27 21 20 30 29 38 29 34 22\n[12145] 35 33 24 24 19 29 24 21 34 25 37 40 31 34 32 34 27 21 34 24 22 18 25 26\n[12169] 34 31 26 29 23 29 20 27 36 39 29 23 36 23 29 37 33 21 39 22 34 34 26 27\n[12193] 39 39 21 19 27 23 27 39 37 21 37 21 30 20 31 23 28 24 35 25 22 24 34 28\n[12217] 31 20 26 40 24 23 18 19 25 23 32 34 22 28 28 21 18 38 26 22 20 37 37 27\n[12241] 24 35 26 21 19 21 34 25 32 22 40 19 21 32 26 40 31 37 24 31 33 30 26 33\n[12265] 31 32 22 19 35 25 32 34 31 39 18 21 24 21 28 29 33 30 25 34 33 29 38 25\n[12289] 23 26 30 35 30 40 38 34 33 40 37 32 32 33 38 26 25 40 30 22 31 25 38 33\n[12313] 30 32 24 33 28 22 38 30 35 39 30 20 20 22 22 20 30 20 33 28 28 22 32 34\n[12337] 40 26 26 31 28 26 40 39 26 31 33 37 31 22 33 20 31 34 21 32 26 19 30 38\n[12361] 32 39 37 28 24 33 38 23 21 30 28 18 31 22 19 27 18 29 18 40 21 25 32 28\n[12385] 24 36 39 40 20 22 33 35 28 19 37 32 36 38 33 30 27 38 23 31 18 32 30 40\n[12409] 26 32 33 36 18 19 26 28 33 27 23 30 35 37 32 32 24 39 40 30 35 18 19 18\n[12433] 19 23 39 26 35 40 35 30 40 22 27 36 33 25 35 35 25 24 18 37 37 23 27 28\n[12457] 24 19 32 30 35 38 29 22 28 32 35 20 38 32 25 19 32 37 28 36 18 30 28 31\n[12481] 24 30 27 20 25 19 19 23 26 23 31 19 33 35 19 27 34 32 39 33 34 19 38 36\n[12505] 28 23 26 21 34 38 27 32 23 24 37 29 32 22 28 23 25 27 32 27 40 20 26 29\n[12529] 34 22 23 38 23 40 26 19 33 24 39 36 37 33 28 32 34 35 30 32 24 23 33 31\n[12553] 30 40 38 30 28 24 27 30 21 35 33 18 32 22 24 25 29 40 34 38 35 28 36 39\n[12577] 40 19 32 27 36 33 33 35 39 31 25 25 27 40 40 38 26 24 18 38 27 25 18 20\n[12601] 38 36 21 18 28 39 30 20 36 26 28 38 24 34 26 19 34 35 32 33 19 34 34 28\n[12625] 22 33 34 27 24 31 18 24 40 40 39 28 36 18 22 26 33 24 18 35 40 31 29 30\n[12649] 37 40 21 24 25 36 21 25 21 31 27 37 23 20 30 19 24 33 38 21 24 33 18 39\n[12673] 24 35 37 26 40 23 22 27 38 35 31 27 18 33 21 35 23 37 36 21 37 18 29 33\n[12697] 37 21 38 23 29 39 30 26 25 37 21 40 38 27 18 24 39 25 20 37 18 30 28 32\n[12721] 23 21 40 35 33 20 18 36 37 30 40 40 30 25 23 21 34 19 36 18 22 21 21 40\n[12745] 25 31 28 20 29 36 30 32 32 29 36 21 24 22 30 26 34 22 29 29 27 27 38 40\n[12769] 27 25 22 20 33 38 28 36 36 20 29 27 21 30 20 39 19 31 40 23 27 37 21 25\n[12793] 34 19 24 23 29 25 37 27 34 18 36 38 38 28 18 32 21 20 34 40 29 29 23 38\n[12817] 33 27 37 29 18 26 38 21 21 35 33 23 32 36 40 26 19 25 18 19 38 39 20 25\n[12841] 34 19 39 22 35 18 36 22 24 31 21 35 18 37 32 33 21 33 34 35 23 20 22 22\n[12865] 20 28 32 18 32 25 33 40 40 30 18 18 19 20 37 24 28 29 29 24 35 30 40 23\n[12889] 33 25 20 21 40 23 34 25 26 30 24 33 29 35 30 32 22 24 40 33 25 24 30 19\n[12913] 40 24 27 27 36 23 21 30 30 20 35 28 37 32 34 32 20 21 27 24 22 22 21 32\n[12937] 28 18 23 21 26 22 36 32 35 27 26 32 37 18 30 30 33 34 32 26 27 26 21 24\n[12961] 27 20 22 34 37 25 34 23 21 38 21 36 27 18 27 40 19 36 27 40 33 21 26 28\n[12985] 19 25 37 37 34 22 37 25 21 34 40 37 28 29 38 19 21 25 33 26 18 37 38 34\n[13009] 27 36 30 35 34 38 28 20 37 35 33 31 33 29 27 34 28 18 18 31 32 21 20 40\n[13033] 30 18 36 25 27 21 35 18 20 30 35 34 40 37 23 22 31 26 31 36 38 28 34 25\n[13057] 38 34 33 36 32 18 21 30 33 34 22 21 40 23 20 28 36 26 35 36 19 32 33 40\n[13081] 26 40 39 20 32 18 23 26 32 22 27 18 23 29 37 31 30 18 22 27 33 33 25 21\n[13105] 20 23 33 32 18 30 27 31 27 39 30 37 24 32 27 28 39 40 37 26 38 31 40 40\n[13129] 25 28 25 32 33 28 24 19 27 29 40 28 33 26 18 21 35 23 18 35 30 31 35 30\n[13153] 33 31 39 31 32 28 29 40 35 22 25 21 34 29 25 27 18 23 34 24 39 38 33 33\n[13177] 18 19 39 27 31 23 33 38 24 39 21 34 35 33 28 30 27 35 21 29 22 22 31 22\n[13201] 31 22 32 34 39 34 28 25 28 33 36 33 38 31 19 25 26 36 22 20 26 34 37 29\n[13225] 20 23 18 20 32 35 38 18 35 20 23 33 19 32 20 32 32 21 25 33 35 22 37 38\n[13249] 20 27 23 29 27 30 38 35 21 20 18 27 21 27 25 35 34 27 24 32 32 35 18 20\n[13273] 34 27 40 29 20 26 26 33 30 37 34 37 38 22 19 21 34 24 35 40 32 31 38 29\n[13297] 38 22 21 33 25 36 29 38 24 30 21 38 23 27 40 28 24 30 40 32 20 38 21 19\n[13321] 22 21 30 19 28 32 37 35 31 33 21 20 40 29 20 22 34 30 29 29 39 24 38 38\n[13345] 23 26 25 20 23 21 33 24 22 37 24 28 27 37 21 22 21 30 34 24 18 30 18 30\n[13369] 36 39 23 34 32 35 22 30 24 22 21 38 22 38 36 27 32 27 23 24 36 23 31 37\n[13393] 20 31 35 35 27 24 27 39 22 26 22 27 26 26 33 35 22 30 27 36 29 26 29 18\n[13417] 28 20 26 35 34 23 23 24 23 22 37 21 18 38 30 28 20 22 33 18 37 28 29 32\n[13441] 39 24 19 30 36 26 21 31 24 26 20 24 24 26 40 32 19 24 27 30 20 24 27 19\n[13465] 27 37 19 22 21 37 18 38 37 28 31 37 18 34 40 29 33 37 26 28 26 26 31 38\n[13489] 31 23 36 35 23 39 31 23 38 32 26 38 21 30 38 28 24 38 32 38 40 40 30 20\n[13513] 28 20 34 30 28 18 36 18 35 29 40 32 31 38 33 30 25 31 21 36 40 34 22 39\n[13537] 24 18 21 20 22 33 18 36 36 40 25 34 39 25 31 24 29 32 39 38 36 25 25 40\n[13561] 39 27 38 24 30 26 19 34 24 21 36 39 19 31 24 36 36 34 26 26 27 28 40 38\n[13585] 18 25 40 40 26 37 19 19 35 22 30 24 33 28 24 18 35 33 30 25 37 39 23 38\n[13609] 29 38 21 39 35 20 22 22 40 39 26 36 26 39 26 38 39 34 22 39 23 23 36 26\n[13633] 39 21 39 19 34 25 39 36 40 38 40 27 31 28 37 33 34 18 21 27 29 31 21 33\n[13657] 27 19 31 20 37 39 32 36 35 40 34 22 22 31 35 28 39 25 34 18 20 29 29 22\n[13681] 30 27 38 32 30 18 21 21 27 30 26 38 24 24 32 27 23 22 27 27 19 20 20 39\n[13705] 26 24 31 26 34 31 23 25 39 39 39 27 39 28 33 22 23 35 27 32 30 21 19 32\n[13729] 38 24 39 27 25 33 36 40 39 25 25 26 26 22 38 33 21 20 38 19 34 23 37 40\n[13753] 38 20 40 40 27 19 36 21 39 21 25 33 28 34 36 19 38 30 20 19 34 18 35 31\n[13777] 26 27 23 25 38 28 31 21 32 34 28 26 25 35 31 21 22 40 21 36 36 29 21 39\n[13801] 31 21 39 26 29 40 24 20 30 37 26 24 30 26 28 37 32 25 23 19 39 23 32 31\n[13825] 26 35 37 32 30 32 38 40 25 38 27 38 30 22 26 23 22 26 22 28 19 26 29 40\n[13849] 27 20 26 32 29 21 38 23 18 38 20 35 26 33 20 34 32 39 35 21 32 23 27 32\n[13873] 19 29 27 40 20 35 24 23 18 39 25 40 30 23 37 36 27 23 36 22 26 32 37 28\n[13897] 31 37 33 24 34 18 30 24 28 32 24 19 39 31 39 38 36 30 35 22 22 29 33 20\n[13921] 38 31 37 32 24 27 30 26 32 35 31 35 40 32 26 26 30 23 31 19 18 19 39 33\n[13945] 18 25 37 25 20 30 34 33 20 22 30 38 35 23 22 32 23 18 37 35 34 19 21 37\n[13969] 32 22 24 35 26 32 18 29 38 24 23 27 28 38 40 23 27 18 18 20 36 31 20 37\n[13993] 40 21 30 34 24 37 35 22 20 37 28 19 24 29 22 24 32 23 23 22 23 25 33 23\n[14017] 40 28 23 37 34 21 20 18 39 20 30 34 34 23 30 36 30 34 40 32 36 20 38 36\n[14041] 24 18 28 35 32 29 31 35 39 22 39 27 24 26 28 38 26 18 31 25 21 34 27 24\n[14065] 30 33 39 39 33 25 36 18 32 30 37 32 20 30 25 22 22 40 32 38 33 27 23 28\n[14089] 22 33 38 18 36 21 33 18 32 37 30 20 38 25 31 23 18 23 30 26 39 26 29 31\n[14113] 36 28 19 22 40 36 39 39 20 26 29 32 20 39 40 22 26 40 26 25 21 39 36 35\n[14137] 36 23 35 24 19 32 24 23 37 33 21 32 18 26 39 37 35 36 33 39 36 23 23 30\n[14161] 30 37 29 34 26 25 20 23 19 21 28 22 26 28 24 26 36 25 30 40 34 20 23 28\n[14185] 34 23 19 30 35 27 34 40 25 34 19 36 22 27 21 35 20 38 34 25 23 36 29 36\n[14209] 20 31 21 36 40 39 25 36 36 32 34 33 20 29 35 36 35 39 33 32 40 39 34 26\n[14233] 35 38 27 32 38 38 20 38 19 24 28 29 24 34 24 22 25 37 39 24 39 39 19 27\n[14257] 21 39 25 28 25 34 18 20 20 22 37 39 37 33 30 29 28 27 40 27 18 25 29 38\n[14281] 37 40 28 21 28 32 26 31 19 21 31 40 36 21 32 38 40 23 20 28 37 30 40 36\n[14305] 27 34 39 24 29 28 27 18 29 21 21 21 28 37 32 37 32 37 32 23 28 20 40 21\n[14329] 40 20 40 20 39 36 23 32 25 30 20 18 27 23 31 39 26 30 27 37 40 23 33 35\n[14353] 27 21 22 28 35 34 37 29 39 32 36 29 39 34 36 24 29 36 23 36 33 32 31 36\n[14377] 35 35 32 29 28 37 19 40 40 29 27 35 21 33 33 34 22 35 34 18 36 22 30 19\n[14401] 34 27 34 40 35 36 30 27 30 24 35 21 23 34 32 21 32 39 26 29 36 33 29 27\n[14425] 23 24 22 20 29 35 28 40 35 29 22 26 36 33 39 38 36 36 24 23 23 25 20 32\n[14449] 32 30 21 21 38 29 24 28 37 25 27 38 20 32 18 33 26 23 30 29 26 37 24 20\n[14473] 32 24 21 36 21 21 24 20 34 30 19 36 28 23 28 19 19 39 35 23 25 21 18 38\n[14497] 27 39 22 23 28 21 35 23 36 27 40 29 27 26 25 37 28 21 36 33 22 21 34 38\n[14521] 18 39 36 25 31 37 22 28 38 20 39 27 27 20 21 21 32 31 39 28 22 35 21 18\n[14545] 39 22 35 32 37 32 30 34 22 30 33 26 39 40 31 20 18 27 32 22 21 33 37 26\n[14569] 37 35 32 18 29 22 28 26 26 32 28 34 20 30 36 40 34 20 33 25 30 23 24 23\n[14593] 33 38 27 38 34 32 18 18 22 30 22 34 19 35 24 28 19 30 22 24 35 32 25 20\n[14617] 26 21 26 37 31 37 36 34 29 37 22 36 18 31 33 21 20 27 28 40 22 29 21 18\n[14641] 38 23 22 34 38 26 36 38 22 18 25 21 23 23 24 27 24 40 23 26 31 18 32 21\n[14665] 29 19 34 29 27 28 39 20 25 20 36 40 28 32 27 36 24 32 29 35 40 20 37 22\n[14689] 40 30 20 32 34 36 28 19 36 19 38 28 25 31 18 31 38 27 39 29 23 27 32 28\n[14713] 22 22 28 22 25 35 40 22 36 26 28 20 38 26 24 25 19 24 40 27 30 40 33 31\n[14737] 39 37 26 33 23 28 33 20 25 39 24 33 24 21 22 18 19 39 36 25 30 25 36 32\n[14761] 22 36 32 37 22 40 31 22 31 29 31 31 37 33 36 35 27 28 27 36 25 24 19 36\n[14785] 40 28 34 25 19 31 22 21 26 18 20 29 31 39 30 30 34 27 29 26 39 19 26 29\n[14809] 32 38 31 31 26 28 18 30 38 38 20 30 37 27 22 26 36 28 33 27 39 20 29 36\n[14833] 36 30 34 28 39 29 29 20 32 20 27 37 31 25 25 25 25 34 18 22 18 23 34 34\n[14857] 26 40 38 24 33 22 19 30 31 23 31 18 24 23 20 21 36 18 18 32 29 31 27 28\n[14881] 33 21 25 18 30 36 39 30 39 37 28 25 40 28 37 28 37 21 27 37 22 27 37 23\n[14905] 37 21 28 20 21 31 36 24 22 26 33 38 31 28 26 31 38 25 29 19 29 28 28 20\n[14929] 19 29 25 34 21 27 20 26 28 30 18 18 37 25 18 40 39 32 33 18 34 33 35 40\n[14953] 23 21 18 32 19 21 38 19 23 30 28 27 19 21 18 28 37 19 20 40 32 27 23 37\n[14977] 26 22 26 27 33 39 26 32 37 19 22 26 33 23 21 36 39 40 24 31 28 35 30 34\n[15001] 29 22 33 31 29 34 27 40 30 30 30 23 24 36 19 38 37 26 37 20 38 36 29 36\n[15025] 20 21 29 21 22 20 31 18 35 28 19 28 26 32 33 35 29 23 26 31 22 21 33 37\n[15049] 25 25 25 28 29 38 39 25 18 30 34 20 23 25 31 21 24 39 25 32 19 33 33 26\n[15073] 24 36 36 37 37 35 28 36 26 30 39 35 36 22 32 29 18 25 37 40 39 37 35 20\n[15097] 28 29 23 39 28 38 34 19 40 39 37 40 29 37 40 34 32 28 37 23 24 35 31 24\n[15121] 28 32 26 39 23 21 28 19 29 25 22 25 39 33 21 35 31 35 38 36 36 18 33 28\n[15145] 27 22 25 38 28 19 18 32 23 26 18 24 29 19 27 37 18 34 31 23 21 24 29 30\n[15169] 33 19 27 27 26 31 40 36 19 24 21 20 33 31 28 19 21 36 38 27 26 29 36 38\n[15193] 23 18 38 32 26 37 29 19 20 28 30 27 28 28 33 22 32 21 19 37 18 29 21 38\n[15217] 40 37 25 20 36 27 28 30 22 24 24 28 22 30 25 31 20 26 25 26 35 19 23 37\n[15241] 27 35 38 21 23 38 25 32 19 31 28 37 36 30 29 19 24 26 31 21 22 21 26 26\n[15265] 26 26 32 40 26 33 20 27 39 28 39 29 36 31 31 37 36 29 20 19 21 33 22 23\n[15289] 23 23 25 32 21 28 37 20 18 35 34 36 22 34 36 25 29 29 22 35 31 31 39 40\n[15313] 25 31 37 35 24 39 35 20 19 35 32 25 22 39 38 29 24 29 32 19 25 31 37 20\n[15337] 23 26 32 34 18 36 26 30 29 34 21 20 24 30 25 33 18 22 30 23 34 36 37 28\n[15361] 28 25 34 19 40 21 29 38 29 36 32 32 19 35 22 31 28 39 34 40 38 18 27 35\n[15385] 23 38 37 26 24 19 20 40 18 29 25 20 32 24 40 37 25 30 21 28 36 36 25 24\n[15409] 37 30 38 27 33 22 19 29 29 35 27 24 28 28 19 19 24 40 18 19 23 19 33 18\n[15433] 37 40 29 29 39 36 34 31 32 35 23 20 18 36 20 26 27 22 32 22 25 40 37 29\n[15457] 38 35 35 36 28 25 28 40 38 30 31 28 27 34 30 27 18 24 37 37 35 21 28 38\n[15481] 32 32 28 23 26 30 21 34 37 38 40 32 39 26 38 34 34 19 20 34 36 30 20 32\n[15505] 39 20 36 24 39 39 40 25 18 24 19 21 21 38 18 22 19 40 34 29 25 34 33 22\n[15529] 19 23 26 33 36 34 26 32 20 23 39 23 22 23 25 22 32 18 23 32 32 33 40 29\n[15553] 29 39 24 38 34 33 25 30 18 20 29 18 40 26 36 24 39 31 22 24 31 31 30 39\n[15577] 19 34 39 19 18 40 27 25 38 26 35 24 27 24 38 18 36 37 18 18 37 24 25 30\n[15601] 18 25 39 32 25 39 18 24 20 36 18 20 26 37 21 18 21 22 23 24 28 22 24 22\n[15625] 24 25 30 40 24 27 33 31 29 23 33 35 28 38 22 28 35 36 19 20 32 26 27 23\n[15649] 21 37 28 38 27 21 30 28 29 20 24 25 29 36 35 23 23 18 35 21 28 29 24 18\n[15673] 34 18 36 33 25 33 37 29 37 24 20 21 36 22 37 26 38 40 38 27 26 35 30 25\n[15697] 33 31 35 23 34 21 35 33 19 40 40 32 25 37 31 24 39 36 38 34 22 34 35 31\n[15721] 18 37 19 33 26 35 36 19 21 21 27 21 22 20 31 32 31 40 19 29 27 37 22 38\n[15745] 32 38 25 22 39 23 18 25 26 35 39 35 18 28 30 37 20 28 36 29 33 26 25 32\n[15769] 26 26 38 23 29 23 20 26 36 40 20 28 26 30 28 36 18 24 34 31 22 18 39 32\n[15793] 33 34 36 30 31 28 29 35 32 20 22 24 37 38 34 40 27 18 32 37 27 31 39 21\n[15817] 35 35 35 38 40 33 27 20 29 24 39 38 30 36 32 19 37 26 23 34 40 25 19 34\n[15841] 22 24 25 19 35 24 25 38 21 23 34 35 27 26 37 19 18 34 27 38 32 39 21 39\n[15865] 24 29 20 29 32 28 40 20 40 23 38 18 27 24 31 35 33 22 18 19 22 27 18 31\n[15889] 39 25 31 21 25 24 32 39 33 39 18 31 26 30 30 27 19 35 18 23 28 39 18 20\n[15913] 25 30 36 34 18 34 27 36 26 23 18 30 27 22 30 35 18 33 30 32 25 31 30 21\n[15937] 39 36 23 31 22 34 38 26 36 19 18 39 24 30 24 23 34 38 29 36 32 38 40 23\n[15961] 35 37 34 26 18 39 38 32 30 38 20 21 40 34 37 21 36 32 22 27 31 30 18 33\n[15985] 30 30 35 28 33 37 34 33 27 32 22 36 25 27 38 20 35 36 22 28 37 38 37 22\n[16009] 37 18 23 40 40 32 33 40 20 29 31 37 37 33 24 35 27 23 21 23 40 31 22 25\n[16033] 19 30 36 18 20 18 20 18 19 25 26 32 26 26 40 28 29 37 18 29 33 25 18 21\n[16057] 25 18 37 37 20 39 36 32 32 34 18 37 20 36 32 26 23 19 26 30 18 39 35 19\n[16081] 33 25 32 39 33 31 31 23 20 39 25 30 30 32 28 23 30 36 21 35 39 31 34 30\n[16105] 30 23 18 29 34 26 29 34 32 38 24 28 18 28 32 23 21 24 27 18 38 31 18 20\n[16129] 39 19 33 29 34 23 22 23 25 24 30 40 33 33 33 25 21 19 27 28 22 38 28 23\n[16153] 38 40 21 36 20 40 27 28 39 39 26 36 35 36 19 21 21 36 39 34 37 26 35 20\n[16177] 26 23 38 36 40 28 33 26 21 34 40 23 25 19 29 39 29 34 31 26 38 40 32 27\n[16201] 28 40 29 22 39 31 32 26 38 21 20 39 22 18 36 37 18 34 39 28 25 31 22 20\n[16225] 40 39 20 37 39 36 40 26 34 30 21 18 20 35 39 25 22 33 26 36 22 34 20 30\n[16249] 22 21 38 20 27 27 33 33 30 38 37 36 36 39 36 39 26 26 33 32 36 37 25 28\n[16273] 35 32 22 29 33 19 35 37 29 34 32 24 27 26 39 25 35 24 18 26 25 28 19 33\n[16297] 38 21 18 39 38 24 23 33 20 23 35 32 37 21 18 24 31 32 24 40 23 23 29 33\n[16321] 19 36 25 18 39 32 28 23 24 27 28 30 39 39 38 36 26 25 40 25 36 26 35 38\n[16345] 19 32 36 24 39 39 19 31 23 31 23 33 35 32 32 28 20 20 34 40 31 33 18 30\n[16369] 20 28 37 22 21 30 30 24 27 28 39 38 38 35 23 25 20 28 24 34 21 29 36 21\n[16393] 36 20 32 35 22 20 29 24 39 32 29 25 26 36 35 24 26 27 26 30 21 24 33 24\n[16417] 18 33 36 40 35 27 23 30 36 39 20 19 31 32 25 21 20 21 39 32 21 30 21 19\n[16441] 22 33 31 21 28 39 35 27 20 29 31 39 23 24 39 29 35 31 28 18 28 37 27 38\n[16465] 30 31 35 28 30 39 22 26 40 36 20 32 30 20 26 31 39 26 18 29 31 22 29 22\n[16489] 32 36 21 22 28 22 22 35 29 32 29 22 29 28 29 28 25 37 33 23 20 38 21 24\n[16513] 29 21 19 27 27 35 29 38 25 18 19 28 37 38 38 20 31 40 18 22 37 27 23 32\n[16537] 27 38 19 37 40 28 37 34 37 40 36 21 28 19 21 30 34 33 27 35 31 32 25 20\n[16561] 18 37 32 26 40 19 35 33 29 31 35 23 37 20 37 22 19 35 28 31 37 28 33 36\n[16585] 28 31 34 36 28 40 30 25 20 35 37 21 33 22 33 33 28 33 22 38 23 39 21 35\n[16609] 26 34 36 25 37 34 26 33 27 23 34 29 34 37 29 33 20 30 35 24 20 36 19 39\n[16633] 27 27 31 39 28 28 19 39 23 26 33 35 38 29 35 19 32 37 26 25 20 27 34 25\n[16657] 21 37 18 24 37 30 23 26 28 32 19 20 35 34 34 26 27 22 30 29 30 39 18 23\n[16681] 23 36 31 20 37 31 38 28 35 32 23 32 23 31 24 23 30 31 30 20 25 22 32 26\n[16705] 35 39 23 25 18 33 21 19 22 38 40 21 36 25 22 24 35 30 23 38 20 27 19 25\n[16729] 34 35 23 20 21 40 33 40 37 37 27 23 33 33 29 22 33 39 25 22 37 33 28 28\n[16753] 28 32 23 37 23 40 27 25 36 36 23 32 36 37 34 18 19 25 23 25 22 40 36 25\n[16777] 38 27 36 32 31 23 40 22 40 34 24 29 40 23 38 40 23 23 38 38 20 27 40 36\n[16801] 26 22 24 39 36 39 19 36 35 29 21 40 39 30 38 35 36 31 30 29 29 20 30 22\n[16825] 20 40 26 28 33 29 40 36 30 34 40 20 27 32 38 19 37 25 22 39 30 40 38 32\n[16849] 28 31 20 25 32 24 25 35 38 21 40 39 32 40 39 20 38 40 18 21 26 27 19 36\n[16873] 40 32 28 20 23 36 37 25 30 22 25 21 39 40 39 38 29 26 29 26 28 38 24 33\n[16897] 40 37 23 29 22 20 33 39 29 31 25 25 31 29 23 38 39 30 18 37 38 38 35 39\n[16921] 25 40 18 35 26 37 22 28 35 31 19 29 23 25 36 18 38 30 20 38 26 27 31 26\n[16945] 19 35 33 30 37 34 19 19 38 35 24 21 35 35 31 29 39 29 18 31 36 37 26 19\n[16969] 24 33 19 22 32 19 22 31 32 24 39 31 32 21 34 21 18 22 39 38 18 19 25 34\n[16993] 37 24 31 20 34 34 39 27 25 24 35 22 23 24 39 37 23 40 23 38 37 31 22 18\n[17017] 26 21 21 35 19 27 20 34 21 28 20 30 34 31 31 37 34 33 29 20 39 30 26 24\n[17041] 29 30 28 31 35 34 40 32 24 20 28 22 21 29 33 20 30 24 31 34 26 38 25 32\n[17065] 27 34 28 39 27 18 20 34 33 26 26 31 40 38 30 34 35 38 32 31 37 38 36 30\n[17089] 35 25 18 18 20 19 36 22 18 21 20 26 31 20 40 21 30 26 33 20 25 19 19 31\n[17113] 24 28 18 20 25 21 39 26 25 22 40 19 33 23 36 37 24 24 21 38 29 38 25 40\n[17137] 23 27 20 19 21 22 31 32 31 27 35 36 36 34 18 36 22 36 24 29 20 19 30 23\n[17161] 26 39 37 34 30 23 37 26 20 38 20 27 35 40 36 32 38 31 39 37 27 37 19 24\n[17185] 31 38 19 35 33 30 24 26 39 29 22 31 31 21 34 32 25 27 23 39 34 37 25 18\n[17209] 33 28 24 33 31 26 28 24 19 24 37 37 20 37 18 36 25 21 31 18 22 33 28 39\n[17233] 29 29 34 18 35 23 35 22 35 33 36 32 28 21 38 32 19 20 24 40 18 26 39 32\n[17257] 28 36 37 20 33 26 27 30 37 38 26 34 22 28 18 30 28 30 27 39 35 29 21 31\n[17281] 28 26 24 38 18 21 32 36 37 36 33 33 20 22 38 24 38 22 20 22 27 31 37 20\n[17305] 29 37 34 23 35 19 22 22 31 27 40 32 21 30 22 38 26 32 33 26 30 35 24 39\n[17329] 40 23 24 20 18 33 35 35 37 24 22 25 25 32 18 21 20 25 28 39 24 30 37 27\n[17353] 31 20 32 36 18 32 28 29 29 30 20 31 25 21 36 37 19 32 25 34 28 20 38 36\n[17377] 21 21 22 20 35 23 23 34 40 36 33 22 18 25 34 25 32 21 38 36 35 34 19 31\n[17401] 40 38 20 36 30 32 33 36 24 38 39 18 39 29 33 38 34 37 40 28 25 26 37 18\n[17425] 29 38 29 39 33 29 29 34 31 30 32 27 37 18 37 19 35 34 31 31 20 22 36 20\n[17449] 29 33 36 36 32 32 25 37 23 38 28 25 22 25 30 19 34 23 38 31 20 19 40 35\n[17473] 19 40 38 18 39 29 26 21 26 21 40 30 28 33 20 29 37 35 20 18 34 19 25 37\n[17497] 31 18 27 20 36 32 33 36 22 34 35 24 18 23 35 38 28 37 25 32 36 23 31 21\n[17521] 38 19 35 38 36 27 19 21 34 23 35 26 19 22 19 40 28 30 40 26 31 35 28 31\n[17545] 26 36 32 35 23 40 25 27 30 30 24 38 31 32 39 28 38 26 37 25 36 29 26 37\n[17569] 31 28 36 35 35 20 34 35 28 27 34 25 22 34 33 34 20 39 34 26 28 20 38 21\n[17593] 28 33 24 38 32 30 29 19 30 29 20 36 27 39 38 34 36 21 26 40 37 26 34 24\n[17617] 23 36 22 34 34 20 23 36 21 25 33 32 24 29 31 32 38 24 32 35 36 33 20 36\n[17641] 22 19 21 35 29 21 22 23 30 32 19 21 40 37 24 23 40 25 40 20 22 36 28 34\n[17665] 20 29 36 24 37 26 34 29 19 37 40 33 30 35 31 19 21 22 29 29 22 34 25 35\n[17689] 29 32 29 34 40 32 24 24 20 24 34 30 39 24 29 19 37 33 19 37 28 32 29 32\n[17713] 31 34 23 29 24 26 30 33 29 33 36 28 39 33 23 26 18 18 19 38 28 40 31 18\n[17737] 34 25 29 25 24 39 28 23 36 37 35 39 19 37 38 40 39 40 18 19 32 34 36 33\n[17761] 20 35 26 34 29 37 28 39 21 39 36 38 20 31 38 38 29 24 25 39 40 21 23 28\n[17785] 32 26 30 23 24 30 33 33 27 20 37 38 28 19 38 27 28 18 19 27 19 18 24 38\n[17809] 29 30 19 25 19 26 40 31 26 22 38 37 25 36 21 20 38 22 25 19 31 25 36 25\n[17833] 29 36 21 24 40 31 18 20 37 40 19 21 26 34 40 18 24 30 19 25 29 20 40 19\n[17857] 22 24 29 38 39 25 30 19 20 39 40 38 18 40 27 34 40 19 21 20 27 28 21 39\n[17881] 28 24 27 31 31 21 30 34 30 34 23 32 27 38 40 28 28 27 23 23 21 37 33 26\n[17905] 27 28 35 21 28 22 27 25 24 32 39 36 32 24 40 25 27 32 23 36 29 24 34 40\n[17929] 22 25 19 29 23 20 38 35 40 31 18 30 19 32 21 20 34 36 34 33 32 20 39 20\n[17953] 20 26 20 19 31 34 24 27 21 39 28 35 34 21 26 39 26 18 35 29 18 24 39 23\n[17977] 31 28 20 40 28 36 28 35 27 24 34 23 35 18 35 21 32 23 39 24 21 34 37 32\n[18001] 28 38 27 37 19 20 33 28 29 26 31 18 22 38 37 38 19 25 27 33 37 28 28 36\n[18025] 21 22 25 32 27 34 19 31 22 28 18 28 22 22 20 37 26 20 18 27 20 24 24 37\n[18049] 38 23 19 25 23 37 28 33 23 21 36 32 40 22 20 27 20 32 23 40 27 40 27 30\n[18073] 28 34 18 21 30 30 19 36 35 34 18 37 28 31 29 33 20 23 24 26 37 31 31 26\n[18097] 19 19 25 27 37 25 38 20 37 32 18 31 19 18 33 31 19 30 20 26 38 28 23 27\n[18121] 37 32 19 18 34 39 33 40 28 35 22 25 21 24 22 25 18 37 38 31 29 36 28 18\n[18145] 25 37 31 25 25 35 38 35 35 36 33 20 20 30 22 27 21 35 29 36 26 33 28 38\n[18169] 23 27 32 25 31 31 22 29 37 24 33 33 27 38 29 29 28 28 33 35 32 24 33 33\n[18193] 27 29 37 33 35 22 29 34 31 25 27 22 38 25 22 36 18 22 35 31 38 25 31 32\n[18217] 28 23 18 37 28 28 39 18 21 28 23 19 27 34 38 25 27 22 29 40 34 38 35 20\n[18241] 25 40 28 32 20 18 38 18 35 25 18 22 27 31 31 32 22 21 24 31 31 29 24 21\n[18265] 33 28 32 36 35 19 34 34 36 30 30 34 20 40 21 35 30 37 27 30 34 32 18 18\n[18289] 37 38 30 29 30 40 22 22 30 30 25 30 27 23 22 35 21 31 27 25 39 19 21 35\n[18313] 20 24 26 22 28 20 20 26 18 28 28 18 40 31 18 30 33 33 28 34 22 40 34 32\n[18337] 39 21 30 31 39 37 33 28 19 22 27 20 37 34 31 37 28 36 34 36 30 38 27 30\n[18361] 24 31 36 21 18 19 25 24 34 37 38 32 19 30 37 34 26 21 40 30 29 35 36 30\n[18385] 24 27 38 21 40 24 31 40 20 36 30 25 20 25 20 38 23 35 35 25 23 32 34 40\n[18409] 35 20 34 34 22 32 39 18 22 29 18 40 24 24 27 37 31 33 19 32 34 26 24 26\n[18433] 38 36 37 23 19 22 36 31 35 34 31 37 27 39 30 38 25 29 38 22 25 35 18 27\n[18457] 20 20 37 28 23 36 32 33 27 18 26 38 26 25 38 19 30 23 34 26 28 22 18 31\n[18481] 18 39 21 32 37 27 29 30 21 30 19 20 28 18 23 29 34 34 21 36 20 29 32 24\n[18505] 31 37 40 40 28 39 34 40 23 34 39 24 30 39 24 38 32 33 27 35 33 40 22 19\n[18529] 33 18 31 33 25 33 26 40 25 19 35 37 32 35 30 22 34 23 40 29 31 28 38 33\n[18553] 39 29 33 33 39 20 26 31 40 38 22 22 28 27 39 26 25 23 40 24 27 37 23 28\n[18577] 30 19 23 27 30 18 40 38 19 21 30 22 25 37 26 29 34 27 26 20 40 37 35 18\n[18601] 36 28 27 34 21 30 33 26 31 21 23 31 20 33 20 39 26 35 19 26 22 40 31 27\n[18625] 24 26 29 32 37 27 35 32 23 33 33 18 29 19 30 40 32 25 19 18 31 27 38 18\n[18649] 30 29 35 31 24 31 18 21 30 35 32 22 29 25 29 27 38 19 33 29 30 23 32 22\n[18673] 27 21 37 37 40 40 33 28 29 19 22 23 22 19 22 19 23 36 34 32 30 21 27 20\n[18697] 40 33 31 31 26 33 36 20 34 38 39 24 32 28 35 23 26 20 24 37 30 29 24 32\n[18721] 22 29 23 25 35 25 39 26 33 39 36 21 29 27 35 24 22 26 30 30 28 23 33 39\n[18745] 20 35 18 28 39 22 22 20 27 20 32 32 26 38 36 25 32 27 21 23 31 28 40 24\n[18769] 24 31 34 21 38 24 30 33 39 32 22 37 32 23 39 36 27 31 40 29 35 37 32 39\n[18793] 32 21 24 27 26 31 25 27 38 28 22 40 34 28 25 23 25 37 20 39 33 33 22 23\n[18817] 24 32 37 38 38 30 18 23 35 18 35 37 20 36 30 19 25 24 36 19 39 30 39 39\n[18841] 38 27 19 24 21 18 29 22 19 34 21 19 19 31 20 36 26 19 28 37 21 36 37 38\n[18865] 37 32 40 36 27 27 33 34 22 40 34 19 39 34 30 21 34 21 20 34 31 35 24 38\n[18889] 29 32 38 24 20 35 36 29 27 25 36 28 23 35 30 32 19 22 30 18 27 21 30 30\n[18913] 30 29 22 28 34 33 37 36 36 32 19 38 35 27 20 35 38 39 26 29 20 36 30 26\n[18937] 40 38 38 29 40 35 23 24 34 33 36 18 25 25 30 20 35 36 31 22 20 22 27 21\n[18961] 39 22 24 29 31 18 29 21 34 31 32 29 38 35 24 40 31 34 30 29 27 25 40 22\n[18985] 33 30 26 37 20 36 21 20 40 19 21 38 20 38 27 24 40 19 18 38 23 25 35 27\n[19009] 20 33 23 39 34 21 20 39 33 24 39 30 37 22 25 38 36 37 18 35 38 35 26 31\n[19033] 39 23 31 30 18 26 19 32 20 22 29 38 36 37 29 25 28 36 29 22 18 32 28 31\n[19057] 37 27 40 37 28 30 21 20 23 39 33 31 40 35 33 38 34 23 18 38 38 40 29 32\n[19081] 29 37 36 32 24 19 21 34 34 32 28 28 37 29 20 20 29 36 40 21 25 21 37 18\n[19105] 31 27 33 19 28 18 18 20 25 33 37 20 23 18 18 20 23 32 18 25 25 20 24 40\n[19129] 25 27 36 33 30 33 38 30 23 19 33 29 40 38 22 22 30 28 35 37 39 18 30 38\n[19153] 37 36 33 38 32 19 31 30 18 38 30 40 36 34 39 40 36 33 35 20 40 23 20 23\n[19177] 32 32 39 38 36 33 18 38 34 33 26 18 31 23 37 25 20 19 21 23 37 26 22 33\n[19201] 20 39 33 39 18 21 40 19 34 38 18 34 35 18 23 20 40 37 24 24 31 26 18 36\n[19225] 29 39 37 36 34 38 37 30 23 22 24 35 18 26 39 22 35 30 22 23 28 35 18 23\n[19249] 35 26 18 37 35 26 19 23 28 37 39 33 18 34 21 26 33 32 28 34 23 37 34 35\n[19273] 18 32 26 30 23 40 34 36 22 26 31 27 31 33 20 33 22 33 27 39 38 29 36 21\n[19297] 22 37 21 26 36 39 31 28 36 40 34 37 24 32 22 29 30 39 26 27 28 19 37 26\n[19321] 37 32 21 21 26 39 22 27 31 18 27 19 27 22 37 34 40 22 38 38 30 32 25 35\n[19345] 28 30 29 25 36 36 40 20 19 18 19 22 36 22 38 38 34 28 22 39 27 34 40 32\n[19369] 24 31 22 37 22 36 33 19 38 34 27 39 36 40 35 38 20 28 38 24 18 39 24 33\n[19393] 31 29 27 26 39 21 37 34 22 40 34 21 32 23 29 39 23 34 40 37 25 22 23 32\n[19417] 27 35 39 38 34 25 33 39 35 21 18 37 40 20 32 39 22 38 33 39 31 39 28 22\n[19441] 24 39 31 28 33 30 22 26 39 32 35 29 37 34 24 28 37 26 40 18 36 35 35 31\n[19465] 33 24 37 28 38 34 18 33 25 31 38 24 22 37 19 19 26 23 37 26 28 29 35 34\n[19489] 18 20 24 32 21 20 36 34 35 34 19 36 19 20 32 20 29 23 26 32 37 19 33 20\n[19513] 33 32 25 18 25 36 32 32 19 30 29 40 32 19 24 28 32 31 28 26 29 38 32 21\n[19537] 35 26 32 35 33 20 32 34 29 31 35 31 34 29 24 31 36 40 20 31 38 28 39 18\n[19561] 29 29 29 18 19 30 36 18 29 36 33 34 32 20 34 36 40 39 27 31 36 30 28 37\n[19585] 36 19 40 34 24 30 21 38 23 27 25 32 26 23 24 32 33 19 30 36 40 29 21 27\n[19609] 29 37 24 36 30 28 21 26 28 19 26 39 30 18 21 32 18 37 25 34 21 34 19 31\n[19633] 35 29 29 37 22 39 29 25 33 27 30 33 19 28 30 26 19 27 31 28 22 20 28 27\n[19657] 33 34 35 30 18 37 27 25 33 27 32 25 27 35 26 20 22 19 39 21 28 23 35 40\n[19681] 33 18 25 23 29 31 25 22 32 37 18 32 19 38 36 20 24 26 30 29 26 32 25 23\n[19705] 36 18 21 37 24 22 27 29 26 40 30 29 39 28 33 38 32 36 30 37 28 21 35 35\n[19729] 25 40 20 27 20 30 31 33 33 19 19 37 22 27 22 36 29 40 32 21 28 35 25 24\n[19753] 33 35 31 21 35 22 37 40 37 18 32 26 23 40 21 19 34 20 19 40 34 21 24 36\n[19777] 28 40 19 27 19 31 39 30 28 25 22 37 22 33 38 30 35 35 21 20 25 32 24 20\n[19801] 21 22 20 32 23 25 36 35 28 37 36 27 18 33 32 37 28 38 36 37 32 18 19 33\n[19825] 23 26 24 35 37 37 34 31 40 20 40 25 24 19 40 19 32 40 27 34 30 23 34 25\n[19849] 20 33 19 18 32 30 35 25 21 21 32 37 26 22 26 30 25 27 19 19 31 19 21 31\n[19873] 28 39 36 38 33 35 38 26 19 20 27 30 26 27 31 30 26 26 40 26 34 19 37 35\n[19897] 36 28 34 30 39 31 25 40 20 38 29 23 38 33 21 39 27 23 18 39 27 22 19 29\n[19921] 19 26 27 29 18 25 27 35 21 19 27 18 30 37 27 37 24 35 28 38 24 19 23 35\n[19945] 31 27 27 39 27 39 32 25 20 32 28 27 29 37 28 31 39 22 26 22 29 30 34 31\n[19969] 20 27 23 35 24 29 21 27 40 31 20 34 33 32 31 31 32 30 38 26 25 29 35 26\n[19993] 36 26 27 26 21 31 33 21\n\n$data.name\n[1] \"dades[, variable]\"\n\n$bad.obs\n[1] 0\n\n$all.stats\n  i  Mean.i     SD.i Value Obs.Num    R.i+1 lambda.i+1 Outlier\n1 0 29.0338 6.622458    18      73 1.666119   4.706884   FALSE\n\nattr(,\"class\")\n[1] \"gofOutlier\"\n```\n\n\n:::\n\n```{.r .cell-code}\ntest$all.stats\n```\n\n::: {.cell-output .cell-output-stdout}\n\n```\n  i  Mean.i     SD.i Value Obs.Num    R.i+1 lambda.i+1 Outlier\n1 0 29.0338 6.622458    18      73 1.666119   4.706884   FALSE\n```\n\n\n:::\n:::\n\n\n\n## Multivariate\n\n\n\n::: {.cell}\n\n```{.r .cell-code}\nlibrary(scatterplot3d)\nlibrary(readr)\ndades <- readr::read_csv(\"https://archive.ics.uci.edu/ml/machine-learning-databases/forest-fires/forestfires.csv\")\ndades <- data.frame(dades[, c(\"DC\", \"temp\", \"RH\")])\nscatterplot3d(dades[,\"DC\"], dades[, \"temp\"],dades[, \"RH\"])\n```\n\n::: {.cell-output-display}\n![](AdvancedPreprocessing_files/figure-html/plot_multivariate-1.png){width=672}\n:::\n:::\n\n::: {.cell}\n\n```{.r .cell-code}\nlibrary(rgl)\n\n# Plot\nrgl::plot3d(x = dades[, \"DC\"], y = dades[, \"temp\"], z = dades[, \"RH\"], \ncol = \"black\", type = 'p', radius = .1)\n```\n:::\n\n::: {.cell}\n\n```{.r .cell-code}\nlibrary(plotly)\n\n(fig <- plotly::plot_ly(dades, x = ~DC, y = ~temp, z = ~RH, size = 1) %>% \n       add_markers())\n```\n\n::: {.cell-output-display}\n\n```{=html}\n<div class=\"plotly html-widget html-fill-item\" id=\"htmlwidget-ee6535149ad4c6730f0e\" style=\"width:100%;height:464px;\"></div>\n<script type=\"application/json\" data-for=\"htmlwidget-ee6535149ad4c6730f0e\">{\"x\":{\"visdat\":{\"1ae857792968\":[\"function () \",\"plotlyVisDat\"]},\"cur_data\":\"1ae857792968\",\"attrs\":{\"1ae857792968\":{\"x\":{},\"y\":{},\"z\":{},\"size\":1,\"alpha_stroke\":1,\"sizes\":[10,100],\"spans\":[1,20],\"type\":\"scatter3d\",\"mode\":\"markers\",\"inherit\":true}},\"layout\":{\"margin\":{\"b\":40,\"l\":60,\"t\":25,\"r\":10},\"scene\":{\"xaxis\":{\"title\":\"DC\"},\"yaxis\":{\"title\":\"temp\"},\"zaxis\":{\"title\":\"RH\"}},\"hovermode\":\"closest\",\"showlegend\":false},\"source\":\"A\",\"config\":{\"modeBarButtonsToAdd\":[\"hoverclosest\",\"hovercompare\"],\"showSendToCloud\":false},\"data\":[{\"x\":[94.299999999999997,669.10000000000002,686.89999999999998,77.5,102.2,488,495.60000000000002,608.20000000000005,692.60000000000002,698.60000000000002,698.60000000000002,713,665.29999999999995,686.5,699.60000000000002,713.89999999999998,80.799999999999997,664.20000000000005,70.799999999999997,97.099999999999994,692.60000000000002,724.29999999999995,200,537.39999999999998,594.20000000000005,601.39999999999998,668,686.5,721.39999999999998,728.60000000000002,692.29999999999995,709.89999999999998,706.79999999999995,718.29999999999995,724.29999999999995,730.20000000000005,669.10000000000002,682.60000000000002,686.89999999999998,67.599999999999994,366.69999999999999,624.20000000000005,647.10000000000002,698.60000000000002,735.70000000000005,692.29999999999995,686.5,442.89999999999998,64.700000000000003,103.8,706.39999999999998,631.20000000000005,654.10000000000002,654.10000000000002,661.29999999999995,706.39999999999998,730.20000000000005,691.79999999999995,34,43,102.2,102.2,466.60000000000002,631.20000000000005,638.79999999999995,661.29999999999995,668,668,668,77.5,97.799999999999997,692.29999999999995,77.5,614.5,713.89999999999998,26.600000000000001,43,103.8,529.79999999999995,561.60000000000002,601.39999999999998,631.20000000000005,647.10000000000002,654.10000000000002,661.29999999999995,706.39999999999998,706.39999999999998,706.39999999999998,728.60000000000002,80.799999999999997,624.20000000000005,80.799999999999997,488,601.39999999999998,638.79999999999995,704.39999999999998,30.199999999999999,15.5,601.39999999999998,601.39999999999998,601.39999999999998,614.5,647.10000000000002,674.39999999999998,9.3000000000000007,57.299999999999997,74.299999999999997,631.20000000000005,698.60000000000002,709.89999999999998,57.299999999999997,77.5,704.39999999999998,724.29999999999995,67.599999999999994,67.599999999999994,80.799999999999997,80.799999999999997,86.599999999999994,466.60000000000002,608.20000000000005,608.20000000000005,680.70000000000005,671.89999999999998,692.29999999999995,691.79999999999995,103.8,728.60000000000002,673.79999999999995,691.79999999999995,87.200000000000003,64.700000000000003,102.2,685.20000000000005,67.599999999999994,594.20000000000005,680.70000000000005,686.5,313.39999999999998,692.60000000000002,686.5,513.29999999999995,529.79999999999995,296.30000000000001,513.29999999999995,578.79999999999995,86.599999999999994,671.89999999999998,647.10000000000002,685.20000000000005,433.30000000000001,355.19999999999999,424.10000000000002,692.29999999999995,721.39999999999998,647.10000000000002,721.39999999999998,654.10000000000002,654.10000000000002,668,86.599999999999994,578.79999999999995,100.40000000000001,674.39999999999998,704.39999999999998,55,654.10000000000002,570.5,97.799999999999997,578.79999999999995,699.60000000000002,609.60000000000002,601.39999999999998,686.5,624.20000000000005,624.20000000000005,55.200000000000003,631.20000000000005,735.70000000000005,614.5,680.70000000000005,664.20000000000005,48.299999999999997,696.10000000000002,586.70000000000005,692.60000000000002,102.2,686.5,89.400000000000006,92.400000000000006,97.799999999999997,578.79999999999995,647.10000000000002,699.60000000000002,647.10000000000002,586.70000000000005,55.200000000000003,706.39999999999998,692.60000000000002,665.29999999999995,692.60000000000002,83.700000000000003,32.100000000000001,673.79999999999995,100.40000000000001,706.39999999999998,594.20000000000005,692.60000000000002,668,685.20000000000005,686.89999999999998,594.20000000000005,692.29999999999995,103.8,80.799999999999997,80.799999999999997,680.70000000000005,709.89999999999998,699.60000000000002,86.599999999999994,631.20000000000005,713.89999999999998,103.8,309.89999999999998,735.70000000000005,728.60000000000002,696.10000000000002,480.80000000000001,728.60000000000002,480.80000000000001,699.60000000000002,728.60000000000002,692.60000000000002,671.89999999999998,674.39999999999998,601.39999999999998,674.39999999999998,692.60000000000002,674.39999999999998,7.9000000000000004,43.5,85.299999999999997,589.89999999999998,700.70000000000005,700.70000000000005,700.70000000000005,700.70000000000005,503.60000000000002,666.70000000000005,666.70000000000005,666.70000000000005,666.70000000000005,666.70000000000005,565.5,621.70000000000005,694.79999999999995,581.10000000000002,581.10000000000002,692.29999999999995,692.29999999999995,542,573,573,629.10000000000002,684.39999999999998,550.29999999999995,607.10000000000002,658.20000000000005,658.20000000000005,658.20000000000005,658.20000000000005,658.20000000000005,658.20000000000005,353.5,354.60000000000002,352,349.69999999999999,349.69999999999999,349.69999999999999,349.69999999999999,352.60000000000002,349.69999999999999,353.5,18.699999999999999,15.800000000000001,411.80000000000001,437.69999999999999,474.89999999999998,474.89999999999998,474.89999999999998,474.89999999999998,474.89999999999998,466.30000000000001,430.80000000000001,440.89999999999998,430.80000000000001,290.80000000000001,290.80000000000001,377.19999999999999,233.80000000000001,298.10000000000002,298.10000000000002,232.09999999999999,232.09999999999999,113.8,714.29999999999995,714.29999999999995,714.29999999999995,758.10000000000002,758.10000000000002,758.10000000000002,758.10000000000002,706.60000000000002,777.10000000000002,777.10000000000002,817.5,739.39999999999998,739.39999999999998,783.5,783.5,783.5,783.5,783.5,822.79999999999995,726.89999999999998,751.5,751.5,751.5,751.5,751.5,751.5,795.29999999999995,795.29999999999995,721.10000000000002,764,764,764,764,764,764,764,770.29999999999995,807.10000000000002,807.10000000000002,807.10000000000002,807.10000000000002,807.10000000000002,745.29999999999995,745.29999999999995,745.29999999999995,745.29999999999995,745.29999999999995,745.29999999999995,745.29999999999995,745.29999999999995,745.29999999999995,745.29999999999995,789.70000000000005,789.70000000000005,789.70000000000005,789.70000000000005,789.70000000000005,732.29999999999995,770.29999999999995,770.29999999999995,770.29999999999995,812.10000000000002,812.10000000000002,744.39999999999998,825.10000000000002,825.10000000000002,520.5,664.5,698.60000000000002,855.29999999999995,744.39999999999998,672.60000000000002,715.10000000000002,30.600000000000001,171.40000000000001,458.80000000000001,643,690,753.79999999999995,819.10000000000002,613,750.5,30.600000000000001,706.70000000000005,706.70000000000005,58.299999999999997,738.10000000000002,825.10000000000002,25.600000000000001,46.700000000000003,56.899999999999999,750.5,613,715.10000000000002,297.69999999999999,297.69999999999999,731.70000000000005,706.70000000000005,643,725.10000000000002,680.89999999999998,860.60000000000002,55,855.29999999999995,450.19999999999999,52.799999999999997,43.600000000000001,442.10000000000002,715.10000000000002,723.10000000000002,698.60000000000002,575.79999999999995,28.300000000000001,664.5,613,635.89999999999998,690,795.89999999999998,744.39999999999998,715.10000000000002,753.79999999999995,753.79999999999995,672.60000000000002,698.60000000000002,613,849.29999999999995,605.29999999999995,698.60000000000002,723.10000000000002,811.20000000000005,376.60000000000002,672.60000000000002,768.39999999999998,715.10000000000002,738.10000000000002,855.29999999999995,672.60000000000002,41.600000000000001,368.30000000000001,855.29999999999995,100.7,664.5,28.300000000000001,844,613,690,649.89999999999998,730.60000000000002,803.29999999999995,753.79999999999995,567.20000000000005,753.79999999999995,635.89999999999998,715.10000000000002,819.10000000000002,715.10000000000002,715.10000000000002,825.10000000000002,16.199999999999999,16.199999999999999,15.300000000000001,36.899999999999999,41.100000000000001,43.5,25.600000000000001,25.600000000000001,73.700000000000003,229,252.59999999999999,316.69999999999999,350.19999999999999,395,423.39999999999998,423.39999999999998,431.60000000000002,560,560,587.10000000000002,587.10000000000002,587.10000000000002,596.29999999999995,605.79999999999995,605.79999999999995,605.79999999999995,605.79999999999995,605.79999999999995,624.10000000000002,633.60000000000002,633.60000000000002,643,661.79999999999995,661.79999999999995,671.20000000000005,671.20000000000005,671.20000000000005,671.20000000000005,671.20000000000005,671.20000000000005,689.10000000000002,689.10000000000002,744.39999999999998,752.60000000000002,752.60000000000002,752.60000000000002,752.60000000000002,752.60000000000002,665.60000000000002,665.60000000000002,665.60000000000002,665.60000000000002,614.70000000000005,106.7],\"y\":[8.1999999999999993,18,14.6,8.3000000000000007,11.4,22.199999999999999,24.100000000000001,8,13.1,22.800000000000001,17.800000000000001,19.300000000000001,17,21.300000000000001,26.399999999999999,22.899999999999999,15.1,16.699999999999999,15.9,9.3000000000000007,18.300000000000001,19.100000000000001,21,19.5,23.699999999999999,16.300000000000001,19,19.399999999999999,30.199999999999999,22.800000000000001,25.399999999999999,11.199999999999999,20.600000000000001,17.699999999999999,21.199999999999999,18.199999999999999,21.699999999999999,11.300000000000001,17.800000000000001,14.1,23.300000000000001,18.399999999999999,16.600000000000001,19.600000000000001,12.9,25.899999999999999,14.699999999999999,23,11.800000000000001,11,20.800000000000001,21.5,20.399999999999999,20.399999999999999,17.600000000000001,27.699999999999999,17.800000000000001,13.800000000000001,13.9,12.300000000000001,11.5,5.5,18.800000000000001,20.800000000000001,23.100000000000001,18.600000000000001,23,19.600000000000001,19.600000000000001,17.199999999999999,15.800000000000001,17.699999999999999,15.6,17.300000000000001,27.600000000000001,6.7000000000000002,15.699999999999999,8.3000000000000007,14.699999999999999,21.600000000000001,19.5,17.899999999999999,18.600000000000001,16.600000000000001,20.199999999999999,21.5,25.399999999999999,22.399999999999999,25.300000000000001,17.399999999999999,14.699999999999999,17.399999999999999,20.800000000000001,18.199999999999999,23.399999999999999,17.800000000000001,12.699999999999999,17.399999999999999,11.6,19.800000000000001,19.800000000000001,14.4,20.100000000000001,24.100000000000001,5.2999999999999998,12.699999999999999,18.199999999999999,21.399999999999999,20.300000000000001,17.399999999999999,13.699999999999999,18.800000000000001,22.800000000000001,18.899999999999999,15.800000000000001,15.5,11.6,15.199999999999999,10.6,19.600000000000001,10.300000000000001,17.100000000000001,22.5,17.899999999999999,19.800000000000001,20.600000000000001,9,17.199999999999999,15.9,15.4,15.4,14,10.6,17.600000000000001,14.9,17.600000000000001,17.199999999999999,15.6,18,21.699999999999999,21.899999999999999,23.300000000000001,21.199999999999999,16.600000000000001,23.800000000000001,27.399999999999999,13.199999999999999,24.199999999999999,17.399999999999999,23.699999999999999,23.199999999999999,24.800000000000001,24.600000000000001,20.100000000000001,29.600000000000001,16.399999999999999,28.600000000000001,18.399999999999999,20.5,19,16.100000000000001,20.300000000000001,15.199999999999999,17.800000000000001,17.800000000000001,5.2999999999999998,16.600000000000001,23.399999999999999,14.6,20.699999999999999,21.899999999999999,17.399999999999999,20.100000000000001,17.699999999999999,14.199999999999999,20.300000000000001,5.7999999999999998,19.199999999999999,18.300000000000001,14.4,23.899999999999999,19.100000000000001,12.4,16.800000000000001,20.800000000000001,17.600000000000001,11.5,21,13.300000000000001,11.5,11.699999999999999,24.199999999999999,24.600000000000001,24.300000000000001,24.600000000000001,23.5,5.7999999999999998,21.5,13.9,22.600000000000001,21.600000000000001,12.4,8.8000000000000007,20.199999999999999,15.1,22.100000000000001,22.899999999999999,20.699999999999999,19.600000000000001,23.199999999999999,18.399999999999999,5.0999999999999996,20.100000000000001,11,17,17,16.899999999999999,12.4,19.399999999999999,15.199999999999999,16.199999999999999,18.600000000000001,11,13.4,15.4,22.899999999999999,16.100000000000001,20.100000000000001,28.300000000000001,16.399999999999999,26.399999999999999,27.800000000000001,18.699999999999999,24.300000000000001,17.699999999999999,19.600000000000001,18.199999999999999,18.800000000000001,25.100000000000001,13.4,15.199999999999999,16.699999999999999,15.4,21.899999999999999,22.399999999999999,26.800000000000001,25.699999999999999,20.699999999999999,28.699999999999999,21.699999999999999,26.800000000000001,24,22.100000000000001,21.399999999999999,18.899999999999999,22.300000000000001,23.899999999999999,21.399999999999999,20.600000000000001,23.699999999999999,28.300000000000001,11.199999999999999,21.399999999999999,19.300000000000001,21.800000000000001,22.100000000000001,19.399999999999999,23.699999999999999,21,19.100000000000001,21.800000000000001,20.100000000000001,20.199999999999999,4.7999999999999998,5.0999999999999996,5.0999999999999996,4.5999999999999996,4.5999999999999996,4.5999999999999996,4.5999999999999996,2.2000000000000002,5.0999999999999996,4.2000000000000002,8.8000000000000007,7.5,23.399999999999999,12.6,22.100000000000001,24.199999999999999,24.300000000000001,18.699999999999999,25.300000000000001,22.899999999999999,26.899999999999999,17.100000000000001,22.199999999999999,14.300000000000001,15.4,19.600000000000001,10.6,20.699999999999999,19.100000000000001,19.199999999999999,19.199999999999999,11.300000000000001,19,17.100000000000001,23.800000000000001,16,24.899999999999999,25.300000000000001,24.800000000000001,12.199999999999999,24.300000000000001,19.699999999999999,18.5,18.600000000000001,19.199999999999999,21.600000000000001,21.600000000000001,18.899999999999999,16.800000000000001,16.800000000000001,12.9,13.699999999999999,24.199999999999999,24.100000000000001,21.199999999999999,19.699999999999999,23.5,24.199999999999999,21.5,17.100000000000001,18.100000000000001,18,9.8000000000000007,19.300000000000001,23,22.699999999999999,20.399999999999999,19.300000000000001,15.699999999999999,20.600000000000001,15.9,12.199999999999999,16.800000000000001,21.300000000000001,10.1,17.399999999999999,12.800000000000001,10.1,15.4,20.600000000000001,19.800000000000001,18.699999999999999,20.800000000000001,20.800000000000001,15.9,19.699999999999999,21.100000000000001,18.399999999999999,17.300000000000001,15.199999999999999,15.9,21.100000000000001,19.600000000000001,15.9,16.399999999999999,16.800000000000001,13.800000000000001,13.800000000000001,14.199999999999999,10.4,20.300000000000001,10.300000000000001,15.4,21.100000000000001,21.899999999999999,8.6999999999999993,5.2000000000000002,19.300000000000001,16.199999999999999,28.199999999999999,20.5,21.300000000000001,20.899999999999999,20.600000000000001,11.6,23.300000000000001,23.300000000000001,7.5,20.699999999999999,21.899999999999999,15.199999999999999,5.2999999999999998,10.1,20.399999999999999,24.300000000000001,25.899999999999999,28,28,22.800000000000001,25,21.300000000000001,21.800000000000001,27.899999999999999,17,14.199999999999999,19.899999999999999,23.399999999999999,14.699999999999999,8.1999999999999993,22.800000000000001,26.399999999999999,24.100000000000001,27.5,26.300000000000001,13.800000000000001,24.899999999999999,24.800000000000001,26.199999999999999,30.800000000000001,29.300000000000001,22.300000000000001,26.899999999999999,20.399999999999999,20.399999999999999,27.899999999999999,26.199999999999999,24.600000000000001,19.399999999999999,23.300000000000001,23.899999999999999,20.899999999999999,22.199999999999999,23.800000000000001,26.800000000000001,14.199999999999999,23.600000000000001,19.100000000000001,16.199999999999999,25.5,10.9,14.800000000000001,16.199999999999999,17.300000000000001,19.100000000000001,8.9000000000000004,10.5,19.300000000000001,23.399999999999999,11.800000000000001,17.699999999999999,17.399999999999999,16.800000000000001,17.899999999999999,16.600000000000001,19.899999999999999,18.899999999999999,15.5,18.899999999999999,18.899999999999999,14.5,4.5999999999999996,5.0999999999999996,4.5999999999999996,10.199999999999999,11.199999999999999,13.300000000000001,13.699999999999999,17.600000000000001,18,14.300000000000001,24.5,26.399999999999999,22.699999999999999,27.199999999999999,26.100000000000001,18.199999999999999,22.600000000000001,30.199999999999999,30.199999999999999,23.399999999999999,31,33.100000000000001,30.600000000000001,24.100000000000001,26.399999999999999,19.399999999999999,20.600000000000001,28.699999999999999,32.399999999999999,32.399999999999999,27.5,30.800000000000001,23.899999999999999,32.600000000000001,32.299999999999997,33.299999999999997,27.300000000000001,21.600000000000001,21.600000000000001,20.699999999999999,29.199999999999999,28.899999999999999,26.699999999999999,18.5,25.899999999999999,25.899999999999999,21.100000000000001,18.199999999999999,27.800000000000001,27.800000000000001,21.899999999999999,21.199999999999999,25.600000000000001,11.800000000000001],\"z\":[51,33,33,97,99,29,27,86,63,40,51,38,72,42,21,44,27,47,35,44,40,38,44,43,32,60,34,48,24,39,24,78,37,39,32,62,24,60,27,43,37,42,54,48,74,24,70,36,35,46,17,34,42,42,45,24,63,50,40,51,39,59,35,33,31,44,37,33,33,26,27,37,25,43,30,79,43,72,66,19,39,44,51,47,45,15,27,34,36,25,59,24,32,43,22,64,48,24,87,39,39,66,40,29,78,52,29,33,45,56,43,18,39,35,27,27,30,27,30,36,74,43,42,45,50,24,49,43,46,35,40,39,46,42,38,52,58,66,42,38,39,31,51,53,32,22,40,28,43,25,39,29,43,47,27,47,27,45,35,34,29,41,31,56,67,70,47,33,26,45,35,50,39,39,53,39,54,44,45,66,32,32,53,45,34,46,39,42,42,60,33,28,22,25,22,36,54,15,59,38,33,54,68,37,64,34,31,37,33,26,25,96,47,46,27,27,60,73,19,27,59,49,46,79,57,39,44,34,26,43,21,27,43,36,25,41,46,40,27,75,51,20,66,73,54,38,39,70,28,40,25,36,37,38,41,46,41,44,59,40,32,84,42,39,53,54,55,24,32,53,56,58,47,57,61,61,21,21,21,21,59,24,51,35,46,40,90,49,32,30,53,39,40,28,67,48,46,45,43,90,25,39,38,38,94,52,53,35,45,27,27,28,78,27,41,30,24,24,27,28,34,28,28,39,56,27,27,32,35,27,27,28,41,54,51,86,44,34,35,41,44,51,37,51,66,43,35,75,57,64,75,53,43,47,50,35,35,55,39,39,42,45,64,53,35,45,38,27,47,77,77,58,75,42,78,57,54,42,51,100,39,63,29,58,44,50,55,48,34,34,71,46,43,19,68,62,55,33,32,34,34,46,36,41,34,27,67,46,44,31,42,53,27,33,50,27,39,24,42,36,36,19,27,48,31,56,56,33,34,44,45,40,38,66,45,51,35,73,53,46,58,29,64,78,58,80,70,35,77,61,49,88,65,54,56,48,59,50,64,72,64,64,76,82,77,59,45,41,27,33,27,40,79,50,35,40,28,45,82,57,25,22,40,27,25,28,43,34,71,58,33,21,27,29,30,42,26,27,26,63,65,65,69,30,29,35,73,41,41,71,62,35,32,71,70,42,31],\"type\":\"scatter3d\",\"mode\":\"markers\",\"marker\":{\"color\":\"rgba(31,119,180,1)\",\"size\":[55,55,55,55,55,55,55,55,55,55,55,55,55,55,55,55,55,55,55,55,55,55,55,55,55,55,55,55,55,55,55,55,55,55,55,55,55,55,55,55,55,55,55,55,55,55,55,55,55,55,55,55,55,55,55,55,55,55,55,55,55,55,55,55,55,55,55,55,55,55,55,55,55,55,55,55,55,55,55,55,55,55,55,55,55,55,55,55,55,55,55,55,55,55,55,55,55,55,55,55,55,55,55,55,55,55,55,55,55,55,55,55,55,55,55,55,55,55,55,55,55,55,55,55,55,55,55,55,55,55,55,55,55,55,55,55,55,55,55,55,55,55,55,55,55,55,55,55,55,55,55,55,55,55,55,55,55,55,55,55,55,55,55,55,55,55,55,55,55,55,55,55,55,55,55,55,55,55,55,55,55,55,55,55,55,55,55,55,55,55,55,55,55,55,55,55,55,55,55,55,55,55,55,55,55,55,55,55,55,55,55,55,55,55,55,55,55,55,55,55,55,55,55,55,55,55,55,55,55,55,55,55,55,55,55,55,55,55,55,55,55,55,55,55,55,55,55,55,55,55,55,55,55,55,55,55,55,55,55,55,55,55,55,55,55,55,55,55,55,55,55,55,55,55,55,55,55,55,55,55,55,55,55,55,55,55,55,55,55,55,55,55,55,55,55,55,55,55,55,55,55,55,55,55,55,55,55,55,55,55,55,55,55,55,55,55,55,55,55,55,55,55,55,55,55,55,55,55,55,55,55,55,55,55,55,55,55,55,55,55,55,55,55,55,55,55,55,55,55,55,55,55,55,55,55,55,55,55,55,55,55,55,55,55,55,55,55,55,55,55,55,55,55,55,55,55,55,55,55,55,55,55,55,55,55,55,55,55,55,55,55,55,55,55,55,55,55,55,55,55,55,55,55,55,55,55,55,55,55,55,55,55,55,55,55,55,55,55,55,55,55,55,55,55,55,55,55,55,55,55,55,55,55,55,55,55,55,55,55,55,55,55,55,55,55,55,55,55,55,55,55,55,55,55,55,55,55,55,55,55,55,55,55,55,55,55,55,55,55,55,55,55,55,55,55,55,55,55,55,55,55,55,55,55,55,55,55,55,55,55,55,55,55,55,55,55,55,55,55,55,55,55,55,55,55,55,55,55,55,55,55,55,55,55,55,55,55],\"sizemode\":\"area\",\"line\":{\"color\":\"rgba(31,119,180,1)\"}},\"textfont\":{\"size\":55},\"error_y\":{\"color\":\"rgba(31,119,180,1)\",\"width\":55},\"error_x\":{\"color\":\"rgba(31,119,180,1)\",\"width\":55},\"line\":{\"color\":\"rgba(31,119,180,1)\",\"width\":55},\"frame\":null}],\"highlight\":{\"on\":\"plotly_click\",\"persistent\":false,\"dynamic\":false,\"selectize\":false,\"opacityDim\":0.20000000000000001,\"selected\":{\"opacity\":1},\"debounce\":0},\"shinyEvents\":[\"plotly_hover\",\"plotly_click\",\"plotly_selected\",\"plotly_relayout\",\"plotly_brushed\",\"plotly_brushing\",\"plotly_clickannotation\",\"plotly_doubleclick\",\"plotly_deselect\",\"plotly_afterplot\",\"plotly_sunburstclick\"],\"base_url\":\"https://plot.ly\"},\"evals\":[],\"jsHooks\":[]}</script>\n```\n\n:::\n:::\n\n\n\n## Cas general\n\n\n\n::: {.cell}\n\n```{.r .cell-code}\nlibrary(mvoutlier)\ndades2 <- dades; Y <- as.matrix(dades2)\ndistances <- dd.plot(Y,quan=1/2, alpha=0.025)\n```\n\n::: {.cell-output-display}\n![](AdvancedPreprocessing_files/figure-html/deteccio_outliers-1.png){width=672}\n:::\n\n```{.r .cell-code}\ndistances$md.cla\n```\n\n::: {.cell-output .cell-output-stdout}\n\n```\n  [1] 2.1512048 1.3379825 2.1172116 3.8246066 4.1575569 1.0214128 1.2694422\n  [8] 2.7595383 1.6355391 0.7435067 0.8384635 0.9832367 1.8368465 0.5815850\n [15] 1.5811197 0.8448810 2.2378066 0.8891432 2.0349346 2.1415420 0.9637216\n [22] 1.0652484 2.0207355 0.1516285 0.9211263 0.9991636 1.0865045 0.6181512\n [29] 1.9793545 0.8189627 1.3860142 2.3444645 0.8378744 1.2409837 1.1152316\n [36] 1.3406612 1.4257126 1.8975023 1.8395299 1.9442325 1.5246648 0.5432011\n [43] 0.8329662 0.6613403 2.1071830 1.4175912 1.7140652 1.1449734 2.2130392\n [50] 1.9026888 2.1219783 0.7044810 0.4459360 0.4459360 0.7512874 1.6047252\n [57] 1.3885461 1.5468641 2.1002115 2.0633162 2.0167931 2.4299533 0.7010824\n [64] 0.8008038 0.9015124 0.6025597 0.7374479 1.0558439 1.0558439 2.2428749\n [71] 2.1585402 1.2384809 2.3062269 0.6858624 1.5046259 2.9334983 2.1118951\n [78] 2.4255957 1.3308234 1.6266383 0.4465482 0.5872994 0.5867873 0.8654335\n [85] 0.4631097 2.1760160 1.2790069 0.8809271 1.1237454 2.2646990 1.1262982\n [92] 2.2986587 0.8051529 0.4352584 1.4074557 1.3971864 2.0931182 2.5313223\n [99] 2.6371026 0.4134452 0.4134452 1.4052058 0.4979006 1.0797643 2.9624567\n[106] 2.0237801 2.2067698 0.7659111 0.6120329 1.0306586 1.9840817 2.5398227\n[113] 0.7583594 1.2612702 2.2550289 2.2630901 2.3986605 2.2333581 2.5154080\n[120] 0.6164195 2.0776908 0.7059860 0.6907049 0.7447968 0.6961495 1.6092699\n[127] 2.0621329 1.2085780 1.1273125 1.8393167 1.8994420 1.9919912 1.9422520\n[134] 0.9727646 1.9913779 0.5248409 1.0284115 1.4808298 1.0140768 0.6869463\n[141] 0.6472623 1.0173741 1.0022887 1.2393227 1.0774778 1.7008576 1.9173406\n[148] 1.1253466 0.8016034 1.2873884 1.2708888 1.7937650 1.7535716 0.6123247\n[155] 1.8615127 0.8772978 1.6878607 0.5740120 0.7635284 1.0865045 2.1190046\n[162] 0.2598342 2.0279375 0.9019672 1.5828523 2.6275057 0.8654335 0.8812522\n[169] 2.2615419 0.4126382 0.8242294 0.5192159 0.3914657 1.1041732 1.1545360\n[176] 0.4488220 2.5007877 0.3735133 0.9842039 1.4052058 0.9619567 1.1900212\n[183] 2.0712298 1.0688091 0.6509067 0.8710078 2.0167931 0.5721858 1.8734132\n[190] 2.0455397 2.2223974 1.1169353 1.4160636 1.3115436 1.4160636 0.8402910\n[197] 2.5007877 2.1760160 1.4576505 0.6739897 0.9174610 1.9459779 2.4916974\n[204] 0.7477589 2.4314093 0.8863790 0.8707309 0.7715035 1.0558439 1.2380805\n[211] 1.8688756 3.4063203 0.6123247 1.9026888 2.1987798 2.1987798 1.1310435\n[218] 2.0474931 2.1657213 2.2160825 1.0026014 0.8037506 1.9026888 2.4507631\n[225] 1.3683752 0.8261645 1.2511671 0.6967559 1.6506914 0.5608519 1.5811197\n[232] 1.5634876 0.7688811 0.9334464 1.9579191 0.3124014 0.6834758 0.8748825\n[239] 1.2285607 3.1928408 2.1998017 2.4581678 1.3489065 2.4697383 1.2347779\n[246] 1.4312779 1.2250285 2.3230787 1.7396325 0.5648614 1.4690388 0.8842203\n[253] 0.6571482 0.4842651 0.4929435 0.7917183 1.0180851 0.5284808 1.2853576\n[260] 0.8651401 1.9285065 2.4490604 0.4759367 0.5746102 1.0670200 1.3483202\n[267] 0.8323413 1.3050887 0.9206251 0.7215715 1.2665824 1.1392373 0.5009500\n[274] 2.5915741 2.4562117 2.4533198 4.3204916 4.3204916 4.3204916 4.3204916\n[281] 3.1279535 4.0240805 2.9005429 2.6536444 2.4875865 1.4261032 2.9289704\n[288] 1.2602955 1.2582225 1.2913573 0.8064294 1.5973586 1.1013307 1.9199488\n[295] 1.6791747 1.3933199 1.0945785 1.0435959 0.9079748 3.1489768 1.6067994\n[302] 1.1813530 1.4983957 1.4983957 3.7793529 0.8403912 1.0098248 0.9263502\n[309] 1.5109206 1.3378955 1.3510446 1.2935832 2.2628304 1.3807921 1.0992508\n[316] 2.0043758 2.0723786 1.9693414 1.5822400 1.5224026 1.5667415 2.3115444\n[323] 2.3115444 2.7030650 1.6165510 1.3156217 1.3162506 1.2162273 1.2460084\n[330] 1.3295084 1.3156217 1.5777655 1.6136293 0.9647550 1.1032109 2.9002933\n[337] 1.0052333 1.0565707 1.0247083 0.9592401 1.0052333 1.4799833 1.2766433\n[344] 1.6119247 2.2102537 1.6489460 1.2846146 2.4626101 1.1856617 1.8722498\n[351] 2.4626101 1.4018743 0.8164050 0.8427082 0.9426092 1.0749215 1.0749215\n[358] 1.5076101 1.2309112 1.0752235 1.3174101 1.4108121 1.5390601 1.4262600\n[365] 1.1474900 0.9851802 2.0608206 2.5616952 1.2350960 2.3991992 2.3991992\n[372] 0.9636042 2.2156559 0.6405978 2.8472072 1.4027365 1.0146283 0.7065577\n[379] 2.2524889 3.6873905 0.5056023 1.2273610 1.6242278 1.2826760 1.1054025\n[386] 0.7217604 1.1213620 2.1008998 0.9016456 0.9016456 2.5306142 0.7783752\n[393] 1.1204441 2.7312638 2.6070900 2.2217968 1.1074819 0.9756355 1.2224428\n[400] 2.7386289 2.7386289 0.9215108 1.0612070 0.4646294 0.9617825 1.5893047\n[407] 1.9402502 2.0059941 1.3786885 1.2066435 2.0204233 2.2514669 1.2539158\n[414] 1.2942327 1.3207677 1.5193393 1.5408538 2.5836481 1.1581001 1.0629563\n[421] 1.3292082 2.1547964 1.8064456 0.9532013 1.3835120 1.1658931 1.1658931\n[428] 1.6023373 1.2601133 1.2353069 1.3882029 0.8093320 0.8875183 1.8162538\n[435] 1.0718102 2.1192709 1.3990278 2.0596422 1.3930155 0.8712025 1.7654778\n[442] 1.2064497 2.3516796 2.3766534 1.7654778 3.6831554 1.8781162 2.6231962\n[449] 2.7624742 1.2571769 1.1315694 2.7292269 1.4988128 1.3645685 1.2487224\n[456] 0.2760227 1.3354776 0.5711344 1.4684949 2.0850998 1.4684949 1.4684949\n[463] 2.3204115 3.1150249 2.9179968 2.6863547 2.1762693 2.1608622 2.4512056\n[470] 2.2700598 2.4203373 2.1340683 2.7610866 2.7243416 2.3384447 1.5379530\n[477] 2.1017212 2.1939930 2.9836682 1.9994740 2.2210057 2.2179387 0.8614322\n[484] 2.3467527 2.7820672 2.2514710 1.0877247 1.3927841 2.0228082 1.2372504\n[491] 1.8863196 2.5240480 2.5562991 1.5504217 2.2311298 0.9425752 2.5338080\n[498] 2.4657745 2.6692880 2.8486431 1.8598956 1.8598956 2.0117051 1.8215322\n[505] 1.7567235 1.3587946 2.0685362 1.3162443 1.3162443 2.1979471 1.3911676\n[512] 1.6202613 1.5794635 2.3509350 2.1643692 1.3910454 2.2803773\n```\n\n\n:::\n\n```{.r .cell-code}\ndistances$md.rob\n```\n\n::: {.cell-output .cell-output-stdout}\n\n```\n  [1] 8.2157063 1.6301206 2.5927006 8.7074405 8.4305593 2.4131242 2.2677777\n  [8] 3.5465258 1.7618316 0.5640203 0.7009379 0.8879920 2.2292868 0.1551463\n [15] 1.6122568 0.8823011 7.8819613 1.0741592 7.6935630 8.1537779 0.9463274\n [22] 0.9930106 5.6883551 1.7830105 1.1389196 1.7054315 1.2689717 0.3929892\n [29] 2.2821365 0.8087114 1.3567522 2.5487554 0.6616880 1.2461023 1.0917446\n [36] 1.5038041 1.5930573 2.1694506 2.2059985 7.8152918 3.6288603 1.0804302\n [43] 1.1331551 0.4178624 2.2342008 1.3909220 1.9335813 2.7410709 8.3315088\n [50] 7.7723462 2.4649409 0.8600525 0.3581614 0.3581614 0.9090681 1.6896377\n [57] 1.5454964 1.7296222 8.2698337 8.2217135 7.8649425 8.4360084 2.8650931\n [64] 1.0618142 0.8732263 0.6670303 0.4821334 1.2010922 1.2010922 7.6603786\n [71] 7.5939776 1.3602058 7.9060422 1.3889142 1.6766843 9.0342033 7.9236794\n [78] 7.9552566 2.6860109 2.4573528 1.1848045 1.0624264 0.7875436 1.1490070\n [85] 0.3059888 2.5202367 1.2684147 0.7229385 1.3017097 7.6246013 1.6925358\n [92] 7.6522631 2.4586887 1.2914784 1.5606376 1.5774550 8.3501267 8.3858393\n [99] 3.4202364 1.1279366 1.1279366 2.0225251 0.5860946 0.9498146 9.3747753\n[106] 8.0042550 7.5080277 0.9509607 0.2662519 0.9717070 7.9816607 7.6885325\n[113] 0.5881634 1.2813352 7.9291458 7.9707388 8.3405097 7.8674589 8.4531841\n[120] 2.7190157 2.8323876 1.4897117 0.4801052 0.7783254 0.5601142 1.8191839\n[127] 8.0224812 1.1488887 1.3199856 2.1943586 7.4800868 7.9251227 7.8497015\n[134] 1.0134693 7.7967344 1.3976338 1.1000734 1.6510473 4.5524693 0.3744225\n[141] 0.2942177 1.9978997 1.9915017 4.8510143 1.9650389 1.7813716 7.7651241\n[148] 1.0128859 1.1389993 1.2677583 2.8594690 3.7699709 3.0964572 0.3419226\n[155] 2.1672916 1.2420105 1.9283729 0.7278137 0.8383210 1.2689717 7.6229208\n[162] 1.2436442 7.5391699 0.9694854 1.8389077 8.8702041 1.1490070 1.3377451\n[169] 7.8021768 1.2243510 0.6254693 1.2536495 1.0758740 1.2006624 1.7968090\n[176] 0.8097497 8.9738594 0.7656994 0.8372706 2.0225251 0.7872045 1.4281055\n[183] 8.1349516 1.0719965 1.3511167 0.7897428 7.8649425 0.1006548 7.6830528\n[190] 7.7041955 8.0468280 1.4253214 1.4455696 1.2942278 1.4455696 1.1315623\n[197] 8.9738594 2.5202367 1.5507476 0.3998531 0.7934616 7.7225329 8.6898201\n[204] 0.6729101 7.3401343 0.7313357 1.2005866 0.5753968 1.2010922 1.2191654\n[211] 2.2341036 4.3439349 0.3419226 7.7723462 7.6226334 7.6226334 1.2376389\n[218] 2.1997155 2.5641247 7.8035716 1.4484463 0.5987993 7.7723462 5.4377862\n[225] 1.2912976 0.8264241 1.3381767 2.5574766 1.9021290 2.8662752 1.6122568\n[232] 1.7948921 0.6174913 0.7730502 2.4187140 1.0869098 0.6461858 0.8002264\n[239] 1.1237513 8.6804322 7.9203264 7.8232250 2.1318851 3.1432113 1.4900889\n[246] 1.6284259 1.3516616 3.3785762 1.7661100 0.2235938 1.3926630 0.6973112\n[253] 0.3886249 1.3555949 1.0294052 0.7528347 1.3244015 1.1808389 1.5292418\n[260] 0.7777983 2.1524233 3.4065074 1.2438199 0.9814537 1.2219665 2.0478026\n[267] 1.3464787 1.3297142 0.9883371 0.8295569 1.5217910 1.3754096 0.4405954\n[274] 6.1191808 5.9436337 5.9674829 7.9240497 7.9240497 7.9240497 7.9240497\n[281] 6.6707462 7.6051455 6.4542151 9.3221740 9.2822318 3.1220294 4.7475686\n[288] 2.5612214 2.3893762 2.4146280 2.6506927 2.5009851 2.4807670 2.9676485\n[295] 3.5326586 3.0298057 5.2123227 5.0776808 3.6566395 6.7286092 4.7921000\n[302] 4.6577486 5.4328510 5.4328510 8.1145477 0.7352526 0.8870954 0.8683079\n[309] 1.4948587 1.5921329 1.6257463 1.5461321 2.4944242 1.7285717 1.2036855\n[316] 2.3519796 2.3716572 2.2385864 1.8657511 1.7978546 1.7387780 2.6272422\n[323] 2.6272422 2.9709197 1.6027909 1.4991915 1.4963063 1.2920596 1.2827263\n[330] 1.4920590 1.4991915 1.9104816 1.7320072 0.8777790 1.0878941 3.0972045\n[337] 1.0095365 1.2710524 1.2243430 1.0216210 1.0095365 1.4306690 1.6256760\n[344] 1.6944177 2.2387272 1.7907724 1.6777179 2.5400737 1.1772680 1.8565204\n[351] 2.5400737 1.3144652 0.7736309 0.7922019 0.8656220 1.0775349 1.0775349\n[358] 1.5327420 1.4134151 1.3608060 1.4303565 1.4745843 1.5632731 1.3756478\n[365] 1.2928977 1.0560837 2.2734361 2.9506793 1.1408481 2.7494115 2.7494115\n[372] 2.6585856 2.5915964 0.2859186 3.0384855 1.3264608 1.1576615 0.5548502\n[379] 8.8379406 8.0047752 2.7728449 1.5869296 1.7102709 1.6361218 1.6955705\n[386] 1.0860546 1.3977195 8.4811265 0.7680764 0.7680764 8.5500507 0.7492957\n[393] 1.8107260 8.7268752 8.9704335 8.2617904 1.3615027 0.9947617 1.3039687\n[400] 4.5322201 4.5322201 1.1056697 1.0836389 0.4212128 0.8857965 1.6000059\n[407] 2.6049474 7.9135709 2.0553305 2.6971923 7.9288514 8.7374402 2.9247081\n[414] 1.4293907 1.6915854 1.5751506 1.7459313 8.7440972 1.1963003 1.0766232\n[421] 1.3067784 2.2908143 2.6026554 1.2100382 1.5260517 1.4601269 1.4601269\n[428] 1.6726862 1.3123943 1.3896346 1.9752446 0.9759090 0.7983458 2.3001027\n[435] 1.7262508 3.8221951 1.4273152 2.2326354 1.7639182 0.7243175 2.1746276\n[442] 1.0879861 8.3518095 4.7687156 2.1746276 7.7082555 2.3184326 9.2029703\n[449] 2.9222732 1.7396517 1.3004394 3.2912419 1.7013126 1.5480203 1.2065761\n[456] 1.6118910 1.3402572 0.8055922 1.7284307 2.4764389 1.7284307 1.7284307\n[463] 2.7157733 9.4021626 9.3190081 9.5136889 8.6514786 8.5380896 8.5611742\n[470] 8.5336824 8.1756216 7.3768976 6.2780301 5.2036864 4.2458609 3.8429164\n[477] 3.3654341 3.3213773 4.6178209 3.4097509 2.2935763 2.2743959 1.1648570\n[484] 2.4055707 2.8867780 2.3051858 1.2552220 1.4103238 2.6423464 1.7033756\n[491] 1.9444397 2.5749001 2.7090937 1.4875413 2.3631233 0.8971715 2.7553091\n[498] 2.7178706 2.9674546 3.5872517 2.3123520 2.3123520 2.5043740 1.9885769\n[505] 1.8866382 1.7367897 2.5726948 1.8058369 1.8058369 2.8863013 1.6014070\n[512] 1.7055864 1.6057526 2.9520098 2.7068229 1.5144614 7.9984070\n```\n\n\n:::\n\n```{.r .cell-code}\nres <- aq.plot(Y,delta=qchisq(0.975,df=ncol(Y)),quan=1/2,alpha=0.05)\n```\n\n::: {.cell-output .cell-output-stdout}\n\n```\nProjection to the first and second robust principal components.\nProportion of total variation (explained variance): 0.9692463\n```\n\n\n:::\n\n::: {.cell-output-display}\n![](AdvancedPreprocessing_files/figure-html/deteccio_outliers-2.png){width=672}\n:::\n\n```{.r .cell-code}\nstr(res)\n```\n\n::: {.cell-output .cell-output-stdout}\n\n```\nList of 1\n $ outliers: logi [1:517] TRUE FALSE FALSE TRUE TRUE FALSE ...\n```\n\n\n:::\n\n```{.r .cell-code}\nres$outliers\n```\n\n::: {.cell-output .cell-output-stdout}\n\n```\n  [1]  TRUE FALSE FALSE  TRUE  TRUE FALSE FALSE  TRUE FALSE FALSE FALSE FALSE\n [13] FALSE FALSE FALSE FALSE  TRUE FALSE  TRUE  TRUE FALSE FALSE  TRUE FALSE\n [25] FALSE FALSE FALSE FALSE FALSE FALSE FALSE FALSE FALSE FALSE FALSE FALSE\n [37] FALSE FALSE FALSE  TRUE  TRUE FALSE FALSE FALSE FALSE FALSE FALSE FALSE\n [49]  TRUE  TRUE FALSE FALSE FALSE FALSE FALSE FALSE FALSE FALSE  TRUE  TRUE\n [61]  TRUE  TRUE FALSE FALSE FALSE FALSE FALSE FALSE FALSE  TRUE  TRUE FALSE\n [73]  TRUE FALSE FALSE  TRUE  TRUE  TRUE FALSE FALSE FALSE FALSE FALSE FALSE\n [85] FALSE FALSE FALSE FALSE FALSE  TRUE FALSE  TRUE FALSE FALSE FALSE FALSE\n [97]  TRUE  TRUE  TRUE FALSE FALSE FALSE FALSE FALSE  TRUE  TRUE  TRUE FALSE\n[109] FALSE FALSE  TRUE  TRUE FALSE FALSE  TRUE  TRUE  TRUE  TRUE  TRUE FALSE\n[121] FALSE FALSE FALSE FALSE FALSE FALSE  TRUE FALSE FALSE FALSE  TRUE  TRUE\n[133]  TRUE FALSE  TRUE FALSE FALSE FALSE  TRUE FALSE FALSE FALSE FALSE  TRUE\n[145] FALSE FALSE  TRUE FALSE FALSE FALSE FALSE  TRUE FALSE FALSE FALSE FALSE\n[157] FALSE FALSE FALSE FALSE  TRUE FALSE  TRUE FALSE FALSE  TRUE FALSE FALSE\n[169]  TRUE FALSE FALSE FALSE FALSE FALSE FALSE FALSE  TRUE FALSE FALSE FALSE\n[181] FALSE FALSE  TRUE FALSE FALSE FALSE  TRUE FALSE  TRUE  TRUE  TRUE FALSE\n[193] FALSE FALSE FALSE FALSE  TRUE FALSE FALSE FALSE FALSE  TRUE  TRUE FALSE\n[205]  TRUE FALSE FALSE FALSE FALSE FALSE FALSE  TRUE FALSE  TRUE  TRUE  TRUE\n[217] FALSE FALSE FALSE  TRUE FALSE FALSE  TRUE  TRUE FALSE FALSE FALSE FALSE\n[229] FALSE FALSE FALSE FALSE FALSE FALSE FALSE FALSE FALSE FALSE FALSE  TRUE\n[241]  TRUE  TRUE FALSE FALSE FALSE FALSE FALSE FALSE FALSE FALSE FALSE FALSE\n[253] FALSE FALSE FALSE FALSE FALSE FALSE FALSE FALSE FALSE  TRUE FALSE FALSE\n[265] FALSE FALSE FALSE FALSE FALSE FALSE FALSE FALSE FALSE  TRUE  TRUE  TRUE\n[277]  TRUE  TRUE  TRUE  TRUE  TRUE  TRUE  TRUE  TRUE  TRUE FALSE  TRUE FALSE\n[289] FALSE FALSE FALSE FALSE FALSE FALSE  TRUE FALSE  TRUE  TRUE  TRUE  TRUE\n[301]  TRUE  TRUE  TRUE  TRUE  TRUE FALSE FALSE FALSE FALSE FALSE FALSE FALSE\n[313] FALSE FALSE FALSE FALSE FALSE FALSE FALSE FALSE FALSE FALSE FALSE FALSE\n[325] FALSE FALSE FALSE FALSE FALSE FALSE FALSE FALSE FALSE FALSE FALSE FALSE\n[337] FALSE FALSE FALSE FALSE FALSE FALSE FALSE FALSE FALSE FALSE FALSE FALSE\n[349] FALSE FALSE FALSE FALSE FALSE FALSE FALSE FALSE FALSE FALSE FALSE FALSE\n[361] FALSE FALSE FALSE FALSE FALSE FALSE FALSE FALSE FALSE FALSE FALSE FALSE\n[373] FALSE FALSE FALSE FALSE FALSE FALSE  TRUE  TRUE FALSE FALSE FALSE FALSE\n[385] FALSE FALSE FALSE  TRUE FALSE FALSE  TRUE FALSE FALSE  TRUE  TRUE  TRUE\n[397] FALSE FALSE FALSE  TRUE  TRUE FALSE FALSE FALSE FALSE FALSE FALSE  TRUE\n[409] FALSE FALSE  TRUE  TRUE FALSE FALSE FALSE FALSE FALSE  TRUE FALSE FALSE\n[421] FALSE FALSE FALSE FALSE FALSE FALSE FALSE FALSE FALSE FALSE FALSE FALSE\n[433] FALSE FALSE FALSE  TRUE FALSE FALSE FALSE FALSE FALSE FALSE  TRUE  TRUE\n[445] FALSE  TRUE FALSE  TRUE FALSE FALSE FALSE FALSE FALSE FALSE FALSE FALSE\n[457] FALSE FALSE FALSE FALSE FALSE FALSE FALSE  TRUE  TRUE  TRUE  TRUE  TRUE\n[469]  TRUE  TRUE  TRUE  TRUE  TRUE  TRUE  TRUE  TRUE FALSE FALSE  TRUE  TRUE\n[481] FALSE FALSE FALSE FALSE FALSE FALSE FALSE FALSE FALSE FALSE FALSE FALSE\n[493] FALSE FALSE FALSE FALSE FALSE FALSE FALSE  TRUE FALSE FALSE FALSE FALSE\n[505] FALSE FALSE FALSE FALSE FALSE FALSE FALSE FALSE FALSE FALSE FALSE FALSE\n[517]  TRUE\n```\n\n\n:::\n\n```{.r .cell-code}\ntable(res$outliers)\n```\n\n::: {.cell-output .cell-output-stdout}\n\n```\n\nFALSE  TRUE \n  388   129 \n```\n\n\n:::\n\n```{.r .cell-code}\n#windows()\npar(mfrow=c(1, 1))\nlibrary(MVN)\n# mvnoutliers <- mvn(dades, multivariateOutlierMethod = \"adj\", showOutliers = TRUE, \n#                   showNewData = TRUE)\nmvnoutliers <- mvn(data = dades, mvn_test = \"royston\", \n                   univariate_test = \"AD\", \n              multivariate_outlier_method = \"adj\",\n              show_new_data = TRUE)\n```\n:::\n\n\n\nVisualitzem tots els outliers detectats com a true\n\n\n\n::: {.cell}\n\n```{.r .cell-code}\nsummary(mvnoutliers, select = \"outliers\")\n```\n\n::: {.cell-output .cell-output-stdout}\n\n```\n    Observation Mahalanobis.Distance\n1           466               95.620\n2           464               92.910\n3           105               92.347\n4           284               91.668\n5           465               91.312\n6           285               90.872\n7           448               89.349\n8            76               85.582\n9           177               85.110\n10          197               85.110\n11          395               84.820\n12          166               82.912\n13          379               82.172\n14          412               80.371\n15          418               80.180\n16          394               79.742\n17          203               79.121\n18            4               79.053\n19          467               78.658\n20          240               78.246\n21          469               76.910\n22          391               76.746\n23          468               76.551\n24          470               76.236\n25          119               75.377\n26          388               75.344\n27           62               75.271\n28            5               73.796\n29          117               73.244\n30           98               73.243\n31           49               72.952\n32          443               72.902\n33           97               72.889\n34          396               71.492\n35           59               71.469\n36            1               71.192\n37           60               70.684\n38           20               70.109\n39          471               69.553\n40          183               69.161\n41          305               68.417\n42          191               68.156\n43          127               67.840\n44          277               67.386\n45          278               67.386\n46          279               67.386\n47          280               67.386\n48          517               67.373\n49          380               67.118\n50          106               66.945\n51          111               66.582\n52          116               66.430\n53           78               66.389\n54          115               65.699\n55          132               65.676\n56          411               65.587\n57           73               65.387\n58           77               65.351\n59          408               65.339\n60          241               65.243\n61           61               65.055\n62          187               65.055\n63           17               65.028\n64          133               64.804\n65          118               64.776\n66          242               63.968\n67          169               63.822\n68           40               63.798\n69          220               63.737\n70           50               63.488\n71          214               63.488\n72          223               63.488\n73          135               63.471\n74          147               63.165\n75          202               62.350\n76          190               62.077\n77          282               62.062\n78          189               61.798\n79           19               61.726\n80          112               61.540\n81          446               61.359\n82           70               61.172\n83           92               61.051\n84          161               60.679\n85           90               60.596\n86          215               60.585\n87          216               60.585\n88           71               60.301\n89          163               59.452\n90          107               58.594\n91          131               58.351\n92          472               56.439\n93          205               55.917\n94          281               47.755\n95          300               47.138\n96          283               44.684\n97          473               40.862\n98          274               40.080\n99          276               38.049\n100         275               37.750\n101          23               33.308\n102         224               30.706\n103         303               30.572\n104         304               30.572\n105         297               28.501\n106         474               27.684\n107         298               26.969\n108         144               24.440\n109         301               23.821\n110         444               23.544\n111         287               23.359\n112         302               22.481\n113         479               21.975\n114         139               21.533\n115         400               20.893\n116         401               20.893\n117         212               19.743\n118         475               18.348\n119         476               15.110\n120         436               14.908\n121         152               14.508\n122         299               13.807\n123         500               13.600\n124          41               13.455\n125           8               13.137\n126         295               12.864\n127          99               12.083\n```\n\n\n:::\n:::\n\n\n\nVisualitzem les variables originals quines han donat els que no son outliers\n\n\n\n::: {.cell}\n\n```{.r .cell-code}\nsummary(mvnoutliers, select = \"new_data\")\n```\n\n::: {.cell-output .cell-output-stdout}\n\n```\n       DC temp RH\n2   669.1 18.0 33\n3   686.9 14.6 33\n6   488.0 22.2 29\n7   495.6 24.1 27\n9   692.6 13.1 63\n10  698.6 22.8 40\n11  698.6 17.8 51\n12  713.0 19.3 38\n13  665.3 17.0 72\n14  686.5 21.3 42\n15  699.6 26.4 21\n16  713.9 22.9 44\n18  664.2 16.7 47\n21  692.6 18.3 40\n22  724.3 19.1 38\n24  537.4 19.5 43\n25  594.2 23.7 32\n26  601.4 16.3 60\n27  668.0 19.0 34\n28  686.5 19.4 48\n29  721.4 30.2 24\n30  728.6 22.8 39\n31  692.3 25.4 24\n32  709.9 11.2 78\n33  706.8 20.6 37\n34  718.3 17.7 39\n35  724.3 21.2 32\n36  730.2 18.2 62\n37  669.1 21.7 24\n38  682.6 11.3 60\n39  686.9 17.8 27\n42  624.2 18.4 42\n43  647.1 16.6 54\n44  698.6 19.6 48\n45  735.7 12.9 74\n46  692.3 25.9 24\n47  686.5 14.7 70\n48  442.9 23.0 36\n51  706.4 20.8 17\n52  631.2 21.5 34\n53  654.1 20.4 42\n54  654.1 20.4 42\n55  661.3 17.6 45\n56  706.4 27.7 24\n57  730.2 17.8 63\n58  691.8 13.8 50\n63  466.6 18.8 35\n64  631.2 20.8 33\n65  638.8 23.1 31\n66  661.3 18.6 44\n67  668.0 23.0 37\n68  668.0 19.6 33\n69  668.0 19.6 33\n72  692.3 17.7 37\n74  614.5 17.3 43\n75  713.9 27.6 30\n79  529.8 14.7 66\n80  561.6 21.6 19\n81  601.4 19.5 39\n82  631.2 17.9 44\n83  647.1 18.6 51\n84  654.1 16.6 47\n85  661.3 20.2 45\n86  706.4 21.5 15\n87  706.4 25.4 27\n88  706.4 22.4 34\n89  728.6 25.3 36\n91  624.2 14.7 59\n93  488.0 20.8 32\n94  601.4 18.2 43\n95  638.8 23.4 22\n96  704.4 17.8 64\n100 601.4 19.8 39\n101 601.4 19.8 39\n102 614.5 14.4 66\n103 647.1 20.1 40\n104 674.4 24.1 29\n108 631.2 21.4 33\n109 698.6 20.3 45\n110 709.9 17.4 56\n113 704.4 22.8 39\n114 724.3 18.9 35\n120 466.6 19.6 36\n121 608.2 10.3 74\n122 608.2 17.1 43\n123 680.7 22.5 42\n124 671.9 17.9 45\n125 692.3 19.8 50\n126 691.8 20.6 24\n128 728.6 17.2 43\n129 673.8 15.9 46\n130 691.8 15.4 35\n134 685.2 17.6 42\n136 594.2 17.6 52\n137 680.7 17.2 58\n138 686.5 15.6 66\n140 692.6 21.7 38\n141 686.5 21.9 39\n142 513.3 23.3 31\n143 529.8 21.2 51\n145 513.3 23.8 32\n146 578.8 27.4 22\n148 671.9 24.2 28\n149 647.1 17.4 43\n150 685.2 23.7 25\n151 433.3 23.2 39\n153 424.1 24.6 43\n154 692.3 20.1 47\n155 721.4 29.6 27\n156 647.1 16.4 47\n157 721.4 28.6 27\n158 654.1 18.4 45\n159 654.1 20.5 35\n160 668.0 19.0 34\n162 578.8 20.3 41\n164 674.4 17.8 56\n165 704.4 17.8 67\n167 654.1 16.6 47\n168 570.5 23.4 33\n170 578.8 20.7 45\n171 699.6 21.9 35\n172 609.6 17.4 50\n173 601.4 20.1 39\n174 686.5 17.7 39\n175 624.2 14.2 53\n176 624.2 20.3 39\n178 631.2 19.2 44\n179 735.7 18.3 45\n180 614.5 14.4 66\n181 680.7 23.9 32\n182 664.2 19.1 32\n184 696.1 16.8 45\n185 586.7 20.8 34\n186 692.6 17.6 46\n188 686.5 21.0 42\n192 578.8 24.2 28\n193 647.1 24.6 22\n194 699.6 24.3 25\n195 647.1 24.6 22\n196 586.7 23.5 36\n198 706.4 21.5 15\n199 692.6 13.9 59\n200 665.3 22.6 38\n201 692.6 21.6 33\n204 673.8 20.2 37\n206 706.4 22.1 34\n207 594.2 22.9 31\n208 692.6 20.7 37\n209 668.0 19.6 33\n210 685.2 23.2 26\n211 686.9 18.4 25\n213 692.3 20.1 47\n217 680.7 16.9 60\n218 709.9 12.4 73\n219 699.6 19.4 19\n221 631.2 16.2 59\n222 713.9 18.6 49\n225 735.7 15.4 57\n226 728.6 22.9 39\n227 696.1 16.1 44\n228 480.8 20.1 34\n229 728.6 28.3 26\n230 480.8 16.4 43\n231 699.6 26.4 21\n232 728.6 27.8 27\n233 692.6 18.7 43\n234 671.9 24.3 36\n235 674.4 17.7 25\n236 601.4 19.6 41\n237 674.4 18.2 46\n238 692.6 18.8 40\n239 674.4 25.1 27\n243 589.9 15.4 66\n244 700.7 21.9 73\n245 700.7 22.4 54\n246 700.7 26.8 38\n247 700.7 25.7 39\n248 503.6 20.7 70\n249 666.7 28.7 28\n250 666.7 21.7 40\n251 666.7 26.8 25\n252 666.7 24.0 36\n253 666.7 22.1 37\n254 565.5 21.4 38\n255 621.7 18.9 41\n256 694.8 22.3 46\n257 581.1 23.9 41\n258 581.1 21.4 44\n259 692.3 20.6 59\n260 692.3 23.7 40\n261 542.0 28.3 32\n262 573.0 11.2 84\n263 573.0 21.4 42\n264 629.1 19.3 39\n265 684.4 21.8 53\n266 550.3 22.1 54\n267 607.1 19.4 55\n268 658.2 23.7 24\n269 658.2 21.0 32\n270 658.2 19.1 53\n271 658.2 21.8 56\n272 658.2 20.1 58\n273 658.2 20.2 47\n286 411.8 23.4 40\n288 474.9 22.1 49\n289 474.9 24.2 32\n290 474.9 24.3 30\n291 474.9 18.7 53\n292 474.9 25.3 39\n293 466.3 22.9 40\n294 430.8 26.9 28\n296 430.8 22.2 48\n306 714.3 19.0 52\n307 714.3 17.1 53\n308 714.3 23.8 35\n309 758.1 16.0 45\n310 758.1 24.9 27\n311 758.1 25.3 27\n312 758.1 24.8 28\n313 706.6 12.2 78\n314 777.1 24.3 27\n315 777.1 19.7 41\n316 817.5 18.5 30\n317 739.4 18.6 24\n318 739.4 19.2 24\n319 783.5 21.6 27\n320 783.5 21.6 28\n321 783.5 18.9 34\n322 783.5 16.8 28\n323 783.5 16.8 28\n324 822.8 12.9 39\n325 726.9 13.7 56\n326 751.5 24.2 27\n327 751.5 24.1 27\n328 751.5 21.2 32\n329 751.5 19.7 35\n330 751.5 23.5 27\n331 751.5 24.2 27\n332 795.3 21.5 28\n333 795.3 17.1 41\n334 721.1 18.1 54\n335 764.0 18.0 51\n336 764.0  9.8 86\n337 764.0 19.3 44\n338 764.0 23.0 34\n339 764.0 22.7 35\n340 764.0 20.4 41\n341 764.0 19.3 44\n342 770.3 15.7 51\n343 807.1 20.6 37\n344 807.1 15.9 51\n345 807.1 12.2 66\n346 807.1 16.8 43\n347 807.1 21.3 35\n348 745.3 10.1 75\n349 745.3 17.4 57\n350 745.3 12.8 64\n351 745.3 10.1 75\n352 745.3 15.4 53\n353 745.3 20.6 43\n354 745.3 19.8 47\n355 745.3 18.7 50\n356 745.3 20.8 35\n357 745.3 20.8 35\n358 789.7 15.9 55\n359 789.7 19.7 39\n360 789.7 21.1 39\n361 789.7 18.4 42\n362 789.7 17.3 45\n363 732.3 15.2 64\n364 770.3 15.9 53\n365 770.3 21.1 35\n366 770.3 19.6 45\n367 812.1 15.9 38\n368 812.1 16.4 27\n369 744.4 16.8 47\n370 825.1 13.8 77\n371 825.1 13.8 77\n372 520.5 14.2 58\n373 664.5 10.4 75\n374 698.6 20.3 42\n375 855.3 10.3 78\n376 744.4 15.4 57\n377 672.6 21.1 54\n378 715.1 21.9 42\n381 458.8 19.3 39\n382 643.0 16.2 63\n383 690.0 28.2 29\n384 753.8 20.5 58\n385 819.1 21.3 44\n386 613.0 20.9 50\n387 750.5 20.6 55\n389 706.7 23.3 34\n390 706.7 23.3 34\n392 738.1 20.7 46\n393 825.1 21.9 43\n397 750.5 20.4 55\n398 613.0 24.3 33\n399 715.1 25.9 32\n402 731.7 22.8 46\n403 706.7 25.0 36\n404 643.0 21.3 41\n405 725.1 21.8 34\n406 680.9 27.9 27\n407 860.6 17.0 67\n409 855.3 19.9 44\n410 450.2 23.4 31\n413 442.1 22.8 27\n414 715.1 26.4 33\n415 723.1 24.1 50\n416 698.6 27.5 27\n417 575.8 26.3 39\n419 664.5 24.9 42\n420 613.0 24.8 36\n421 635.9 26.2 36\n422 690.0 30.8 19\n423 795.9 29.3 27\n424 744.4 22.3 48\n425 715.1 26.9 31\n426 753.8 20.4 56\n427 753.8 20.4 56\n428 672.6 27.9 33\n429 698.6 26.2 34\n430 613.0 24.6 44\n431 849.3 19.4 45\n432 605.3 23.3 40\n433 698.6 23.9 38\n434 723.1 20.9 66\n435 811.2 22.2 45\n437 672.6 26.8 35\n438 768.4 14.2 73\n439 715.1 23.6 53\n440 738.1 19.1 46\n441 855.3 16.2 58\n442 672.6 25.5 29\n445 855.3 16.2 58\n447 664.5 19.1 70\n449 844.0 10.5 77\n450 613.0 19.3 61\n451 690.0 23.4 49\n452 649.9 11.8 88\n453 730.6 17.7 65\n454 803.3 17.4 54\n455 753.8 16.8 56\n456 567.2 17.9 48\n457 753.8 16.6 59\n458 635.9 19.9 50\n459 715.1 18.9 64\n460 819.1 15.5 72\n461 715.1 18.9 64\n462 715.1 18.9 64\n463 825.1 14.5 76\n477 395.0 27.2 28\n478 423.4 26.1 45\n480 431.6 22.6 57\n481 560.0 30.2 25\n482 560.0 30.2 22\n483 587.1 23.4 40\n484 587.1 31.0 27\n485 587.1 33.1 25\n486 596.3 30.6 28\n487 605.8 24.1 43\n488 605.8 26.4 34\n489 605.8 19.4 71\n490 605.8 20.6 58\n491 605.8 28.7 33\n492 624.1 32.4 21\n493 633.6 32.4 27\n494 633.6 27.5 29\n495 643.0 30.8 30\n496 661.8 23.9 42\n497 661.8 32.6 26\n498 671.2 32.3 27\n499 671.2 33.3 26\n501 671.2 21.6 65\n502 671.2 21.6 65\n503 671.2 20.7 69\n504 689.1 29.2 30\n505 689.1 28.9 29\n506 744.4 26.7 35\n507 752.6 18.5 73\n508 752.6 25.9 41\n509 752.6 25.9 41\n510 752.6 21.1 71\n511 752.6 18.2 62\n512 665.6 27.8 35\n513 665.6 27.8 32\n514 665.6 21.9 71\n515 665.6 21.2 70\n516 614.7 25.6 42\n```\n\n\n:::\n:::\n\n\n\nVisualitzem els resultats del test de normalitat univariant\n\n\n\n::: {.cell}\n\n```{.r .cell-code}\nsummary(mvnoutliers, select = \"mvn\")\n```\n\n::: {.cell-output .cell-output-stdout}\n\n```\n     Test Statistic p.value     Method          MVN\n1 Royston   162.918  <0.001 asymptotic ✗ Not normal\n```\n\n\n:::\n:::\n\n\n\ni multivariant\n\n\n\n::: {.cell}\n\n```{.r .cell-code}\nsummary(mvnoutliers, select = \"univariate\")\n```\n\n::: {.cell-output .cell-output-stdout}\n\n```\n              Test Variable Statistic p.value    Normality\n1 Anderson-Darling       DC    43.098  <0.001 ✗ Not normal\n2 Anderson-Darling     temp     1.812  <0.001 ✗ Not normal\n3 Anderson-Darling       RH     7.871  <0.001 ✗ Not normal\n```\n\n\n:::\n:::\n\n\n\n## PCA\n\nMétodes basats en correlacions ens permeten detectar outliers\n\n## Distancia de Mahalanobis\n\nMedeix la distancia de un punt respecte a la mitjana considerant la covariança\n\n\n\n::: {.cell}\n\n```{.r .cell-code}\ndistancia_mahalanobis <- mahalanobis(dades, colMeans(dades), cov(dades))\n```\n:::\n\n\n\nGrafiquem el plot de la densitat de les distancies\n\n\n\n::: {.cell}\n\n```{.r .cell-code}\nplot(density(distancia_mahalanobis))\n```\n\n::: {.cell-output-display}\n![](AdvancedPreprocessing_files/figure-html/plot_density_mahalanobis-1.png){width=672}\n:::\n:::\n\n\n\nEs mostren els valors de la bbdd que queden per sobre de el 99% de la distribució chi-cuadrat\n\n\n\n::: {.cell}\n\n```{.r .cell-code}\ncutoff <- qchisq(p = 0.99, df = ncol(dades))\ndades[distancia_mahalanobis>cutoff, ]\n```\n\n::: {.cell-output .cell-output-stdout}\n\n```\n       DC temp  RH\n4    77.5  8.3  97\n5   102.2 11.4  99\n212 594.2  5.1  96\n277 349.7  4.6  21\n278 349.7  4.6  21\n279 349.7  4.6  21\n280 349.7  4.6  21\n282 349.7  5.1  24\n305 113.8 11.3  94\n380 171.4  5.2 100\n446 100.7 17.3  80\n```\n\n\n:::\n:::\n\n\n\nOrdenamos de forma decreciente, según el score de Mahalanobis\n\n\n\n::: {.cell}\n\n```{.r .cell-code}\ndades <- dades[order(distancia_mahalanobis, decreasing = TRUE),]\n```\n:::\n\n\n\nVisualitzem l'histograma de les distancies per veure on tallem els outliers\n\n\n\n::: {.cell}\n\n```{.r .cell-code}\npar(mfrow=c(1,1))\nhist(distancia_mahalanobis)\n```\n\n::: {.cell-output-display}\n![](AdvancedPreprocessing_files/figure-html/plot_mahalanobis-1.png){width=672}\n:::\n:::\n\n\n\nDescartamos los outliers según un umbral\n\n\n\n::: {.cell}\n\n```{.r .cell-code}\numbral <- 8\ndades[, \"outlier\"] <- (distancia_mahalanobis > umbral)\n\ndades[, \"color\"] <- ifelse(dades[, \"outlier\"], \"red\", \"black\")\nscatterplot3d(dades[, \"DC\"], dades[, \"temp\"], dades[, \"RH\"], \n              color = dades[, \"color\"])\n```\n\n::: {.cell-output-display}\n![](AdvancedPreprocessing_files/figure-html/umbral_mahalanobis-1.png){width=672}\n:::\n\n```{.r .cell-code}\n(fig <- plotly::plot_ly(dades, x = ~DC, y = ~temp, z = ~RH, \n                       color = ~color, colors = c('#0C4B8E', '#BF382A')) %>% \n                        add_markers())\n```\n\n::: {.cell-output-display}\n\n```{=html}\n<div class=\"plotly html-widget html-fill-item\" id=\"htmlwidget-1d031261bad5dc9c85f6\" style=\"width:100%;height:464px;\"></div>\n<script type=\"application/json\" data-for=\"htmlwidget-1d031261bad5dc9c85f6\">{\"x\":{\"visdat\":{\"1ae860b4194f\":[\"function () \",\"plotlyVisDat\"]},\"cur_data\":\"1ae860b4194f\",\"attrs\":{\"1ae860b4194f\":{\"x\":{},\"y\":{},\"z\":{},\"color\":{},\"colors\":[\"#0C4B8E\",\"#BF382A\"],\"alpha_stroke\":1,\"sizes\":[10,100],\"spans\":[1,20],\"type\":\"scatter3d\",\"mode\":\"markers\",\"inherit\":true}},\"layout\":{\"margin\":{\"b\":40,\"l\":60,\"t\":25,\"r\":10},\"scene\":{\"xaxis\":{\"title\":\"DC\"},\"yaxis\":{\"title\":\"temp\"},\"zaxis\":{\"title\":\"RH\"}},\"hovermode\":\"closest\",\"showlegend\":true},\"source\":\"A\",\"config\":{\"modeBarButtonsToAdd\":[\"hoverclosest\",\"hovercompare\"],\"showSendToCloud\":false},\"data\":[{\"x\":[349.69999999999999,349.69999999999999,349.69999999999999,349.69999999999999,77.5,113.8,171.40000000000001,100.7,594.20000000000005,7.9000000000000004,233.80000000000001,352.60000000000002,16.199999999999999,423.39999999999998,9.3000000000000007,26.600000000000001,437.69999999999999,16.199999999999999,353.5,764,671.20000000000005,855.29999999999995,587.10000000000002,844,229,608.20000000000005,297.69999999999999,297.69999999999999,25.600000000000001,649.89999999999998,252.59999999999999,822.79999999999995,15.300000000000001,671.20000000000005,18.699999999999999,601.39999999999998,55,28.300000000000001,46.700000000000003,353.5,28.300000000000001,812.10000000000002,633.60000000000002,77.5,661.79999999999995,15.5,58.299999999999997,624.10000000000002,86.599999999999994,55.200000000000003,55.200000000000003,32.100000000000001,15.800000000000001,700.70000000000005,671.20000000000005,745.29999999999995,745.29999999999995,85.299999999999997,354.60000000000002,352,43.5,309.89999999999998,573,100.40000000000001,102.2,103.8,25.600000000000001,825.10000000000002,825.10000000000002,80.799999999999997,368.30000000000001,41.600000000000001,665.60000000000002,709.89999999999998,316.69999999999999,503.60000000000002,825.10000000000002,783.5,783.5,77.5,80.799999999999997,106.7,25.600000000000001,80.799999999999997,67.599999999999994,706.60000000000002,97.799999999999997,67.599999999999994,30.600000000000001,596.29999999999995,43.600000000000001,77.5,80.799999999999997,80.799999999999997,643,97.799999999999997,56.899999999999999,560,560,86.599999999999994,664.5,807.10000000000002,74.299999999999997,43.5,80.799999999999997,80.799999999999997,752.60000000000002,423.39999999999998,36.899999999999999,706.39999999999998,706.39999999999998,699.60000000000002,665.60000000000002,41.100000000000001,97.799999999999997,690,94.299999999999997,97.099999999999994,73.700000000000003,706.39999999999998,376.60000000000002,86.599999999999994,686.89999999999998,43,735.70000000000005,395,30.600000000000001,34,30.199999999999999,819.10000000000002,608.20000000000005,739.39999999999998,48.299999999999997,752.60000000000002,43,103.8,812.10000000000002,768.39999999999998,709.89999999999998,92.400000000000006,70.799999999999997,100.40000000000001,57.299999999999997,605.79999999999995,200,52.799999999999997,102.2,102.2,671.20000000000005,55,817.5,431.60000000000002,64.700000000000003,67.599999999999994,57.299999999999997,721.39999999999998,739.39999999999998,674.39999999999998,83.700000000000003,67.599999999999994,102.2,860.60000000000002,542,430.80000000000001,86.599999999999994,103.8,103.8,103.8,87.200000000000003,682.60000000000002,605.79999999999995,664.5,89.400000000000006,745.29999999999995,686.89999999999998,721.39999999999998,671.20000000000005,671.20000000000005,686.89999999999998,691.79999999999995,665.29999999999995,689.10000000000002,723.10000000000002,795.89999999999998,355.19999999999999,855.29999999999995,855.29999999999995,689.10000000000002,424.10000000000002,666.70000000000005,686.5,578.79999999999995,721.39999999999998,440.89999999999998,728.60000000000002,807.10000000000002,692.60000000000002,561.60000000000002,690,665.60000000000002,726.89999999999998,795.29999999999995,807.10000000000002,691.79999999999995,298.10000000000002,706.39999999999998,672.60000000000002,680.89999999999998,704.39999999999998,783.5,699.60000000000002,699.60000000000002,665.60000000000002,795.29999999999995,783.5,728.60000000000002,633.60000000000002,691.79999999999995,575.79999999999995,732.29999999999995,350.19999999999999,366.69999999999999,783.5,698.60000000000002,758.10000000000002,789.70000000000005,713.89999999999998,730.60000000000002,232.09999999999999,232.09999999999999,686.5,770.29999999999995,666.70000000000005,715.10000000000002,715.10000000000002,692.60000000000002,700.70000000000005,770.29999999999995,411.80000000000001,669.10000000000002,692.29999999999995,647.10000000000002,647.10000000000002,789.70000000000005,638.79999999999995,614.5,614.5,744.39999999999998,745.29999999999995,672.60000000000002,704.39999999999998,430.80000000000001,715.10000000000002,605.79999999999995,752.60000000000002,614.70000000000005,730.20000000000005,849.29999999999995,692.29999999999995,715.10000000000002,777.10000000000002,855.29999999999995,735.70000000000005,803.29999999999995,744.39999999999998,758.10000000000002,589.89999999999998,550.29999999999995,730.20000000000005,669.10000000000002,751.5,752.60000000000002,752.60000000000002,751.5,699.60000000000002,658.20000000000005,715.10000000000002,758.10000000000002,474.89999999999998,685.20000000000005,692.29999999999995,807.10000000000002,753.79999999999995,706.39999999999998,807.10000000000002,495.60000000000002,658.20000000000005,724.29999999999995,474.89999999999998,474.89999999999998,613,442.10000000000002,696.10000000000002,753.79999999999995,751.5,718.29999999999995,296.30000000000001,692.29999999999995,685.20000000000005,605.79999999999995,613,744.39999999999998,700.70000000000005,789.70000000000005,674.39999999999998,643,700.70000000000005,715.10000000000002,751.5,728.60000000000002,450.19999999999999,672.60000000000002,664.20000000000005,745.29999999999995,298.10000000000002,753.79999999999995,753.79999999999995,664.5,624.20000000000005,442.89999999999998,658.20000000000005,690,680.70000000000005,673.79999999999995,624.20000000000005,671.89999999999998,728.60000000000002,750.5,825.10000000000002,578.79999999999995,724.29999999999995,750.5,819.10000000000002,686.5,764,466.30000000000001,777.10000000000002,290.80000000000001,605.79999999999995,668,668,674.39999999999998,513.29999999999995,789.70000000000005,745.29999999999995,745.29999999999995,811.20000000000005,696.10000000000002,684.39999999999998,724.29999999999995,613,706.70000000000005,764,668,668,668,290.80000000000001,680.70000000000005,764,488,581.10000000000002,672.60000000000002,313.39999999999998,714.29999999999995,764,764,631.20000000000005,529.79999999999995,601.39999999999998,770.29999999999995,735.70000000000005,713,613,685.20000000000005,721.10000000000002,692.60000000000002,520.5,680.70000000000005,725.10000000000002,764,744.39999999999998,745.29999999999995,661.79999999999995,671.89999999999998,714.29999999999995,731.70000000000005,594.20000000000005,658.20000000000005,692.60000000000002,377.19999999999999,674.39999999999998,706.70000000000005,706.70000000000005,638.79999999999995,664.20000000000005,698.60000000000002,706.39999999999998,666.70000000000005,570.5,706.39999999999998,647.10000000000002,692.60000000000002,738.10000000000002,692.60000000000002,594.20000000000005,654.10000000000002,654.10000000000002,692.29999999999995,587.10000000000002,713.89999999999998,745.29999999999995,714.29999999999995,586.70000000000005,698.60000000000002,706.79999999999995,647.10000000000002,607.10000000000002,728.60000000000002,699.60000000000002,728.60000000000002,745.29999999999995,605.29999999999995,474.89999999999998,488,713.89999999999998,647.10000000000002,694.79999999999995,738.10000000000002,692.60000000000002,692.60000000000002,631.20000000000005,654.10000000000002,704.39999999999998,661.29999999999995,673.79999999999995,671.89999999999998,698.60000000000002,668,613,658.20000000000005,715.10000000000002,608.20000000000005,631.20000000000005,692.29999999999995,680.70000000000005,692.60000000000002,614.5,674.39999999999998,665.29999999999995,698.60000000000002,666.70000000000005,586.70000000000005,686.5,698.60000000000002,686.5,466.60000000000002,692.29999999999995,698.60000000000002,661.29999999999995,631.20000000000005,647.10000000000002,686.5,629.10000000000002,654.10000000000002,686.5,635.89999999999998,666.70000000000005,480.80000000000001,624.20000000000005,581.10000000000002,594.20000000000005,609.60000000000002,458.80000000000001,658.20000000000005,647.10000000000002,621.70000000000005,573,643,661.29999999999995,624.20000000000005,601.39999999999998,654.10000000000002,654.10000000000002,601.39999999999998,601.39999999999998,601.39999999999998,578.79999999999995,601.39999999999998,631.20000000000005,601.39999999999998,567.20000000000005,578.79999999999995,537.39999999999998],\"y\":[4.5999999999999996,4.5999999999999996,4.5999999999999996,5.0999999999999996,8.3000000000000007,11.300000000000001,5.2000000000000002,17.300000000000001,5.0999999999999996,13.4,10.6,2.2000000000000002,4.5999999999999996,18.199999999999999,5.2999999999999998,6.7000000000000002,12.6,5.0999999999999996,4.2000000000000002,9.8000000000000007,27.300000000000001,10.300000000000001,33.100000000000001,10.5,14.300000000000001,8,28,28,15.199999999999999,11.800000000000001,24.5,12.9,4.5999999999999996,33.299999999999997,8.8000000000000007,11.6,5.2999999999999998,8.9000000000000004,5.2999999999999998,4.7999999999999998,13.800000000000001,16.399999999999999,32.399999999999999,18.800000000000001,32.600000000000001,17.399999999999999,7.5,32.399999999999999,10.6,5.7999999999999998,5.7999999999999998,8.8000000000000007,7.5,21.899999999999999,32.299999999999997,10.1,10.1,16.699999999999999,5.0999999999999996,5.0999999999999996,13.300000000000001,13.4,11.199999999999999,15.1,5.5,8.3000000000000007,17.600000000000001,13.800000000000001,13.800000000000001,11.6,14.800000000000001,10.9,21.899999999999999,11.199999999999999,26.399999999999999,20.699999999999999,14.5,16.800000000000001,16.800000000000001,15.6,17.399999999999999,11.800000000000001,13.699999999999999,17.399999999999999,15.5,12.199999999999999,14.6,15.800000000000001,8.6999999999999993,30.600000000000001,8.1999999999999993,17.199999999999999,15.1,15.199999999999999,30.800000000000001,11.699999999999999,10.1,30.199999999999999,30.199999999999999,15.199999999999999,10.4,12.199999999999999,18.199999999999999,15.199999999999999,17,17,21.100000000000001,26.100000000000001,10.199999999999999,21.5,21.5,19.399999999999999,21.199999999999999,11.199999999999999,15.800000000000001,30.800000000000001,8.1999999999999993,9.3000000000000007,18,20.800000000000001,23.800000000000001,16.100000000000001,14.6,15.699999999999999,12.9,27.199999999999999,11.6,13.9,12.699999999999999,15.5,10.300000000000001,18.600000000000001,12.4,18.5,12.300000000000001,9,15.9,14.199999999999999,12.4,11.5,15.9,15.199999999999999,12.699999999999999,19.399999999999999,21,14.699999999999999,11.5,11.5,20.699999999999999,14.199999999999999,18.5,22.600000000000001,14,14.9,13.699999999999999,30.199999999999999,19.199999999999999,17.699999999999999,12.4,14.1,10.6,17,28.300000000000001,26.899999999999999,13.199999999999999,11,11,11,15.4,11.300000000000001,28.699999999999999,19.100000000000001,13.300000000000001,12.800000000000001,18.399999999999999,29.600000000000001,21.600000000000001,21.600000000000001,17.800000000000001,15.4,17,29.199999999999999,20.899999999999999,29.300000000000001,24.800000000000001,16.199999999999999,16.199999999999999,28.899999999999999,24.600000000000001,28.699999999999999,14.699999999999999,27.399999999999999,28.600000000000001,17.100000000000001,28.300000000000001,16.800000000000001,13.1,21.600000000000001,28.199999999999999,27.800000000000001,13.699999999999999,17.100000000000001,15.9,20.600000000000001,20.699999999999999,27.699999999999999,27.899999999999999,27.899999999999999,17.800000000000001,21.600000000000001,26.399999999999999,26.399999999999999,27.800000000000001,21.5,18.899999999999999,27.800000000000001,27.5,13.800000000000001,26.300000000000001,15.199999999999999,22.699999999999999,23.300000000000001,21.600000000000001,27.5,16,15.9,27.600000000000001,17.699999999999999,19.199999999999999,19.199999999999999,15.6,15.699999999999999,26.800000000000001,18.899999999999999,18.899999999999999,13.9,26.800000000000001,15.9,23.399999999999999,21.699999999999999,25.899999999999999,24.600000000000001,24.600000000000001,17.300000000000001,23.399999999999999,14.4,14.4,15.4,15.4,26.800000000000001,17.800000000000001,22.199999999999999,23.600000000000001,26.399999999999999,18.199999999999999,25.600000000000001,17.800000000000001,19.399999999999999,25.399999999999999,26.899999999999999,24.300000000000001,19.899999999999999,15.4,17.399999999999999,26.699999999999999,25.300000000000001,15.4,22.100000000000001,18.199999999999999,18,24.100000000000001,25.899999999999999,25.899999999999999,24.199999999999999,24.300000000000001,23.699999999999999,26.399999999999999,24.800000000000001,24.300000000000001,23.699999999999999,20.600000000000001,21.300000000000001,20.5,25.399999999999999,20.600000000000001,24.100000000000001,21.800000000000001,18.899999999999999,22.100000000000001,24.199999999999999,19.300000000000001,22.800000000000001,16.100000000000001,16.800000000000001,19.699999999999999,17.699999999999999,16.600000000000001,17.699999999999999,23.199999999999999,20.600000000000001,24.600000000000001,16.800000000000001,22.399999999999999,19.699999999999999,25.100000000000001,16.199999999999999,25.699999999999999,25.899999999999999,21.199999999999999,17.199999999999999,23.399999999999999,25.5,19.100000000000001,17.399999999999999,19.100000000000001,20.399999999999999,20.399999999999999,24.899999999999999,14.199999999999999,23,20.100000000000001,23.399999999999999,16.899999999999999,15.9,14.699999999999999,24.199999999999999,25.300000000000001,20.600000000000001,21.899999999999999,24.199999999999999,21.199999999999999,20.399999999999999,21.300000000000001,17.699999999999999,18,22.899999999999999,19.699999999999999,14.300000000000001,24.100000000000001,19,19,24.100000000000001,23.800000000000001,21.100000000000001,20.800000000000001,20.800000000000001,22.199999999999999,16.800000000000001,21.800000000000001,19.100000000000001,24.800000000000001,25,23,19.600000000000001,19.600000000000001,19.600000000000001,15.4,17.199999999999999,22.699999999999999,22.199999999999999,23.899999999999999,21.100000000000001,18,17.100000000000001,19.300000000000001,19.300000000000001,16.199999999999999,21.199999999999999,16.300000000000001,19.600000000000001,18.300000000000001,19.300000000000001,24.300000000000001,17.600000000000001,18.100000000000001,18.300000000000001,14.199999999999999,23.899999999999999,21.800000000000001,20.399999999999999,22.300000000000001,18.699999999999999,23.899999999999999,24.300000000000001,23.800000000000001,22.800000000000001,23.699999999999999,21,21.600000000000001,19.600000000000001,17.800000000000001,23.300000000000001,23.300000000000001,23.100000000000001,16.699999999999999,23.899999999999999,22.100000000000001,24,23.399999999999999,22.399999999999999,16.399999999999999,18.800000000000001,19.100000000000001,17.600000000000001,22.899999999999999,16.600000000000001,16.600000000000001,23.699999999999999,23.399999999999999,22.899999999999999,19.800000000000001,19,23.5,17.800000000000001,20.600000000000001,16.600000000000001,19.399999999999999,22.899999999999999,21.899999999999999,22.800000000000001,20.600000000000001,23.300000000000001,18.699999999999999,20.800000000000001,18.600000000000001,17.399999999999999,22.300000000000001,20.699999999999999,20.699999999999999,18.699999999999999,21.399999999999999,20.5,22.800000000000001,17.600000000000001,20.199999999999999,17.899999999999999,22.800000000000001,23,20.899999999999999,19.100000000000001,21.899999999999999,17.100000000000001,21.5,19.800000000000001,22.5,21.699999999999999,17.300000000000001,18.199999999999999,22.600000000000001,19.600000000000001,22.100000000000001,20.800000000000001,21.899999999999999,20.300000000000001,19.399999999999999,19.600000000000001,20.100000000000001,20.300000000000001,18.600000000000001,17.899999999999999,18.600000000000001,21.300000000000001,19.300000000000001,18.399999999999999,21,19.899999999999999,21.699999999999999,16.399999999999999,18.399999999999999,21.399999999999999,17.600000000000001,17.399999999999999,19.300000000000001,20.199999999999999,20.100000000000001,18.899999999999999,21.399999999999999,21.300000000000001,20.199999999999999,20.300000000000001,19.5,20.399999999999999,20.399999999999999,18.199999999999999,19.800000000000001,19.800000000000001,20.699999999999999,20.100000000000001,19.199999999999999,19.600000000000001,17.899999999999999,20.300000000000001,19.5],\"z\":[21,21,21,24,97,94,100,80,96,75,90,59,82,82,78,79,90,77,51,86,63,78,25,77,79,86,34,34,19,88,50,39,59,26,35,87,70,35,68,57,24,27,27,18,26,24,71,21,30,54,54,68,46,73,27,75,75,20,61,61,27,79,84,64,59,72,27,77,77,30,78,64,71,78,35,70,76,28,28,25,24,31,33,25,27,78,26,27,51,28,53,26,27,27,30,33,62,25,22,27,75,66,29,51,27,27,71,45,45,15,15,19,70,41,27,19,51,44,40,17,51,29,33,43,74,28,48,40,48,72,74,24,53,73,51,49,38,73,73,60,35,31,52,71,44,42,39,39,69,46,30,57,39,38,43,24,24,25,54,43,46,67,32,28,40,46,46,46,40,60,33,70,42,64,25,27,65,65,27,35,72,30,66,27,29,58,58,29,43,28,70,22,27,67,26,43,63,19,29,35,56,41,51,24,25,24,33,27,67,27,21,21,32,28,34,27,29,50,39,64,40,37,28,27,45,55,30,65,38,38,66,51,25,64,64,59,38,53,40,24,24,22,22,45,22,66,66,57,53,35,64,48,53,34,62,42,63,45,24,31,27,44,57,54,35,27,66,54,62,33,27,41,41,27,25,24,33,28,30,25,59,35,58,27,37,27,56,35,49,32,61,27,44,56,35,39,53,37,26,58,44,47,54,39,27,63,39,32,32,43,31,29,32,57,39,56,56,42,53,36,58,49,60,46,59,28,36,55,43,28,32,55,44,39,51,40,41,46,43,34,34,29,32,39,35,35,45,45,53,38,36,36,34,33,33,33,45,58,35,29,41,54,42,53,44,44,59,51,60,45,45,38,33,42,54,40,58,32,34,41,48,50,42,36,35,46,32,32,33,43,56,34,34,31,47,38,34,36,33,34,47,40,46,46,31,47,47,40,40,44,47,52,36,51,37,54,55,39,35,39,43,40,53,32,49,43,46,46,37,43,33,35,39,45,37,45,40,37,50,53,42,43,34,50,42,38,43,46,38,48,37,34,39,42,48,36,47,45,44,44,51,42,39,45,42,50,40,43,42,44,52,50,39,47,40,41,42,41,45,39,39,42,42,43,39,39,45,39,44,41,48,41,43],\"type\":\"scatter3d\",\"mode\":\"markers\",\"name\":\"black\",\"marker\":{\"color\":\"rgba(12,75,142,1)\",\"line\":{\"color\":\"rgba(12,75,142,1)\"}},\"textfont\":{\"color\":\"rgba(12,75,142,1)\"},\"error_y\":{\"color\":\"rgba(12,75,142,1)\"},\"error_x\":{\"color\":\"rgba(12,75,142,1)\"},\"line\":{\"color\":\"rgba(12,75,142,1)\"},\"frame\":null},{\"x\":[349.69999999999999,102.2,587.10000000000002,64.700000000000003,474.89999999999998,715.10000000000002,758.10000000000002,753.79999999999995,529.79999999999995,751.5,635.89999999999998,723.10000000000002,789.70000000000005,751.5,433.30000000000001,698.60000000000002,770.29999999999995,709.89999999999998,513.29999999999995,631.20000000000005,466.60000000000002,480.80000000000001,692.29999999999995,565.5],\"y\":[4.5999999999999996,11.4,31,11.800000000000001,25.300000000000001,18.899999999999999,24.899999999999999,16.600000000000001,14.699999999999999,23.5,26.199999999999999,24.100000000000001,18.399999999999999,24.199999999999999,23.199999999999999,26.199999999999999,21.100000000000001,17.399999999999999,23.300000000000001,20.800000000000001,18.800000000000001,20.100000000000001,20.100000000000001,21.399999999999999],\"z\":[21,99,27,35,39,64,27,59,66,27,36,50,42,27,39,34,35,56,31,33,35,34,47,38],\"type\":\"scatter3d\",\"mode\":\"markers\",\"name\":\"red\",\"marker\":{\"color\":\"rgba(191,56,42,1)\",\"line\":{\"color\":\"rgba(191,56,42,1)\"}},\"textfont\":{\"color\":\"rgba(191,56,42,1)\"},\"error_y\":{\"color\":\"rgba(191,56,42,1)\"},\"error_x\":{\"color\":\"rgba(191,56,42,1)\"},\"line\":{\"color\":\"rgba(191,56,42,1)\"},\"frame\":null}],\"highlight\":{\"on\":\"plotly_click\",\"persistent\":false,\"dynamic\":false,\"selectize\":false,\"opacityDim\":0.20000000000000001,\"selected\":{\"opacity\":1},\"debounce\":0},\"shinyEvents\":[\"plotly_hover\",\"plotly_click\",\"plotly_selected\",\"plotly_relayout\",\"plotly_brushed\",\"plotly_brushing\",\"plotly_clickannotation\",\"plotly_doubleclick\",\"plotly_deselect\",\"plotly_afterplot\",\"plotly_sunburstclick\"],\"base_url\":\"https://plot.ly\"},\"evals\":[],\"jsHooks\":[]}</script>\n```\n\n:::\n\n```{.r .cell-code}\n(quienes <- which(dades[, \"outlier\"] == TRUE))\n```\n\n::: {.cell-output .cell-output-stdout}\n\n```\n [1]   4   5  76 105 212 240 277 278 279 280 281 282 283 287 300 305 336 375 380\n[20] 446 464 465 479 500\n```\n\n\n:::\n:::\n\n\n\n### Mahalanobis Robusto\n\n\n\n::: {.cell}\n\n```{.r .cell-code}\nlibrary(chemometrics)\n\ndis <- chemometrics::Moutlier(dades[, c(\"DC\", \"temp\", \"RH\")], quantile = 0.99, plot = TRUE)\n```\n\n::: {.cell-output-display}\n![](AdvancedPreprocessing_files/figure-html/mahalanobis_robusto-1.png){width=672}\n:::\n\n```{.r .cell-code}\npar(mfrow = c(1, 1))\nplot(dis$md, dis$rd, type = \"n\")\ntext(dis$md, dis$rd, labels = rownames(dades))\n```\n\n::: {.cell-output-display}\n![](AdvancedPreprocessing_files/figure-html/mahalanobis_robusto-2.png){width=672}\n:::\n\n```{.r .cell-code}\na <- which(dis$rd > 7)\nprint(a)\n```\n\n::: {.cell-output .cell-output-stdout}\n\n```\n277 278 279 280   5 282   4 305 380 446 240 464 105  76 465 394 466 284 166 448 \n  1   2   3   4   5   6   7   8   9  10  12  15  17  18  20  31  35  37  39  40 \n395 418 112  98 391 119 177 197 203 285 242 469 205  62  78 471 117 443  73  92 \n 41  43  46  48  49  51  52  53  54  55  60  63  66  67  68  69  72  74  83  84 \n517 470  90 116 169 115 379 412  70  17 118 191 396 220  49 107 241 215 216 467 \n 85  86  87  88  90  91  92  94  95  96  97  99 100 103 105 107 108 109 110 113 \n468  71   1  20 472 161  77 388  59  97 183  60 127 190  19 163 106 411  61 187 \n118 119 121 122 123 126 128 131 132 133 137 139 140 144 145 146 147 150 151 152 \n408 132 135 111 202  40 133 147  50 214 223 131 189 \n154 157 158 159 163 164 165 169 170 171 172 173 177 \n```\n\n\n:::\n:::\n\n\n\n## Regresió Lineal i residus\n\nUn punt amb un residu gran pot considerar-se un outlier\n\n## Distancia de Cook\n\nIdentifica punts amb gran influència en la regresió. Un valor de Cook D_i \\> 1 és un outliers.\n\n## K-Nearest Neighbors (KNN) Outlier Score\n\nBasats en la densitat local de les dades\n\n\n\n::: {.cell}\n\n```{.r .cell-code}\nlibrary(adamethods)\n\ndo_knno(dades[, c(\"DC\", \"temp\", \"RH\")], k=1, top_n = 30)\n```\n\n::: {.cell-output .cell-output-stdout}\n\n```\n [1]   9 149  64  65   7  33  73  79 130  32  16  19 274 167 198  22 142  63 106\n[20]  35  11 273 245 227   5   8  13  27  10 279\n```\n\n\n:::\n:::\n\n\n\n## Local Outlier Factor (LOF)\n\nCompara la densidat de un punt amb la densidat dels seus veïns. Un valor LOF alt\n\n\n\n::: {.cell}\n\n```{.r .cell-code}\nlibrary(DMwR2)\nlibrary(dplyr)\n\noutlier.scores <- lofactor(dades[, c(\"DC\", \"temp\", \"RH\")], k = 5)\npar(mfrow=c(1,1))\nplot(density(outlier.scores))\noutlier.scores\noutliers <- order(outlier.scores, decreasing=T)\noutliers <- order(outlier.scores, decreasing=T)[1:5]\n```\n:::\n\n\n\nAprofitarem el ACP per poder visualizar els outliers\n\n\n\n::: {.cell}\n\n```{.r .cell-code}\nn <- nrow(dades[, c(\"DC\", \"temp\", \"RH\")]); labels <- 1:n; labels[-outliers] <- \".\"\nbiplot(prcomp(dades[, c(\"DC\", \"temp\", \"RH\")]), cex = .8, xlabs = labels)\n```\n:::\n\n\n\nGrafiquem les correlacions per veure els gráfics\n\n\n\n::: {.cell}\n\n```{.r .cell-code}\npch <- rep(\".\", n)\npch[outliers] <- \"+\"\ncol <- rep(\"black\", n)\ncol[outliers] <- \"red\"\npairs(dades[, c(\"DC\", \"temp\", \"RH\")], pch = pch, col = col)\n```\n:::\n\n\n\nHo visualitzem en 3D\n\n\n\n::: {.cell}\n\n```{.r .cell-code}\nplot3d(dades[, \"DC\"], dades[, \"temp\"], dades[, \"RH\"], type = \"s\", col = col, size = 1)\n```\n:::\n\n\n\n### Nueva versión de LOF\n\n\n\n::: {.cell}\n\n```{.r .cell-code}\nlibrary(Rlof)\noutliers.scores <- Rlof::lof(dades[, c(\"DC\", \"temp\", \"RH\")], k = 5)\nplot(density(outliers.scores))\n```\n\n::: {.cell-output-display}\n![](AdvancedPreprocessing_files/figure-html/lof2-1.png){width=672}\n:::\n\n```{.r .cell-code}\n#outlier.scores <- lof(dades[, c(\"DC\", \"temp\", \"RH\")], k=c(5:10))\n```\n:::\n\n\n\n## Isolation Forest\n\n\n\n::: {.cell}\n\n```{.r .cell-code}\n### Cargamos las librerias necesarias\nlibrary(R.matlab)   # Lectura de archivos .mat\nlibrary(solitude)   # Modelo isolation forest\nlibrary(tidyverse)  # Preparación de datos y gráficos\nlibrary(MLmetrics)\n\n# Carreguem les dades\ncardio_mat  <- readMat(\"https://www.dropbox.com/s/galg3ihvxklf0qi/cardio.mat?dl=1\")\ndf_cardio   <- as.data.frame(cardio_mat$X)\ndf_cardio$y <- as.character(cardio_mat$y)\ndatos <- df_cardio\n```\n:::\n\n::: {.cell}\n\n```{.r .cell-code}\nisoforest <- isolationForest$new(\n  sample_size = as.integer(nrow(datos)/2),\n  num_trees   = 500, \n  replace     = TRUE,\n  seed        = 123\n)\nisoforest$fit(dataset = datos %>% select(-y))\n```\n:::\n\n\n\nAra anem a realitzar les prediccions.\n\n\n\n::: {.cell}\n\n```{.r .cell-code}\npredicciones <- isoforest$predict(\n  data = datos %>% select(-y)\n)\nhead(predicciones)\n```\n\n::: {.cell-output .cell-output-stdout}\n\n```\n      id average_depth anomaly_score\n   <int>         <num>         <num>\n1:     1         9.816     0.5875006\n2:     2         9.738     0.5899888\n3:     3         9.528     0.5967405\n4:     4         9.728     0.5903086\n5:     5         9.860     0.5861016\n6:     6         9.796     0.5881376\n```\n\n\n:::\n:::\n\n::: {.cell}\n\n```{.r .cell-code}\nggplot(data = predicciones, aes(x = average_depth)) +\n  geom_histogram(color = \"gray40\") +\n  geom_vline(\n    xintercept = quantile(predicciones$average_depth, seq(0, 1, 0.1)),\n    color      = \"red\",\n    linetype   = \"dashed\") +\n  labs(\n    title = \"Distribución de las distancias medias del Isolation Forest\",\n    subtitle = \"Cuantiles marcados en rojo\"  ) +\n  theme_bw() +\n  theme(plot.title = element_text(size = 11))\n```\n\n::: {.cell-output-display}\n![](AdvancedPreprocessing_files/figure-html/plot_isolationForest-1.png){width=672}\n:::\n\n```{.r .cell-code}\ncuantiles <- quantile(x = predicciones$average_depth, probs = seq(0, 1, 0.05))\ncuantiles\n```\n\n::: {.cell-output .cell-output-stdout}\n\n```\n   0%    5%   10%   15%   20%   25%   30%   35%   40%   45%   50%   55%   60% \n7.556 8.952 9.264 9.451 9.548 9.629 9.694 9.744 9.790 9.824 9.852 9.870 9.888 \n  65%   70%   75%   80%   85%   90%   95%  100% \n9.904 9.920 9.934 9.948 9.958 9.970 9.980 9.998 \n```\n\n\n:::\n:::\n\n\n\n## TIPS: Detección de anomalías\n\nUna vez que la distancia de separación ha sido calculado, se puede emplear como criterio para identificar anomalías. Asumiendo que las observaciones con valores atípicos en una o más de sus variables se separan del resto con mayor facilidad, aquellas observaciones con menor distancia promedio deberían ser las más atípicas.\n\nEn la práctica, si se está empleando esta estrategia de detección es porque no se dispone de datos etiquetados, es decir, no se conoce qué observaciones son realmente anomalías. Sin embargo, como en este ejemplo se dispone de la clasificación real, se puede verificar si realmente los datos anómalos tienen menores distancias.\n\n\n\n::: {.cell}\n\n```{.r .cell-code}\ndatos <- datos %>%\n  bind_cols(predicciones)\n\nggplot(data = datos,\n       aes(x = y, y = average_depth)) +\n  geom_jitter(aes(color = y), width = 0.03, alpha = 0.3) + \n  geom_violin(alpha = 0) +\n  geom_boxplot(width = 0.2, outlier.shape = NA, alpha = 0) +\n  stat_summary(fun = \"mean\", colour = \"orangered2\", size = 3, geom = \"point\") +\n  labs(title = \"Distancia promedio en el modelo Isolation Forest\",\n       x = \"clasificación (0 = normal, 1 = anomalía)\",\n       y = \"Distancia promedio\") +\n  theme_bw() + \n  theme(legend.position = \"none\",\n        plot.title = element_text(size = 11)\n  )\n```\n\n::: {.cell-output-display}\n![](AdvancedPreprocessing_files/figure-html/plot_deteccionAnomalias-1.png){width=672}\n:::\n:::\n\n\n\nLa distancia promedio en el grupo de las anomalías (1) es claramente inferior. Sin embargo, al existir solapamiento, si se clasifican las n observaciones con menor distancia como anomalías, se incurriría en errores de falsos positivos.\n\nAcorde a la documentación, el set de datos Cardiotocogrpahy contiene 176 anomalías. Véase la matriz de confusión resultante si se clasifican como anomalías las 176 observaciones con menor distancia predicha.\n\n\n\n::: {.cell}\n\n```{.r .cell-code}\nresultados <- datos %>%\n  select(y, average_depth) %>%\n  arrange(average_depth) %>%\n  mutate(clasificacion = if_else(average_depth <= 8.5, \"1\", \"0\"))\n\nmat_confusion <- MLmetrics::ConfusionMatrix(\n  y_pred = resultados$clasificacion,\n  y_true = resultados$y)\n\nmat_confusion\n```\n\n::: {.cell-output .cell-output-stdout}\n\n```\n      y_pred\ny_true    0    1\n     0 1638   17\n     1  158   18\n```\n\n\n:::\n:::\n\n\n\n# Imputation Methods\n\n## Generate data with NA's\n\n\n\n::: {.cell}\n\n```{.r .cell-code}\ncolSums(is.na(iris))\n```\n\n::: {.cell-output .cell-output-stdout}\n\n```\nSepal.Length  Sepal.Width Petal.Length  Petal.Width      Species \n           0            0            0            0            0 \n```\n\n\n:::\n\n```{.r .cell-code}\niris.mis <- missForest::prodNA(iris, noNA = 0.1)\ncolSums((is.na(iris.mis)))\n```\n\n::: {.cell-output .cell-output-stdout}\n\n```\nSepal.Length  Sepal.Width Petal.Length  Petal.Width      Species \n          12           15           16           16           16 \n```\n\n\n:::\n:::\n\n\n\nOtra forma de crear missings en el dataframe\n\n\n\n::: {.cell}\n\n```{.r .cell-code}\niris.mis <- mi::create.missing(iris, pct.mis = 10)\n```\n:::\n\n\n\n## Little Test\n\nEs un test que nos permite detectar con que tipo de NA's estamos enfrente:\n\n\n\n::: {.cell}\n\n```{.r .cell-code}\nnaniar::mcar_test(iris.mis)\n```\n:::\n\n\n\nSi el valor p de la prova és inferior a 0 això vol dir que les dades amb NAs s'han generat aleatòriament.\n\n## Patrons descriptius de NA en una base de dades\n\n### Explorar les relacions de NA's\n\n\n\n::: {.cell}\n\n```{.r .cell-code}\nlibrary(visdat)\nlibrary(ggplot2)\nlibrary(naniar)\n\nvis_dat(airquality);\n```\n\n::: {.cell-output-display}\n![](AdvancedPreprocessing_files/figure-html/vis_na_total-1.png){width=672}\n:::\n\n```{.r .cell-code}\nvis_dat(iris.mis)\n```\n\n::: {.cell-output-display}\n![](AdvancedPreprocessing_files/figure-html/vis_na_total-2.png){width=672}\n:::\n\n```{.r .cell-code}\nvis_miss(airquality);\n```\n\n::: {.cell-output-display}\n![](AdvancedPreprocessing_files/figure-html/vis_na_total-3.png){width=672}\n:::\n\n```{.r .cell-code}\nvis_miss(iris.mis)\n```\n\n::: {.cell-output-display}\n![](AdvancedPreprocessing_files/figure-html/vis_na_total-4.png){width=672}\n:::\n\n```{.r .cell-code}\nggplot(airquality, aes(x = Solar.R,y = Ozone)) + \n  geom_point()\n```\n\n::: {.cell-output-display}\n![](AdvancedPreprocessing_files/figure-html/vis_na_total-5.png){width=672}\n:::\n\n```{.r .cell-code}\nggplot(airquality, aes(x = Solar.R,  y = Ozone)) + \n  geom_miss_point()\n```\n\n::: {.cell-output-display}\n![](AdvancedPreprocessing_files/figure-html/vis_na_total-6.png){width=672}\n:::\n\n```{.r .cell-code}\nggplot(airquality, aes(x = Solar.R, y = Ozone)) + \n  geom_miss_point() + \n  facet_wrap(~Month)\n```\n\n::: {.cell-output-display}\n![](AdvancedPreprocessing_files/figure-html/vis_na_total-7.png){width=672}\n:::\n\n```{.r .cell-code}\nggplot(airquality, aes(x = Solar.R, y = Ozone)) + \n  geom_miss_point() + \n  facet_wrap(~Month) + \n  theme_dark()\n```\n\n::: {.cell-output-display}\n![](AdvancedPreprocessing_files/figure-html/vis_na_total-8.png){width=672}\n:::\n:::\n\n\n\n### Visualització dels NA's per variables\n\n\n\n::: {.cell}\n\n```{.r .cell-code}\ngg_miss_var(airquality) + labs(y = \"Look at all the missing ones\")\n```\n\n::: {.cell-output-display}\n![](AdvancedPreprocessing_files/figure-html/vis_na_variables-1.png){width=672}\n:::\n:::\n\n\n\n### Detecció de NA's en la base de dades\n\n\n\n::: {.cell}\n\n```{.r .cell-code}\naq_shadow <- bind_shadow(airquality)\n```\n:::\n\n\n\nImprimeix el gràfic amb diferència a les NA i no a les NA,\n\n\n\n::: {.cell}\n\n```{.r .cell-code}\nairquality %>%\n  bind_shadow() %>%\n  group_by(Ozone_NA) %>%\n  summarise_at(.vars = \"Solar.R\",\n               .funs = c(\"mean\", \"sd\", \"var\", \"min\", \"max\"),\n               na.rm = TRUE)\n```\n\n::: {.cell-output .cell-output-stdout}\n\n```\n# A tibble: 2 × 6\n  Ozone_NA  mean    sd   var   min   max\n  <fct>    <dbl> <dbl> <dbl> <int> <int>\n1 !NA       185.  91.2 8309.     7   334\n2 NA        190.  87.7 7690.    31   332\n```\n\n\n:::\n\n```{.r .cell-code}\nggplot(aq_shadow,\n       aes(x = Temp,\n           colour = Ozone_NA)) + \n  geom_density()\n```\n\n::: {.cell-output-display}\n![](AdvancedPreprocessing_files/figure-html/grafico_detec_na-1.png){width=672}\n:::\n:::\n\n\n\n### Extreu estadístiques amb NAs de la base de dades\n\n\n\n::: {.cell}\n\n```{.r .cell-code}\nprop_miss_case(airquality)\n```\n\n::: {.cell-output .cell-output-stdout}\n\n```\n[1] 0.2745098\n```\n\n\n:::\n\n```{.r .cell-code}\npct_miss_case(airquality)\n```\n\n::: {.cell-output .cell-output-stdout}\n\n```\n[1] 27.45098\n```\n\n\n:::\n\n```{.r .cell-code}\nmiss_case_summary(airquality)\n```\n\n::: {.cell-output .cell-output-stdout}\n\n```\n# A tibble: 153 × 3\n    case n_miss pct_miss\n   <int>  <int>    <dbl>\n 1     5      2     33.3\n 2    27      2     33.3\n 3     6      1     16.7\n 4    10      1     16.7\n 5    11      1     16.7\n 6    25      1     16.7\n 7    26      1     16.7\n 8    32      1     16.7\n 9    33      1     16.7\n10    34      1     16.7\n# ℹ 143 more rows\n```\n\n\n:::\n\n```{.r .cell-code}\nmiss_case_table(airquality)\n```\n\n::: {.cell-output .cell-output-stdout}\n\n```\n# A tibble: 3 × 3\n  n_miss_in_case n_cases pct_cases\n           <int>   <int>     <dbl>\n1              0     111     72.5 \n2              1      40     26.1 \n3              2       2      1.31\n```\n\n\n:::\n\n```{.r .cell-code}\nprop_miss_var(airquality)\n```\n\n::: {.cell-output .cell-output-stdout}\n\n```\n[1] 0.3333333\n```\n\n\n:::\n\n```{.r .cell-code}\npct_miss_var(airquality)\n```\n\n::: {.cell-output .cell-output-stdout}\n\n```\n[1] 33.33333\n```\n\n\n:::\n\n```{.r .cell-code}\nmiss_var_summary(airquality)\n```\n\n::: {.cell-output .cell-output-stdout}\n\n```\n# A tibble: 6 × 3\n  variable n_miss pct_miss\n  <chr>     <int>    <num>\n1 Ozone        37    24.2 \n2 Solar.R       7     4.58\n3 Wind          0     0   \n4 Temp          0     0   \n5 Month         0     0   \n6 Day           0     0   \n```\n\n\n:::\n\n```{.r .cell-code}\nmiss_var_table(airquality)\n```\n\n::: {.cell-output .cell-output-stdout}\n\n```\n# A tibble: 3 × 3\n  n_miss_in_var n_vars pct_vars\n          <int>  <int>    <dbl>\n1             0      4     66.7\n2             7      1     16.7\n3            37      1     16.7\n```\n\n\n:::\n:::\n\n\n\n## Imputació bàsica\n\n### Imputar amb valor mitjà\n\n\n\n::: {.cell}\n\n```{.r .cell-code}\niris.mis[, \"imputed_Sepal.Length\"] <- with(iris.mis, Hmisc::impute(Sepal.Length, mean))\n```\n:::\n\n\n\n# Imputar amb valor aleatori\n\n\n\n::: {.cell}\n\n```{.r .cell-code}\niris.mis[, \"imputed_Sepal.Length2\"] <- with(iris.mis, Hmisc::impute(Sepal.Length, 'random'))\n```\n:::\n\n\n\nDe manera similar podeu utilitzar la mediana min, max, per imputar el valor que manca.\n\n### Representa la distribució a variables reals i d'imputació a través del gráfico de densidad con ggplot2\n\n\n\n::: {.cell}\n\n```{.r .cell-code}\ndf_long <- iris.mis %>%\n  select(Sepal.Length, imputed_Sepal.Length, imputed_Sepal.Length2) %>%\n  pivot_longer(cols = everything(), names_to = \"Variable\", values_to = \"Valor\")\n\nggplot(df_long, aes(x = Valor, fill = Variable)) +\n  geom_density(alpha = 0.3) +  # Transparencia para mejor visualización\n  labs(title = \"Densidad de las tres variables\",\n       x = \"Valor\",\n       y = \"Densidad\") +\n  theme_minimal() +\n  scale_fill_manual(values = c(\"blue\", \"red\", \"green\"))\n```\n\n::: {.cell-output-display}\n![](AdvancedPreprocessing_files/figure-html/grafico_imputacion-1.png){width=672}\n:::\n\n```{.r .cell-code}\niris.mis[, c(\"imputed_Sepal.Length\", \"imputed_Sepal.Length2\")] <- NULL\n```\n:::\n\n\n\nOtra forma es usando el paquete `argImpute`.\n\n\n\n::: {.cell}\n\n```{.r .cell-code}\n(impute_arg <- Hmisc::aregImpute(~ Sepal.Length + Sepal.Width + Petal.Length + Petal.Width +\n                           Species, data = iris.mis, n.impute = 5))\n```\n\n::: {.cell-output .cell-output-stdout}\n\n```\nIteration 1 \nIteration 2 \nIteration 3 \nIteration 4 \nIteration 5 \nIteration 6 \nIteration 7 \nIteration 8 \n```\n\n\n:::\n\n::: {.cell-output .cell-output-stdout}\n\n```\n\nMultiple Imputation using Bootstrap and PMM\n\nHmisc::aregImpute(formula = ~Sepal.Length + Sepal.Width + Petal.Length + \n    Petal.Width + Species, data = iris.mis, n.impute = 5)\n\nn: 150 \tp: 5 \tImputations: 5  \tnk: 3 \n\nNumber of NAs:\nSepal.Length  Sepal.Width Petal.Length  Petal.Width      Species \n          12           15           16           16           16 \n\n             type d.f.\nSepal.Length    s    2\nSepal.Width     s    2\nPetal.Length    s    2\nPetal.Width     s    2\nSpecies         c    2\n\nTransformation of Target Variables Forced to be Linear\n\nR-squares for Predicting Non-Missing Values for Each Variable\nUsing Last Imputations of Predictors\nSepal.Length  Sepal.Width Petal.Length  Petal.Width      Species \n       0.825        0.632        0.982        0.974        0.990 \n```\n\n\n:::\n:::\n\n\n\nRevisamos la variable `Sepal.Length` con la imputación realizada en cada una de las rondas.\n\n\n\n::: {.cell}\n\n```{.r .cell-code}\nimpute_arg$imputed$Sepal.Length\n```\n\n::: {.cell-output .cell-output-stdout}\n\n```\n    [,1] [,2] [,3] [,4] [,5]\n6    5.8  5.1  4.6  5.1  5.0\n52   5.8  6.1  6.0  6.7  6.5\n61   5.1  5.1  5.7  5.0  5.4\n62   6.0  5.6  6.3  5.8  6.3\n74   6.7  5.6  5.8  6.4  5.6\n81   5.2  6.0  5.5  5.1  5.2\n116  6.1  6.1  6.0  6.3  6.3\n118  5.1  5.1  7.7  7.7  7.7\n132  7.6  7.6  7.2  7.7  7.3\n133  6.0  6.7  6.9  6.9  6.8\n136  6.3  7.2  6.9  6.8  6.7\n138  6.5  6.3  6.3  6.9  6.7\n```\n\n\n:::\n:::\n\n\n\nCalculamos la media para las 5 simulaciones.\n\n\n\n::: {.cell}\n\n```{.r .cell-code}\nimputed_Sepal.Length <- rowMeans(impute_arg$imputed$Sepal.Length)\nnew_var_imputed <- iris$Sepal.Length\nnew_var_imputed[as.numeric(names(imputed_Sepal.Length))] <- imputed_Sepal.Length\n```\n:::\n\n\n\nRevisamos la diferencia entre las dos imputaciones.\n\n\n\n::: {.cell}\n\n```{.r .cell-code}\nnewBD <- data.frame(real = iris[, \"Sepal.Length\"], imputed = new_var_imputed)\ndf_long <- newBD %>%\n  pivot_longer(cols = everything(), names_to = \"Variable\", values_to = \"Valor\")\n\nggplot(df_long, aes(x = Valor, fill = Variable)) +\n  geom_density(alpha = 0.3) +  # Transparencia para mejor visualización\n  labs(title = \"Densidad de las tres variables\",\n       x = \"Valor\",\n       y = \"Densidad\") +\n  theme_minimal() +\n  scale_fill_manual(values = c(\"blue\", \"red\"))\n```\n\n::: {.cell-output-display}\n![](AdvancedPreprocessing_files/figure-html/grafico_media_simulaciones-1.png){width=672}\n:::\n:::\n\n\n\n## Multiple Iterative Regression Imputation (MI method)\n\nImputamos los valores NA's con mi\n\n\n\n::: {.cell}\n\n```{.r .cell-code}\nmi_data <- mi::mi(iris.mis, seed = 335)\n```\n:::\n\n\n\nRevisamos la información de las imputaciones.\n\n\n\n::: {.cell}\n\n```{.r .cell-code}\nsummary(mi_data)\nplot(mi_data)\npar(ask = FALSE)\n```\n:::\n\n\n\nRevisamos las interaciones de la base de datos\n\n\n\n::: {.cell}\n\n```{.r .cell-code}\nmi_data@data\n```\n:::\n\n\n\n## Media con una variable target\n\nDefinimos la variable target\n\n\n\n::: {.cell}\n\n```{.r .cell-code}\ntarget = \"Species\"\n```\n:::\n\n\n\nDefinimos la base de datos con NA's\n\n\n\n::: {.cell}\n\n```{.r .cell-code}\ndata <- subset(iris, select = -c(get(target)))\ndata <- missForest::prodNA(data, noNA = 0.1)\ndata$Species <- iris[, target]\n```\n:::\n\n\n\nDefinir variables a imputar (excluyendo la variable target)\n\n\n\n::: {.cell}\n\n```{.r .cell-code}\nvarImp <- colnames(data)[which(!colnames(data) %in% target)]\n```\n:::\n\n\n\nCalcular las medias por grupo\n\n\n\n::: {.cell}\n\n```{.r .cell-code}\nmeans <- aggregate(data[, varImp], list(data[, target]), mean, na.rm = TRUE)\n```\n:::\n\n\n\nImputar valores faltantes\n\n\n\n::: {.cell}\n\n```{.r .cell-code}\nfor (c in varImp) {\n  for (g in means[, \"Group.1\"]) {\n    cond <- data[, target] == g  # Condición booleana en vez de which()\n    na_index <- is.na(data[, c]) & cond  # Seleccionar NA dentro del grupo\n    \n    # Asignar valores imputados\n    data[na_index, c] <- means[means[, \"Group.1\"] == g, c]\n  }\n}\nsummary(data)\n```\n\n::: {.cell-output .cell-output-stdout}\n\n```\n  Sepal.Length    Sepal.Width     Petal.Length    Petal.Width   \n Min.   :4.300   Min.   :2.000   Min.   :1.000   Min.   :0.100  \n 1st Qu.:5.100   1st Qu.:2.800   1st Qu.:1.500   1st Qu.:0.300  \n Median :5.800   Median :3.000   Median :4.300   Median :1.326  \n Mean   :5.833   Mean   :3.034   Mean   :3.757   Mean   :1.202  \n 3rd Qu.:6.400   3rd Qu.:3.300   3rd Qu.:5.100   3rd Qu.:1.800  \n Max.   :7.900   Max.   :4.100   Max.   :6.900   Max.   :2.500  \n       Species  \n setosa    :50  \n versicolor:50  \n virginica :50  \n                \n                \n                \n```\n\n\n:::\n:::\n\n\n\nVisualizamos la diferencia entre las imputaciones\n\n\n\n::: {.cell}\n\n```{.r .cell-code}\niris[, \"Tipo\"] <- \"original\"\ndata[, \"Tipo\"] <- \"imputed\"\n```\n:::\n\n\n\nUnimos en un mismo dataframe\n\n\n\n::: {.cell}\n\n```{.r .cell-code}\ndata_long <- bind_rows(iris, data)\ncols_numeric <- names(data_long)[sapply(data_long, is.numeric) & names(data_long) != \"Tipo\"]\n\n# Convert a large data\ndata_long <- data_long %>%\n  pivot_longer(cols = all_of(cols_numeric), names_to = \"Variable\", values_to = \"Valor\")\n```\n:::\n\n\n\nCreamos el gráfico con ggplot\n\n\n\n::: {.cell}\n\n```{.r .cell-code}\nggplot(data_long, aes(x = Valor, fill = Tipo)) +\n  geom_density(alpha = 0.3) +  # Transparencia para comparación\n  facet_wrap(~Variable, scales = \"free\") +  # Un gráfico por variable\n  labs(title = \"Comparación de Distribuciones: Original vs Imputado\",\n       x = \"Valor\",\n       y = \"Densidad\") +\n  theme_minimal() +\n  scale_fill_manual(values = c(\"blue\", \"red\"))\n```\n\n::: {.cell-output-display}\n![](AdvancedPreprocessing_files/figure-html/unnamed-chunk-8-1.png){width=672}\n:::\n:::\n\n\n\nRemovemos la tipologia de variable\n\n\n\n::: {.cell}\n\n```{.r .cell-code}\niris.mis[, \"Tipo\"] <- NULL\n```\n:::\n\n\n\n## Multiple Imputation by Chained Equations (MICE)\n\nEliminamos las variables categoricas\n\n\n\n::: {.cell}\n\n```{.r .cell-code}\nquiCat <- which(lapply(iris.mis, class) %in% c(\"character\", \"factor\"))\ncategories <- names(iris.mis)[quiCat]\niris.mis2 <- subset(iris.mis, select = -c(get(categories)))\nsummary(iris.mis2)\n```\n\n::: {.cell-output .cell-output-stdout}\n\n```\n  Sepal.Length    Sepal.Width     Petal.Length    Petal.Width   \n Min.   :4.300   Min.   :2.000   Min.   :1.000   Min.   :0.100  \n 1st Qu.:5.100   1st Qu.:2.800   1st Qu.:1.500   1st Qu.:0.300  \n Median :5.700   Median :3.000   Median :4.300   Median :1.300  \n Mean   :5.795   Mean   :3.032   Mean   :3.697   Mean   :1.208  \n 3rd Qu.:6.375   3rd Qu.:3.300   3rd Qu.:5.100   3rd Qu.:1.800  \n Max.   :7.700   Max.   :4.400   Max.   :6.700   Max.   :2.500  \n NA's   :12      NA's   :15      NA's   :16      NA's   :16     \n```\n\n\n:::\n:::\n\n\n\nVisualizamos los patrones de NA's de la base de datos\n\n\n\n::: {.cell}\n\n```{.r .cell-code}\npar(mfrow = c(1, 1))\nmice::md.pattern(iris.mis2, rotate.names = TRUE)\n```\n\n::: {.cell-output-display}\n![](AdvancedPreprocessing_files/figure-html/unnamed-chunk-11-1.png){width=672}\n:::\n\n::: {.cell-output .cell-output-stdout}\n\n```\n   Sepal.Length Sepal.Width Petal.Length Petal.Width   \n99            1           1            1           1  0\n12            1           1            1           0  1\n15            1           1            0           1  1\n9             1           0            1           1  1\n2             1           0            1           0  2\n1             1           0            0           1  2\n7             0           1            1           1  1\n2             0           1            1           0  2\n3             0           0            1           1  2\n             12          15           16          16 59\n```\n\n\n:::\n:::\n\n\n\nTambién lo podemos visualizar con el paquete VIM\n\n\n\n::: {.cell}\n\n```{.r .cell-code}\nmice_plot <- VIM::aggr(iris.mis2, col=c('navyblue','yellow'),\n                  numbers=TRUE, sortVars=TRUE,\n                  labels=names(iris.mis), cex.axis=.7,\n                  gap=3, ylab=c(\"Missing data\",\"Pattern\"))\n```\n\n::: {.cell-output-display}\n![](AdvancedPreprocessing_files/figure-html/unnamed-chunk-12-1.png){width=672}\n:::\n\n::: {.cell-output .cell-output-stdout}\n\n```\n\n Variables sorted by number of missings: \n     Variable     Count\n Petal.Length 0.1066667\n  Petal.Width 0.1066667\n  Sepal.Width 0.1000000\n Sepal.Length 0.0800000\n```\n\n\n:::\n:::\n\n\n\nA continuación realizamos la imputación de los valores faltanes de manera multivariada\n\n\n\n::: {.cell}\n\n```{.r .cell-code}\nimputed_Data <- mice::mice(iris.mis2, m=5, maxit = 50, method = 'pmm', seed = 500)\n```\n\n::: {.cell-output .cell-output-stdout}\n\n```\n\n iter imp variable\n  1   1  Sepal.Length  Sepal.Width  Petal.Length  Petal.Width\n  1   2  Sepal.Length  Sepal.Width  Petal.Length  Petal.Width\n  1   3  Sepal.Length  Sepal.Width  Petal.Length  Petal.Width\n  1   4  Sepal.Length  Sepal.Width  Petal.Length  Petal.Width\n  1   5  Sepal.Length  Sepal.Width  Petal.Length  Petal.Width\n  2   1  Sepal.Length  Sepal.Width  Petal.Length  Petal.Width\n  2   2  Sepal.Length  Sepal.Width  Petal.Length  Petal.Width\n  2   3  Sepal.Length  Sepal.Width  Petal.Length  Petal.Width\n  2   4  Sepal.Length  Sepal.Width  Petal.Length  Petal.Width\n  2   5  Sepal.Length  Sepal.Width  Petal.Length  Petal.Width\n  3   1  Sepal.Length  Sepal.Width  Petal.Length  Petal.Width\n  3   2  Sepal.Length  Sepal.Width  Petal.Length  Petal.Width\n  3   3  Sepal.Length  Sepal.Width  Petal.Length  Petal.Width\n  3   4  Sepal.Length  Sepal.Width  Petal.Length  Petal.Width\n  3   5  Sepal.Length  Sepal.Width  Petal.Length  Petal.Width\n  4   1  Sepal.Length  Sepal.Width  Petal.Length  Petal.Width\n  4   2  Sepal.Length  Sepal.Width  Petal.Length  Petal.Width\n  4   3  Sepal.Length  Sepal.Width  Petal.Length  Petal.Width\n  4   4  Sepal.Length  Sepal.Width  Petal.Length  Petal.Width\n  4   5  Sepal.Length  Sepal.Width  Petal.Length  Petal.Width\n  5   1  Sepal.Length  Sepal.Width  Petal.Length  Petal.Width\n  5   2  Sepal.Length  Sepal.Width  Petal.Length  Petal.Width\n  5   3  Sepal.Length  Sepal.Width  Petal.Length  Petal.Width\n  5   4  Sepal.Length  Sepal.Width  Petal.Length  Petal.Width\n  5   5  Sepal.Length  Sepal.Width  Petal.Length  Petal.Width\n  6   1  Sepal.Length  Sepal.Width  Petal.Length  Petal.Width\n  6   2  Sepal.Length  Sepal.Width  Petal.Length  Petal.Width\n  6   3  Sepal.Length  Sepal.Width  Petal.Length  Petal.Width\n  6   4  Sepal.Length  Sepal.Width  Petal.Length  Petal.Width\n  6   5  Sepal.Length  Sepal.Width  Petal.Length  Petal.Width\n  7   1  Sepal.Length  Sepal.Width  Petal.Length  Petal.Width\n  7   2  Sepal.Length  Sepal.Width  Petal.Length  Petal.Width\n  7   3  Sepal.Length  Sepal.Width  Petal.Length  Petal.Width\n  7   4  Sepal.Length  Sepal.Width  Petal.Length  Petal.Width\n  7   5  Sepal.Length  Sepal.Width  Petal.Length  Petal.Width\n  8   1  Sepal.Length  Sepal.Width  Petal.Length  Petal.Width\n  8   2  Sepal.Length  Sepal.Width  Petal.Length  Petal.Width\n  8   3  Sepal.Length  Sepal.Width  Petal.Length  Petal.Width\n  8   4  Sepal.Length  Sepal.Width  Petal.Length  Petal.Width\n  8   5  Sepal.Length  Sepal.Width  Petal.Length  Petal.Width\n  9   1  Sepal.Length  Sepal.Width  Petal.Length  Petal.Width\n  9   2  Sepal.Length  Sepal.Width  Petal.Length  Petal.Width\n  9   3  Sepal.Length  Sepal.Width  Petal.Length  Petal.Width\n  9   4  Sepal.Length  Sepal.Width  Petal.Length  Petal.Width\n  9   5  Sepal.Length  Sepal.Width  Petal.Length  Petal.Width\n  10   1  Sepal.Length  Sepal.Width  Petal.Length  Petal.Width\n  10   2  Sepal.Length  Sepal.Width  Petal.Length  Petal.Width\n  10   3  Sepal.Length  Sepal.Width  Petal.Length  Petal.Width\n  10   4  Sepal.Length  Sepal.Width  Petal.Length  Petal.Width\n  10   5  Sepal.Length  Sepal.Width  Petal.Length  Petal.Width\n  11   1  Sepal.Length  Sepal.Width  Petal.Length  Petal.Width\n  11   2  Sepal.Length  Sepal.Width  Petal.Length  Petal.Width\n  11   3  Sepal.Length  Sepal.Width  Petal.Length  Petal.Width\n  11   4  Sepal.Length  Sepal.Width  Petal.Length  Petal.Width\n  11   5  Sepal.Length  Sepal.Width  Petal.Length  Petal.Width\n  12   1  Sepal.Length  Sepal.Width  Petal.Length  Petal.Width\n  12   2  Sepal.Length  Sepal.Width  Petal.Length  Petal.Width\n  12   3  Sepal.Length  Sepal.Width  Petal.Length  Petal.Width\n  12   4  Sepal.Length  Sepal.Width  Petal.Length  Petal.Width\n  12   5  Sepal.Length  Sepal.Width  Petal.Length  Petal.Width\n  13   1  Sepal.Length  Sepal.Width  Petal.Length  Petal.Width\n  13   2  Sepal.Length  Sepal.Width  Petal.Length  Petal.Width\n  13   3  Sepal.Length  Sepal.Width  Petal.Length  Petal.Width\n  13   4  Sepal.Length  Sepal.Width  Petal.Length  Petal.Width\n  13   5  Sepal.Length  Sepal.Width  Petal.Length  Petal.Width\n  14   1  Sepal.Length  Sepal.Width  Petal.Length  Petal.Width\n  14   2  Sepal.Length  Sepal.Width  Petal.Length  Petal.Width\n  14   3  Sepal.Length  Sepal.Width  Petal.Length  Petal.Width\n  14   4  Sepal.Length  Sepal.Width  Petal.Length  Petal.Width\n  14   5  Sepal.Length  Sepal.Width  Petal.Length  Petal.Width\n  15   1  Sepal.Length  Sepal.Width  Petal.Length  Petal.Width\n  15   2  Sepal.Length  Sepal.Width  Petal.Length  Petal.Width\n  15   3  Sepal.Length  Sepal.Width  Petal.Length  Petal.Width\n  15   4  Sepal.Length  Sepal.Width  Petal.Length  Petal.Width\n  15   5  Sepal.Length  Sepal.Width  Petal.Length  Petal.Width\n  16   1  Sepal.Length  Sepal.Width  Petal.Length  Petal.Width\n  16   2  Sepal.Length  Sepal.Width  Petal.Length  Petal.Width\n  16   3  Sepal.Length  Sepal.Width  Petal.Length  Petal.Width\n  16   4  Sepal.Length  Sepal.Width  Petal.Length  Petal.Width\n  16   5  Sepal.Length  Sepal.Width  Petal.Length  Petal.Width\n  17   1  Sepal.Length  Sepal.Width  Petal.Length  Petal.Width\n  17   2  Sepal.Length  Sepal.Width  Petal.Length  Petal.Width\n  17   3  Sepal.Length  Sepal.Width  Petal.Length  Petal.Width\n  17   4  Sepal.Length  Sepal.Width  Petal.Length  Petal.Width\n  17   5  Sepal.Length  Sepal.Width  Petal.Length  Petal.Width\n  18   1  Sepal.Length  Sepal.Width  Petal.Length  Petal.Width\n  18   2  Sepal.Length  Sepal.Width  Petal.Length  Petal.Width\n  18   3  Sepal.Length  Sepal.Width  Petal.Length  Petal.Width\n  18   4  Sepal.Length  Sepal.Width  Petal.Length  Petal.Width\n  18   5  Sepal.Length  Sepal.Width  Petal.Length  Petal.Width\n  19   1  Sepal.Length  Sepal.Width  Petal.Length  Petal.Width\n  19   2  Sepal.Length  Sepal.Width  Petal.Length  Petal.Width\n  19   3  Sepal.Length  Sepal.Width  Petal.Length  Petal.Width\n  19   4  Sepal.Length  Sepal.Width  Petal.Length  Petal.Width\n  19   5  Sepal.Length  Sepal.Width  Petal.Length  Petal.Width\n  20   1  Sepal.Length  Sepal.Width  Petal.Length  Petal.Width\n  20   2  Sepal.Length  Sepal.Width  Petal.Length  Petal.Width\n  20   3  Sepal.Length  Sepal.Width  Petal.Length  Petal.Width\n  20   4  Sepal.Length  Sepal.Width  Petal.Length  Petal.Width\n  20   5  Sepal.Length  Sepal.Width  Petal.Length  Petal.Width\n  21   1  Sepal.Length  Sepal.Width  Petal.Length  Petal.Width\n  21   2  Sepal.Length  Sepal.Width  Petal.Length  Petal.Width\n  21   3  Sepal.Length  Sepal.Width  Petal.Length  Petal.Width\n  21   4  Sepal.Length  Sepal.Width  Petal.Length  Petal.Width\n  21   5  Sepal.Length  Sepal.Width  Petal.Length  Petal.Width\n  22   1  Sepal.Length  Sepal.Width  Petal.Length  Petal.Width\n  22   2  Sepal.Length  Sepal.Width  Petal.Length  Petal.Width\n  22   3  Sepal.Length  Sepal.Width  Petal.Length  Petal.Width\n  22   4  Sepal.Length  Sepal.Width  Petal.Length  Petal.Width\n  22   5  Sepal.Length  Sepal.Width  Petal.Length  Petal.Width\n  23   1  Sepal.Length  Sepal.Width  Petal.Length  Petal.Width\n  23   2  Sepal.Length  Sepal.Width  Petal.Length  Petal.Width\n  23   3  Sepal.Length  Sepal.Width  Petal.Length  Petal.Width\n  23   4  Sepal.Length  Sepal.Width  Petal.Length  Petal.Width\n  23   5  Sepal.Length  Sepal.Width  Petal.Length  Petal.Width\n  24   1  Sepal.Length  Sepal.Width  Petal.Length  Petal.Width\n  24   2  Sepal.Length  Sepal.Width  Petal.Length  Petal.Width\n  24   3  Sepal.Length  Sepal.Width  Petal.Length  Petal.Width\n  24   4  Sepal.Length  Sepal.Width  Petal.Length  Petal.Width\n  24   5  Sepal.Length  Sepal.Width  Petal.Length  Petal.Width\n  25   1  Sepal.Length  Sepal.Width  Petal.Length  Petal.Width\n  25   2  Sepal.Length  Sepal.Width  Petal.Length  Petal.Width\n  25   3  Sepal.Length  Sepal.Width  Petal.Length  Petal.Width\n  25   4  Sepal.Length  Sepal.Width  Petal.Length  Petal.Width\n  25   5  Sepal.Length  Sepal.Width  Petal.Length  Petal.Width\n  26   1  Sepal.Length  Sepal.Width  Petal.Length  Petal.Width\n  26   2  Sepal.Length  Sepal.Width  Petal.Length  Petal.Width\n  26   3  Sepal.Length  Sepal.Width  Petal.Length  Petal.Width\n  26   4  Sepal.Length  Sepal.Width  Petal.Length  Petal.Width\n  26   5  Sepal.Length  Sepal.Width  Petal.Length  Petal.Width\n  27   1  Sepal.Length  Sepal.Width  Petal.Length  Petal.Width\n  27   2  Sepal.Length  Sepal.Width  Petal.Length  Petal.Width\n  27   3  Sepal.Length  Sepal.Width  Petal.Length  Petal.Width\n  27   4  Sepal.Length  Sepal.Width  Petal.Length  Petal.Width\n  27   5  Sepal.Length  Sepal.Width  Petal.Length  Petal.Width\n  28   1  Sepal.Length  Sepal.Width  Petal.Length  Petal.Width\n  28   2  Sepal.Length  Sepal.Width  Petal.Length  Petal.Width\n  28   3  Sepal.Length  Sepal.Width  Petal.Length  Petal.Width\n  28   4  Sepal.Length  Sepal.Width  Petal.Length  Petal.Width\n  28   5  Sepal.Length  Sepal.Width  Petal.Length  Petal.Width\n  29   1  Sepal.Length  Sepal.Width  Petal.Length  Petal.Width\n  29   2  Sepal.Length  Sepal.Width  Petal.Length  Petal.Width\n  29   3  Sepal.Length  Sepal.Width  Petal.Length  Petal.Width\n  29   4  Sepal.Length  Sepal.Width  Petal.Length  Petal.Width\n  29   5  Sepal.Length  Sepal.Width  Petal.Length  Petal.Width\n  30   1  Sepal.Length  Sepal.Width  Petal.Length  Petal.Width\n  30   2  Sepal.Length  Sepal.Width  Petal.Length  Petal.Width\n  30   3  Sepal.Length  Sepal.Width  Petal.Length  Petal.Width\n  30   4  Sepal.Length  Sepal.Width  Petal.Length  Petal.Width\n  30   5  Sepal.Length  Sepal.Width  Petal.Length  Petal.Width\n  31   1  Sepal.Length  Sepal.Width  Petal.Length  Petal.Width\n  31   2  Sepal.Length  Sepal.Width  Petal.Length  Petal.Width\n  31   3  Sepal.Length  Sepal.Width  Petal.Length  Petal.Width\n  31   4  Sepal.Length  Sepal.Width  Petal.Length  Petal.Width\n  31   5  Sepal.Length  Sepal.Width  Petal.Length  Petal.Width\n  32   1  Sepal.Length  Sepal.Width  Petal.Length  Petal.Width\n  32   2  Sepal.Length  Sepal.Width  Petal.Length  Petal.Width\n  32   3  Sepal.Length  Sepal.Width  Petal.Length  Petal.Width\n  32   4  Sepal.Length  Sepal.Width  Petal.Length  Petal.Width\n  32   5  Sepal.Length  Sepal.Width  Petal.Length  Petal.Width\n  33   1  Sepal.Length  Sepal.Width  Petal.Length  Petal.Width\n  33   2  Sepal.Length  Sepal.Width  Petal.Length  Petal.Width\n  33   3  Sepal.Length  Sepal.Width  Petal.Length  Petal.Width\n  33   4  Sepal.Length  Sepal.Width  Petal.Length  Petal.Width\n  33   5  Sepal.Length  Sepal.Width  Petal.Length  Petal.Width\n  34   1  Sepal.Length  Sepal.Width  Petal.Length  Petal.Width\n  34   2  Sepal.Length  Sepal.Width  Petal.Length  Petal.Width\n  34   3  Sepal.Length  Sepal.Width  Petal.Length  Petal.Width\n  34   4  Sepal.Length  Sepal.Width  Petal.Length  Petal.Width\n  34   5  Sepal.Length  Sepal.Width  Petal.Length  Petal.Width\n  35   1  Sepal.Length  Sepal.Width  Petal.Length  Petal.Width\n  35   2  Sepal.Length  Sepal.Width  Petal.Length  Petal.Width\n  35   3  Sepal.Length  Sepal.Width  Petal.Length  Petal.Width\n  35   4  Sepal.Length  Sepal.Width  Petal.Length  Petal.Width\n  35   5  Sepal.Length  Sepal.Width  Petal.Length  Petal.Width\n  36   1  Sepal.Length  Sepal.Width  Petal.Length  Petal.Width\n  36   2  Sepal.Length  Sepal.Width  Petal.Length  Petal.Width\n  36   3  Sepal.Length  Sepal.Width  Petal.Length  Petal.Width\n  36   4  Sepal.Length  Sepal.Width  Petal.Length  Petal.Width\n  36   5  Sepal.Length  Sepal.Width  Petal.Length  Petal.Width\n  37   1  Sepal.Length  Sepal.Width  Petal.Length  Petal.Width\n  37   2  Sepal.Length  Sepal.Width  Petal.Length  Petal.Width\n  37   3  Sepal.Length  Sepal.Width  Petal.Length  Petal.Width\n  37   4  Sepal.Length  Sepal.Width  Petal.Length  Petal.Width\n  37   5  Sepal.Length  Sepal.Width  Petal.Length  Petal.Width\n  38   1  Sepal.Length  Sepal.Width  Petal.Length  Petal.Width\n  38   2  Sepal.Length  Sepal.Width  Petal.Length  Petal.Width\n  38   3  Sepal.Length  Sepal.Width  Petal.Length  Petal.Width\n  38   4  Sepal.Length  Sepal.Width  Petal.Length  Petal.Width\n  38   5  Sepal.Length  Sepal.Width  Petal.Length  Petal.Width\n  39   1  Sepal.Length  Sepal.Width  Petal.Length  Petal.Width\n  39   2  Sepal.Length  Sepal.Width  Petal.Length  Petal.Width\n  39   3  Sepal.Length  Sepal.Width  Petal.Length  Petal.Width\n  39   4  Sepal.Length  Sepal.Width  Petal.Length  Petal.Width\n  39   5  Sepal.Length  Sepal.Width  Petal.Length  Petal.Width\n  40   1  Sepal.Length  Sepal.Width  Petal.Length  Petal.Width\n  40   2  Sepal.Length  Sepal.Width  Petal.Length  Petal.Width\n  40   3  Sepal.Length  Sepal.Width  Petal.Length  Petal.Width\n  40   4  Sepal.Length  Sepal.Width  Petal.Length  Petal.Width\n  40   5  Sepal.Length  Sepal.Width  Petal.Length  Petal.Width\n  41   1  Sepal.Length  Sepal.Width  Petal.Length  Petal.Width\n  41   2  Sepal.Length  Sepal.Width  Petal.Length  Petal.Width\n  41   3  Sepal.Length  Sepal.Width  Petal.Length  Petal.Width\n  41   4  Sepal.Length  Sepal.Width  Petal.Length  Petal.Width\n  41   5  Sepal.Length  Sepal.Width  Petal.Length  Petal.Width\n  42   1  Sepal.Length  Sepal.Width  Petal.Length  Petal.Width\n  42   2  Sepal.Length  Sepal.Width  Petal.Length  Petal.Width\n  42   3  Sepal.Length  Sepal.Width  Petal.Length  Petal.Width\n  42   4  Sepal.Length  Sepal.Width  Petal.Length  Petal.Width\n  42   5  Sepal.Length  Sepal.Width  Petal.Length  Petal.Width\n  43   1  Sepal.Length  Sepal.Width  Petal.Length  Petal.Width\n  43   2  Sepal.Length  Sepal.Width  Petal.Length  Petal.Width\n  43   3  Sepal.Length  Sepal.Width  Petal.Length  Petal.Width\n  43   4  Sepal.Length  Sepal.Width  Petal.Length  Petal.Width\n  43   5  Sepal.Length  Sepal.Width  Petal.Length  Petal.Width\n  44   1  Sepal.Length  Sepal.Width  Petal.Length  Petal.Width\n  44   2  Sepal.Length  Sepal.Width  Petal.Length  Petal.Width\n  44   3  Sepal.Length  Sepal.Width  Petal.Length  Petal.Width\n  44   4  Sepal.Length  Sepal.Width  Petal.Length  Petal.Width\n  44   5  Sepal.Length  Sepal.Width  Petal.Length  Petal.Width\n  45   1  Sepal.Length  Sepal.Width  Petal.Length  Petal.Width\n  45   2  Sepal.Length  Sepal.Width  Petal.Length  Petal.Width\n  45   3  Sepal.Length  Sepal.Width  Petal.Length  Petal.Width\n  45   4  Sepal.Length  Sepal.Width  Petal.Length  Petal.Width\n  45   5  Sepal.Length  Sepal.Width  Petal.Length  Petal.Width\n  46   1  Sepal.Length  Sepal.Width  Petal.Length  Petal.Width\n  46   2  Sepal.Length  Sepal.Width  Petal.Length  Petal.Width\n  46   3  Sepal.Length  Sepal.Width  Petal.Length  Petal.Width\n  46   4  Sepal.Length  Sepal.Width  Petal.Length  Petal.Width\n  46   5  Sepal.Length  Sepal.Width  Petal.Length  Petal.Width\n  47   1  Sepal.Length  Sepal.Width  Petal.Length  Petal.Width\n  47   2  Sepal.Length  Sepal.Width  Petal.Length  Petal.Width\n  47   3  Sepal.Length  Sepal.Width  Petal.Length  Petal.Width\n  47   4  Sepal.Length  Sepal.Width  Petal.Length  Petal.Width\n  47   5  Sepal.Length  Sepal.Width  Petal.Length  Petal.Width\n  48   1  Sepal.Length  Sepal.Width  Petal.Length  Petal.Width\n  48   2  Sepal.Length  Sepal.Width  Petal.Length  Petal.Width\n  48   3  Sepal.Length  Sepal.Width  Petal.Length  Petal.Width\n  48   4  Sepal.Length  Sepal.Width  Petal.Length  Petal.Width\n  48   5  Sepal.Length  Sepal.Width  Petal.Length  Petal.Width\n  49   1  Sepal.Length  Sepal.Width  Petal.Length  Petal.Width\n  49   2  Sepal.Length  Sepal.Width  Petal.Length  Petal.Width\n  49   3  Sepal.Length  Sepal.Width  Petal.Length  Petal.Width\n  49   4  Sepal.Length  Sepal.Width  Petal.Length  Petal.Width\n  49   5  Sepal.Length  Sepal.Width  Petal.Length  Petal.Width\n  50   1  Sepal.Length  Sepal.Width  Petal.Length  Petal.Width\n  50   2  Sepal.Length  Sepal.Width  Petal.Length  Petal.Width\n  50   3  Sepal.Length  Sepal.Width  Petal.Length  Petal.Width\n  50   4  Sepal.Length  Sepal.Width  Petal.Length  Petal.Width\n  50   5  Sepal.Length  Sepal.Width  Petal.Length  Petal.Width\n```\n\n\n:::\n\n```{.r .cell-code}\nsummary(imputed_Data)\n```\n\n::: {.cell-output .cell-output-stdout}\n\n```\nClass: mids\nNumber of multiple imputations:  5 \nImputation methods:\nSepal.Length  Sepal.Width Petal.Length  Petal.Width \n       \"pmm\"        \"pmm\"        \"pmm\"        \"pmm\" \nPredictorMatrix:\n             Sepal.Length Sepal.Width Petal.Length Petal.Width\nSepal.Length            0           1            1           1\nSepal.Width             1           0            1           1\nPetal.Length            1           1            0           1\nPetal.Width             1           1            1           0\n```\n\n\n:::\n:::\n\n\n\nInspeccionamos la calidad de las imputaciones\n\n\n\n::: {.cell}\n\n```{.r .cell-code}\nmice::stripplot(imputed_Data, Sepal.Width, pch = 19, xlab = \"Imputation number\")\n```\n\n::: {.cell-output-display}\n![](AdvancedPreprocessing_files/figure-html/unnamed-chunk-14-1.png){width=672}\n:::\n\n```{.r .cell-code}\nimputed_Data$imp$Sepal.Width\n```\n\n::: {.cell-output .cell-output-stdout}\n\n```\n      1   2   3   4   5\n1   3.6 3.6 4.1 3.5 3.0\n5   3.4 3.0 2.6 3.0 3.4\n6   2.3 3.1 3.4 3.5 3.5\n17  4.4 3.8 4.2 3.5 3.7\n26  2.9 3.1 3.2 2.9 3.3\n31  2.8 2.8 2.8 2.8 3.1\n38  3.1 3.3 2.9 2.9 3.1\n70  3.0 2.9 2.3 2.4 2.4\n101 2.5 2.9 3.0 2.7 3.2\n112 2.9 3.2 3.0 3.0 2.7\n116 2.8 4.2 3.2 3.1 3.2\n121 3.4 2.8 2.8 3.8 3.2\n130 2.8 3.4 3.1 4.1 3.3\n132 2.7 2.7 2.7 2.5 2.9\n146 3.4 3.0 3.8 3.5 3.3\n```\n\n\n:::\n:::\n\n\n\nAl final seleccionamos una de las iteracciones y la dejamos como imputación de los valores faltantes.\n\n\n\n::: {.cell}\n\n```{.r .cell-code}\ncompleteData <- mice::complete(imputed_Data, action = \"long\")\n```\n:::\n\n\n\n### Exercices:\n\n1. Deploy the multiple plot to compare te imputation and not imputation with all numeric vars in dataframe\n\n## KNN\n\n\n\n::: {.cell}\n\n```{.r .cell-code}\ntipos <- sapply(iris.mis, class)\nvarNum <- names(tipos)[which(tipos %in% c(\"numeric\", \"integer\"))]\ndata_knn_imputation <- multiUS::KNNimp(iris.mis[, varNum], k = 1)\nsummary(data_knn_imputation)\n```\n\n::: {.cell-output .cell-output-stdout}\n\n```\n  Sepal.Length    Sepal.Width     Petal.Length    Petal.Width   \n Min.   :4.300   Min.   :2.000   Min.   :1.000   Min.   :0.100  \n 1st Qu.:5.100   1st Qu.:2.800   1st Qu.:1.600   1st Qu.:0.300  \n Median :5.800   Median :3.000   Median :4.400   Median :1.300  \n Mean   :5.841   Mean   :3.045   Mean   :3.767   Mean   :1.191  \n 3rd Qu.:6.475   3rd Qu.:3.375   3rd Qu.:5.100   3rd Qu.:1.800  \n Max.   :7.700   Max.   :4.400   Max.   :6.700   Max.   :2.500  \n```\n\n\n:::\n:::\n\n\n\nVisualizamos la diferencia entre las dos imputaciones. \n\n\n\n::: {.cell}\n\n```{.r .cell-code}\nnewBD <- data.frame(real = iris[, \"Sepal.Length\"], imputed = data_knn_imputation[, \"Sepal.Length\"])\ndf_long <- newBD %>%\n  pivot_longer(cols = everything(), names_to = \"Variable\", values_to = \"Valor\")\n\nggplot(df_long, aes(x = Valor, fill = Variable)) +\n  geom_density(alpha = 0.3) +  # Transparencia para mejor visualización\n  labs(title = \"Densidad de las tres variables\",\n       x = \"Valor\",\n       y = \"Densidad\") +\n  theme_minimal() +\n  scale_fill_manual(values = c(\"blue\", \"red\"))\n```\n\n::: {.cell-output-display}\n![](AdvancedPreprocessing_files/figure-html/unnamed-chunk-17-1.png){width=672}\n:::\n:::\n\n\n\n### Exercices: \n1. Deploy the multiple plot to compare the imputation and not imputation with all numeric vars in dataframe\n\n## missForest\n\nImputamos los missings usando todos los parametros con los valores por defectos. \n\n\n\n::: {.cell}\n\n```{.r .cell-code}\nlibrary(missForest)\n```\n\n::: {.cell-output .cell-output-stderr}\n\n```\nWarning: package 'missForest' was built under R version 4.4.3\n```\n\n\n:::\n\n```{.r .cell-code}\niris.imp <- missForest(iris.mis, variablewise = T, verbose = T) \n```\n\n::: {.cell-output .cell-output-stdout}\n\n```\n  missForest iteration 1 in progress...done!\n    estimated error(s): 0.1785301 0.09607199 0.1616973 0.032296 0.05223881 \n    difference(s): 0.005511064 0.08 \n    time: 0.06 seconds\n\n  missForest iteration 2 in progress...done!\n    estimated error(s): 0.1241168 0.08722486 0.06218984 0.02937162 0.04477612 \n    difference(s): 0.0001018209 0 \n    time: 0.04 seconds\n\n  missForest iteration 3 in progress...done!\n    estimated error(s): 0.1310795 0.08576933 0.0644648 0.02911535 0.03731343 \n    difference(s): 1.120453e-05 0 \n    time: 0.07 seconds\n\n  missForest iteration 4 in progress...done!\n    estimated error(s): 0.1240951 0.08841871 0.06278651 0.02825258 0.04477612 \n    difference(s): 1.038555e-05 0 \n    time: 0.04 seconds\n\n  missForest iteration 5 in progress...done!\n    estimated error(s): 0.1255279 0.09103837 0.06693245 0.0299239 0.04477612 \n    difference(s): 6.865365e-06 0 \n    time: 0.07 seconds\n\n  missForest iteration 6 in progress...done!\n    estimated error(s): 0.1239506 0.08867171 0.06091633 0.02916087 0.04477612 \n    difference(s): 6.449324e-06 0 \n    time: 0.04 seconds\n\n  missForest iteration 7 in progress...done!\n    estimated error(s): 0.1228071 0.08399709 0.06295863 0.03010765 0.05223881 \n    difference(s): 1.060512e-05 0 \n    time: 0.05 seconds\n```\n\n\n:::\n:::\n\n\n\n\nVisualizamos los valores imputados \n\n\n\n::: {.cell}\n\n```{.r .cell-code}\niris.imp$ximp\n```\n\n::: {.cell-output .cell-output-stdout}\n\n```\n    Sepal.Length Sepal.Width Petal.Length Petal.Width    Species\n1       5.100000    3.503897     1.504231   0.2000000     setosa\n2       4.900000    3.000000     1.400000   0.2000000     setosa\n3       4.700000    3.200000     1.300000   0.2000000     setosa\n4       4.600000    3.100000     1.500000   0.2000000     setosa\n5       5.000000    3.302965     1.400000   0.2057000     setosa\n6       5.209333    3.597583     1.700000   0.4000000     setosa\n7       4.600000    3.400000     1.400000   0.3000000     setosa\n8       5.000000    3.400000     1.500000   0.2000000     setosa\n9       4.400000    2.900000     1.400000   0.2000000     setosa\n10      4.900000    3.100000     1.500000   0.1000000     setosa\n11      5.400000    3.700000     1.500000   0.2667614     setosa\n12      4.800000    3.400000     1.600000   0.2000000     setosa\n13      4.800000    3.000000     1.400000   0.1000000     setosa\n14      4.300000    3.000000     1.100000   0.1000000     setosa\n15      5.800000    4.000000     1.200000   0.3362333     setosa\n16      5.700000    4.400000     1.500000   0.4000000     setosa\n17      5.400000    3.694333     1.300000   0.4000000     setosa\n18      5.100000    3.500000     1.442550   0.3000000     setosa\n19      5.700000    3.800000     1.700000   0.3000000     setosa\n20      5.100000    3.800000     1.500000   0.3000000     setosa\n21      5.400000    3.400000     1.700000   0.2000000     setosa\n22      5.100000    3.700000     1.500000   0.4000000     setosa\n23      4.600000    3.600000     1.000000   0.2000000     setosa\n24      5.100000    3.300000     1.700000   0.5000000     setosa\n25      4.800000    3.400000     1.900000   0.2938250     setosa\n26      5.000000    3.435417     1.600000   0.2000000     setosa\n27      5.000000    3.400000     1.600000   0.4000000     setosa\n28      5.200000    3.500000     1.500000   0.2000000     setosa\n29      5.200000    3.400000     1.400000   0.2000000     setosa\n30      4.700000    3.200000     1.600000   0.2000000     setosa\n31      4.800000    3.306800     1.600000   0.2000000     setosa\n32      5.400000    3.400000     1.500000   0.2217281     setosa\n33      5.200000    4.100000     1.500000   0.1000000     setosa\n34      5.500000    4.200000     1.400000   0.2000000     setosa\n35      4.900000    3.100000     1.500000   0.2000000     setosa\n36      5.000000    3.200000     1.200000   0.2000000     setosa\n37      5.500000    3.500000     1.300000   0.2000000     setosa\n38      4.900000    3.071380     1.400000   0.1000000     setosa\n39      4.400000    3.000000     1.300000   0.1940821     setosa\n40      5.100000    3.400000     1.500000   0.2000000     setosa\n41      5.000000    3.500000     1.300000   0.3000000     setosa\n42      4.500000    2.300000     1.300000   0.3000000     setosa\n43      4.400000    3.200000     1.300000   0.2000000     setosa\n44      5.000000    3.500000     1.600000   0.6000000     setosa\n45      5.100000    3.800000     1.900000   0.4000000     setosa\n46      4.800000    3.000000     1.400000   0.3000000     setosa\n47      5.100000    3.800000     1.600000   0.2000000     setosa\n48      4.600000    3.200000     1.400000   0.2000000     setosa\n49      5.300000    3.700000     1.500000   0.2000000     setosa\n50      5.000000    3.300000     1.400000   0.2000000     setosa\n51      7.000000    3.200000     4.657098   1.4000000 versicolor\n52      6.224267    3.200000     4.500000   1.5000000 versicolor\n53      6.900000    3.100000     4.900000   1.5000000 versicolor\n54      5.500000    2.300000     4.009955   1.3000000 versicolor\n55      6.500000    2.800000     4.785000   1.5000000 versicolor\n56      5.700000    2.800000     4.500000   1.3000000 versicolor\n57      6.300000    3.300000     4.723100   1.6000000 versicolor\n58      4.900000    2.400000     3.300000   1.0000000 versicolor\n59      6.600000    2.900000     4.600000   1.3000000 versicolor\n60      5.200000    2.700000     3.900000   1.4000000 versicolor\n61      5.415833    2.000000     3.500000   1.0000000 versicolor\n62      5.721783    3.000000     4.200000   1.5000000 versicolor\n63      6.000000    2.200000     4.000000   1.0000000 versicolor\n64      6.100000    2.900000     4.700000   1.4000000 versicolor\n65      5.600000    2.900000     4.224271   1.3000000 versicolor\n66      6.700000    3.100000     4.400000   1.4000000 versicolor\n67      5.600000    3.000000     4.500000   1.4176667 versicolor\n68      5.800000    2.700000     4.100000   1.0000000 versicolor\n69      6.200000    2.200000     4.500000   1.5000000 versicolor\n70      5.600000    2.473683     3.900000   1.1000000 versicolor\n71      5.900000    3.200000     4.800000   1.8000000 versicolor\n72      6.100000    2.800000     4.000000   1.3000000 versicolor\n73      6.300000    2.500000     4.900000   1.5000000 versicolor\n74      6.294995    2.800000     4.700000   1.4422000 versicolor\n75      6.400000    2.900000     4.300000   1.3419000 versicolor\n76      6.600000    3.000000     4.400000   1.4000000 versicolor\n77      6.800000    2.800000     4.800000   1.4000000 versicolor\n78      6.700000    3.000000     5.000000   1.7000000 versicolor\n79      6.000000    2.900000     4.647900   1.5000000 versicolor\n80      5.700000    2.600000     3.500000   1.0000000 versicolor\n81      5.440450    2.400000     3.800000   1.1000000 versicolor\n82      5.500000    2.400000     3.700000   1.0000000 versicolor\n83      5.800000    2.700000     3.900000   1.2000000 versicolor\n84      6.000000    2.700000     5.100000   1.6000000 versicolor\n85      5.400000    3.000000     4.500000   1.5000000 versicolor\n86      6.000000    3.400000     4.500000   1.6000000 versicolor\n87      6.700000    3.100000     4.700000   1.4577000 versicolor\n88      6.300000    2.300000     4.400000   1.3000000 versicolor\n89      5.600000    3.000000     4.100000   1.3000000 versicolor\n90      5.500000    2.500000     4.000000   1.3000000 versicolor\n91      5.500000    2.600000     4.400000   1.2000000 versicolor\n92      6.100000    3.000000     4.526114   1.4000000 versicolor\n93      5.800000    2.600000     4.000000   1.2000000 versicolor\n94      5.000000    2.300000     3.300000   1.0000000 versicolor\n95      5.600000    2.700000     4.200000   1.3000000 versicolor\n96      5.700000    3.000000     4.139935   1.2000000 versicolor\n97      5.700000    2.900000     4.200000   1.3000000 versicolor\n98      6.200000    2.900000     4.300000   1.3000000 versicolor\n99      5.100000    2.500000     3.725717   1.1000000 versicolor\n100     5.700000    2.800000     4.287783   1.3000000 versicolor\n101     6.300000    3.327167     6.000000   2.5000000  virginica\n102     5.800000    2.700000     5.100000   1.9000000  virginica\n103     7.100000    3.000000     5.900000   2.1000000  virginica\n104     6.300000    2.900000     5.600000   1.8000000  virginica\n105     6.500000    3.000000     5.800000   2.2000000  virginica\n106     7.600000    3.000000     6.600000   2.1000000  virginica\n107     4.900000    2.500000     4.500000   1.7000000  virginica\n108     7.300000    2.900000     6.300000   1.8000000  virginica\n109     6.700000    2.500000     5.800000   1.8000000  virginica\n110     7.200000    3.600000     6.100000   2.5000000  virginica\n111     6.500000    3.200000     5.100000   2.0000000  virginica\n112     6.400000    2.756000     5.300000   1.9000000  virginica\n113     6.800000    3.000000     5.500000   2.1000000  virginica\n114     5.700000    2.500000     5.000000   2.0000000  virginica\n115     5.800000    2.800000     5.100000   2.4000000  virginica\n116     6.736750    3.133500     5.300000   2.3000000  virginica\n117     6.500000    3.000000     5.500000   1.8000000  virginica\n118     7.345200    3.800000     6.700000   2.2000000  virginica\n119     7.700000    2.600000     6.322667   2.3000000  virginica\n120     6.000000    2.200000     5.000000   1.5000000  virginica\n121     6.900000    3.186500     5.700000   2.3000000  virginica\n122     5.600000    2.800000     4.900000   1.8892000  virginica\n123     7.700000    2.800000     6.700000   2.0000000  virginica\n124     6.300000    2.700000     5.410267   1.8000000  virginica\n125     6.700000    3.300000     5.700000   2.1000000  virginica\n126     7.200000    3.200000     6.000000   1.8000000  virginica\n127     6.200000    2.800000     4.800000   1.7237000  virginica\n128     6.100000    3.000000     4.900000   1.8000000  virginica\n129     6.400000    2.800000     5.600000   2.1000000  virginica\n130     7.200000    3.045971     5.800000   2.0216667  virginica\n131     7.400000    2.800000     6.326700   1.9000000  virginica\n132     7.477000    2.862000     6.400000   2.0000000  virginica\n133     6.409000    2.800000     5.600000   2.2000000  virginica\n134     6.300000    2.800000     5.100000   1.5000000  virginica\n135     6.100000    2.600000     5.600000   1.9045667  virginica\n136     7.186500    3.000000     6.100000   2.0358333  virginica\n137     6.300000    3.400000     5.600000   2.4000000  virginica\n138     6.586857    3.100000     5.500000   1.8000000  virginica\n139     6.000000    3.000000     4.800000   1.8000000  virginica\n140     6.900000    3.100000     5.400000   2.1000000  virginica\n141     6.700000    3.100000     5.317300   2.4000000  virginica\n142     6.900000    3.100000     5.100000   2.3000000  virginica\n143     5.800000    2.700000     5.100000   1.9000000  virginica\n144     6.800000    3.200000     5.900000   2.3000000  virginica\n145     6.700000    3.300000     5.700000   2.5000000  virginica\n146     6.700000    3.118500     5.200000   2.3000000  virginica\n147     6.300000    2.500000     5.000000   1.9000000  virginica\n148     6.500000    3.000000     5.200000   1.9456667  virginica\n149     6.200000    3.400000     5.400000   2.3000000  virginica\n150     5.900000    3.000000     5.100000   1.8000000  virginica\n```\n\n\n:::\n:::\n\n\n\n\nVisualizamos el error cometido en las imputaciones.\n\n\n\n::: {.cell}\n\n```{.r .cell-code}\niris.imp$OOBerror\n```\n\n::: {.cell-output .cell-output-stdout}\n\n```\n       MSE        MSE        MSE        MSE        PFC \n0.12395058 0.08867171 0.06091633 0.02916087 0.04477612 \n```\n\n\n:::\n:::\n\n\n\nNRMSE és un error normalitzat mitjà al quadrat. S'utilitza per representar l'error derivat d'imputar valors continus. El PFC (proporció de falsament classificada) s'utilitza per representar l'error derivat d'imputar valors categòrics.\n\nComparamos el accuracy actual,\n\n\n\n::: {.cell}\n\n```{.r .cell-code}\n(iris.err <- mixError(iris.imp$ximp, iris.mis, iris))\n```\n\n::: {.cell-output .cell-output-stdout}\n\n```\n    NRMSE       PFC \n0.1403915 0.0000000 \n```\n\n\n:::\n:::\n\n\n\nMiramos la diferencia entre las dos imputaciones \n\n\n\n::: {.cell}\n\n```{.r .cell-code}\nnewBD <- data.frame(real = iris[, \"Sepal.Length\"], imputed =  iris.imp$ximp[, \"Sepal.Length\"])\ndf_long <- newBD %>%\n  pivot_longer(cols = everything(), names_to = \"Variable\", values_to = \"Valor\")\n\nggplot(df_long, aes(x = Valor, fill = Variable)) +\n  geom_density(alpha = 0.3) +  # Transparencia para mejor visualización\n  labs(title = \"Densidad de las tres variables\",\n       x = \"Valor\",\n       y = \"Densidad\") +\n  theme_minimal() +\n  scale_fill_manual(values = c(\"blue\", \"red\"))\n```\n\n::: {.cell-output-display}\n![](AdvancedPreprocessing_files/figure-html/unnamed-chunk-22-1.png){width=672}\n:::\n:::\n\n\n\n### Exercises: \n1. Deploy the multiple plot to compare te imputation and not imputation with all numeric vars in dataframe\n\n### Extra: \n\nQuan es tracta de valors que manquen, és possible que vulgueu reemplaçar valors per valors que manquen (NA). Això és útil en els casos en què es coneix l'origen de les dades i es pot estar segur de quins valors han de faltar. Per exemple, podríeu saber que tots els valors de «N/A», «N A» i «No disponible», o -99 o -1 se suposa que falten.\n\nnaniar proporciona funcions per treballar específicament en aquest tipus de problemes utilitzant la funció replace.with.na. Aquesta funció és el compliment a tidyr::replace els NA's, que reemplaça un valor NA per un valor especificat, mentre que naniar::replace,with_na reemplaça un valor per un NA:\n\n\n\n::: {.cell}\n\n```{.r .cell-code}\ntidyr::replace_na: Missing values turns into a value (NA –> -99)\nnaniar::replace_with_na: Value becomes a missing value (-99 –> NA)\n```\n:::\n\n\n\n\n# Bibliografía\n## Outliers\n\n-   https://statsandr.com/blog/outliers-detection-in-r/#z-scores\n-   https://m-mburu.github.io/datacamp/anomaly_detection_R/anomaly_detection.html\n-   https://github.com/pridiltal/ctv-AnomalyDetection\n\n## Imputación\n\n-   http://naniar.njtierney.com/articles/replace-with-na.html\n-   https://cran.r-project.org/web/packages/visdat/vignettes/using_visdat.html\n-   https://cran.r-project.org/web/packages/DMwR2/DMwR2.pdf\n-   https://ltorgo.github.io/DMwR2/RintroDM.html#data_pre-processing\n-   https://www.rdocumentation.org/packages/DMwR/versions/0.4.1/topics/knnImputation\n-   https://amices.org/mice/\n\n",
    "supporting": [
      "AdvancedPreprocessing_files"
    ],
    "filters": [
      "rmarkdown/pagebreak.lua"
    ],
    "includes": {
      "include-in-header": [
        "<link href=\"../../site_libs/htmltools-fill-0.5.8.1/fill.css\" rel=\"stylesheet\" />\n<script src=\"../../site_libs/htmlwidgets-1.6.4/htmlwidgets.js\"></script>\n<script src=\"../../site_libs/plotly-binding-4.10.4/plotly.js\"></script>\n<script src=\"../../site_libs/typedarray-0.1/typedarray.min.js\"></script>\n<script src=\"../../site_libs/jquery-3.5.1/jquery.min.js\"></script>\n<link href=\"../../site_libs/crosstalk-1.2.1/css/crosstalk.min.css\" rel=\"stylesheet\" />\n<script src=\"../../site_libs/crosstalk-1.2.1/js/crosstalk.min.js\"></script>\n<link href=\"../../site_libs/plotly-htmlwidgets-css-2.11.1/plotly-htmlwidgets.css\" rel=\"stylesheet\" />\n<script src=\"../../site_libs/plotly-main-2.11.1/plotly-latest.min.js\"></script>\n"
      ]
    },
    "engineDependencies": {},
    "preserve": {},
    "postProcess": true
  }
}
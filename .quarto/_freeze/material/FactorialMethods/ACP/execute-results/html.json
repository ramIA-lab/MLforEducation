{
  "hash": "a1b1e493f61e0639754cbc9f049cc9b7",
  "result": {
    "engine": "knitr",
    "markdown": "---\ntitle: \"Anàlisis de Components Principals (ACP)\"\nauthor: Dante Conti, Sergi Ramirez, (c) IDEAI\ndate: \"2025-09-21\"\ndate-modified: \"2025-09-21\"\ntoc: true\n# language: es\nnumber-sections: true\nformat: \n  html: \n    theme:\n      light: cerulean\n      dark: darkly\neditor: visual\n#execute: \n#  freeze: auto\n---\n\n\n\n\n\n## Introducció\n\nL'anàlisi de correspondencies simples (ACS) s'utilitza per a descriure taules de contingència [^1] (TC) mitjançant la representació geomètrica de les taules de condicionals fila i columna (perfils) derivades d'aquelles.\n\n[^1]: En estadística les taules de contingència s'empren per a registrar i analitzar l'associació entre dues o més variables, habitualment de naturalesa qualitativa (nominals o ordinals).\n\nL'objectiu de l'ACS és descriure les associacions entre les variables fila i columna, a través dels seus perfils:\n\n-   Comparar els perfilis fila.\n\n-   Comparar els perfilis columna.\n\n-   Estudiar les correspondències entre perfils fila i columna\n\nLa metodologia la va desenvolupar **Benzecri**, a principis dels anys 60 del segle XX en la Universitat de **Renner (França)**. En essència. és un tipus especial d'anàlisi de components principals però realitzat sobre una taula de contingència i usant una distància euclidiana ponderada anomenada chi-quadrat ($\\chi^{2}$)\n\n### Contrast de Chi-quadrat ($\\chi^{2}$)\n\nLa prova de chi-quadrat ($\\chi^{2}$) és un mètode estadístic que s'utilitza per a determinar si existeix una associació significativa entre variables categòriques comparant les freqüències observades i esperades en una taula de contingència.\n\n*H0 :* No hi ha associació significativa entre les variables.\n\n*H1 :* Hi ha una associació significativa entre les variables.\n\nPer a realitzar la prova chi-quadrat ($\\chi^{2}$):\n\n1- Crear una taula de contingència amb les freqüències observades per a cada categoria.\n\n2- Calcular les freqüències esperades assumint la independència entre les variables.\n\n3- Calcular l'estadístic chi-quadrat ($\\chi^{2}$).\n\nComparar l'estadístic calculat amb el valor crític de la distribució chi-quadrat ($\\chi^{2}$) per a determinar si es rebutja o no la hipòtesi nul·la.\n\n$$\n  \\chi^{2} = \\sum{\\frac{(O_{ij}-E_{ij})^{2}}{E_{ij}}}\n$$ Ón:\n\n-   $chi-quadrat ($\\chi\\^{2}$)$: El estadístic de prova $\\chi^{2}$, medeix la discrepancia entre els valors observats i els esperats\n\n-   $\\sum$ (sigma): Suma els valors de cada cela de la taula de contingència.\n\n-   $O_{ij}$: La freqüència observada en cada cel·la de la taula de contingència.\n\n-   $E_{ij}$: La freqüència esperada en cada cel·la de la taula de contingència.\n\n**Casos d'ús d'exemple**\n\n-   Avaluar la relació entre les variables demogràfiques (per exemple, edat, gènere, ingressos) i les preferències del consumidor o el comportament de compra.\n\n-   Examinar l'associació entre els factors de risc i els resultats de les malalties, com el tabaquisme i la incidència el càncer de pulmó.\n\n-   Explorar la relació entre variables categòriques com el nivell educatiu i la situació laboral o l'afiliació política i el comportament electoral.\n\n-   Determinar si els patrons d'herència observats són consistents amb les proporcions mendelianes esperades, o si uns certs marcadors genètics estan associats amb trets o malalties específiques.\n\n-   Avaluar la relació entre les variables de control de qualitat, com el tipus de defecte, i la línia de producció.\n\n**Suposicions**\n\n1.  **Independència:** L'ocurrència d'una observació no ha d'influir ni ser influenciada per una altra observació.\n\n2.  **Categòric:** Totes dues variables són per a dades categòriques.\n\n3.  **Mútuament excloents:** Les observacions només poden pertànyer a una cel·la de la taula de contingència.\n\n4.  **Grandària de la mostra:** Ha d'haver-hi almenys cinc observacions en cada cel·la de la taula de contingència.\n\n**Proves alternatives**\n\n**Prova exacta de *Fisher*:** adequada quan la grandària de la mostra és petit i les freqüències de cel·la esperades en la taula de contingència són inferiors a 5. Sovint s'utilitza com a alternativa a la prova de chi-quadrat en taules de contingència de 2x2.\n\n**Prova de *McNemar*:** s'utilitza en analitzar dades categòriques aparellades, generalment en una taula de contingència de 2x2, on les observacions són dependents o estan relacionades. S'utilitza comunament en estudis d'abans i després o en estudis de casos i controls aparellats.\n\n**Prova de *Cochran-Estovalles-Haenszel*:** s'utilitza en analitzar dades categòriques en estudis estratificats o aparellats. Permet la comparació de múltiples taules de contingència 2x2 mentre controla variables de confusió o factors d'estratificació.\n\n\n\n\n\n::: {.cell}\n\n```{.r .cell-code}\nlibrary(\"factoextra\")\nlibrary(\"FactoMineR\")\nlibrary(\"gplots\")\nlibrary(\"dplyr\")\n```\n:::\n\n\n\n\n\n## Definició del problema\n\n\n\n\n\n::: {.cell}\n\n```{.r .cell-code}\ndata(\"housetasks\")\nhead(housetasks)\n```\n\n::: {.cell-output .cell-output-stdout}\n\n```\n           Wife Alternating Husband Jointly\nLaundry     156          14       2       4\nMain_meal   124          20       5       4\nDinner       77          11       7      13\nBreakfeast   82          36      15       7\nTidying      53          11       1      57\nDishes       32          24       4      53\n```\n\n\n:::\n\n```{.r .cell-code}\ncolnames(housetasks) <- c(\"Dona\", \"Alternant\", \"Marit\", \"Conjuntament\")\nrownames(housetasks) <- c(\"Bugaderia\", \"Dinar\", \"Sopar\", \"Esmorçar\", \"Ordenar\", \"Netejar_Plats\", \"Compres\", \"Oficial\", \"Conduir\", \"Finances\", \"Assegurança\", \"Reparacions\", \"Vacances\")\n\ndf <- as.table(as.matrix(housetasks))\ndf\n```\n\n::: {.cell-output .cell-output-stdout}\n\n```\n              Dona Alternant Marit Conjuntament\nBugaderia      156        14     2            4\nDinar          124        20     5            4\nSopar           77        11     7           13\nEsmorçar        82        36    15            7\nOrdenar         53        11     1           57\nNetejar_Plats   32        24     4           53\nCompres         33        23     9           55\nOficial         12        46    23           15\nConduir         10        51    75            3\nFinances        13        13    21           66\nAssegurança      8         1    53           77\nReparacions      0         3   160            2\nVacances         0         1     6          153\n```\n\n\n:::\n:::\n\n::: {.cell}\n\n```{.r .cell-code}\nballoonplot(t(df), label=F, main=\"Tareas del hogar\")\n```\n\n::: {.cell-output-display}\n![](ACP_files/figure-html/unnamed-chunk-1-1.png){width=672}\n:::\n:::\n\n\n\n\n\n## Prova de la $\\chi^{2}$\n\n$H_{0}$: Variables independents (hipòtesi nula) $H_{1}$: Variables dependents (hipòtesi alternativa)\n\n\n\n\n\n::: {.cell}\n\n```{.r .cell-code}\nchisq.test(housetasks)\n```\n\n::: {.cell-output .cell-output-stdout}\n\n```\n\n\tPearson's Chi-squared test\n\ndata:  housetasks\nX-squared = 1944.5, df = 36, p-value < 2.2e-16\n```\n\n\n:::\n:::\n\n\n\n\n\nEs refusa l'hipòtesi nula en favor de la alternativa, les parelles s'organitzen per fer les tasques de la llar.\n\n## Anàlisi de Correspondència Simple (ACS)\n\n\n\n\n\n::: {.cell}\n\n```{.r .cell-code}\nhousetasks_CA <- CA(housetasks, graph = F)\nprint(housetasks_CA)\n```\n\n::: {.cell-output .cell-output-stdout}\n\n```\n**Results of the Correspondence Analysis (CA)**\nThe row variable has  13  categories; the column variable has 4 categories\nThe chi square of independence between the two variables is equal to 1944.456 (p-value =  0 ).\n*The results are available in the following objects:\n\n   name              description                   \n1  \"$eig\"            \"eigenvalues\"                 \n2  \"$col\"            \"results for the columns\"     \n3  \"$col$coord\"      \"coord. for the columns\"      \n4  \"$col$cos2\"       \"cos2 for the columns\"        \n5  \"$col$contrib\"    \"contributions of the columns\"\n6  \"$row\"            \"results for the rows\"        \n7  \"$row$coord\"      \"coord. for the rows\"         \n8  \"$row$cos2\"       \"cos2 for the rows\"           \n9  \"$row$contrib\"    \"contributions of the rows\"   \n10 \"$call\"           \"summary called parameters\"   \n11 \"$call$marge.col\" \"weights of the columns\"      \n12 \"$call$marge.row\" \"weights of the rows\"         \n```\n\n\n:::\n:::\n\n::: {.cell}\n\n```{.r .cell-code}\nhousetasks_CA$col\n```\n\n::: {.cell-output .cell-output-stdout}\n\n```\n$coord\n                   Dim 1      Dim 2       Dim 3\nDona         -0.83762154  0.3652207 -0.19991139\nAlternant    -0.06218462  0.2915938  0.84858939\nMarit         1.16091847  0.6019199 -0.18885924\nConjuntament  0.14942609 -1.0265791 -0.04644302\n\n$contrib\n                 Dim 1     Dim 2      Dim 3\nDona         44.462018 10.312237 10.8220753\nAlternant     0.103739  2.782794 82.5492464\nMarit        54.233879 17.786612  6.1331792\nConjuntament  1.200364 69.118357  0.4954991\n\n$cos2\n                   Dim 1     Dim 2       Dim 3\nDona         0.801875947 0.1524482 0.045675847\nAlternant    0.004779897 0.1051016 0.890118521\nMarit        0.772026244 0.2075420 0.020431728\nConjuntament 0.020705858 0.9772939 0.002000236\n\n$inertia\n[1] 0.3010185 0.1178242 0.3813729 0.3147248\n```\n\n\n:::\n:::\n\n::: {.cell}\n\n```{.r .cell-code}\nhousetasks_CA$row\n```\n\n::: {.cell-output .cell-output-stdout}\n\n```\n$coord\n                   Dim 1      Dim 2       Dim 3\nBugaderia     -0.9918368  0.4953220 -0.31672897\nDinar         -0.8755855  0.4901092 -0.16406487\nSopar         -0.6925740  0.3081043 -0.20741377\nEsmorçar      -0.5086002  0.4528038  0.22040453\nOrdenar       -0.3938084 -0.4343444 -0.09421375\nNetejar_Plats -0.1889641 -0.4419662  0.26694926\nCompres       -0.1176813 -0.4033171  0.20261512\nOficial        0.2266324  0.2536132  0.92336416\nConduir        0.7417696  0.6534143  0.54445849\nFinances       0.2707669 -0.6178684  0.03479681\nAssegurança    0.6470759 -0.4737832 -0.28936051\nReparacions    1.5287787  0.8642647 -0.47208778\nVacances       0.2524863 -1.4350066 -0.12958665\n\n$contrib\n                   Dim 1      Dim 2       Dim 3\nBugaderia     18.2867003  5.5638913  7.96842443\nDinar         12.3888433  4.7355230  1.85868941\nSopar          5.4713982  1.3210221  2.09692603\nEsmorçar       3.8249284  3.6986131  3.06939857\nOrdenar        1.9983518  2.9656441  0.48873403\nNetejar_Plats  0.4261663  2.8441170  3.63429434\nCompres        0.1755248  2.5151584  2.22335679\nOficial        0.5207837  0.7956201 36.94038942\nConduir        8.0778371  7.6468564 18.59638635\nFinances       0.8750075  5.5585460  0.06175066\nAssegurança    6.1470616  4.0203590  5.25263863\nReparacions   40.7300940 15.8806509 16.59639139\nVacances       1.0773030 42.4539986  1.21261994\n\n$cos2\n                   Dim 1      Dim 2       Dim 3\nBugaderia     0.73998741 0.18455213 0.075460467\nDinar         0.74160285 0.23235928 0.026037873\nSopar         0.77664011 0.15370323 0.069656660\nEsmorçar      0.50494329 0.40023001 0.094826699\nOrdenar       0.43981243 0.53501508 0.025172490\nNetejar_Plats 0.11811778 0.64615253 0.235729693\nCompres       0.06365362 0.74765514 0.188691242\nOficial       0.05304464 0.06642648 0.880528877\nConduir       0.43201860 0.33522911 0.232752289\nFinances      0.16067678 0.83666958 0.002653634\nAssegurança   0.57601197 0.30880208 0.115185951\nReparacions   0.70673575 0.22587147 0.067392778\nVacances      0.02979239 0.96235977 0.007847841\n\n$inertia\n [1] 0.13415976 0.09069235 0.03824633 0.04112368 0.02466697 0.01958732\n [7] 0.01497017 0.05330000 0.10150885 0.02956446 0.05793584 0.31287411\n[13] 0.19631064\n```\n\n\n:::\n:::\n\n::: {.cell}\n\n```{.r .cell-code}\nfviz_screeplot(housetasks_CA, addlabel=T)\n```\n\n::: {.cell-output-display}\n![](ACP_files/figure-html/unnamed-chunk-6-1.png){width=672}\n:::\n:::\n\n\n\n\n\nEl 89% de la variança de les variables están explicades per les dimensiones 1 i 2.\n\n\n\n\n\n::: {.cell}\n\n```{.r .cell-code}\nfviz_ca_biplot(housetasks_CA,repel = T)\n```\n\n::: {.cell-output-display}\n![](ACP_files/figure-html/unnamed-chunk-7-1.png){width=672}\n:::\n:::\n\n\n\n\n\nLa descripció del gràfic és el següent:\n\n-   **Blau**: Corresponen a les files\n-   **Vermell**: Corresponen a les columnes\n\nD'aqui podem extreure les següents conclusions:\n\n1- Les tasques de dinar, sopar, estendre i esmorçar son realitzades amb més freqüéncia per les dones.\n\n2- Les tasques de conduir i fer reparacions es realitzen amb més freqüéncia pels marits.\n\n3- Les tasques de vacances, finances i seguretat ho fan en conjunt.\n\nPer tal de poder descriure les dimensions, podem realitzar un gràfic de correlacions.\n\n\n\n\n\n::: {.cell}\n\n```{.r .cell-code}\nlibrary(corrplot)\ncorrplot(housetasks_CA$col$cos2)\n```\n\n::: {.cell-output-display}\n![](ACP_files/figure-html/unnamed-chunk-8-1.png){width=672}\n:::\n:::\n\n\n\n\n\nUtilitzem la distància $cos^{2}$ per la variable de tasques.\n\n\n\n\n\n::: {.cell}\n\n```{.r .cell-code}\ncorrplot(housetasks_CA$row$cos2 )\n```\n\n::: {.cell-output-display}\n![](ACP_files/figure-html/unnamed-chunk-9-1.png){width=672}\n:::\n:::\n\n\n\n\n\nD'aquí podem extreure que:\n\n-   La 1a component fa referència a tasques realitzades de manera individual\n\n-   La 2a component fa referència a tasques realitzades de manera col·lectiva.\n\nA continuació anem a veure la contribució de cada columna a cada dimensió:\n\n\n\n\n\n::: {.cell}\n\n```{.r .cell-code}\nfviz_contrib(housetasks_CA, choice = \"col\" ,axes = 1)\n```\n\n::: {.cell-output-display}\n![](ACP_files/figure-html/unnamed-chunk-10-1.png){width=672}\n:::\n:::\n\n::: {.cell}\n\n```{.r .cell-code}\nfviz_contrib(housetasks_CA, choice = \"col\" ,axes = 2)\n```\n\n::: {.cell-output-display}\n![](ACP_files/figure-html/unnamed-chunk-11-1.png){width=672}\n:::\n:::\n\n::: {.cell}\n\n```{.r .cell-code}\nfviz_contrib(housetasks_CA, choice = \"col\" ,axes = 1:2)\n```\n\n::: {.cell-output-display}\n![](ACP_files/figure-html/unnamed-chunk-12-1.png){width=672}\n:::\n:::\n\n::: {.cell}\n\n```{.r .cell-code}\nfviz_contrib(housetasks_CA, choice = \"row\" ,axes = 1)\n```\n\n::: {.cell-output-display}\n![](ACP_files/figure-html/unnamed-chunk-13-1.png){width=672}\n:::\n:::\n\n::: {.cell}\n\n```{.r .cell-code}\nfviz_contrib(housetasks_CA, choice = \"row\" ,axes = 2)\n```\n\n::: {.cell-output-display}\n![](ACP_files/figure-html/unnamed-chunk-14-1.png){width=672}\n:::\n:::\n\n::: {.cell}\n\n```{.r .cell-code}\nfviz_contrib(housetasks_CA, choice = \"row\" ,axes = 1:2)\n```\n\n::: {.cell-output-display}\n![](ACP_files/figure-html/unnamed-chunk-15-1.png){width=672}\n:::\n:::\n\n::: {.cell}\n\n```{.r .cell-code}\nfviz_ca_biplot(housetasks_CA,repel = T, arrow = c(F,T), col.col = \"cos2\", \n               gradient.cols = c(\"red\", \"yellow\", \"green\"),\n               alpha.col = \"contrib\")\n```\n\n::: {.cell-output-display}\n![](ACP_files/figure-html/unnamed-chunk-16-1.png){width=672}\n:::\n:::\n\n\n\n\n\n::: {#refs}\n:::\n",
    "supporting": [
      "ACP_files"
    ],
    "filters": [
      "rmarkdown/pagebreak.lua"
    ],
    "includes": {},
    "engineDependencies": {},
    "preserve": {},
    "postProcess": true
  }
}
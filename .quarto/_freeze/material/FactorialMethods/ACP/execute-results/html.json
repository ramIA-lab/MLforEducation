{
  "hash": "0f57f0009c4401428e54f3529d077a0f",
  "result": {
    "engine": "knitr",
    "markdown": "---\ntitle: \"Anàlisis de Components Principals (ACP)\"\nauthor: Dante Conti, Sergi Ramirez, (c) IDEAI\ndate: \"2025-09-30\"\ndate-modified: \"2025-09-30\"\ntoc: true\n# language: es\nnumber-sections: true\nformat: \n  html: \n    theme:\n      light: cerulean\n      dark: darkly\neditor: visual\n#execute: \n#  freeze: auto\n---\n\n\n\n# ¿Qué es el ACP?\n\nEl **Análisis de Componentes Principales (ACP)** es una técnica de **reducción de dimensionalidad** que transforma un conjunto de variables posiblemente correlacionadas en un conjunto más pequeño de variables no correlacionadas llamadas **componentes principales (CPs)**.  \nObjetivos típicos:\n\n- Capturar la mayor **varianza** con el menor número de componentes.  \n- **Descorrelacionar** variables y simplificar la estructura.  \n- Facilitar **visualización**, **preprocesamiento** para modelos y **compresión**.\n\n> Intuición: el ACP encuentra direcciones (vectores) en el espacio de los datos que maximizan la varianza. Esas direcciones son los **autovectores** de la matriz de covarianzas (o correlaciones), y la varianza capturada por cada componente viene dada por su **autovalor**.\n\n# Supuestos y buenas prácticas\n\n- **Estandarización**: si las variables tienen escalas diferentes, estandariza (media 0, var 1).  \n- **Linealidad**: PCA capta relaciones lineales.  \n- **Outliers**: pueden dominar la varianza; considera limpiarlos o usar variantes robustas.  \n- **Datos numéricos**: para variables categóricas puras, usa técnicas específicas (MCA/FAMD).\n\n# Flujo de trabajo (resumen)\n\n1. Estandarizar (opcional pero recomendado).  \n2. Ajustar ACP sobre matriz estandarizada.  \n3. Evaluar **varianza explicada** y elegir k componentes.  \n4. Inspeccionar **cargas** (loadings) y **scores**.  \n5. Visualizar: **scree plot**, **biplot**.  \n6. Proyectar nuevos datos y (si aplica) reconstruir.\n\n# Dataset de ejemplo\n\nUsaremos el clásico **Iris** (4 variables numéricas, 3 especies).  \nEn R: `datasets::iris`.  \nEn Python: `sklearn.datasets.load_iris()`.\n\n\n# Datos y estandarización\n\n::: panel-tabset\n\n## R\n\n\n\n::: {.cell}\n\n```{.r .cell-code}\n# Paquetes\nlibrary(dplyr)\n```\n\n::: {.cell-output .cell-output-stderr}\n\n```\n\nAdjuntando el paquete: 'dplyr'\n```\n\n\n:::\n\n::: {.cell-output .cell-output-stderr}\n\n```\nThe following objects are masked from 'package:stats':\n\n    filter, lag\n```\n\n\n:::\n\n::: {.cell-output .cell-output-stderr}\n\n```\nThe following objects are masked from 'package:base':\n\n    intersect, setdiff, setequal, union\n```\n\n\n:::\n\n```{.r .cell-code}\nlibrary(ggplot2)\n\n# Cargar iris\ndata(iris)\ndf <- iris %>% select(-Species)  # solo numéricas\n\n# Estandarizar (media 0, sd 1)\ndf_scaled <- scale(df)\n\n# Vista rápida\nas_tibble(head(df)) %>% print(n=6)\n```\n\n::: {.cell-output .cell-output-stdout}\n\n```\n# A tibble: 6 × 4\n  Sepal.Length Sepal.Width Petal.Length Petal.Width\n         <dbl>       <dbl>        <dbl>       <dbl>\n1          5.1         3.5          1.4         0.2\n2          4.9         3            1.4         0.2\n3          4.7         3.2          1.3         0.2\n4          4.6         3.1          1.5         0.2\n5          5           3.6          1.4         0.2\n6          5.4         3.9          1.7         0.4\n```\n\n\n:::\n\n```{.r .cell-code}\napply(df_scaled, 2, sd)   # ~1\n```\n\n::: {.cell-output .cell-output-stdout}\n\n```\nSepal.Length  Sepal.Width Petal.Length  Petal.Width \n           1            1            1            1 \n```\n\n\n:::\n:::\n\n\n\n\n## Python\n\n\n\n::: {.cell}\n\n```{.python .cell-code}\nimport numpy as np\nimport pandas as pd\nfrom sklearn.datasets import load_iris\nfrom sklearn.preprocessing import StandardScaler\n\n# Cargar iris\niris = load_iris()\nX = pd.DataFrame(iris.data, columns=iris.feature_names)\ny = pd.Series(iris.target, name=\"species\")  # 0,1,2\n\n# Estandarizar\nscaler = StandardScaler()\nX_scaled = scaler.fit_transform(X)\n\n# Vista rápida\nX.head()\n```\n\n::: {.cell-output .cell-output-stdout}\n\n```\n   sepal length (cm)  sepal width (cm)  petal length (cm)  petal width (cm)\n0                5.1               3.5                1.4               0.2\n1                4.9               3.0                1.4               0.2\n2                4.7               3.2                1.3               0.2\n3                4.6               3.1                1.5               0.2\n4                5.0               3.6                1.4               0.2\n```\n\n\n:::\n\n```{.python .cell-code}\nnp.std(X_scaled, axis=0)  # ~1\n```\n\n::: {.cell-output .cell-output-stdout}\n\n```\narray([1., 1., 1., 1.])\n```\n\n\n:::\n:::\n\n\n:::\n\n# Ajuste del ACP\n\n::: panel-tabset\n\n## R\n\n\n\n::: {.cell}\n\n```{.r .cell-code}\n# prcomp usa SVD; center=TRUE, scale.=TRUE también estandariza internamente\npca <- prcomp(df, center = TRUE, scale. = TRUE)\n\n# Varianza explicada\nvar_exp <- pca$sdev^2\nvar_exp_ratio <- var_exp / sum(var_exp)\ncum_exp_ratio <- cumsum(var_exp_ratio)\n\nvar_exp_ratio\n```\n\n::: {.cell-output .cell-output-stdout}\n\n```\n[1] 0.729624454 0.228507618 0.036689219 0.005178709\n```\n\n\n:::\n\n```{.r .cell-code}\ncum_exp_ratio\n```\n\n::: {.cell-output .cell-output-stdout}\n\n```\n[1] 0.7296245 0.9581321 0.9948213 1.0000000\n```\n\n\n:::\n:::\n\n\n\n\n## Python \n\n\n\n::: {.cell}\n\n```{.python .cell-code}\nfrom sklearn.decomposition import PCA\n\npca = PCA()  # por defecto n_components = min(n_samples, n_features)\npca.fit(X_scaled)\n```\n\n::: {.cell-output-display}\n\n```{=html}\n<style>#sk-container-id-1 {\n  /* Definition of color scheme common for light and dark mode */\n  --sklearn-color-text: #000;\n  --sklearn-color-text-muted: #666;\n  --sklearn-color-line: gray;\n  /* Definition of color scheme for unfitted estimators */\n  --sklearn-color-unfitted-level-0: #fff5e6;\n  --sklearn-color-unfitted-level-1: #f6e4d2;\n  --sklearn-color-unfitted-level-2: #ffe0b3;\n  --sklearn-color-unfitted-level-3: chocolate;\n  /* Definition of color scheme for fitted estimators */\n  --sklearn-color-fitted-level-0: #f0f8ff;\n  --sklearn-color-fitted-level-1: #d4ebff;\n  --sklearn-color-fitted-level-2: #b3dbfd;\n  --sklearn-color-fitted-level-3: cornflowerblue;\n\n  /* Specific color for light theme */\n  --sklearn-color-text-on-default-background: var(--sg-text-color, var(--theme-code-foreground, var(--jp-content-font-color1, black)));\n  --sklearn-color-background: var(--sg-background-color, var(--theme-background, var(--jp-layout-color0, white)));\n  --sklearn-color-border-box: var(--sg-text-color, var(--theme-code-foreground, var(--jp-content-font-color1, black)));\n  --sklearn-color-icon: #696969;\n\n  @media (prefers-color-scheme: dark) {\n    /* Redefinition of color scheme for dark theme */\n    --sklearn-color-text-on-default-background: var(--sg-text-color, var(--theme-code-foreground, var(--jp-content-font-color1, white)));\n    --sklearn-color-background: var(--sg-background-color, var(--theme-background, var(--jp-layout-color0, #111)));\n    --sklearn-color-border-box: var(--sg-text-color, var(--theme-code-foreground, var(--jp-content-font-color1, white)));\n    --sklearn-color-icon: #878787;\n  }\n}\n\n#sk-container-id-1 {\n  color: var(--sklearn-color-text);\n}\n\n#sk-container-id-1 pre {\n  padding: 0;\n}\n\n#sk-container-id-1 input.sk-hidden--visually {\n  border: 0;\n  clip: rect(1px 1px 1px 1px);\n  clip: rect(1px, 1px, 1px, 1px);\n  height: 1px;\n  margin: -1px;\n  overflow: hidden;\n  padding: 0;\n  position: absolute;\n  width: 1px;\n}\n\n#sk-container-id-1 div.sk-dashed-wrapped {\n  border: 1px dashed var(--sklearn-color-line);\n  margin: 0 0.4em 0.5em 0.4em;\n  box-sizing: border-box;\n  padding-bottom: 0.4em;\n  background-color: var(--sklearn-color-background);\n}\n\n#sk-container-id-1 div.sk-container {\n  /* jupyter's `normalize.less` sets `[hidden] { display: none; }`\n     but bootstrap.min.css set `[hidden] { display: none !important; }`\n     so we also need the `!important` here to be able to override the\n     default hidden behavior on the sphinx rendered scikit-learn.org.\n     See: https://github.com/scikit-learn/scikit-learn/issues/21755 */\n  display: inline-block !important;\n  position: relative;\n}\n\n#sk-container-id-1 div.sk-text-repr-fallback {\n  display: none;\n}\n\ndiv.sk-parallel-item,\ndiv.sk-serial,\ndiv.sk-item {\n  /* draw centered vertical line to link estimators */\n  background-image: linear-gradient(var(--sklearn-color-text-on-default-background), var(--sklearn-color-text-on-default-background));\n  background-size: 2px 100%;\n  background-repeat: no-repeat;\n  background-position: center center;\n}\n\n/* Parallel-specific style estimator block */\n\n#sk-container-id-1 div.sk-parallel-item::after {\n  content: \"\";\n  width: 100%;\n  border-bottom: 2px solid var(--sklearn-color-text-on-default-background);\n  flex-grow: 1;\n}\n\n#sk-container-id-1 div.sk-parallel {\n  display: flex;\n  align-items: stretch;\n  justify-content: center;\n  background-color: var(--sklearn-color-background);\n  position: relative;\n}\n\n#sk-container-id-1 div.sk-parallel-item {\n  display: flex;\n  flex-direction: column;\n}\n\n#sk-container-id-1 div.sk-parallel-item:first-child::after {\n  align-self: flex-end;\n  width: 50%;\n}\n\n#sk-container-id-1 div.sk-parallel-item:last-child::after {\n  align-self: flex-start;\n  width: 50%;\n}\n\n#sk-container-id-1 div.sk-parallel-item:only-child::after {\n  width: 0;\n}\n\n/* Serial-specific style estimator block */\n\n#sk-container-id-1 div.sk-serial {\n  display: flex;\n  flex-direction: column;\n  align-items: center;\n  background-color: var(--sklearn-color-background);\n  padding-right: 1em;\n  padding-left: 1em;\n}\n\n\n/* Toggleable style: style used for estimator/Pipeline/ColumnTransformer box that is\nclickable and can be expanded/collapsed.\n- Pipeline and ColumnTransformer use this feature and define the default style\n- Estimators will overwrite some part of the style using the `sk-estimator` class\n*/\n\n/* Pipeline and ColumnTransformer style (default) */\n\n#sk-container-id-1 div.sk-toggleable {\n  /* Default theme specific background. It is overwritten whether we have a\n  specific estimator or a Pipeline/ColumnTransformer */\n  background-color: var(--sklearn-color-background);\n}\n\n/* Toggleable label */\n#sk-container-id-1 label.sk-toggleable__label {\n  cursor: pointer;\n  display: flex;\n  width: 100%;\n  margin-bottom: 0;\n  padding: 0.5em;\n  box-sizing: border-box;\n  text-align: center;\n  align-items: start;\n  justify-content: space-between;\n  gap: 0.5em;\n}\n\n#sk-container-id-1 label.sk-toggleable__label .caption {\n  font-size: 0.6rem;\n  font-weight: lighter;\n  color: var(--sklearn-color-text-muted);\n}\n\n#sk-container-id-1 label.sk-toggleable__label-arrow:before {\n  /* Arrow on the left of the label */\n  content: \"▸\";\n  float: left;\n  margin-right: 0.25em;\n  color: var(--sklearn-color-icon);\n}\n\n#sk-container-id-1 label.sk-toggleable__label-arrow:hover:before {\n  color: var(--sklearn-color-text);\n}\n\n/* Toggleable content - dropdown */\n\n#sk-container-id-1 div.sk-toggleable__content {\n  display: none;\n  text-align: left;\n  /* unfitted */\n  background-color: var(--sklearn-color-unfitted-level-0);\n}\n\n#sk-container-id-1 div.sk-toggleable__content.fitted {\n  /* fitted */\n  background-color: var(--sklearn-color-fitted-level-0);\n}\n\n#sk-container-id-1 div.sk-toggleable__content pre {\n  margin: 0.2em;\n  border-radius: 0.25em;\n  color: var(--sklearn-color-text);\n  /* unfitted */\n  background-color: var(--sklearn-color-unfitted-level-0);\n}\n\n#sk-container-id-1 div.sk-toggleable__content.fitted pre {\n  /* unfitted */\n  background-color: var(--sklearn-color-fitted-level-0);\n}\n\n#sk-container-id-1 input.sk-toggleable__control:checked~div.sk-toggleable__content {\n  /* Expand drop-down */\n  display: block;\n  width: 100%;\n  overflow: visible;\n}\n\n#sk-container-id-1 input.sk-toggleable__control:checked~label.sk-toggleable__label-arrow:before {\n  content: \"▾\";\n}\n\n/* Pipeline/ColumnTransformer-specific style */\n\n#sk-container-id-1 div.sk-label input.sk-toggleable__control:checked~label.sk-toggleable__label {\n  color: var(--sklearn-color-text);\n  background-color: var(--sklearn-color-unfitted-level-2);\n}\n\n#sk-container-id-1 div.sk-label.fitted input.sk-toggleable__control:checked~label.sk-toggleable__label {\n  background-color: var(--sklearn-color-fitted-level-2);\n}\n\n/* Estimator-specific style */\n\n/* Colorize estimator box */\n#sk-container-id-1 div.sk-estimator input.sk-toggleable__control:checked~label.sk-toggleable__label {\n  /* unfitted */\n  background-color: var(--sklearn-color-unfitted-level-2);\n}\n\n#sk-container-id-1 div.sk-estimator.fitted input.sk-toggleable__control:checked~label.sk-toggleable__label {\n  /* fitted */\n  background-color: var(--sklearn-color-fitted-level-2);\n}\n\n#sk-container-id-1 div.sk-label label.sk-toggleable__label,\n#sk-container-id-1 div.sk-label label {\n  /* The background is the default theme color */\n  color: var(--sklearn-color-text-on-default-background);\n}\n\n/* On hover, darken the color of the background */\n#sk-container-id-1 div.sk-label:hover label.sk-toggleable__label {\n  color: var(--sklearn-color-text);\n  background-color: var(--sklearn-color-unfitted-level-2);\n}\n\n/* Label box, darken color on hover, fitted */\n#sk-container-id-1 div.sk-label.fitted:hover label.sk-toggleable__label.fitted {\n  color: var(--sklearn-color-text);\n  background-color: var(--sklearn-color-fitted-level-2);\n}\n\n/* Estimator label */\n\n#sk-container-id-1 div.sk-label label {\n  font-family: monospace;\n  font-weight: bold;\n  display: inline-block;\n  line-height: 1.2em;\n}\n\n#sk-container-id-1 div.sk-label-container {\n  text-align: center;\n}\n\n/* Estimator-specific */\n#sk-container-id-1 div.sk-estimator {\n  font-family: monospace;\n  border: 1px dotted var(--sklearn-color-border-box);\n  border-radius: 0.25em;\n  box-sizing: border-box;\n  margin-bottom: 0.5em;\n  /* unfitted */\n  background-color: var(--sklearn-color-unfitted-level-0);\n}\n\n#sk-container-id-1 div.sk-estimator.fitted {\n  /* fitted */\n  background-color: var(--sklearn-color-fitted-level-0);\n}\n\n/* on hover */\n#sk-container-id-1 div.sk-estimator:hover {\n  /* unfitted */\n  background-color: var(--sklearn-color-unfitted-level-2);\n}\n\n#sk-container-id-1 div.sk-estimator.fitted:hover {\n  /* fitted */\n  background-color: var(--sklearn-color-fitted-level-2);\n}\n\n/* Specification for estimator info (e.g. \"i\" and \"?\") */\n\n/* Common style for \"i\" and \"?\" */\n\n.sk-estimator-doc-link,\na:link.sk-estimator-doc-link,\na:visited.sk-estimator-doc-link {\n  float: right;\n  font-size: smaller;\n  line-height: 1em;\n  font-family: monospace;\n  background-color: var(--sklearn-color-background);\n  border-radius: 1em;\n  height: 1em;\n  width: 1em;\n  text-decoration: none !important;\n  margin-left: 0.5em;\n  text-align: center;\n  /* unfitted */\n  border: var(--sklearn-color-unfitted-level-1) 1pt solid;\n  color: var(--sklearn-color-unfitted-level-1);\n}\n\n.sk-estimator-doc-link.fitted,\na:link.sk-estimator-doc-link.fitted,\na:visited.sk-estimator-doc-link.fitted {\n  /* fitted */\n  border: var(--sklearn-color-fitted-level-1) 1pt solid;\n  color: var(--sklearn-color-fitted-level-1);\n}\n\n/* On hover */\ndiv.sk-estimator:hover .sk-estimator-doc-link:hover,\n.sk-estimator-doc-link:hover,\ndiv.sk-label-container:hover .sk-estimator-doc-link:hover,\n.sk-estimator-doc-link:hover {\n  /* unfitted */\n  background-color: var(--sklearn-color-unfitted-level-3);\n  color: var(--sklearn-color-background);\n  text-decoration: none;\n}\n\ndiv.sk-estimator.fitted:hover .sk-estimator-doc-link.fitted:hover,\n.sk-estimator-doc-link.fitted:hover,\ndiv.sk-label-container:hover .sk-estimator-doc-link.fitted:hover,\n.sk-estimator-doc-link.fitted:hover {\n  /* fitted */\n  background-color: var(--sklearn-color-fitted-level-3);\n  color: var(--sklearn-color-background);\n  text-decoration: none;\n}\n\n/* Span, style for the box shown on hovering the info icon */\n.sk-estimator-doc-link span {\n  display: none;\n  z-index: 9999;\n  position: relative;\n  font-weight: normal;\n  right: .2ex;\n  padding: .5ex;\n  margin: .5ex;\n  width: min-content;\n  min-width: 20ex;\n  max-width: 50ex;\n  color: var(--sklearn-color-text);\n  box-shadow: 2pt 2pt 4pt #999;\n  /* unfitted */\n  background: var(--sklearn-color-unfitted-level-0);\n  border: .5pt solid var(--sklearn-color-unfitted-level-3);\n}\n\n.sk-estimator-doc-link.fitted span {\n  /* fitted */\n  background: var(--sklearn-color-fitted-level-0);\n  border: var(--sklearn-color-fitted-level-3);\n}\n\n.sk-estimator-doc-link:hover span {\n  display: block;\n}\n\n/* \"?\"-specific style due to the `<a>` HTML tag */\n\n#sk-container-id-1 a.estimator_doc_link {\n  float: right;\n  font-size: 1rem;\n  line-height: 1em;\n  font-family: monospace;\n  background-color: var(--sklearn-color-background);\n  border-radius: 1rem;\n  height: 1rem;\n  width: 1rem;\n  text-decoration: none;\n  /* unfitted */\n  color: var(--sklearn-color-unfitted-level-1);\n  border: var(--sklearn-color-unfitted-level-1) 1pt solid;\n}\n\n#sk-container-id-1 a.estimator_doc_link.fitted {\n  /* fitted */\n  border: var(--sklearn-color-fitted-level-1) 1pt solid;\n  color: var(--sklearn-color-fitted-level-1);\n}\n\n/* On hover */\n#sk-container-id-1 a.estimator_doc_link:hover {\n  /* unfitted */\n  background-color: var(--sklearn-color-unfitted-level-3);\n  color: var(--sklearn-color-background);\n  text-decoration: none;\n}\n\n#sk-container-id-1 a.estimator_doc_link.fitted:hover {\n  /* fitted */\n  background-color: var(--sklearn-color-fitted-level-3);\n}\n\n.estimator-table summary {\n    padding: .5rem;\n    font-family: monospace;\n    cursor: pointer;\n}\n\n.estimator-table details[open] {\n    padding-left: 0.1rem;\n    padding-right: 0.1rem;\n    padding-bottom: 0.3rem;\n}\n\n.estimator-table .parameters-table {\n    margin-left: auto !important;\n    margin-right: auto !important;\n}\n\n.estimator-table .parameters-table tr:nth-child(odd) {\n    background-color: #fff;\n}\n\n.estimator-table .parameters-table tr:nth-child(even) {\n    background-color: #f6f6f6;\n}\n\n.estimator-table .parameters-table tr:hover {\n    background-color: #e0e0e0;\n}\n\n.estimator-table table td {\n    border: 1px solid rgba(106, 105, 104, 0.232);\n}\n\n.user-set td {\n    color:rgb(255, 94, 0);\n    text-align: left;\n}\n\n.user-set td.value pre {\n    color:rgb(255, 94, 0) !important;\n    background-color: transparent !important;\n}\n\n.default td {\n    color: black;\n    text-align: left;\n}\n\n.user-set td i,\n.default td i {\n    color: black;\n}\n\n.copy-paste-icon {\n    background-image: url(data:image/svg+xml;base64,PHN2ZyB4bWxucz0iaHR0cDovL3d3dy53My5vcmcvMjAwMC9zdmciIHZpZXdCb3g9IjAgMCA0NDggNTEyIj48IS0tIUZvbnQgQXdlc29tZSBGcmVlIDYuNy4yIGJ5IEBmb250YXdlc29tZSAtIGh0dHBzOi8vZm9udGF3ZXNvbWUuY29tIExpY2Vuc2UgLSBodHRwczovL2ZvbnRhd2Vzb21lLmNvbS9saWNlbnNlL2ZyZWUgQ29weXJpZ2h0IDIwMjUgRm9udGljb25zLCBJbmMuLS0+PHBhdGggZD0iTTIwOCAwTDMzMi4xIDBjMTIuNyAwIDI0LjkgNS4xIDMzLjkgMTQuMWw2Ny45IDY3LjljOSA5IDE0LjEgMjEuMiAxNC4xIDMzLjlMNDQ4IDMzNmMwIDI2LjUtMjEuNSA0OC00OCA0OGwtMTkyIDBjLTI2LjUgMC00OC0yMS41LTQ4LTQ4bDAtMjg4YzAtMjYuNSAyMS41LTQ4IDQ4LTQ4ek00OCAxMjhsODAgMCAwIDY0LTY0IDAgMCAyNTYgMTkyIDAgMC0zMiA2NCAwIDAgNDhjMCAyNi41LTIxLjUgNDgtNDggNDhMNDggNTEyYy0yNi41IDAtNDgtMjEuNS00OC00OEwwIDE3NmMwLTI2LjUgMjEuNS00OCA0OC00OHoiLz48L3N2Zz4=);\n    background-repeat: no-repeat;\n    background-size: 14px 14px;\n    background-position: 0;\n    display: inline-block;\n    width: 14px;\n    height: 14px;\n    cursor: pointer;\n}\n</style><body><div id=\"sk-container-id-1\" class=\"sk-top-container\"><div class=\"sk-text-repr-fallback\"><pre>PCA()</pre><b>In a Jupyter environment, please rerun this cell to show the HTML representation or trust the notebook. <br />On GitHub, the HTML representation is unable to render, please try loading this page with nbviewer.org.</b></div><div class=\"sk-container\" hidden><div class=\"sk-item\"><div class=\"sk-estimator fitted sk-toggleable\"><input class=\"sk-toggleable__control sk-hidden--visually\" id=\"sk-estimator-id-1\" type=\"checkbox\" checked><label for=\"sk-estimator-id-1\" class=\"sk-toggleable__label fitted sk-toggleable__label-arrow\"><div><div>PCA</div></div><div><a class=\"sk-estimator-doc-link fitted\" rel=\"noreferrer\" target=\"_blank\" href=\"https://scikit-learn.org/1.7/modules/generated/sklearn.decomposition.PCA.html\">?<span>Documentation for PCA</span></a><span class=\"sk-estimator-doc-link fitted\">i<span>Fitted</span></span></div></label><div class=\"sk-toggleable__content fitted\" data-param-prefix=\"\">\n        <div class=\"estimator-table\">\n            <details>\n                <summary>Parameters</summary>\n                <table class=\"parameters-table\">\n                  <tbody>\n                    \n        <tr class=\"default\">\n            <td><i class=\"copy-paste-icon\"\n                 onclick=\"copyToClipboard('n_components',\n                          this.parentElement.nextElementSibling)\"\n            ></i></td>\n            <td class=\"param\">n_components&nbsp;</td>\n            <td class=\"value\">None</td>\n        </tr>\n    \n\n        <tr class=\"default\">\n            <td><i class=\"copy-paste-icon\"\n                 onclick=\"copyToClipboard('copy',\n                          this.parentElement.nextElementSibling)\"\n            ></i></td>\n            <td class=\"param\">copy&nbsp;</td>\n            <td class=\"value\">True</td>\n        </tr>\n    \n\n        <tr class=\"default\">\n            <td><i class=\"copy-paste-icon\"\n                 onclick=\"copyToClipboard('whiten',\n                          this.parentElement.nextElementSibling)\"\n            ></i></td>\n            <td class=\"param\">whiten&nbsp;</td>\n            <td class=\"value\">False</td>\n        </tr>\n    \n\n        <tr class=\"default\">\n            <td><i class=\"copy-paste-icon\"\n                 onclick=\"copyToClipboard('svd_solver',\n                          this.parentElement.nextElementSibling)\"\n            ></i></td>\n            <td class=\"param\">svd_solver&nbsp;</td>\n            <td class=\"value\">&#x27;auto&#x27;</td>\n        </tr>\n    \n\n        <tr class=\"default\">\n            <td><i class=\"copy-paste-icon\"\n                 onclick=\"copyToClipboard('tol',\n                          this.parentElement.nextElementSibling)\"\n            ></i></td>\n            <td class=\"param\">tol&nbsp;</td>\n            <td class=\"value\">0.0</td>\n        </tr>\n    \n\n        <tr class=\"default\">\n            <td><i class=\"copy-paste-icon\"\n                 onclick=\"copyToClipboard('iterated_power',\n                          this.parentElement.nextElementSibling)\"\n            ></i></td>\n            <td class=\"param\">iterated_power&nbsp;</td>\n            <td class=\"value\">&#x27;auto&#x27;</td>\n        </tr>\n    \n\n        <tr class=\"default\">\n            <td><i class=\"copy-paste-icon\"\n                 onclick=\"copyToClipboard('n_oversamples',\n                          this.parentElement.nextElementSibling)\"\n            ></i></td>\n            <td class=\"param\">n_oversamples&nbsp;</td>\n            <td class=\"value\">10</td>\n        </tr>\n    \n\n        <tr class=\"default\">\n            <td><i class=\"copy-paste-icon\"\n                 onclick=\"copyToClipboard('power_iteration_normalizer',\n                          this.parentElement.nextElementSibling)\"\n            ></i></td>\n            <td class=\"param\">power_iteration_normalizer&nbsp;</td>\n            <td class=\"value\">&#x27;auto&#x27;</td>\n        </tr>\n    \n\n        <tr class=\"default\">\n            <td><i class=\"copy-paste-icon\"\n                 onclick=\"copyToClipboard('random_state',\n                          this.parentElement.nextElementSibling)\"\n            ></i></td>\n            <td class=\"param\">random_state&nbsp;</td>\n            <td class=\"value\">None</td>\n        </tr>\n    \n                  </tbody>\n                </table>\n            </details>\n        </div>\n    </div></div></div></div></div><script>function copyToClipboard(text, element) {\n    // Get the parameter prefix from the closest toggleable content\n    const toggleableContent = element.closest('.sk-toggleable__content');\n    const paramPrefix = toggleableContent ? toggleableContent.dataset.paramPrefix : '';\n    const fullParamName = paramPrefix ? `${paramPrefix}${text}` : text;\n\n    const originalStyle = element.style;\n    const computedStyle = window.getComputedStyle(element);\n    const originalWidth = computedStyle.width;\n    const originalHTML = element.innerHTML.replace('Copied!', '');\n\n    navigator.clipboard.writeText(fullParamName)\n        .then(() => {\n            element.style.width = originalWidth;\n            element.style.color = 'green';\n            element.innerHTML = \"Copied!\";\n\n            setTimeout(() => {\n                element.innerHTML = originalHTML;\n                element.style = originalStyle;\n            }, 2000);\n        })\n        .catch(err => {\n            console.error('Failed to copy:', err);\n            element.style.color = 'red';\n            element.innerHTML = \"Failed!\";\n            setTimeout(() => {\n                element.innerHTML = originalHTML;\n                element.style = originalStyle;\n            }, 2000);\n        });\n    return false;\n}\n\ndocument.querySelectorAll('.fa-regular.fa-copy').forEach(function(element) {\n    const toggleableContent = element.closest('.sk-toggleable__content');\n    const paramPrefix = toggleableContent ? toggleableContent.dataset.paramPrefix : '';\n    const paramName = element.parentElement.nextElementSibling.textContent.trim();\n    const fullParamName = paramPrefix ? `${paramPrefix}${paramName}` : paramName;\n\n    element.setAttribute('title', fullParamName);\n});\n</script></body>\n```\n\n:::\n\n```{.python .cell-code}\nvar_exp = pca.explained_variance_\nvar_exp_ratio = pca.explained_variance_ratio_\ncum_exp_ratio = np.cumsum(var_exp_ratio)\n\nvar_exp_ratio, cum_exp_ratio\n```\n\n::: {.cell-output .cell-output-stdout}\n\n```\n(array([0.72962445, 0.22850762, 0.03668922, 0.00517871]), array([0.72962445, 0.95813207, 0.99482129, 1.        ]))\n```\n\n\n:::\n:::\n\n\n\n:::\n\n# Scree plot y varianza acumulada\n\n::: panel-tabset\n\n## R\n\n\n\n::: {.cell}\n\n```{.r .cell-code}\nscree_df <- data.frame(\n  PC = paste0(\"PC\", seq_along(var_exp_ratio)),\n  VarExp = var_exp_ratio,\n  CumExp = cum_exp_ratio\n)\n\n# Scree plot\nggplot(scree_df, aes(x = seq_along(VarExp), y = VarExp)) +\n  geom_line() + geom_point() +\n  labs(x = \"Componente\", y = \"Proporción varianza explicada\",\n       title = \"Scree plot (R)\") +\n  theme_minimal()\n```\n\n::: {.cell-output-display}\n![](ACP_files/figure-html/unnamed-chunk-5-1.png){width=672}\n:::\n\n```{.r .cell-code}\n# Varianza acumulada\nggplot(scree_df, aes(x = seq_along(CumExp), y = CumExp)) +\n  geom_line() + geom_point() +\n  geom_hline(yintercept = 0.95, linetype = \"dashed\") +\n  labs(x = \"Componente\", y = \"Varianza acumulada\",\n       title = \"Varianza acumulada (R)\") +\n  theme_minimal()\n```\n\n::: {.cell-output-display}\n![](ACP_files/figure-html/unnamed-chunk-5-2.png){width=672}\n:::\n:::\n\n\n\n\n## Python\n\n\n\n::: {.cell}\n\n```{.python .cell-code}\nimport matplotlib.pyplot as plt\n\n# Scree plot\nplt.figure()\nplt.plot(range(1, len(var_exp_ratio)+1), var_exp_ratio, marker=\"o\")\nplt.xlabel(\"Componente\")\nplt.ylabel(\"Proporción varianza explicada\")\nplt.title(\"Scree plot (Python)\")\nplt.show()\n```\n\n::: {.cell-output-display}\n![](ACP_files/figure-html/unnamed-chunk-6-1.png){width=672}\n:::\n\n```{.python .cell-code}\n# Varianza acumulada\nplt.figure()\nplt.plot(range(1, len(cum_exp_ratio)+1), cum_exp_ratio, marker=\"o\")\nplt.axhline(0.95, linestyle=\"--\")\nplt.xlabel(\"Componente\")\nplt.ylabel(\"Varianza acumulada\")\nplt.title(\"Varianza acumulada (Python)\")\nplt.show()\n```\n\n::: {.cell-output-display}\n![](ACP_files/figure-html/unnamed-chunk-6-2.png){width=672}\n:::\n:::\n\n\n\n:::\n\n# Cargas (loadings) y scores\n\nLas **cargas** indican cuánto contribuye cada variable a cada componente (correlaciones variable–componente).\n\nLos **scores** son las coordenadas de las observaciones en el espacio de componentes.\n\n::: panel-tabset\n\n## R\n\n\n\n::: {.cell}\n\n```{.r .cell-code}\n# Cargas\nloadings <- pca$rotation\nround(loadings, 3)\n```\n\n::: {.cell-output .cell-output-stdout}\n\n```\n                PC1    PC2    PC3    PC4\nSepal.Length  0.521 -0.377  0.720  0.261\nSepal.Width  -0.269 -0.923 -0.244 -0.124\nPetal.Length  0.580 -0.024 -0.142 -0.801\nPetal.Width   0.565 -0.067 -0.634  0.524\n```\n\n\n:::\n\n```{.r .cell-code}\n# Scores\nscores <- pca$x\nhead(scores)\n```\n\n::: {.cell-output .cell-output-stdout}\n\n```\n           PC1        PC2         PC3          PC4\n[1,] -2.257141 -0.4784238  0.12727962  0.024087508\n[2,] -2.074013  0.6718827  0.23382552  0.102662845\n[3,] -2.356335  0.3407664 -0.04405390  0.028282305\n[4,] -2.291707  0.5953999 -0.09098530 -0.065735340\n[5,] -2.381863 -0.6446757 -0.01568565 -0.035802870\n[6,] -2.068701 -1.4842053 -0.02687825  0.006586116\n```\n\n\n:::\n\n```{.r .cell-code}\n# Biplot rápido\nbiplot(pca, cex = 0.7)  # base R\n```\n\n::: {.cell-output-display}\n![](ACP_files/figure-html/unnamed-chunk-7-5.png){width=672}\n:::\n:::\n\n\n\n\n## Python\n\n\n\n::: {.cell}\n\n```{.python .cell-code}\n# Cargas = vectores propios (componentes)\nloadings = pca.components_.T  # shape: n_features x n_components\npd.DataFrame(loadings, index=iris.feature_names,\n             columns=[f\"PC{i+1}\" for i in range(loadings.shape[1])]).round(3)\n```\n\n::: {.cell-output .cell-output-stdout}\n\n```\n                     PC1    PC2    PC3    PC4\nsepal length (cm)  0.521  0.377  0.720 -0.261\nsepal width (cm)  -0.269  0.923 -0.244  0.124\npetal length (cm)  0.580  0.024 -0.142  0.801\npetal width (cm)   0.565  0.067 -0.634 -0.524\n```\n\n\n:::\n\n```{.python .cell-code}\n# Scores (transformación de los datos)\nscores = pca.transform(X_scaled)\npd.DataFrame(scores, columns=[f\"PC{i+1}\" for i in range(scores.shape[1])]).head()\n```\n\n::: {.cell-output .cell-output-stdout}\n\n```\n        PC1       PC2       PC3       PC4\n0 -2.264703  0.480027  0.127706 -0.024168\n1 -2.080961 -0.674134  0.234609 -0.103007\n2 -2.364229 -0.341908 -0.044201 -0.028377\n3 -2.299384 -0.597395 -0.091290  0.065956\n4 -2.389842  0.646835 -0.015738  0.035923\n```\n\n\n:::\n\n```{.python .cell-code}\n# Biplot sencillo (PC1 vs PC2)\npc1, pc2 = 0, 1\nplt.figure()\nplt.scatter(scores[:, pc1], scores[:, pc2], alpha=0.7)\n# Vectores de variables\nfor i, feature in enumerate(iris.feature_names):\n    plt.arrow(0, 0, loadings[i, pc1]*3, loadings[i, pc2]*3, head_width=0.05)\n    plt.text(loadings[i, pc1]*3.2, loadings[i, pc2]*3.2, feature)\nplt.xlabel(\"PC1\")\nplt.ylabel(\"PC2\")\nplt.title(\"Biplot (Python)\")\nplt.axhline(0, linewidth=0.5); plt.axvline(0, linewidth=0.5)\nplt.show()\n```\n\n::: {.cell-output-display}\n![](ACP_files/figure-html/unnamed-chunk-8-1.png){width=672}\n:::\n:::\n\n\n\n:::\n\n## Elección de número de componentes\n\nCriterios habituales:\n\n1. **Codo** del scree plot.\n2. Umbral de **varianza acumulada** (p. ej., 90–95%).\n3. **Kaiser** (autovalores > 1) cuando se usa matriz de correlaciones.\n4. **Validación** en tareas posteriores (clasificación/regresión).\n\n::: panel-tabset\n\n## R\n\n\n\n::: {.cell}\n\n```{.r .cell-code}\n# Elegir k para alcanzar >= 95% varianza\n(k <- which(cum_exp_ratio >= 0.95)[1])\n```\n\n::: {.cell-output .cell-output-stdout}\n\n```\n[1] 2\n```\n\n\n:::\n:::\n\n\n\n\n## Python\n\n\n\n::: {.cell}\n\n```{.python .cell-code}\nk = int(np.argmax(cum_exp_ratio >= 0.95)) + 1\nk\n```\n\n::: {.cell-output .cell-output-stdout}\n\n```\n2\n```\n\n\n:::\n:::\n\n\n\n:::\n\n# Proyección y reconstrucción\n\n::: panel-tabset\n\n## R\n\n\n\n::: {.cell}\n\n```{.r .cell-code}\n# Proyectar datos a k componentes\nk <- which(cum_exp_ratio >= 0.95)[1]\nscores_k <- scores[, 1:k, drop = FALSE]\n\n# Reconstrucción aproximada (desde scores_k -> espacio original estandarizado)\n# X_std_hat = scores_k %*% t(loadings[,1:k])\nXstd_hat <- scores_k %*% t(loadings[, 1:k])\n\n# \"Desestandarizar\" para volver a escala original\nmeans <- attr(df_scaled, \"scaled:center\")\nsds   <- attr(df_scaled, \"scaled:scale\")\nXrec <- sweep(Xstd_hat, 2, sds, `*`)\nXrec <- sweep(Xrec, 2, means, `+`)\n\nas_tibble(head(Xrec))\n```\n\n::: {.cell-output .cell-output-stdout}\n\n```\n# A tibble: 6 × 4\n  Sepal.Length Sepal.Width Petal.Length Petal.Width\n         <dbl>       <dbl>        <dbl>       <dbl>\n1         5.02        3.51         1.47       0.252\n2         4.74        3.03         1.60       0.272\n3         4.72        3.20         1.33       0.167\n4         4.67        3.09         1.38       0.182\n5         5.02        3.60         1.35       0.207\n6         5.41        3.90         1.70       0.384\n```\n\n\n:::\n:::\n\n\n\n\n## Python\n\n\n\n::: {.cell}\n\n```{.python .cell-code}\nk = int(np.argmax(cum_exp_ratio >= 0.95)) + 1\nscores_k = scores[:, :k]\nload_k = loadings[:, :k]\n\n# Reconstrucción en espacio estandarizado\nXstd_hat = np.dot(scores_k, load_k.T)\n\n# Desestandarizar\nXrec = scaler.inverse_transform(Xstd_hat)\npd.DataFrame(Xrec, columns=iris.feature_names).head()\n```\n\n::: {.cell-output .cell-output-stdout}\n\n```\n   sepal length (cm)  sepal width (cm)  petal length (cm)  petal width (cm)\n0           5.018949          3.514854           1.466013          0.251922\n1           4.738463          3.030433           1.603913          0.272074\n2           4.720130          3.196830           1.328961          0.167414\n3           4.668436          3.086770           1.384170          0.182247\n4           5.017093          3.596402           1.345411          0.206706\n```\n\n\n:::\n:::\n\n\n\n:::\n\n# Pipeline para uso en modelos\n\nEn ML, es común encadenar **escalado + PCA** y luego un modelo.\n\n::: panel-tabset\n\n## R\n\n\n\n::: {.cell}\n\n```{.r .cell-code}\n# Ejemplo con caret o tidymodels (aquí base con prcomp para simplicidad)\n# Generar componentes y usar los primeros k como features\nk <- 2\npc_df <- as.data.frame(scores[, 1:k])\npc_df$Species <- iris$Species\nhead(pc_df)\n```\n\n::: {.cell-output .cell-output-stdout}\n\n```\n        PC1        PC2 Species\n1 -2.257141 -0.4784238  setosa\n2 -2.074013  0.6718827  setosa\n3 -2.356335  0.3407664  setosa\n4 -2.291707  0.5953999  setosa\n5 -2.381863 -0.6446757  setosa\n6 -2.068701 -1.4842053  setosa\n```\n\n\n:::\n:::\n\n\n\n\n## Python\n\n\n\n::: {.cell}\n\n```{.python .cell-code}\nfrom sklearn.pipeline import Pipeline\nfrom sklearn.linear_model import LogisticRegression\nfrom sklearn.model_selection import cross_val_score\n\nk = 2\npipe = Pipeline([\n    (\"scaler\", StandardScaler()),\n    (\"pca\", PCA(n_components=k)),\n    (\"clf\", LogisticRegression(max_iter=1000))\n])\n\nscores_cv = cross_val_score(pipe, X, y, cv=5)\nscores_cv.mean(), scores_cv.std()\n```\n\n::: {.cell-output .cell-output-stdout}\n\n```\n(np.float64(0.9133333333333334), np.float64(0.05416025603090639))\n```\n\n\n:::\n:::\n\n\n\n:::\n\n## Interpretación de cargas y biplot\n\n* Vectores largos: variables con alta contribución al componente.\n* Ángulos pequeños entre vectores: variables **correlacionadas.**\n* Puntos (observaciones) próximos: perfiles similares en variables originales.\n* Signo de la carga: dirección de la relación con el componente.\n\n# Trucos y errores comunes\n\n* **No estandarizar** cuando hay escalas muy distintas distorsiona el resultado \n* **Outliers**: revisar o usar alternativas robustas (p. ej., `robustbase` en R, `sklearn` + métodos robustos).\n* **Muchas variables**: considerar **PCA incremental** si hay memoria limitada. \n* **Interpretabilidad**: PCA rota ejes de forma no supervisada, no siempre mapea a factores *interpretables*. \n\n# Referencias rápidas (concepto)\n\n* Componentes = autovectores de covarianzas/correlaciones; varianza = autovalores. \n* `scores = X_estandarizado %*% loadings`\n* Reconstrucción aproximada: `X̂_est = scores_k %*% t(loadings_k)`; desestandarizar para volver a escala original.\n\n",
    "supporting": [
      "ACP_files"
    ],
    "filters": [
      "rmarkdown/pagebreak.lua"
    ],
    "includes": {},
    "engineDependencies": {},
    "preserve": {},
    "postProcess": true
  }
}